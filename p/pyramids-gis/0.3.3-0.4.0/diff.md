# Comparing `tmp/pyramids-gis-0.3.3.tar.gz` & `tmp/pyramids-gis-0.4.0.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "pyramids-gis-0.3.3.tar", last modified: Sun Feb  5 23:47:57 2023, max compression
+gzip compressed data, was "pyramids-gis-0.4.0.tar", last modified: Tue Apr 11 20:27:12 2023, max compression
```

## Comparing `pyramids-gis-0.3.3.tar` & `pyramids-gis-0.4.0.tar`

### file list

```diff
@@ -1,25 +1,27 @@
-drwxrwxrwx   0        0        0        0 2023-02-05 23:47:57.257698 pyramids-gis-0.3.3/
--rw-rw-rw-   0        0        0      173 2023-01-23 00:40:23.000000 pyramids-gis-0.3.3/AUTHORS.rst
--rw-rw-rw-   0        0        0    35591 2023-01-23 00:40:23.000000 pyramids-gis-0.3.3/LICENSE.md
--rw-rw-rw-   0        0        0     9441 2023-02-05 23:47:57.255697 pyramids-gis-0.3.3/PKG-INFO
--rw-rw-rw-   0        0        0     6860 2023-02-05 23:46:48.000000 pyramids-gis-0.3.3/README.md
-drwxrwxrwx   0        0        0        0 2023-02-05 23:47:57.220659 pyramids-gis-0.3.3/pyramids/
--rw-rw-rw-   0        0        0     1036 2023-01-23 00:40:23.000000 pyramids-gis-0.3.3/pyramids/__init__.py
--rw-rw-rw-   0        0        0     1536 2023-01-23 00:40:23.000000 pyramids-gis-0.3.3/pyramids/array.py
--rw-rw-rw-   0        0        0    34420 2023-02-02 23:35:18.000000 pyramids-gis-0.3.3/pyramids/catchment.py
--rw-rw-rw-   0        0        0    30307 2023-02-05 23:46:48.000000 pyramids-gis-0.3.3/pyramids/convert.py
--rw-rw-rw-   0        0        0     1880 2023-01-23 00:40:23.000000 pyramids-gis-0.3.3/pyramids/data.py
--rw-rw-rw-   0        0        0     6370 2023-01-26 22:58:32.000000 pyramids-gis-0.3.3/pyramids/indexing.py
--rw-rw-rw-   0        0        0    11735 2023-01-26 23:48:33.000000 pyramids-gis-0.3.3/pyramids/netcdf.py
--rw-rw-rw-   0        0        0   119523 2023-02-02 23:52:30.000000 pyramids-gis-0.3.3/pyramids/raster.py
--rw-rw-rw-   0        0        0     2665 2023-01-23 00:40:23.000000 pyramids-gis-0.3.3/pyramids/utils.py
--rw-rw-rw-   0        0        0    36223 2023-02-05 23:46:48.000000 pyramids-gis-0.3.3/pyramids/vector.py
-drwxrwxrwx   0        0        0        0 2023-02-05 23:47:57.252698 pyramids-gis-0.3.3/pyramids_gis.egg-info/
--rw-rw-rw-   0        0        0     9441 2023-02-05 23:47:57.000000 pyramids-gis-0.3.3/pyramids_gis.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0      449 2023-02-05 23:47:57.000000 pyramids-gis-0.3.3/pyramids_gis.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2023-02-05 23:47:57.000000 pyramids-gis-0.3.3/pyramids_gis.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0        2 2023-02-05 23:47:57.000000 pyramids-gis-0.3.3/pyramids_gis.egg-info/not-zip-safe
--rw-rw-rw-   0        0        0      242 2023-02-05 23:47:57.000000 pyramids-gis-0.3.3/pyramids_gis.egg-info/requires.txt
--rw-rw-rw-   0        0        0        9 2023-02-05 23:47:57.000000 pyramids-gis-0.3.3/pyramids_gis.egg-info/top_level.txt
--rw-rw-rw-   0        0        0       42 2023-02-05 23:47:57.257698 pyramids-gis-0.3.3/setup.cfg
--rw-rw-rw-   0        0        0     1665 2023-02-05 23:46:48.000000 pyramids-gis-0.3.3/setup.py
+drwxrwxrwx   0        0        0        0 2023-04-11 20:27:12.319140 pyramids-gis-0.4.0/
+-rw-rw-rw-   0        0        0      173 2023-01-23 00:40:23.000000 pyramids-gis-0.4.0/AUTHORS.rst
+-rw-rw-rw-   0        0        0    35591 2023-01-23 00:40:23.000000 pyramids-gis-0.4.0/LICENSE.md
+-rw-rw-rw-   0        0        0    10198 2023-04-11 20:27:12.318136 pyramids-gis-0.4.0/PKG-INFO
+-rw-rw-rw-   0        0        0     7038 2023-04-11 20:12:29.000000 pyramids-gis-0.4.0/README.md
+drwxrwxrwx   0        0        0        0 2023-04-11 20:27:12.264345 pyramids-gis-0.4.0/pyramids/
+-rw-rw-rw-   0        0        0     1036 2023-01-23 00:40:23.000000 pyramids-gis-0.4.0/pyramids/__init__.py
+-rw-rw-rw-   0        0        0   131171 2023-04-11 20:12:29.000000 pyramids-gis-0.4.0/pyramids/dataset.py
+-rw-rw-rw-   0        0        0    29271 2023-04-11 20:12:29.000000 pyramids-gis-0.4.0/pyramids/dem.py
+-rw-rw-rw-   0        0        0     1222 2023-04-11 20:12:29.000000 pyramids-gis-0.4.0/pyramids/errors.py
+-rw-rw-rw-   0        0        0    38123 2023-04-11 20:12:29.000000 pyramids-gis-0.4.0/pyramids/featurecollection.py
+-rw-rw-rw-   0        0        0     5701 2023-04-11 20:12:29.000000 pyramids-gis-0.4.0/pyramids/gdal_drivers.yaml
+-rw-rw-rw-   0        0        0     8336 2023-04-11 20:12:29.000000 pyramids-gis-0.4.0/pyramids/io.py
+-rw-rw-rw-   0        0        0     6285 2023-04-11 20:12:29.000000 pyramids-gis-0.4.0/pyramids/ogr_drivers.yaml
+-rw-rw-rw-   0        0        0     5624 2023-04-11 20:12:29.000000 pyramids-gis-0.4.0/pyramids/utils.py
+drwxrwxrwx   0        0        0        0 2023-04-11 20:27:12.309763 pyramids-gis-0.4.0/pyramids_gis.egg-info/
+-rw-rw-rw-   0        0        0    10198 2023-04-11 20:27:09.000000 pyramids-gis-0.4.0/pyramids_gis.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0      484 2023-04-11 20:27:09.000000 pyramids-gis-0.4.0/pyramids_gis.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0        1 2023-04-11 20:27:09.000000 pyramids-gis-0.4.0/pyramids_gis.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0        2 2023-04-11 20:27:09.000000 pyramids-gis-0.4.0/pyramids_gis.egg-info/not-zip-safe
+-rw-rw-rw-   0        0        0      145 2023-04-11 20:27:09.000000 pyramids-gis-0.4.0/pyramids_gis.egg-info/requires.txt
+-rw-rw-rw-   0        0        0        9 2023-04-11 20:27:09.000000 pyramids-gis-0.4.0/pyramids_gis.egg-info/top_level.txt
+-rw-rw-rw-   0        0        0       42 2023-04-11 20:27:12.319140 pyramids-gis-0.4.0/setup.cfg
+-rw-rw-rw-   0        0        0     1752 2023-04-11 20:12:29.000000 pyramids-gis-0.4.0/setup.py
+drwxrwxrwx   0        0        0        0 2023-04-11 20:27:12.314632 pyramids-gis-0.4.0/tests/
+-rw-rw-rw-   0        0        0     4742 2023-04-11 20:12:29.000000 pyramids-gis-0.4.0/tests/test_io.py
+-rw-rw-rw-   0        0        0     1104 2023-04-11 20:12:29.000000 pyramids-gis-0.4.0/tests/test_utils.py
```

### Comparing `pyramids-gis-0.3.3/LICENSE.md` & `pyramids-gis-0.4.0/LICENSE.md`

 * *Files identical despite different names*

### Comparing `pyramids-gis-0.3.3/PKG-INFO` & `pyramids-gis-0.4.0/PKG-INFO`

 * *Files 11% similar despite different names*

```diff
@@ -1,16 +1,16 @@
 Metadata-Version: 2.1
 Name: pyramids-gis
-Version: 0.3.3
+Version: 0.4.0
 Summary: GIS utility package
 Home-page: https://github.com/MAfarrag/pyramids
 Author: Mostafa Farrag
 Author-email: moah.farag@gmail.come
 License: GNU General Public License v3
-Keywords: GIS,gdal,rasterio
+Keywords: GIS,gdal
 Classifier: Development Status :: 5 - Production/Stable
 Classifier: Environment :: Console
 Classifier: License :: OSI Approved :: GNU General Public License v3 (GPLv3)
 Classifier: Natural Language :: English
 Classifier: Programming Language :: Python :: 3
 Classifier: Programming Language :: Python :: 3.7
 Classifier: Programming Language :: Python :: 3.8
@@ -86,26 +86,29 @@
 ```
 pip install git+https://github.com/Serapieum-of-alex/pyramids
 ```
 
 ## pip
 to install the last release you can easly use pip
 ```
-pip install pyramids-gis==0.3.3
+pip install pyramids-gis==0.4.0
 ```
 
 Quick start
 ===========
 
 ```
   >>> import pyramids
 ```
 
 [other code samples](https://pyramids-gis.readthedocs.io/en/latest/?badge=latest)
 
+## Coverage
+[![codecov](https://codecov.io/gh/Serapieum-of-alex/pyramids/branch/main/graphs/sunburst.svg?token=g0DV4dCa8N)](https://codecov.io/gh/Serapieum-of-alex/pyramids)
+
 
 =======
 History
 =======
 
 0.1.0 (2022-05-24)
 ------------------
@@ -152,7 +155,18 @@
 * add documentation
 * fix creating memory driver with compression in _createDataset
 
 0.3.3 (2023-02-06)
 ------------------
 * fix bug in reading the ogr drivers catalog for the vector class
 * fix bug in creating rasterLike in the asciiToRaster method
+
+0.4.0 (2023-04-11)
+------------------
+* Restructure the whole package to two main objects Dataset and FeatureCollection
+* Add class for multiple Dataset "DataCube".
+* Link both Dataset and FeatureCollection to convert between raster and vector data types.
+* Remove rasterio and netcdf from dependencies and depend only on gdal.
+* Test read rasters/netcdf from virtual file systems (aws, compressed)
+* Add dunder methods for all classes.
+* add plotting functionality and cleopatra (plotting package) as an optional package.
+* remove loops and replace it with ufunc from numpy.
```

### Comparing `pyramids-gis-0.3.3/README.md` & `pyramids-gis-0.4.0/README.md`

 * *Files 2% similar despite different names*

```diff
@@ -62,18 +62,21 @@
 ```
 pip install git+https://github.com/Serapieum-of-alex/pyramids
 ```
 
 ## pip
 to install the last release you can easly use pip
 ```
-pip install pyramids-gis==0.3.3
+pip install pyramids-gis==0.4.0
 ```
 
 Quick start
 ===========
 
 ```
   >>> import pyramids
 ```
 
 [other code samples](https://pyramids-gis.readthedocs.io/en/latest/?badge=latest)
+
+## Coverage
+[![codecov](https://codecov.io/gh/Serapieum-of-alex/pyramids/branch/main/graphs/sunburst.svg?token=g0DV4dCa8N)](https://codecov.io/gh/Serapieum-of-alex/pyramids)
```

### Comparing `pyramids-gis-0.3.3/pyramids/__init__.py` & `pyramids-gis-0.4.0/pyramids/__init__.py`

 * *Files identical despite different names*

### Comparing `pyramids-gis-0.3.3/pyramids/catchment.py` & `pyramids-gis-0.4.0/pyramids/dem.py`

 * *Files 19% similar despite different names*

```diff
@@ -1,68 +1,55 @@
-"""Created on Sat May 26 04:52:15 2018.
-
-@author: Mostafa
-"""
-
+from typing import Any, Dict
 import numpy as np
-
-# import pandas as pd
 from osgeo import gdal
-from osgeo.gdal import Dataset
-from pandas import DataFrame
 
-from pyramids.raster import Raster as raster
+from pyramids.dataset import Dataset
+import sys
 
+sys.setrecursionlimit(5000)
 
-class Catchment:
+
+class DEM(Dataset):
     """GISCatchment class contains methods to deal with the MED and generate the flow direction based on the D8 method and process the DEM.
 
     Methods:
         1- D8
         2- FlowDirectIndex
         3- FlowDirecTable
         4- DeleteBasins
         5- NearestCell
         6- GroupNeighbours
         7- Cluster
         8- ListAttributes
     """
 
-    def __init__(self):
-        pass
+    def __init__(self, src: gdal.Dataset):
+        super().__init__(src)
 
-    @staticmethod
-    def D8(DEM):
+    def D8(self):
         """D8 method generate flow direction raster from DEM and fill sinks.
 
-        inputs:
-        ----------
-            1-Raster:
-                [Gdal object] DEM
-
-        Outputs:
-        ----------
-            1- flow_direction_cell:
-                [numpy array] with the same dimensions of the raster and 2 layers
-                first layer for row index and second row for column index
-            2-elev_sinkless:
-                [numpy array] DEM after filling sinks
+        Returns
+        -------
+        flow_direction_cell: [numpy array]
+            with the same dimensions of the raster and 2 layers
+            first layer for rows index and second rows for column index
+        elev_sinkless: [numpy array]
+            DEM after filling sinks
         """
-        #        DEM=self.DEM
-
-        gt = DEM.GetGeoTransform()
-        cellsize = gt[1]
+        cellsize = self.cell_size
         dist2 = cellsize * np.sqrt(2)
-        no_columns = DEM.RasterXSize
-        no_rows = DEM.RasterYSize
+        no_columns = self.columns
+        no_rows = self.rows
 
-        elev = DEM.ReadAsArray()
+        elev = self.read_array(band=0)
         # get the value stores in novalue cells
-        dem_no_val = np.float32(DEM.GetRasterBand(1).GetNoDataValue())
-        elev[elev == dem_no_val] = np.nan
+        dem_no_val = self.no_data_value[0]
+        elev = elev.astype(np.float32)
+        elev[np.isclose(elev, dem_no_val, rtol=0.00001)] = np.nan
 
         slopes = np.ones((no_rows, no_columns, 9)) * np.nan
         distances = [cellsize, dist2, cellsize, dist2, cellsize, dist2, cellsize, dist2]
 
         # filling sinks
         elev_sinkless = elev
         for i in range(1, no_rows - 1):
@@ -122,15 +109,15 @@
                     ) / distances[7]
                     # get the flow direction index
                     flow_direction[i, j] = np.where(
                         slopes[i, j, :] == np.nanmax(slopes[i, j, :])
                     )[0][0]
                     slopes[i, j, 8] = np.nanmax(slopes[i, j, :])
 
-        # first row without corners
+        # first rows without corners
         for i in [0]:
             for j in range(1, no_columns - 1):  # all columns
                 if not np.isnan(elev[i, j]):
                     # slope with cell to the right
                     slopes[i, j, 0] = (
                         elev_sinkless[i, j] - elev_sinkless[i, j + 1]
                     ) / distances[0]
@@ -152,15 +139,15 @@
                     ) / distances[7]
 
                     flow_direction[i, j] = np.where(
                         slopes[i, j, :] == np.nanmax(slopes[i, j, :])
                     )[0][0]
                     slopes[i, j, 8] = np.nanmax(slopes[i, j, :])
 
-        # last row without corners
+        # last rows without corners
         for i in [no_rows - 1]:
             for j in range(1, no_columns - 1):  # all columns
                 if not np.isnan(elev[i, j]):
                     # slope with cell to the right
                     slopes[i, j, 0] = (
                         elev_sinkless[i, j] - elev_sinkless[i, j + 1]
                     ) / distances[0]
@@ -352,15 +339,15 @@
 
         flow_direction_cell = np.ones((no_rows, no_columns, 2)) * np.nan
         # for i in range(1,no_rows-1):
         #    for j in range(1,no_columns-1):
         for i in range(no_rows):
             for j in range(no_columns):
                 if flow_direction[i, j] == 0:
-                    flow_direction_cell[i, j, 0] = i  # index of the row
+                    flow_direction_cell[i, j, 0] = i  # index of the rows
                     flow_direction_cell[i, j, 1] = j + 1  # index of the column
                 elif flow_direction[i, j] == 1:
                     flow_direction_cell[i, j, 0] = i - 1
                     flow_direction_cell[i, j, 1] = j + 1
                 elif flow_direction[i, j] == 2:
                     flow_direction_cell[i, j, 0] = i - 1
                     flow_direction_cell[i, j, 1] = j
@@ -378,67 +365,51 @@
                     flow_direction_cell[i, j, 1] = j
                 elif flow_direction[i, j] == 7:
                     flow_direction_cell[i, j, 0] = i + 1
                     flow_direction_cell[i, j, 1] = j + 1
 
         return flow_direction_cell, elev_sinkless
 
-    @staticmethod
-    def flowDirectionIndex(flow_direct):
+    def flowDirectionIndex(self) -> np.ndarray:
         """this function takes flow firection raster and convert codes for the 8 directions (1,2,4,8,16,32,64,128) into indices of the Downstream cell.
 
-        inputs:
-        ----------
-            1- flow_direct:
-                [gdal.dataset] flow direction raster obtained from catchment delineation
-                it only contains values [1,2,4,8,16,32,64,128]
+        flow_direct:
+            [gdal.dataset] flow direction raster obtained from catchment delineation
+            it only contains values [1,2,4,8,16,32,64,128]
 
-        output:
-        ----------
-            1-fd_indices:
-                [numpy array] with the same dimensions of the raster and 2 layers
-                first layer for row index and second row for column index
+        Returns
+        -------
+        fd_indices:
+            [numpy array] with the same dimensions of the raster and 2 layers
+            first layer for rows index and second rows for column index
 
         Example:
         ----------
             fd=gdal.Open("Flowdir.tif")
             fd_indices=FlowDirectِِIndex(fd)
         """
-        # input data validation
-        # data type
-        assert (
-            type(flow_direct) == gdal.Dataset
-        ), "src should be read using gdal (gdal dataset please read it using gdal library) "
-
         # check flow direction input raster
-        no_val = np.float32(flow_direct.GetRasterBand(1).GetNoDataValue())
-        cols = flow_direct.RasterXSize
-        rows = flow_direct.RasterYSize
-
-        fd = flow_direct.ReadAsArray()
-        fd_val = [
-            int(fd[i, j])
-            for i in range(rows)
-            for j in range(cols)
-            if fd[i, j] != no_val
-        ]
-        fd_val = list(set(fd_val))
+        no_val = self.no_data_value[0]
+        cols = self.columns
+        rows = self.rows
+
+        fd = self.read_array(band=0)
+        fd_val = np.unique(fd[~np.isclose(fd, no_val, rtol=0.00001)])
         fd_should = [1, 2, 4, 8, 16, 32, 64, 128]
-        assert all(
-            fd_val[i] in fd_should for i in range(len(fd_val))
-        ), "flow direction raster should contain values 1,2,4,8,16,32,64,128 only "
+        if not all(fd_val[i] in fd_should for i in range(len(fd_val))):
+            raise ValueError(
+                "flow direction raster should contain values 1,2,4,8,16,32,64,128 only "
+            )
 
-        #    fd=np.float32(flow_direct.ReadAsArray())
-        #    fd[fd==no_val]=np.nan
         fd_cell = np.ones((rows, cols, 2)) * np.nan
 
         for i in range(rows):
             for j in range(cols):
                 if fd[i, j] == 1:
-                    fd_cell[i, j, 0] = i  # index of the row
+                    fd_cell[i, j, 0] = i  # index of the rows
                     fd_cell[i, j, 1] = j + 1  # index of the column
                 elif fd[i, j] == 128:
                     fd_cell[i, j, 0] = i - 1
                     fd_cell[i, j, 1] = j + 1
                 elif fd[i, j] == 64:
                     fd_cell[i, j, 0] = i - 1
                     fd_cell[i, j, 1] = j
@@ -456,103 +427,89 @@
                     fd_cell[i, j, 1] = j
                 elif fd[i, j] == 2:
                     fd_cell[i, j, 0] = i + 1
                     fd_cell[i, j, 1] = j + 1
 
         return fd_cell
 
-    @staticmethod
-    def flowDirectionTable(flow_direct):
-        """this function takes flow direction indices created by FlowDirectِِIndex function and create a dictionary with the cells indices as a key and  indices of directly upstream cells as values (list of tuples)
+    def flowDirectionTable(self) -> Dict:
+        """Flow Direction Table.
+            - This function takes flow direction indices created by FlowDirectِِIndex function and create a
+            dictionary with the cells indices as a key and  indices of directly upstream cells as values (list of tuples)
 
-        Inputs:
-        ----------
-            1- flow_direct:
+
+            flow_direct:
                 [gdal.dataset] flow direction raster obtained from catchment delineation
                 it only contains values [1,2,4,8,16,32,64,128]
 
-        Outputs:
-        ----------
-            1-flowAccTable:
-                [Dict] dictionary with the cells indices as a key and indices of directly
-                upstream cells as values (list of tuples)
-
-        Example:
-        ----------
+        Returns
+        -------
+        flowAccTable:
+            [Dict] dictionary with the cells indices as a key and indices of directly
+            upstream cells as values (list of tuples)
         """
-        # input data validation
-        # validation is inside FlowDirectِِIndex
-        FDI = Catchment.flowDirectionIndex(flow_direct)
+        FDI = self.flowDirectionIndex()
 
-        rows = flow_direct.RasterYSize
-        cols = flow_direct.RasterXSize
+        rows = self.rows
+        cols = self.columns
 
         celli = []
         cellj = []
         celli_content = []
         cellj_content = []
-        for i in range(rows):  # rows
-            for j in range(cols):  # columns
+        for i in range(rows):
+            for j in range(cols):
                 if not np.isnan(FDI[i, j, 0]):
                     # store the indexes of not empty cells and the indexes stored inside these cells
                     celli.append(i)
                     cellj.append(j)
                     # store the index of the receiving cells
                     celli_content.append(FDI[i, j, 0])
                     cellj_content.append(FDI[i, j, 1])
 
         flow_acc_table = {}
         # for each cell store the directly giving cells
-        for i in range(rows):  # rows
-            for j in range(cols):  # columns
+        for i in range(rows):
+            for j in range(cols):
                 if not np.isnan(FDI[i, j, 0]):
                     # get the indexes of the cell and use it as a key in a dictionary
                     name = str(i) + "," + str(j)
                     flow_acc_table[name] = []
                     for k in range(len(celli_content)):
                         # search if any cell are giving this cell
                         if i == celli_content[k] and j == cellj_content[k]:
                             flow_acc_table[name].append((celli[k], cellj[k]))
 
         return flow_acc_table
 
     @staticmethod
     def deleteBasins(basins, pathout):
-        """this function deletes all the basins in a basin raster created when delineating a catchment and leave only the first basin which is the biggest basin in the raster.
+        """Delete Basins
 
-        Inputs:
-        ----------
-            1- basins:
-                [gdal.dataset] raster you create during delineation of a catchment
-                values of its cells are the number of the basin it belongs to
-            2- pathout:
-                [String] path you want to save the resulted raster to it should include
-                the extension ".tif"
-        Outputs:
-        ----------
-            1- raster with only one basin (the basin that its name is 1 )
+            - this function deletes all the basins in a basin raster created when delineating a catchment and leave
+            only the first basin which is the biggest basin in the raster.
 
-        Example:
+        Parameters
         ----------
-            basins=gdal.Open("Data/basins.tif")
-            pathout="mask.tif"
-            DeleteBasins(basins,pathout)
+        basins: [gdal.dataset]
+            raster you create during delineation of a catchment
+            values of its cells are the number of the basin it belongs to
+        pathout: [str]
+             path you want to save the resulted raster to it should include
+            the extension ".tif"
+
+        Returns
+        -------
+        raster with only one basin (the basin that its name is 1 )
         """
-        # input data validation
-        # data type
         assert type(pathout) == str, "A_path input should be string type"
         assert (
             type(basins) == gdal.Dataset
         ), "basins raster should be read using gdal (gdal dataset please read it using gdal library) "
 
-        # input values
-        # check wether the user wrote the extension of the raster or not
-        ext = pathout[-4:]
-        assert ext == ".tif", "please add the extension at the end of the path input"
-
         # get number of rows
         rows = basins.RasterYSize
         # get number of columns
         cols = basins.RasterXSize
         # array
         basins_A = basins.ReadAsArray()
         # no data value
@@ -571,121 +528,30 @@
 
         # keep the first basin and delete the others by filling their cells by nodata value
         for i in range(rows):
             for j in range(cols):
                 if basins_A[i, j] != no_val and basins_A[i, j] != basins_val[0]:
                     basins_A[i, j] = no_val
 
-        raster.rasterLike(basins, basins_A, pathout)
-
-    @staticmethod
-    def nearestCell(
-        Raster: Dataset,
-        StCoord: DataFrame,
-    ) -> DataFrame:
-        """nearestCell.
-
-            nearestCell calculates the the indices (row, col) of nearest cell in a given
-            raster to a station
-            coordinate system of the raster has to be projected to be able to calculate
-            the distance
-
-        Parameters
-        ----------
-        Raster: [gdal.dataset]
-            raster to get the spatial information (coordinates of each cell)
-        StCoord: [Dataframe]
-            dataframe with two columns "x", "y" contains the coordinates
-            of each station
-
-        Returns
-        -------
-        StCoord:the same input dataframe with two extra columns "cellx","celly"
-
-        Examples
-        --------
-        >>> soil_type = gdal.Open("DEM.tif")
-        >>> data = dict(id = [0,1,2,3], x = [1,2,3,6], y = [5,4,7,8])
-        >>> stations = pd.DataFrame(data)
-        >>> coordinates = stations[['id','x','y']][:]
-        >>> coordinates.loc[:,["cell_row","cell_col"]] = Catchment.nearestCell(Raster, StCoord).values
-        """
-        if not isinstance(Raster, gdal.Dataset):
-            raise TypeError(
-                "raster should be read using gdal (gdal dataset please read it using gdal library) "
-            )
-
-        if not isinstance(StCoord, DataFrame):
-            raise TypeError(
-                f"please check StCoord input it should be pandas dataframe - given {type(StCoord)}"
-            )
-
-        # check if the user has stored the coordinates in the dataframe with the right names or not
-        if "x" not in StCoord.columns:
-            raise ValueError(
-                "please check the StCoord parameter it should contain a column with the x coordinates"
-                "and the column name should be 'x'"
-            )
-        if "y" not in StCoord.columns:
-            raise ValueError(
-                "please check the StCoord parameter it should contain a column with the y coordinates"
-                "and the column name should be 'y'"
-            )
-
-        StCoord["cell_row"] = np.nan
-        StCoord["cell_col"] = np.nan
-
-        rows = Raster.RasterYSize
-        cols = Raster.RasterXSize
-        geo_trans = Raster.GetGeoTransform()
-        # get the coordinates of the top left corner and cell size [x,dx,y,dy]
-        # X_coordinate= upperleft corner x+ index* cell size+celsize/2
-        coox = np.ones((rows, cols))
-        cooy = np.ones((rows, cols))
-        for i in range(rows):  # iteration by row
-            for j in range(cols):  # iteration by column
-                coox[i, j] = (
-                    geo_trans[0] + geo_trans[1] / 2 + j * geo_trans[1]
-                )  # calculate x
-                cooy[i, j] = (
-                    geo_trans[3] + geo_trans[5] / 2 + i * geo_trans[5]
-                )  # calculate y
-
-        Dist = np.ones((rows, cols))
-        for no in range(len(StCoord["x"])):
-            # calculate the distance from the station to all cells
-            for i in range(rows):  # iteration by row
-                for j in range(cols):  # iteration by column
-                    Dist[i, j] = np.sqrt(
-                        np.power((StCoord.loc[StCoord.index[no], "x"] - coox[i, j]), 2)
-                        + np.power(
-                            (StCoord.loc[StCoord.index[no], "y"] - cooy[i, j]), 2
-                        )
-                    )
-
-            StCoord.loc[no, "cell_row"], StCoord.loc[no, "cell_col"] = np.where(
-                Dist == np.min(Dist)
-            )
-
-        return StCoord.loc[:, ["cell_row", "cell_col"]]
+        Dataset.dataset_like(basins, basins_A, pathout)
 
     @staticmethod
     def groupNeighbours(
         array, i, j, lowervalue, uppervalue, position, values, count, cluster
     ):
         # bottom cell
         if (
             lowervalue <= array[i + 1, j] <= uppervalue
             and cluster[i + 1, j] == 0
             and i + 1 < array.shape[0]
         ):
             position.append([i + 1, j])
             values.append(array[i + 1, j])
             cluster[i + 1, j] = count
-            Catchment.groupNeighbours(
+            DEM.groupNeighbours(
                 array,
                 i + 1,
                 j,
                 lowervalue,
                 uppervalue,
                 position,
                 values,
@@ -698,15 +564,15 @@
             and i + 1 < array.shape[0]
             and lowervalue <= array[i + 1, j + 1] <= uppervalue
             and cluster[i + 1, j + 1] == 0
         ):
             position.append([i + 1, j + 1])
             values.append(array[i + 1, j + 1])
             cluster[i + 1, j + 1] = count
-            Catchment.groupNeighbours(
+            DEM.groupNeighbours(
                 array,
                 i + 1,
                 j + 1,
                 lowervalue,
                 uppervalue,
                 position,
                 values,
@@ -718,15 +584,15 @@
             j + 1 < array.shape[1]
             and lowervalue <= array[i, j + 1] <= uppervalue
             and cluster[i, j + 1] == 0
         ):
             position.append([i, j + 1])
             values.append(array[i, j + 1])
             cluster[i, j + 1] = count
-            Catchment.groupNeighbours(
+            DEM.groupNeighbours(
                 array,
                 i,
                 j + 1,
                 lowervalue,
                 uppervalue,
                 position,
                 values,
@@ -739,15 +605,15 @@
             and i - 1 >= 0
             and lowervalue <= array[i - 1, j + 1] <= uppervalue
             and cluster[i - 1, j + 1] == 0
         ):
             position.append([i - 1, j + 1])
             values.append(array[i - 1, j + 1])
             cluster[i - 1, j + 1] = count
-            Catchment.groupNeighbours(
+            DEM.groupNeighbours(
                 array,
                 i - 1,
                 j + 1,
                 lowervalue,
                 uppervalue,
                 position,
                 values,
@@ -759,15 +625,15 @@
             i - 1 >= 0
             and lowervalue <= array[i - 1, j] <= uppervalue
             and cluster[i - 1, j] == 0
         ):
             position.append([i - 1, j])
             values.append(array[i - 1, j])
             cluster[i - 1, j] = count
-            Catchment.groupNeighbours(
+            DEM.groupNeighbours(
                 array,
                 i - 1,
                 j,
                 lowervalue,
                 uppervalue,
                 position,
                 values,
@@ -780,15 +646,15 @@
             and j - 1 >= 0
             and lowervalue <= array[i - 1, j - 1] <= uppervalue
             and cluster[i - 1, j - 1] == 0
         ):
             position.append([i - 1, j - 1])
             values.append(array[i - 1, j - 1])
             cluster[i - 1, j - 1] = count
-            Catchment.groupNeighbours(
+            DEM.groupNeighbours(
                 array,
                 i - 1,
                 j - 1,
                 lowervalue,
                 uppervalue,
                 position,
                 values,
@@ -800,15 +666,15 @@
             j - 1 >= 0
             and lowervalue <= array[i, j - 1] <= uppervalue
             and cluster[i, j - 1] == 0
         ):
             position.append([i, j - 1])
             values.append(array[i, j - 1])
             cluster[i, j - 1] = count
-            Catchment.groupNeighbours(
+            DEM.groupNeighbours(
                 array,
                 i,
                 j - 1,
                 lowervalue,
                 uppervalue,
                 position,
                 values,
@@ -821,28 +687,28 @@
             and i + 1 < array.shape[0]
             and lowervalue <= array[i + 1, j - 1] <= uppervalue
             and cluster[i + 1, j - 1] == 0
         ):
             position.append([i + 1, j - 1])
             values.append(array[i + 1, j - 1])
             cluster[i + 1, j - 1] = count
-            Catchment.groupNeighbours(
+            DEM.groupNeighbours(
                 array,
                 i + 1,
                 j - 1,
                 lowervalue,
                 uppervalue,
                 position,
                 values,
                 count,
                 cluster,
             )
 
     @staticmethod
-    def cluster(Data, LowerValue, UpperValue):
+    def cluster(Data: np.ndarray, LowerValue: Any, UpperValue: Any):
         """Cluster method group all the connected values between two numbers in a raster in clusters.
 
         Parameters
         ----------
         Data : [array]
             numpt array of the daya in the raster.
         LowerValue : [numeric]
@@ -866,15 +732,15 @@
         count = 1
         cluster = np.zeros(shape=(Data.shape[0], Data.shape[1]))
 
         for i in range(Data.shape[0]):
             for j in range(Data.shape[1]):
 
                 if LowerValue <= Data[i, j] <= UpperValue and cluster[i, j] == 0:
-                    Catchment.groupNeighbours(
+                    DEM.groupNeighbours(
                         Data,
                         i,
                         j,
                         LowerValue,
                         UpperValue,
                         position,
                         values,
```

### Comparing `pyramids-gis-0.3.3/pyramids/raster.py` & `pyramids-gis-0.4.0/pyramids/dataset.py`

 * *Files 12% similar despite different names*

```diff
@@ -1,7471 +1,8199 @@
-00000000: 2222 2247 4953 7079 2063 6f6e 7461 696e  """GISpy contain
-00000010: 7320 7079 7468 6f6e 2066 756e 6374 696f  s python functio
-00000020: 6e73 2074 6f20 6861 6e64 6c65 2072 6173  ns to handle ras
-00000030: 7465 7220 6461 7461 2061 6c69 676e 2074  ter data align t
-00000040: 6865 6d20 746f 6765 7468 6572 2062 6173  hem together bas
-00000050: 6564 206f 6e20 6120 736f 7572 6365 2072  ed on a source r
-00000060: 6173 7465 722c 2070 6572 666f 726d 2061  aster, perform a
-00000070: 6e79 2061 6c67 6562 7269 6320 6f70 6572  ny algebric oper
-00000080: 6174 696f 6e20 6f6e 2063 656c 6c27 7320  ation on cell's 
-00000090: 7661 6c75 6573 2e20 6764 616c 2063 6c61  values. gdal cla
-000000a0: 7373 3a20 6874 7470 733a 2f2f 6764 616c  ss: https://gdal
-000000b0: 2e6f 7267 2f6a 6176 612f 6f72 672f 6764  .org/java/org/gd
-000000c0: 616c 2f67 6461 6c2f 7061 636b 6167 652d  al/gdal/package-
-000000d0: 7375 6d6d 6172 792e 6874 6d6c 2e0d 0a0d  summary.html....
-000000e0: 0a40 6175 7468 6f72 3a20 4d6f 7374 6166  .@author: Mostaf
-000000f0: 610d 0a22 2222 0d0a 696d 706f 7274 2064  a.."""..import d
-00000100: 6174 6574 696d 6520 6173 2064 740d 0a69  atetime as dt..i
-00000110: 6d70 6f72 7420 6a73 6f6e 0d0a 696d 706f  mport json..impo
-00000120: 7274 206f 730d 0a69 6d70 6f72 7420 7a69  rt os..import zi
-00000130: 7066 696c 650d 0a66 726f 6d20 7479 7069  pfile..from typi
-00000140: 6e67 2069 6d70 6f72 7420 416e 792c 2044  ng import Any, D
-00000150: 6963 742c 204c 6973 742c 2054 7570 6c65  ict, List, Tuple
-00000160: 2c20 556e 696f 6e0d 0a0d 0a69 6d70 6f72  , Union....impor
-00000170: 7420 6765 6f70 616e 6461 7320 6173 2067  t geopandas as g
-00000180: 7064 0d0a 696d 706f 7274 206e 756d 7079  pd..import numpy
-00000190: 2061 7320 6e70 0d0a 696d 706f 7274 2070   as np..import p
-000001a0: 616e 6461 7320 6173 2070 640d 0a69 6d70  andas as pd..imp
-000001b0: 6f72 7420 7079 7072 6f6a 0d0a 696d 706f  ort pyproj..impo
-000001c0: 7274 2072 6173 7465 7269 6f0d 0a66 726f  rt rasterio..fro
-000001d0: 6d20 6765 6f70 616e 6461 732e 6765 6f64  m geopandas.geod
-000001e0: 6174 6166 7261 6d65 2069 6d70 6f72 7420  ataframe import 
-000001f0: 4765 6f44 6174 6146 7261 6d65 0d0a 6672  GeoDataFrame..fr
-00000200: 6f6d 206c 6f67 7572 7520 696d 706f 7274  om loguru import
-00000210: 206c 6f67 6765 720d 0a66 726f 6d20 6f73   logger..from os
-00000220: 6765 6f20 696d 706f 7274 2067 6461 6c2c  geo import gdal,
-00000230: 206f 7372 2020 2320 6764 616c 636f 6e73   osr  # gdalcons
-00000240: 742c 0d0a 6672 6f6d 206f 7367 656f 2e67  t,..from osgeo.g
-00000250: 6461 6c20 696d 706f 7274 2044 6174 6173  dal import Datas
-00000260: 6574 0d0a 6672 6f6d 206f 7367 656f 2e6f  et..from osgeo.o
+00000000: 2222 220d 0a72 6173 7465 7220 636f 6e74  """..raster cont
+00000010: 6169 6e73 2070 7974 686f 6e20 6675 6e63  ains python func
+00000020: 7469 6f6e 7320 746f 2068 616e 646c 6520  tions to handle 
+00000030: 7261 7374 6572 2064 6174 6120 616c 6967  raster data alig
+00000040: 6e20 7468 656d 2074 6f67 6574 6865 7220  n them together 
+00000050: 6261 7365 6420 6f6e 2061 2073 6f75 7263  based on a sourc
+00000060: 6520 7261 7374 6572 2c20 7065 7266 6f72  e raster, perfor
+00000070: 6d20 616e 790d 0a61 6c67 6562 7269 6320  m any..algebric 
+00000080: 6f70 6572 6174 696f 6e20 6f6e 2063 656c  operation on cel
+00000090: 6c27 7320 7661 6c75 6573 2e20 6764 616c  l's values. gdal
+000000a0: 2063 6c61 7373 3a20 6874 7470 733a 2f2f   class: https://
+000000b0: 6764 616c 2e6f 7267 2f6a 6176 612f 6f72  gdal.org/java/or
+000000c0: 672f 6764 616c 2f67 6461 6c2f 7061 636b  g/gdal/gdal/pack
+000000d0: 6167 652d 7375 6d6d 6172 792e 6874 6d6c  age-summary.html
+000000e0: 2e0d 0a22 2222 0d0a 696d 706f 7274 2064  ..."""..import d
+000000f0: 6174 6574 696d 6520 6173 2064 740d 0a66  atetime as dt..f
+00000100: 726f 6d20 7061 7468 6c69 6220 696d 706f  rom pathlib impo
+00000110: 7274 2050 6174 680d 0a0d 0a69 6d70 6f72  rt Path....impor
+00000120: 7420 6f73 0d0a 6672 6f6d 2074 7970 696e  t os..from typin
+00000130: 6720 696d 706f 7274 2041 6e79 2c20 4469  g import Any, Di
+00000140: 6374 2c20 4c69 7374 2c20 5475 706c 652c  ct, List, Tuple,
+00000150: 2055 6e69 6f6e 2c20 4361 6c6c 6162 6c65   Union, Callable
+00000160: 2c20 4f70 7469 6f6e 616c 0d0a 6672 6f6d  , Optional..from
+00000170: 206c 6f67 7572 7520 696d 706f 7274 206c   loguru import l
+00000180: 6f67 6765 720d 0a69 6d70 6f72 7420 7368  ogger..import sh
+00000190: 7574 696c 0d0a 696d 706f 7274 2074 656d  util..import tem
+000001a0: 7066 696c 650d 0a69 6d70 6f72 7420 7575  pfile..import uu
+000001b0: 6964 0d0a 696d 706f 7274 2067 656f 7061  id..import geopa
+000001c0: 6e64 6173 2061 7320 6770 640d 0a69 6d70  ndas as gpd..imp
+000001d0: 6f72 7420 6e75 6d70 7920 6173 206e 700d  ort numpy as np.
+000001e0: 0a69 6d70 6f72 7420 7061 6e64 6173 2061  .import pandas a
+000001f0: 7320 7064 0d0a 0d0a 6672 6f6d 2067 656f  s pd....from geo
+00000200: 7061 6e64 6173 2e67 656f 6461 7461 6672  pandas.geodatafr
+00000210: 616d 6520 696d 706f 7274 2047 656f 4461  ame import GeoDa
+00000220: 7461 4672 616d 652c 2044 6174 6146 7261  taFrame, DataFra
+00000230: 6d65 0d0a 6672 6f6d 206f 7367 656f 2069  me..from osgeo i
+00000240: 6d70 6f72 7420 6764 616c 2c20 6f73 722c  mport gdal, osr,
+00000250: 206f 6772 2020 2320 6764 616c 636f 6e73   ogr  # gdalcons
+00000260: 742c 0d0a 6672 6f6d 206f 7367 656f 2e6f  t,..from osgeo.o
 00000270: 7372 2069 6d70 6f72 7420 5370 6174 6961  sr import Spatia
 00000280: 6c52 6566 6572 656e 6365 0d0a 6672 6f6d  lReference..from
-00000290: 2072 6173 7465 7269 6f2e 6d61 736b 2069   rasterio.mask i
-000002a0: 6d70 6f72 7420 6d61 736b 2061 7320 7269  mport mask as ri
-000002b0: 6f5f 6d61 736b 0d0a 0d0a 7472 793a 0d0a  o_mask....try:..
-000002c0: 2020 2020 6672 6f6d 206f 7367 656f 5f75      from osgeo_u
-000002d0: 7469 6c73 2069 6d70 6f72 7420 6764 616c  tils import gdal
-000002e0: 5f6d 6572 6765 0d0a 6578 6365 7074 204d  _merge..except M
-000002f0: 6f64 756c 654e 6f74 466f 756e 6445 7272  oduleNotFoundErr
-00000300: 6f72 3a0d 0a20 2020 206c 6f67 6765 722e  or:..    logger.
-00000310: 7761 726e 696e 6728 0d0a 2020 2020 2020  warning(..      
-00000320: 2020 226f 7367 656f 5f75 7469 6c73 206d    "osgeo_utils m
-00000330: 6f64 756c 6520 646f 6573 206e 6f74 2065  odule does not e
-00000340: 7869 7374 2074 7279 2069 6e73 7461 6c6c  xist try install
-00000350: 2070 6970 2069 6e73 7461 6c6c 206f 7367   pip install osg
-00000360: 656f 2d75 7469 6c73 2022 0d0a 2020 2020  eo-utils "..    
-00000370: 290d 0a0d 0a66 726f 6d20 7079 7261 6d69  )....from pyrami
-00000380: 6473 2e75 7469 6c73 2069 6d70 6f72 7420  ds.utils import 
-00000390: 6e75 6d70 795f 746f 5f67 6461 6c5f 6474  numpy_to_gdal_dt
-000003a0: 7970 650d 0a66 726f 6d20 7079 7261 6d69  ype..from pyrami
-000003b0: 6473 2e76 6563 746f 7220 696d 706f 7274  ds.vector import
-000003c0: 2056 6563 746f 720d 0a0d 0a44 4546 4155   Vector....DEFAU
-000003d0: 4c54 5f4e 4f5f 4441 5441 5f56 414c 5545  LT_NO_DATA_VALUE
-000003e0: 203d 202d 3939 3939 0d0a 0d0a 0d0a 636c   = -9999......cl
-000003f0: 6173 7320 5261 7374 6572 3a0d 0a20 2020  ass Raster:..   
-00000400: 2022 2222 5261 7374 6572 2063 6c61 7373   """Raster class
-00000410: 2063 6f6e 7461 696e 7320 6d65 7468 6f64   contains method
-00000420: 7320 746f 2064 6561 6c20 7769 7468 2072  s to deal with r
-00000430: 6173 7465 7273 2061 6e64 206e 6574 6364  asters and netcd
-00000440: 6620 6669 6c65 732c 2063 6861 6e67 6520  f files, change 
-00000450: 7072 6f6a 6563 7469 6f6e 2061 6e64 2063  projection and c
-00000460: 6f6f 7264 696e 6174 6520 7379 7374 656d  oordinate system
-00000470: 732e 2222 220d 0a0d 0a20 2020 2064 6566  s."""....    def
-00000480: 205f 5f69 6e69 745f 5f28 7365 6c66 293a   __init__(self):
-00000490: 0d0a 2020 2020 2020 2020 7061 7373 0d0a  ..        pass..
-000004a0: 0d0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
-000004b0: 686f 640d 0a20 2020 2064 6566 206f 7065  hod..    def ope
-000004c0: 6e44 6174 6173 6574 2870 6174 683a 2073  nDataset(path: s
-000004d0: 7472 2c20 7265 6164 5f6f 6e6c 793d 5472  tr, read_only=Tr
-000004e0: 7565 2920 2d3e 2044 6174 6173 6574 3a0d  ue) -> Dataset:.
-000004f0: 0a20 2020 2020 2020 2022 2222 4f70 656e  .        """Open
-00000500: 2061 2072 6173 7465 7220 7573 696e 6720   a raster using 
-00000510: 4744 414c 2e0d 0a0d 0a20 2020 2020 2020  GDAL.....       
-00000520: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-00000530: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-00000540: 0a20 2020 2020 2020 2070 6174 6820 3a20  .        path : 
-00000550: 5b73 7472 5d0d 0a20 2020 2020 2020 2020  [str]..         
-00000560: 2020 2050 6174 6820 6f66 2066 696c 6520     Path of file 
-00000570: 746f 206f 7065 6e2e 0d0a 2020 2020 2020  to open...      
-00000580: 2020 7265 6164 5f6f 6e6c 7920 3a20 5b62    read_only : [b
-00000590: 6f6f 6c5d 0d0a 2020 2020 2020 2020 2020  ool]..          
-000005a0: 2020 4669 6c65 206d 6f64 652c 2073 6574    File mode, set
-000005b0: 2074 6f20 4661 6c73 6520 746f 206f 7065   to False to ope
-000005c0: 6e20 696e 2022 7570 6461 7465 2220 6d6f  n in "update" mo
-000005d0: 6465 2e0d 0a0d 0a20 2020 2020 2020 2052  de.....        R
-000005e0: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
-000005f0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00000600: 2047 4441 4c20 6461 7461 7365 740d 0a20   GDAL dataset.. 
-00000610: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-00000620: 2020 2020 6966 206e 6f74 206f 732e 7061      if not os.pa
-00000630: 7468 2e65 7869 7374 7328 7061 7468 293a  th.exists(path):
-00000640: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
-00000650: 6973 6520 4669 6c65 4e6f 7446 6f75 6e64  ise FileNotFound
-00000660: 4572 726f 7228 6622 5468 6520 6769 7665  Error(f"The give
-00000670: 6e20 6669 6c65 3a7b 7061 7468 7d20 646f  n file:{path} do
-00000680: 6573 206e 6f74 2065 7869 7374 2229 0d0a  es not exist")..
-00000690: 2020 2020 2020 2020 6163 6365 7373 203d          access =
-000006a0: 2067 6461 6c2e 4741 5f52 6561 644f 6e6c   gdal.GA_ReadOnl
-000006b0: 7920 6966 2072 6561 645f 6f6e 6c79 2065  y if read_only e
-000006c0: 6c73 6520 6764 616c 2e47 415f 5570 6461  lse gdal.GA_Upda
-000006d0: 7465 0d0a 2020 2020 2020 2020 7372 6320  te..        src 
-000006e0: 3d20 6764 616c 2e4f 7065 6e53 6861 7265  = gdal.OpenShare
-000006f0: 6428 7061 7468 2c20 6163 6365 7373 290d  d(path, access).
-00000700: 0a20 2020 2020 2020 2069 6620 7372 6320  .        if src 
-00000710: 6973 204e 6f6e 653a 0d0a 2020 2020 2020  is None:..      
-00000720: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-00000730: 6545 7272 6f72 280d 0a20 2020 2020 2020  eError(..       
-00000740: 2020 2020 2020 2020 2066 2254 6865 2072           f"The r
-00000750: 6173 7465 7220 7061 7468 3a20 7b70 6174  aster path: {pat
-00000760: 687d 2079 6f75 2065 6e74 6572 2067 6976  h} you enter giv
-00000770: 6573 2061 204e 6f6e 6520 6764 616c 204f  es a None gdal O
-00000780: 626a 6563 7420 6368 6563 6b20 7468 6520  bject check the 
-00000790: 7265 6164 2070 7265 6d69 7373 696f 6e2c  read premission,
-000007a0: 206d 6179 6265 2022 0d0a 2020 2020 2020   maybe "..      
-000007b0: 2020 2020 2020 2020 2020 6622 7468 6520            f"the 
-000007c0: 7261 7374 6572 2069 7320 6265 696e 6720  raster is being 
-000007d0: 7573 6564 2062 7920 6f74 6865 7220 736f  used by other so
-000007e0: 6674 7761 7265 220d 0a20 2020 2020 2020  ftware"..       
-000007f0: 2020 2020 2029 0d0a 0d0a 2020 2020 2020       )....      
-00000800: 2020 7265 7475 726e 2073 7263 0d0a 0d0a    return src....
-00000810: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
-00000820: 640d 0a20 2020 2064 6566 205f 6372 6561  d..    def _crea
-00000830: 7465 4461 7461 7365 7428 0d0a 2020 2020  teDataset(..    
-00000840: 2020 2020 636f 6c73 3a20 696e 742c 0d0a      cols: int,..
-00000850: 2020 2020 2020 2020 726f 7773 3a20 696e          rows: in
-00000860: 742c 0d0a 2020 2020 2020 2020 6261 6e64  t,..        band
-00000870: 733a 2069 6e74 2c0d 0a20 2020 2020 2020  s: int,..       
-00000880: 2064 7479 7065 3a20 696e 742c 0d0a 2020   dtype: int,..  
-00000890: 2020 2020 2020 6472 6976 6572 3a20 7374        driver: st
-000008a0: 7220 3d20 224d 454d 222c 0d0a 2020 2020  r = "MEM",..    
-000008b0: 2020 2020 7061 7468 3a20 7374 7220 3d20      path: str = 
-000008c0: 4e6f 6e65 2c0d 0a20 2020 2029 202d 3e20  None,..    ) -> 
-000008d0: 4461 7461 7365 743a 0d0a 2020 2020 2020  Dataset:..      
-000008e0: 2020 2222 2243 7265 6174 6520 4744 414c    """Create GDAL
-000008f0: 2064 7269 7665 722e 0d0a 0d0a 2020 2020   driver.....    
-00000900: 2020 2020 2020 2020 6372 6561 7465 7320          creates 
-00000910: 6120 6472 6976 6572 2061 6e64 2073 6176  a driver and sav
-00000920: 6520 6974 2074 6f20 6469 736b 2061 6e64  e it to disk and
-00000930: 2069 6e20 6d65 6d6f 7279 2069 6620 7061   in memory if pa
-00000940: 7468 2069 7320 6e6f 7420 6769 7665 6e2e  th is not given.
-00000950: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
-00000960: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
-00000970: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
-00000980: 2020 2020 636f 6c73 3a20 5b69 6e74 5d0d      cols: [int].
-00000990: 0a20 2020 2020 2020 2020 2020 206e 756d  .            num
-000009a0: 6265 7220 6f66 2063 6f6c 756d 6e73 2e0d  ber of columns..
-000009b0: 0a20 2020 2020 2020 2072 6f77 733a 205b  .        rows: [
-000009c0: 696e 745d 0d0a 2020 2020 2020 2020 2020  int]..          
-000009d0: 2020 6e75 6d62 6572 206f 6620 726f 7773    number of rows
-000009e0: 2e0d 0a20 2020 2020 2020 2062 616e 6473  ...        bands
-000009f0: 3a20 5b69 6e74 5d0d 0a20 2020 2020 2020  : [int]..       
-00000a00: 2020 2020 206e 756d 6265 7220 6f66 2062       number of b
-00000a10: 616e 6473 2e0d 0a20 2020 2020 2020 2064  ands...        d
-00000a20: 7269 7665 723a 205b 7374 725d 0d0a 2020  river: [str]..  
-00000a30: 2020 2020 2020 2020 2020 6472 6976 6572            driver
-00000a40: 2074 7970 6520 5b22 4754 6966 6622 2c20   type ["GTiff", 
-00000a50: 224d 454d 225d 2e0d 0a20 2020 2020 2020  "MEM"]...       
-00000a60: 2070 6174 683a 205b 7374 725d 0d0a 2020   path: [str]..  
-00000a70: 2020 2020 2020 2020 2020 7061 7468 2074            path t
-00000a80: 6f20 7361 7665 2074 6865 2047 5469 6666  o save the GTiff
-00000a90: 2064 7269 7665 722e 0d0a 2020 2020 2020   driver...      
-00000aa0: 2020 6474 7970 653a 0d0a 2020 2020 2020    dtype:..      
-00000ab0: 2020 2020 2020 6764 616c 2064 6174 6120        gdal data 
-00000ac0: 7479 7065 2c20 7573 6520 7468 6520 6675  type, use the fu
-00000ad0: 6e63 7469 6f6e 7320 696e 2074 6865 2075  nctions in the u
-00000ae0: 7469 6c73 206d 6f64 756c 6520 746f 206d  tils module to m
-00000af0: 6170 2064 6174 6120 7479 7065 7320 6672  ap data types fr
-00000b00: 6f6d 206e 756d 7079 206f 7220 6f67 7220  om numpy or ogr 
-00000b10: 746f 2067 6461 6c2e 0d0a 0d0a 2020 2020  to gdal.....    
-00000b20: 2020 2020 5265 7475 726e 730d 0a20 2020      Returns..   
-00000b30: 2020 2020 202d 2d2d 2d2d 2d2d 0d0a 2020       -------..  
-00000b40: 2020 2020 2020 6764 616c 2064 7269 7665        gdal drive
-00000b50: 720d 0a20 2020 2020 2020 2022 2222 0d0a  r..        """..
-00000b60: 2020 2020 2020 2020 6966 2070 6174 683a          if path:
-00000b70: 0d0a 2020 2020 2020 2020 2020 2020 6472  ..            dr
-00000b80: 6976 6572 203d 2022 4754 6966 6622 2069  iver = "GTiff" i
-00000b90: 6620 6472 6976 6572 203d 3d20 224d 454d  f driver == "MEM
-00000ba0: 2220 656c 7365 2064 7269 7665 720d 0a20  " else driver.. 
-00000bb0: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
-00000bc0: 7420 6973 696e 7374 616e 6365 2870 6174  t isinstance(pat
-00000bd0: 682c 2073 7472 293a 0d0a 2020 2020 2020  h, str):..      
-00000be0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00000bf0: 5479 7065 4572 726f 7228 2254 6865 2070  TypeError("The p
-00000c00: 6174 6820 696e 7075 7420 7368 6f75 6c64  ath input should
-00000c10: 2062 6520 7374 7269 6e67 2229 0d0a 2020   be string")..  
-00000c20: 2020 2020 2020 2020 2020 6966 2064 7269            if dri
-00000c30: 7665 7220 3d3d 2022 4754 6966 6622 3a0d  ver == "GTiff":.
-00000c40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00000c50: 2069 6620 6e6f 7420 7061 7468 2e65 6e64   if not path.end
-00000c60: 7377 6974 6828 222e 7469 6622 293a 0d0a  swith(".tif"):..
-00000c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000c80: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
-00000c90: 726f 7228 0d0a 2020 2020 2020 2020 2020  ror(..          
-00000ca0: 2020 2020 2020 2020 2020 2020 2020 2254                "T
-00000cb0: 6865 2070 6174 6820 746f 2073 6176 6520  he path to save 
-00000cc0: 7468 6520 6372 6561 7465 6420 7261 7374  the created rast
-00000cd0: 6572 2073 686f 756c 6420 656e 6420 7769  er should end wi
-00000ce0: 7468 202e 7469 6622 0d0a 2020 2020 2020  th .tif"..      
-00000cf0: 2020 2020 2020 2020 2020 2020 2020 290d                ).
-00000d00: 0a0d 0a20 2020 2020 2020 2020 2020 2073  ...            s
-00000d10: 7263 203d 2067 6461 6c2e 4765 7444 7269  rc = gdal.GetDri
-00000d20: 7665 7242 794e 616d 6528 6472 6976 6572  verByName(driver
-00000d30: 292e 4372 6561 7465 280d 0a20 2020 2020  ).Create(..     
-00000d40: 2020 2020 2020 2020 2020 2070 6174 682c             path,
-00000d50: 2063 6f6c 732c 2072 6f77 732c 2062 616e   cols, rows, ban
-00000d60: 6473 2c20 6474 7970 652c 205b 2243 4f4d  ds, dtype, ["COM
-00000d70: 5052 4553 533d 4c5a 5722 5d0d 0a20 2020  PRESS=LZW"]..   
-00000d80: 2020 2020 2020 2020 2029 2020 2320 4c5a           )  # LZ
-00000d90: 5720 6973 2061 206c 6f73 736c 6573 7320  W is a lossless 
-00000da0: 636f 6d70 7265 7373 696f 6e20 6d65 7468  compression meth
-00000db0: 6f64 2061 6368 6965 7665 2074 6865 2068  od achieve the h
-00000dc0: 6967 6873 7420 636f 6d70 7265 7373 696f  ighst compressio
-00000dd0: 6e20 6275 7420 7769 7468 206c 6f74 206f  n but with lot o
-00000de0: 6620 636f 6d70 7574 6174 696f 6e0d 0a20  f computation.. 
-00000df0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00000e00: 2020 2020 2020 2020 2020 2320 666f 7220            # for 
-00000e10: 6d65 6d6f 7279 2064 7269 7665 7273 0d0a  memory drivers..
-00000e20: 2020 2020 2020 2020 2020 2020 6472 6976              driv
-00000e30: 6572 203d 2022 4d45 4d22 0d0a 2020 2020  er = "MEM"..    
-00000e40: 2020 2020 2020 2020 7372 6320 3d20 6764          src = gd
-00000e50: 616c 2e47 6574 4472 6976 6572 4279 4e61  al.GetDriverByNa
-00000e60: 6d65 2864 7269 7665 7229 2e43 7265 6174  me(driver).Creat
-00000e70: 6528 2222 2c20 636f 6c73 2c20 726f 7773  e("", cols, rows
-00000e80: 2c20 6261 6e64 732c 2064 7479 7065 290d  , bands, dtype).
-00000e90: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00000ea0: 7372 630d 0a0d 0a20 2020 2040 7374 6174  src....    @stat
-00000eb0: 6963 6d65 7468 6f64 0d0a 2020 2020 6465  icmethod..    de
-00000ec0: 6620 6765 7452 6173 7465 7244 6174 6128  f getRasterData(
-00000ed0: 0d0a 2020 2020 2020 2020 7372 633a 2044  ..        src: D
-00000ee0: 6174 6173 6574 2c20 6261 6e64 3a20 696e  ataset, band: in
-00000ef0: 7420 3d20 310d 0a20 2020 2029 202d 3e20  t = 1..    ) -> 
-00000f00: 5475 706c 655b 6e70 2e6e 6461 7272 6179  Tuple[np.ndarray
-00000f10: 2c20 556e 696f 6e5b 696e 742c 2066 6c6f  , Union[int, flo
-00000f20: 6174 5d5d 3a0d 0a20 2020 2020 2020 2022  at]]:..        "
-00000f30: 2222 6765 7420 7468 6520 6261 7369 6320  ""get the basic 
-00000f40: 6461 7461 2069 6e73 6964 6520 6120 7261  data inside a ra
-00000f50: 7374 6572 2028 7468 6520 6172 7261 7920  ster (the array 
-00000f60: 616e 6420 7468 6520 6e6f 6461 7461 7661  and the nodatava
-00000f70: 6c75 6529 0d0a 0d0a 2020 2020 2020 2020  lue)....        
-00000f80: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
-00000f90: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
-00000fa0: 2020 2020 2020 2020 7372 633a 205b 6764          src: [gd
-00000fb0: 616c 2e44 6174 6173 6574 5d0d 0a20 2020  al.Dataset]..   
-00000fc0: 2020 2020 2020 2020 2061 2067 6461 6c2e           a gdal.
-00000fd0: 4461 7461 7365 7420 6973 2061 2072 6173  Dataset is a ras
-00000fe0: 7465 7220 616c 7265 6164 7920 6265 656e  ter already been
-00000ff0: 2072 6561 6420 7573 696e 6720 6764 616c   read using gdal
-00001000: 0d0a 2020 2020 2020 2020 6261 6e64 203a  ..        band :
-00001010: 205b 696e 7465 6765 725d 0d0a 2020 2020   [integer]..    
-00001020: 2020 2020 2020 2020 7468 6520 6261 6e64          the band
-00001030: 2079 6f75 2077 616e 7420 746f 2067 6574   you want to get
-00001040: 2069 7473 2064 6174 612e 2044 6566 6175   its data. Defau
-00001050: 6c74 2069 7320 310d 0a0d 0a20 2020 2020  lt is 1....     
-00001060: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
-00001070: 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020      -------..   
-00001080: 2020 2020 2061 7272 6179 203a 205b 6172       array : [ar
-00001090: 7261 795d 0d0a 2020 2020 2020 2020 2020  ray]..          
-000010a0: 2020 6172 7261 7920 7769 7468 2061 6c6c    array with all
-000010b0: 2074 6865 2076 616c 7565 7320 696e 2074   the values in t
-000010c0: 6865 2066 6c6f 7720 7061 7468 206c 656e  he flow path len
-000010d0: 6774 6820 7261 7374 6572 0d0a 2020 2020  gth raster..    
-000010e0: 2020 2020 6e6f 6461 7461 7661 6c20 3a20      nodataval : 
-000010f0: 5b6e 756d 6572 6963 5d0d 0a20 2020 2020  [numeric]..     
-00001100: 2020 2020 2020 2076 616c 7565 2073 746f         value sto
-00001110: 7265 6420 696e 206e 6f76 616c 7565 2063  red in novalue c
-00001120: 656c 6c73 0d0a 2020 2020 2020 2020 2222  ells..        ""
-00001130: 220d 0a20 2020 2020 2020 2069 6620 6e6f  "..        if no
-00001140: 7420 6973 696e 7374 616e 6365 2873 7263  t isinstance(src
-00001150: 2c20 4461 7461 7365 7429 3a0d 0a20 2020  , Dataset):..   
-00001160: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-00001170: 7970 6545 7272 6f72 280d 0a20 2020 2020  ypeError(..     
-00001180: 2020 2020 2020 2020 2020 2022 706c 6561             "plea
-00001190: 7365 2065 6e74 6572 2061 2076 616c 6962  se enter a valib
-000011a0: 2067 6461 6c20 6f62 6a65 6374 2028 7261   gdal object (ra
-000011b0: 7374 6572 2068 6173 2062 6565 6e20 7265  ster has been re
-000011c0: 6164 2075 7369 6e67 2067 6461 6c2e 4f70  ad using gdal.Op
-000011d0: 656e 2922 0d0a 2020 2020 2020 2020 2020  en)"..          
-000011e0: 2020 290d 0a0d 0a20 2020 2020 2020 2023    )....        #
-000011f0: 2067 6574 2074 6865 2076 616c 7565 2073   get the value s
-00001200: 746f 7265 7320 696e 206e 6f76 616c 7565  tores in novalue
-00001210: 2063 656c 6c73 0d0a 2020 2020 2020 2020   cells..        
-00001220: 6e6f 6461 7461 7661 6c75 6520 3d20 7372  nodatavalue = sr
-00001230: 632e 4765 7452 6173 7465 7242 616e 6428  c.GetRasterBand(
-00001240: 6261 6e64 292e 4765 744e 6f44 6174 6156  band).GetNoDataV
-00001250: 616c 7565 2829 0d0a 2020 2020 2020 2020  alue()..        
-00001260: 6172 7220 3d20 7372 632e 4765 7452 6173  arr = src.GetRas
-00001270: 7465 7242 616e 6428 6261 6e64 292e 5265  terBand(band).Re
-00001280: 6164 4173 4172 7261 7928 290d 0a0d 0a20  adAsArray().... 
-00001290: 2020 2020 2020 2072 6574 7572 6e20 6172         return ar
-000012a0: 722c 206e 6f64 6174 6176 616c 7565 0d0a  r, nodatavalue..
-000012b0: 0d0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
-000012c0: 686f 640d 0a20 2020 2064 6566 2067 6574  hod..    def get
-000012d0: 5072 6f6a 6563 7469 6f6e 4461 7461 2873  ProjectionData(s
-000012e0: 7263 3a20 4461 7461 7365 7429 202d 3e20  rc: Dataset) -> 
-000012f0: 5475 706c 655b 696e 742c 2074 7570 6c65  Tuple[int, tuple
-00001300: 5d3a 0d0a 2020 2020 2020 2020 2222 2247  ]:..        """G
-00001310: 6574 5072 6f6a 6563 7469 6f6e 4461 7461  etProjectionData
-00001320: 2e0d 0a0d 0a20 2020 2020 2020 2047 6574  .....        Get
-00001330: 5072 6f6a 6563 7469 6f6e 4461 7461 2072  ProjectionData r
-00001340: 6574 7572 6e73 2074 6865 2070 726f 6a65  eturns the proje
-00001350: 6374 696f 6e20 6465 7461 696c 7320 6f66  ction details of
-00001360: 2061 2067 6976 656e 2067 6461 6c2e 4461   a given gdal.Da
-00001370: 7461 7365 740d 0a0d 0a20 2020 2020 2020  taset....       
-00001380: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-00001390: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-000013a0: 0a20 2020 2020 2020 2073 7263 3a20 5b67  .        src: [g
-000013b0: 6461 6c2e 4461 7461 7365 745d 0d0a 2020  dal.Dataset]..  
-000013c0: 2020 2020 2020 2020 2020 7261 7374 6572            raster
-000013d0: 2072 6561 6420 6279 2067 6461 6c0d 0a0d   read by gdal...
-000013e0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-000013f0: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00001400: 2d0d 0a20 2020 2020 2020 2065 7073 673a  -..        epsg:
-00001410: 205b 696e 7465 6765 725d 0d0a 2020 2020   [integer]..    
-00001420: 2020 2020 2020 2020 2069 6e74 6567 6572           integer
-00001430: 2072 6566 6572 656e 6365 206e 756d 6265   reference numbe
-00001440: 7220 7468 6174 2064 6566 696e 6573 2074  r that defines t
-00001450: 6865 2070 726f 6a65 6374 696f 6e20 2868  he projection (h
-00001460: 7474 7073 3a2f 2f65 7073 672e 696f 2f29  ttps://epsg.io/)
-00001470: 0d0a 2020 2020 2020 2020 6765 6f3a 205b  ..        geo: [
-00001480: 7475 706c 655d 0d0a 2020 2020 2020 2020  tuple]..        
-00001490: 2020 2020 6765 6f74 7261 6e73 666f 726d      geotransform
-000014a0: 2064 6174 6120 6f66 2074 6865 2075 7070   data of the upp
-000014b0: 6572 206c 6566 7420 636f 726e 6572 206f  er left corner o
-000014c0: 6620 7468 6520 7261 7374 6572 0d0a 2020  f the raster..  
-000014d0: 2020 2020 2020 2020 2020 286d 696e 696d            (minim
-000014e0: 756d 206c 6f6e 2f78 2c20 7069 7865 6c73  um lon/x, pixels
-000014f0: 697a 652c 2072 6f74 6174 696f 6e2c 206d  ize, rotation, m
-00001500: 6178 696d 756d 206c 6174 2f79 2c20 726f  aximum lat/y, ro
-00001510: 7461 7469 6f6e 2c20 7069 7865 6c73 697a  tation, pixelsiz
-00001520: 6529 2e0d 0a20 2020 2020 2020 2022 2222  e)...        """
-00001530: 0d0a 2020 2020 2020 2020 6765 6f20 3d20  ..        geo = 
-00001540: 7372 632e 4765 7447 656f 5472 616e 7366  src.GetGeoTransf
-00001550: 6f72 6d28 290d 0a20 2020 2020 2020 2073  orm()..        s
-00001560: 7263 5f70 726f 6a20 3d20 7372 632e 4765  rc_proj = src.Ge
-00001570: 7450 726f 6a65 6374 696f 6e28 290d 0a20  tProjection().. 
-00001580: 2020 2020 2020 2073 725f 7372 6320 3d20         sr_src = 
-00001590: 6f73 722e 5370 6174 6961 6c52 6566 6572  osr.SpatialRefer
-000015a0: 656e 6365 2877 6b74 3d73 7263 5f70 726f  ence(wkt=src_pro
-000015b0: 6a29 0d0a 2020 2020 2020 2020 6570 7367  j)..        epsg
-000015c0: 203d 2069 6e74 2873 725f 7372 632e 4765   = int(sr_src.Ge
-000015d0: 7441 7474 7256 616c 7565 2822 4155 5448  tAttrValue("AUTH
-000015e0: 4f52 4954 5922 2c20 3129 290d 0a0d 0a20  ORITY", 1)).... 
-000015f0: 2020 2020 2020 2072 6574 7572 6e20 6570         return ep
-00001600: 7367 2c20 6765 6f0d 0a0d 0a20 2020 2040  sg, geo....    @
-00001610: 7374 6174 6963 6d65 7468 6f64 0d0a 2020  staticmethod..  
-00001620: 2020 6465 6620 6765 7452 6173 7465 7244    def getRasterD
-00001630: 6574 6169 6c73 280d 0a20 2020 2020 2020  etails(..       
-00001640: 2073 7263 3a20 4461 7461 7365 742c 0d0a   src: Dataset,..
-00001650: 2020 2020 2920 2d3e 2054 7570 6c65 5b69      ) -> Tuple[i
-00001660: 6e74 2c20 696e 742c 2073 7472 2c20 696e  nt, int, str, in
-00001670: 742c 2054 7570 6c65 2c20 4c69 7374 5b41  t, Tuple, List[A
-00001680: 6e79 5d2c 204c 6973 745d 3a0d 0a20 2020  ny], List]:..   
-00001690: 2020 2020 2022 2222 4765 7420 6764 616c       """Get gdal
-000016a0: 2064 6174 6173 6574 2064 6574 6169 6c73   dataset details
-000016b0: 2e0d 0a0d 0a20 2020 2020 2020 2050 6172  .....        Par
-000016c0: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
-000016d0: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-000016e0: 2020 2020 2073 7263 3a20 5b44 6174 6173       src: [Datas
-000016f0: 6574 5d0d 0a20 2020 2020 2020 2020 2020  et]..           
-00001700: 2067 6461 6c20 6461 7461 7365 740d 0a0d   gdal dataset...
-00001710: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00001720: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00001730: 2d0d 0a20 2020 2020 2020 2063 6f6c 733a  -..        cols:
-00001740: 205b 696e 745d 0d0a 2020 2020 2020 2020   [int]..        
-00001750: 2020 2020 6e75 6d62 6572 206f 6620 636f      number of co
-00001760: 6c75 6d6e 732e 0d0a 2020 2020 2020 2020  lumns...        
-00001770: 726f 7773 3a20 5b69 6e74 5d0d 0a20 2020  rows: [int]..   
-00001780: 2020 2020 2020 2020 206e 756d 6265 7220           number 
-00001790: 6f66 2072 6f77 732e 0d0a 2020 2020 2020  of rows...      
-000017a0: 2020 7072 6a3a 205b 7374 725d 0d0a 2020    prj: [str]..  
-000017b0: 2020 2020 2020 2020 2020 7072 6f6a 6563            projec
-000017c0: 7469 6f6e 2e0d 0a20 2020 2020 2020 2062  tion...        b
-000017d0: 616e 6473 3a20 5b69 6e74 5d0d 0a20 2020  ands: [int]..   
-000017e0: 2020 2020 2020 2020 206e 756d 6265 7220           number 
-000017f0: 6f66 2062 616e 6473 2e0d 0a20 2020 2020  of bands...     
-00001800: 2020 2067 743a 2054 7570 655b 696e 745d     gt: Tupe[int]
-00001810: 0d0a 2020 2020 2020 2020 2020 2020 6765  ..            ge
-00001820: 6f74 7261 6e73 666f 726d 2e0d 0a20 2020  otransform...   
-00001830: 2020 2020 206e 6f5f 6461 7461 5f76 616c       no_data_val
-00001840: 7565 3a20 4c69 7374 5b41 6e79 5d0d 0a20  ue: List[Any].. 
-00001850: 2020 2020 2020 2020 2020 206e 6f20 6461             no da
-00001860: 7461 2076 616c 7565 2066 6f72 2065 6163  ta value for eac
-00001870: 6820 6261 6e64 2069 6e20 7468 6520 6461  h band in the da
-00001880: 7461 7365 742e 0d0a 2020 2020 2020 2020  taset...        
-00001890: 6474 7970 653a 204c 6973 745b 6764 616c  dtype: List[gdal
-000018a0: 2e44 6174 6154 7970 655d 0d0a 2020 2020  .DataType]..    
-000018b0: 2020 2020 2020 2020 6764 616c 2064 6174          gdal dat
-000018c0: 6120 7479 7065 2066 6f72 2065 6163 6820  a type for each 
-000018d0: 6261 6e64 2069 6e20 7468 6520 6461 7461  band in the data
-000018e0: 7365 742e 0d0a 2020 2020 2020 2020 2222  set...        ""
-000018f0: 220d 0a20 2020 2020 2020 2063 6f6c 7320  "..        cols 
-00001900: 3d20 7372 632e 5261 7374 6572 5853 697a  = src.RasterXSiz
-00001910: 650d 0a20 2020 2020 2020 2072 6f77 7320  e..        rows 
-00001920: 3d20 7372 632e 5261 7374 6572 5953 697a  = src.RasterYSiz
-00001930: 650d 0a20 2020 2020 2020 2070 726a 203d  e..        prj =
-00001940: 2073 7263 2e47 6574 5072 6f6a 6563 7469   src.GetProjecti
-00001950: 6f6e 2829 0d0a 2020 2020 2020 2020 2320  on()..        # 
-00001960: 7372 632e 4765 7450 726f 6a65 6374 696f  src.GetProjectio
-00001970: 6e52 6566 2829 0d0a 2020 2020 2020 2020  nRef()..        
-00001980: 6261 6e64 7320 3d20 7372 632e 5261 7374  bands = src.Rast
-00001990: 6572 436f 756e 740d 0a20 2020 2020 2020  erCount..       
-000019a0: 2067 7420 3d20 7372 632e 4765 7447 656f   gt = src.GetGeo
-000019b0: 5472 616e 7366 6f72 6d28 290d 0a0d 0a20  Transform().... 
-000019c0: 2020 2020 2020 206e 6f5f 6461 7461 5f76         no_data_v
-000019d0: 616c 7565 203d 205b 0d0a 2020 2020 2020  alue = [..      
-000019e0: 2020 2020 2020 7372 632e 4765 7452 6173        src.GetRas
-000019f0: 7465 7242 616e 6428 6929 2e47 6574 4e6f  terBand(i).GetNo
-00001a00: 4461 7461 5661 6c75 6528 2920 666f 7220  DataValue() for 
-00001a10: 6920 696e 2072 616e 6765 2831 2c20 6261  i in range(1, ba
-00001a20: 6e64 7320 2b20 3129 0d0a 2020 2020 2020  nds + 1)..      
-00001a30: 2020 5d0d 0a20 2020 2020 2020 2064 7479    ]..        dty
-00001a40: 7065 203d 205b 7372 632e 4765 7452 6173  pe = [src.GetRas
-00001a50: 7465 7242 616e 6428 6929 2e44 6174 6154  terBand(i).DataT
-00001a60: 7970 6520 666f 7220 6920 696e 2072 616e  ype for i in ran
-00001a70: 6765 2831 2c20 6261 6e64 7320 2b20 3129  ge(1, bands + 1)
-00001a80: 5d0d 0a0d 0a20 2020 2020 2020 2072 6574  ]....        ret
-00001a90: 7572 6e20 636f 6c73 2c20 726f 7773 2c20  urn cols, rows, 
-00001aa0: 7072 6a2c 2062 616e 6473 2c20 6774 2c20  prj, bands, gt, 
-00001ab0: 6e6f 5f64 6174 615f 7661 6c75 652c 2064  no_data_value, d
-00001ac0: 7479 7065 0d0a 0d0a 2020 2020 4073 7461  type....    @sta
-00001ad0: 7469 636d 6574 686f 640d 0a20 2020 2064  ticmethod..    d
-00001ae0: 6566 2067 6574 4550 5347 2873 7263 3a20  ef getEPSG(src: 
-00001af0: 4461 7461 7365 7429 202d 3e20 696e 743a  Dataset) -> int:
-00001b00: 0d0a 2020 2020 2020 2020 2222 2247 6574  ..        """Get
-00001b10: 4550 5347 2e0d 0a0d 0a20 2020 2020 2020  EPSG.....       
-00001b20: 2020 2020 2054 6869 7320 6675 6e63 7469       This functi
-00001b30: 6f6e 2072 6561 6473 2074 6865 2070 726f  on reads the pro
-00001b40: 6a65 6374 696f 6e20 6f66 2061 2047 454f  jection of a GEO
-00001b50: 4743 5320 6669 6c65 206f 7220 7469 6666  GCS file or tiff
-00001b60: 2066 696c 650d 0a0d 0a20 2020 2020 2020   file....       
-00001b70: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-00001b80: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-00001b90: 0a20 2020 2020 2020 2073 7263 3a20 5b67  .        src: [g
-00001ba0: 6461 6c2e 4461 7461 7365 745d 0d0a 2020  dal.Dataset]..  
-00001bb0: 2020 2020 2020 2020 2020 7261 7374 6572            raster
-00001bc0: 2072 6561 6420 6279 2067 6461 6c0d 0a0d   read by gdal...
-00001bd0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00001be0: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00001bf0: 2d0d 0a20 2020 2020 2020 2065 7073 6720  -..        epsg 
-00001c00: 3a20 5b69 6e74 6567 6572 5d0d 0a20 2020  : [integer]..   
-00001c10: 2020 2020 2020 2020 2065 7073 6720 6e75           epsg nu
-00001c20: 6d62 6572 0d0a 2020 2020 2020 2020 2222  mber..        ""
-00001c30: 220d 0a20 2020 2020 2020 2070 726a 203d  "..        prj =
-00001c40: 2073 7263 2e47 6574 5072 6f6a 6563 7469   src.GetProjecti
-00001c50: 6f6e 2829 0d0a 2020 2020 2020 2020 6570  on()..        ep
-00001c60: 7367 203d 2056 6563 746f 722e 6765 7445  sg = Vector.getE
-00001c70: 5053 4766 726f 6d50 726a 2870 726a 290d  PSGfromPrj(prj).
-00001c80: 0a0d 0a20 2020 2020 2020 2072 6574 7572  ...        retur
-00001c90: 6e20 6570 7367 0d0a 0d0a 2020 2020 4073  n epsg....    @s
-00001ca0: 7461 7469 636d 6574 686f 640d 0a20 2020  taticmethod..   
-00001cb0: 2064 6566 205f 6372 6561 7465 5352 6672   def _createSRfr
-00001cc0: 6f6d 4550 5347 2865 7073 673a 2069 6e74  omEPSG(epsg: int
-00001cd0: 203d 2022 2229 202d 3e20 5370 6174 6961   = "") -> Spatia
-00001ce0: 6c52 6566 6572 656e 6365 3a0d 0a20 2020  lReference:..   
-00001cf0: 2020 2020 2022 2222 4372 6561 7465 2061       """Create a
-00001d00: 2073 7061 7469 616c 2072 6566 6572 656e   spatial referen
-00001d10: 6365 206f 626a 6563 7420 6672 6f6d 2065  ce object from e
-00001d20: 7073 6720 6e75 6d62 6572 2e0d 0a0d 0a20  psg number..... 
-00001d30: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-00001d40: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-00001d50: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2065  -----..        e
-00001d60: 7073 673a 205b 696e 745d 0d0a 2020 2020  psg: [int]..    
-00001d70: 2020 2020 2020 2020 6570 7367 206e 756d          epsg num
-00001d80: 6265 722e 0d0a 0d0a 2020 2020 2020 2020  ber.....        
-00001d90: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
-00001da0: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020   -------..      
-00001db0: 2020 5370 6174 6961 6c52 6566 6572 656e    SpatialReferen
-00001dc0: 6365 206f 626a 6563 740d 0a20 2020 2020  ce object..     
-00001dd0: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-00001de0: 7372 203d 206f 7372 2e53 7061 7469 616c  sr = osr.Spatial
-00001df0: 5265 6665 7265 6e63 6528 290d 0a0d 0a20  Reference().... 
-00001e00: 2020 2020 2020 2069 6620 6570 7367 203d         if epsg =
-00001e10: 3d20 2222 3a0d 0a20 2020 2020 2020 2020  = "":..         
-00001e20: 2020 2073 722e 5365 7457 656c 6c4b 6e6f     sr.SetWellKno
-00001e30: 776e 4765 6f67 4353 2822 5747 5338 3422  wnGeogCS("WGS84"
-00001e40: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
-00001e50: 0d0a 2020 2020 2020 2020 2020 2020 7472  ..            tr
-00001e60: 793a 0d0a 2020 2020 2020 2020 2020 2020  y:..            
-00001e70: 2020 2020 6966 206e 6f74 2073 722e 5365      if not sr.Se
-00001e80: 7457 656c 6c4b 6e6f 776e 4765 6f67 4353  tWellKnownGeogCS
-00001e90: 2865 7073 6729 203d 3d20 363a 0d0a 2020  (epsg) == 6:..  
-00001ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001eb0: 2020 7372 2e53 6574 5765 6c6c 4b6e 6f77    sr.SetWellKnow
-00001ec0: 6e47 656f 6743 5328 6570 7367 290d 0a20  nGeogCS(epsg).. 
-00001ed0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00001ee0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00001ef0: 2020 2020 2020 2020 2020 7472 793a 0d0a            try:..
-00001f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001f10: 2020 2020 2020 2020 7372 2e49 6d70 6f72          sr.Impor
-00001f20: 7446 726f 6d45 5053 4728 696e 7428 6570  tFromEPSG(int(ep
-00001f30: 7367 2929 0d0a 2020 2020 2020 2020 2020  sg))..          
-00001f40: 2020 2020 2020 2020 2020 6578 6365 7074            except
-00001f50: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00001f60: 2020 2020 2020 2020 2020 2073 722e 496d             sr.Im
-00001f70: 706f 7274 4672 6f6d 576b 7428 6570 7367  portFromWkt(epsg
-00001f80: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-00001f90: 7863 6570 743a 0d0a 2020 2020 2020 2020  xcept:..        
-00001fa0: 2020 2020 2020 2020 7472 793a 0d0a 2020          try:..  
-00001fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001fc0: 2020 7372 2e49 6d70 6f72 7446 726f 6d45    sr.ImportFromE
-00001fd0: 5053 4728 696e 7428 6570 7367 2929 0d0a  PSG(int(epsg))..
-00001fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001ff0: 6578 6365 7074 3a0d 0a20 2020 2020 2020  except:..       
-00002000: 2020 2020 2020 2020 2020 2020 2073 722e               sr.
-00002010: 496d 706f 7274 4672 6f6d 576b 7428 6570  ImportFromWkt(ep
-00002020: 7367 290d 0a20 2020 2020 2020 2072 6574  sg)..        ret
-00002030: 7572 6e20 7372 0d0a 0d0a 2020 2020 4073  urn sr....    @s
-00002040: 7461 7469 636d 6574 686f 640d 0a20 2020  taticmethod..   
-00002050: 2064 6566 2073 6574 4e6f 4461 7461 5661   def setNoDataVa
-00002060: 6c75 6528 7372 632c 206e 6f5f 6461 7461  lue(src, no_data
-00002070: 5f76 616c 7565 3d44 4546 4155 4c54 5f4e  _value=DEFAULT_N
-00002080: 4f5f 4441 5441 5f56 414c 5545 2920 2d3e  O_DATA_VALUE) ->
-00002090: 2044 6174 6173 6574 3a0d 0a20 2020 2020   Dataset:..     
-000020a0: 2020 2022 2222 5365 7420 7468 6520 6e6f     """Set the no
-000020b0: 2064 6174 6120 7661 6c75 6520 696e 2061   data value in a
-000020c0: 2061 6c6c 2072 6173 7465 7220 6261 6e64   all raster band
-000020d0: 732e 0d0a 0d0a 2020 2020 2020 2020 5061  s.....        Pa
-000020e0: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
-000020f0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-00002100: 2020 2020 2020 7372 633a 205b 4461 7461        src: [Data
-00002110: 7365 745d 0d0a 2020 2020 2020 2020 2020  set]..          
-00002120: 2020 6764 616c 2044 6174 6173 6574 0d0a    gdal Dataset..
-00002130: 2020 2020 2020 2020 6e6f 5f64 6174 615f          no_data_
-00002140: 7661 6c75 653a 205b 6e75 6d65 7269 635d  value: [numeric]
-00002150: 0d0a 2020 2020 2020 2020 2020 2020 6e6f  ..            no
-00002160: 2064 6174 6120 7661 6c75 6520 746f 2066   data value to f
-00002170: 696c 6c20 7468 6520 6d61 736b 6564 2070  ill the masked p
-00002180: 6172 7420 6f66 2074 6865 2061 7272 6179  art of the array
-00002190: 0d0a 0d0a 2020 2020 2020 2020 5265 7475  ....        Retu
-000021a0: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
-000021b0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6764  ----..        gd
-000021c0: 616c 2044 6174 6173 6574 0d0a 2020 2020  al Dataset..    
-000021d0: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
-000021e0: 2023 2073 6574 7469 6e67 2074 6865 206e   # setting the n
-000021f0: 6f5f 6461 7461 5f76 616c 7565 2064 6f65  o_data_value doe
-00002200: 7320 6e6f 7420 6163 6365 7074 2064 6f75  s not accept dou
-00002210: 626c 6520 7072 6563 6973 696f 6e20 6e75  ble precision nu
-00002220: 6d62 6572 730d 0a20 2020 2020 2020 2066  mbers..        f
-00002230: 6f72 2062 616e 6420 696e 2072 616e 6765  or band in range
-00002240: 2831 2c20 7372 632e 5261 7374 6572 436f  (1, src.RasterCo
-00002250: 756e 7420 2b20 3129 3a0d 0a20 2020 2020  unt + 1):..     
-00002260: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
-00002270: 2020 2020 2020 2020 2020 2020 2073 7263               src
-00002280: 2e47 6574 5261 7374 6572 4261 6e64 2862  .GetRasterBand(b
-00002290: 616e 6429 2e53 6574 4e6f 4461 7461 5661  and).SetNoDataVa
-000022a0: 6c75 6528 6e6f 5f64 6174 615f 7661 6c75  lue(no_data_valu
-000022b0: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-000022c0: 2020 2020 2320 696e 6974 6961 6c69 7a65      # initialize
-000022d0: 2074 6865 2062 616e 6420 7769 7468 2074   the band with t
-000022e0: 6865 206e 6f64 6174 6120 7661 6c75 6520  he nodata value 
-000022f0: 696e 7374 6561 6420 6f66 2030 0d0a 2020  instead of 0..  
-00002300: 2020 2020 2020 2020 2020 2020 2020 7372                sr
-00002310: 632e 4765 7452 6173 7465 7242 616e 6428  c.GetRasterBand(
-00002320: 6261 6e64 292e 4669 6c6c 286e 6f5f 6461  band).Fill(no_da
-00002330: 7461 5f76 616c 7565 290d 0a20 2020 2020  ta_value)..     
-00002340: 2020 2020 2020 2065 7863 6570 743a 0d0a         except:..
-00002350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002360: 7372 632e 4765 7452 6173 7465 7242 616e  src.GetRasterBan
-00002370: 6428 6261 6e64 292e 5365 744e 6f44 6174  d(band).SetNoDat
-00002380: 6156 616c 7565 2844 4546 4155 4c54 5f4e  aValue(DEFAULT_N
-00002390: 4f5f 4441 5441 5f56 414c 5545 290d 0a20  O_DATA_VALUE).. 
-000023a0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000023b0: 7263 2e47 6574 5261 7374 6572 4261 6e64  rc.GetRasterBand
-000023c0: 2862 616e 6429 2e46 696c 6c28 4445 4641  (band).Fill(DEFA
-000023d0: 554c 545f 4e4f 5f44 4154 415f 5641 4c55  ULT_NO_DATA_VALU
-000023e0: 4529 0d0a 2020 2020 2020 2020 2020 2020  E)..            
-000023f0: 2020 2020 2320 6173 7365 7274 2046 616c      # assert Fal
-00002400: 7365 2c20 2270 6c65 6173 6520 6368 616e  se, "please chan
-00002410: 6765 2074 6865 206e 6f5f 6461 7461 5f76  ge the no_data_v
-00002420: 616c 7565 2069 6e20 7468 6520 736f 7572  alue in the sour
-00002430: 6365 2072 6173 7465 7220 6173 2069 7420  ce raster as it 
-00002440: 6973 206e 6f74 2061 6363 6570 7465 6420  is not accepted 
-00002450: 6279 2047 6461 6c22 0d0a 2020 2020 2020  by Gdal"..      
-00002460: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00002470: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00002480: 2020 2020 2020 2274 6865 206e 6f5f 6461        "the no_da
-00002490: 7461 5f76 616c 7565 2069 6e20 7468 6520  ta_value in the 
-000024a0: 736f 7572 6365 204e 6574 6364 6620 6973  source Netcdf is
-000024b0: 2064 6f75 626c 6520 7072 6563 6973 7369   double precissi
-000024c0: 6f6e 2061 6e64 2061 7320 6974 2069 7320  on and as it is 
-000024d0: 6e6f 7420 6163 6365 7074 6564 2062 7920  not accepted by 
-000024e0: 4764 616c 2074 6865 2022 0d0a 2020 2020  Gdal the "..    
-000024f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002500: 6622 6e6f 5f64 6174 615f 7661 6c75 6520  f"no_data_value 
-00002510: 6e6f 7720 6973 2065 7420 746f 207b 4445  now is et to {DE
-00002520: 4641 554c 545f 4e4f 5f44 4154 415f 5641  FAULT_NO_DATA_VA
-00002530: 4c55 457d 2069 6e20 7468 6520 7261 7374  LUE} in the rast
-00002540: 6572 220d 0a20 2020 2020 2020 2020 2020  er"..           
-00002550: 2020 2020 2029 0d0a 0d0a 2020 2020 2020       )....      
-00002560: 2020 7265 7475 726e 2073 7263 0d0a 0d0a    return src....
-00002570: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
-00002580: 640d 0a20 2020 2064 6566 2067 6574 4261  d..    def getBa
-00002590: 6e64 4e61 6d65 7328 7372 633a 2044 6174  ndNames(src: Dat
-000025a0: 6173 6574 2920 2d3e 204c 6973 745b 7374  aset) -> List[st
-000025b0: 725d 3a0d 0a20 2020 2020 2020 2022 2222  r]:..        """
-000025c0: 4765 7420 6261 6e64 206e 616d 6573 2066  Get band names f
-000025d0: 726f 6d20 6261 6e64 206d 6574 6120 6461  rom band meta da
-000025e0: 7461 2069 6620 6578 6973 7473 206f 7468  ta if exists oth
-000025f0: 6572 7769 7365 2077 696c 6c20 7265 7475  erwise will retu
-00002600: 726e 2069 6465 7820 5b31 2c32 2c20 2e2e  rn idex [1,2, ..
-00002610: 2e5d 0d0a 0d0a 2020 2020 2020 2020 5061  .]....        Pa
-00002620: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
-00002630: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-00002640: 2020 2020 2020 7372 6320 3a20 5b67 6461        src : [gda
-00002650: 6c2e 5d44 6174 6173 6574 5d0d 0a20 2020  l.]Dataset]..   
-00002660: 2020 2020 2020 2020 2067 6461 6c20 4461           gdal Da
-00002670: 7461 7365 740d 0a0d 0a20 2020 2020 2020  taset....       
-00002680: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
-00002690: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
-000026a0: 2020 206c 6973 745b 7374 725d 0d0a 2020     list[str]..  
-000026b0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-000026c0: 2020 206e 616d 6573 203d 205b 5d0d 0a20     names = [].. 
-000026d0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-000026e0: 7261 6e67 6528 312c 2073 7263 2e52 6173  range(1, src.Ras
-000026f0: 7465 7243 6f75 6e74 202b 2031 293a 0d0a  terCount + 1):..
-00002700: 2020 2020 2020 2020 2020 2020 6261 6e64              band
-00002710: 5f69 203d 2073 7263 2e47 6574 5261 7374  _i = src.GetRast
-00002720: 6572 4261 6e64 2869 290d 0a0d 0a20 2020  erBand(i)....   
-00002730: 2020 2020 2020 2020 2069 6620 6261 6e64           if band
-00002740: 5f69 2e47 6574 4465 7363 7269 7074 696f  _i.GetDescriptio
-00002750: 6e28 293a 0d0a 2020 2020 2020 2020 2020  n():..          
-00002760: 2020 2020 2020 2320 5573 6520 7468 6520        # Use the 
-00002770: 6261 6e64 5f69 2064 6573 6372 6970 7469  band_i descripti
-00002780: 6f6e 2e0d 0a20 2020 2020 2020 2020 2020  on...           
-00002790: 2020 2020 206e 616d 6573 2e61 7070 656e       names.appen
-000027a0: 6428 6261 6e64 5f69 2e47 6574 4465 7363  d(band_i.GetDesc
-000027b0: 7269 7074 696f 6e28 2929 0d0a 2020 2020  ription())..    
-000027c0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-000027d0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-000027e0: 2043 6865 636b 2066 6f72 206d 6574 6564   Check for meted
-000027f0: 6174 612e 0d0a 2020 2020 2020 2020 2020  ata...          
-00002800: 2020 2020 2020 6261 6e64 5f69 5f6e 616d        band_i_nam
-00002810: 6520 3d20 2242 616e 645f 7b7d 222e 666f  e = "Band_{}".fo
-00002820: 726d 6174 2862 616e 645f 692e 4765 7442  rmat(band_i.GetB
-00002830: 616e 6428 2929 0d0a 2020 2020 2020 2020  and())..        
-00002840: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
-00002850: 203d 2062 616e 645f 692e 4765 7444 6174   = band_i.GetDat
-00002860: 6173 6574 2829 2e47 6574 4d65 7461 6461  aset().GetMetada
-00002870: 7461 5f44 6963 7428 290d 0a0d 0a20 2020  ta_Dict()....   
-00002880: 2020 2020 2020 2020 2020 2020 2023 2049               # I
-00002890: 6620 696e 206d 6574 6164 6174 612c 2072  f in metadata, r
-000028a0: 6574 7572 6e20 7468 6520 6d65 7461 6461  eturn the metada
-000028b0: 7461 2065 6e74 7279 2c20 656c 7365 2042  ta entry, else B
-000028c0: 616e 645f 4e2e 0d0a 2020 2020 2020 2020  and_N...        
-000028d0: 2020 2020 2020 2020 6966 2062 616e 645f          if band_
-000028e0: 695f 6e61 6d65 2069 6e20 6d65 7461 6461  i_name in metada
-000028f0: 7461 2061 6e64 206d 6574 6164 6174 615b  ta and metadata[
-00002900: 6261 6e64 5f69 5f6e 616d 655d 3a0d 0a20  band_i_name]:.. 
-00002910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002920: 2020 206e 616d 6573 2e61 7070 656e 6428     names.append(
-00002930: 6d65 7461 6461 7461 5b62 616e 645f 695f  metadata[band_i_
-00002940: 6e61 6d65 5d29 0d0a 2020 2020 2020 2020  name])..        
-00002950: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00002960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002970: 2020 206e 616d 6573 2e61 7070 656e 6428     names.append(
-00002980: 6261 6e64 5f69 5f6e 616d 6529 0d0a 0d0a  band_i_name)....
-00002990: 2020 2020 2020 2020 7265 7475 726e 206e          return n
-000029a0: 616d 6573 0d0a 0d0a 2020 2020 4073 7461  ames....    @sta
-000029b0: 7469 636d 6574 686f 640d 0a20 2020 2064  ticmethod..    d
-000029c0: 6566 2063 7265 6174 6545 6d70 7479 4472  ef createEmptyDr
-000029d0: 6976 6572 280d 0a20 2020 2020 2020 2073  iver(..        s
-000029e0: 7263 3a20 4461 7461 7365 742c 2070 6174  rc: Dataset, pat
-000029f0: 683a 2073 7472 2c20 6261 6e64 733a 2069  h: str, bands: i
-00002a00: 6e74 203d 2031 2c20 6e6f 5f64 6174 615f  nt = 1, no_data_
-00002a10: 7661 6c75 653d 4e6f 6e65 0d0a 2020 2020  value=None..    
-00002a20: 2920 2d3e 2044 6174 6173 6574 3a0d 0a20  ) -> Dataset:.. 
-00002a30: 2020 2020 2020 2022 2222 4372 6561 7465         """Create
-00002a40: 2061 206e 6577 2065 6d70 7479 2064 7269   a new empty dri
-00002a50: 7665 7220 6672 6f6d 2061 6e6f 7468 6572  ver from another
-00002a60: 2064 6174 6173 6574 2e0d 0a0d 0a20 2020   dataset.....   
-00002a70: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
-00002a80: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00002a90: 2d2d 2d0d 0a20 2020 2020 2020 2073 7263  ---..        src
-00002aa0: 203a 205b 4461 7461 7365 745d 0d0a 2020   : [Dataset]..  
-00002ab0: 2020 2020 2020 2020 2020 6764 616c 2064            gdal d
-00002ac0: 6174 6173 6574 0d0a 2020 2020 2020 2020  ataset..        
-00002ad0: 7061 7468 203a 2073 7472 0d0a 2020 2020  path : str..    
-00002ae0: 2020 2020 6261 6e64 7320 3a20 696e 7420      bands : int 
-00002af0: 6f72 204e 6f6e 650d 0a20 2020 2020 2020  or None..       
-00002b00: 2020 2020 204e 756d 6265 7220 6f66 2062       Number of b
-00002b10: 616e 6473 2074 6f20 6372 6561 7465 2069  ands to create i
-00002b20: 6e20 7468 6520 6f75 7470 7574 2072 6173  n the output ras
-00002b30: 7465 722e 0d0a 2020 2020 2020 2020 6e6f  ter...        no
-00002b40: 5f64 6174 615f 7661 6c75 6520 3a20 666c  _data_value : fl
-00002b50: 6f61 7420 6f72 204e 6f6e 650d 0a20 2020  oat or None..   
-00002b60: 2020 2020 2020 2020 204e 6f20 6461 7461           No data
-00002b70: 2076 616c 7565 2c20 6966 204e 6f6e 6520   value, if None 
-00002b80: 7573 6573 2074 6865 2073 616d 6520 6173  uses the same as
-00002b90: 2060 6073 7263 6060 2e0d 0a0d 0a20 2020   ``src``.....   
-00002ba0: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
-00002bb0: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
-00002bc0: 2020 2020 2020 2067 6461 6c2e 4461 7461         gdal.Data
-00002bd0: 5365 740d 0a20 2020 2020 2020 2022 2222  Set..        """
-00002be0: 0d0a 2020 2020 2020 2020 6261 6e64 7320  ..        bands 
-00002bf0: 3d20 696e 7428 6261 6e64 7329 2069 6620  = int(bands) if 
-00002c00: 6261 6e64 7320 6973 206e 6f74 204e 6f6e  bands is not Non
-00002c10: 6520 656c 7365 2073 7263 2e52 6173 7465  e else src.Raste
-00002c20: 7243 6f75 6e74 0d0a 0d0a 2020 2020 2020  rCount....      
-00002c30: 2020 636f 6c73 2c20 726f 7773 2c20 7072    cols, rows, pr
-00002c40: 6a2c 205f 2c20 6774 2c20 5f2c 2064 7479  j, _, gt, _, dty
-00002c50: 7065 7320 3d20 5261 7374 6572 2e67 6574  pes = Raster.get
-00002c60: 5261 7374 6572 4465 7461 696c 7328 7372  RasterDetails(sr
-00002c70: 6329 0d0a 2020 2020 2020 2020 2320 4372  c)..        # Cr
-00002c80: 6561 7465 2074 6865 2064 7269 7665 722e  eate the driver.
-00002c90: 0d0a 2020 2020 2020 2020 6473 7420 3d20  ..        dst = 
-00002ca0: 5261 7374 6572 2e5f 6372 6561 7465 4461  Raster._createDa
-00002cb0: 7461 7365 7428 636f 6c73 2c20 726f 7773  taset(cols, rows
-00002cc0: 2c20 6261 6e64 732c 2064 7479 7065 735b  , bands, dtypes[
-00002cd0: 305d 2c20 7061 7468 3d70 6174 6829 0d0a  0], path=path)..
-00002ce0: 0d0a 2020 2020 2020 2020 2320 5365 7420  ..        # Set 
-00002cf0: 7468 6520 7072 6f6a 6563 7469 6f6e 2e0d  the projection..
-00002d00: 0a20 2020 2020 2020 2064 7374 2e53 6574  .        dst.Set
-00002d10: 4765 6f54 7261 6e73 666f 726d 2867 7429  GeoTransform(gt)
-00002d20: 0d0a 2020 2020 2020 2020 6473 742e 5365  ..        dst.Se
-00002d30: 7450 726f 6a65 6374 696f 6e28 7372 632e  tProjection(src.
-00002d40: 4765 7450 726f 6a65 6374 696f 6e52 6566  GetProjectionRef
-00002d50: 2829 290d 0a0d 0a20 2020 2020 2020 2069  ())....        i
-00002d60: 6620 6e6f 5f64 6174 615f 7661 6c75 6520  f no_data_value 
-00002d70: 6973 206e 6f74 204e 6f6e 653a 0d0a 2020  is not None:..  
-00002d80: 2020 2020 2020 2020 2020 6473 7420 3d20            dst = 
-00002d90: 5261 7374 6572 2e73 6574 4e6f 4461 7461  Raster.setNoData
-00002da0: 5661 6c75 6528 6473 742c 206e 6f5f 6461  Value(dst, no_da
-00002db0: 7461 5f76 616c 7565 3d66 6c6f 6174 286e  ta_value=float(n
-00002dc0: 6f5f 6461 7461 5f76 616c 7565 2929 0d0a  o_data_value))..
-00002dd0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00002de0: 2064 7374 0d0a 0d0a 2020 2020 4073 7461   dst....    @sta
-00002df0: 7469 636d 6574 686f 640d 0a20 2020 2064  ticmethod..    d
-00002e00: 6566 2067 6574 4365 6c6c 436f 6f72 6473  ef getCellCoords
-00002e10: 280d 0a20 2020 2020 2020 2073 7263 3a20  (..        src: 
-00002e20: 4461 7461 7365 742c 206c 6f63 6174 696f  Dataset, locatio
-00002e30: 6e3a 2073 7472 203d 2022 6365 6e74 6572  n: str = "center
-00002e40: 222c 206d 6173 6b3a 2062 6f6f 6c20 3d20  ", mask: bool = 
-00002e50: 4661 6c73 650d 0a20 2020 2029 202d 3e20  False..    ) -> 
-00002e60: 5475 706c 655b 6e70 2e6e 6461 7272 6179  Tuple[np.ndarray
-00002e70: 2c20 6e70 2e6e 6461 7272 6179 5d3a 0d0a  , np.ndarray]:..
-00002e80: 2020 2020 2020 2020 2222 2247 6574 436f          """GetCo
-00002e90: 6f72 6473 2e0d 0a0d 0a20 2020 2020 2020  ords.....       
-00002ea0: 2052 6574 7572 6e73 2074 6865 2063 6f6f   Returns the coo
-00002eb0: 7264 696e 6174 6573 206f 6620 7468 6520  rdinates of the 
-00002ec0: 6365 6c6c 2063 656e 7472 6573 2069 6e73  cell centres ins
-00002ed0: 6964 6520 7468 6520 646f 6d61 696e 2028  ide the domain (
-00002ee0: 6f6e 6c79 2074 6865 2063 656c 6c73 2074  only the cells t
-00002ef0: 6861 740d 0a20 2020 2020 2020 2064 6f65  hat..        doe
-00002f00: 7320 6e6f 7420 6861 7665 206e 6f64 6174  s not have nodat
-00002f10: 6120 7661 6c75 6529 0d0a 0d0a 2020 2020  a value)....    
-00002f20: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
-00002f30: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00002f40: 2d2d 0d0a 2020 2020 2020 2020 7372 6320  --..        src 
-00002f50: 3a20 5b67 6461 6c5f 4461 7461 7365 745d  : [gdal_Dataset]
-00002f60: 0d0a 2020 2020 2020 2020 2020 2020 4765  ..            Ge
-00002f70: 7420 7468 6520 6461 7461 2066 726f 6d20  t the data from 
-00002f80: 7468 6520 6764 616c 2064 6174 6173 6574  the gdal dataset
-00002f90: 6f66 2074 6865 2044 454d 0d0a 2020 2020  of the DEM..    
-00002fa0: 2020 2020 6c6f 6361 7469 6f6e 3a20 5b73      location: [s
-00002fb0: 7472 5d0d 0a20 2020 2020 2020 2020 2020  tr]..           
-00002fc0: 206c 6f63 6174 696f 6e20 6f66 2074 6865   location of the
-00002fd0: 2063 6f6f 7264 696e 6174 6573 2022 6365   coordinates "ce
-00002fe0: 6e74 6572 2220 666f 7220 7468 6520 6365  nter" for the ce
-00002ff0: 6e74 6572 206f 6620 6120 6365 6c6c 2c20  nter of a cell, 
-00003000: 636f 726e 6572 2066 6f72 2074 6865 2063  corner for the c
-00003010: 6f72 6e65 7220 6f66 2074 6865 2063 656c  orner of the cel
-00003020: 6c2e 0d0a 2020 2020 2020 2020 2020 2020  l...            
-00003030: 7468 6520 636f 726e 6572 2069 7320 7468  the corner is th
-00003040: 6520 746f 7020 6c65 6674 2063 6f72 6e65  e top left corne
-00003050: 722e 0d0a 2020 2020 2020 2020 6d61 736b  r...        mask
-00003060: 3a20 5b62 6f6f 6c5d 0d0a 2020 2020 2020  : [bool]..      
-00003070: 2020 2020 2020 5472 7565 2074 6f20 4578        True to Ex
-00003080: 6563 6c75 6465 2074 6865 2063 656c 6c73  eclude the cells
-00003090: 206f 7574 206f 6620 7468 6520 646f 6169   out of the doai
-000030a0: 6e2e 2044 6566 6175 6c74 2069 7320 4661  n. Default is Fa
-000030b0: 6c73 652e 0d0a 0d0a 2020 2020 2020 2020  lse.....        
-000030c0: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
-000030d0: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020   -------..      
-000030e0: 2020 636f 6f72 6473 203a 205b 6e70 2e6e    coords : [np.n
-000030f0: 6461 7272 6179 5d0d 0a20 2020 2020 2020  darray]..       
-00003100: 2020 2020 2041 7272 6179 2077 6974 6820       Array with 
-00003110: 6120 6c69 7374 206f 6620 7468 6520 636f  a list of the co
-00003120: 6f72 6469 6e61 7465 7320 746f 2062 6520  ordinates to be 
-00003130: 696e 7465 7270 6f6c 6174 6564 2c20 7769  interpolated, wi
-00003140: 7468 6f75 7420 7468 6520 4e61 6e0d 0a20  thout the Nan.. 
-00003150: 2020 2020 2020 206d 6174 5f72 616e 6765         mat_range
-00003160: 203a 205b 6e70 2e6e 6461 7272 6179 5d0d   : [np.ndarray].
-00003170: 0a20 2020 2020 2020 2020 2020 2041 7272  .            Arr
-00003180: 6179 2077 6974 6820 616c 6c20 7468 6520  ay with all the 
-00003190: 6365 6e74 7265 7320 6f66 2063 656c 6c73  centres of cells
-000031a0: 2069 6e20 7468 6520 646f 6d61 696e 206f   in the domain o
-000031b0: 6620 7468 6520 4445 4d0d 0a20 2020 2020  f the DEM..     
-000031c0: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-000031d0: 2320 6368 6563 6b20 7468 6520 6c6f 6361  # check the loca
-000031e0: 7469 6f6e 2070 6172 616d 6574 6572 0d0a  tion parameter..
-000031f0: 2020 2020 2020 2020 6c6f 6361 7469 6f6e          location
-00003200: 203d 206c 6f63 6174 696f 6e2e 6c6f 7765   = location.lowe
-00003210: 7228 290d 0a20 2020 2020 2020 2069 6620  r()..        if 
-00003220: 6c6f 6361 7469 6f6e 206e 6f74 2069 6e20  location not in 
-00003230: 5b22 6365 6e74 6572 222c 2022 636f 726e  ["center", "corn
-00003240: 6572 225d 3a0d 0a20 2020 2020 2020 2020  er"]:..         
-00003250: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-00003260: 726f 7228 0d0a 2020 2020 2020 2020 2020  ror(..          
-00003270: 2020 2020 2020 2254 6865 206c 6f63 6174        "The locat
-00003280: 696f 6e20 7061 7261 6d65 7465 7220 6361  ion parameter ca
-00003290: 6e20 6861 7665 206f 6e65 206f 6620 7468  n have one of th
-000032a0: 6573 6520 7661 6c75 6573 3a20 2763 656e  ese values: 'cen
-000032b0: 7465 7227 2c20 2763 6f72 6e65 7227 2c20  ter', 'corner', 
-000032c0: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
-000032d0: 2020 2066 2262 7574 2074 6865 2076 616c     f"but the val
-000032e0: 7565 3a20 7b6c 6f63 6174 696f 6e7d 2069  ue: {location} i
-000032f0: 7320 6769 7665 6e2e 220d 0a20 2020 2020  s given."..     
-00003300: 2020 2020 2020 2029 0d0a 0d0a 2020 2020         )....    
-00003310: 2020 2020 6966 206c 6f63 6174 696f 6e20      if location 
-00003320: 3d3d 2022 6365 6e74 6572 223a 0d0a 2020  == "center":..  
-00003330: 2020 2020 2020 2020 2020 2320 4164 6469            # Addi
-00003340: 6e67 2030 2e35 2a63 656c 6c20 7369 7a65  ng 0.5*cell size
-00003350: 2074 6f20 6765 7420 7468 6520 6365 6e74   to get the cent
-00003360: 7265 0d0a 2020 2020 2020 2020 2020 2020  re..            
-00003370: 6164 645f 7661 6c75 6520 3d20 302e 350d  add_value = 0.5.
-00003380: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-00003390: 2020 2020 2020 2020 2020 2020 6164 645f              add_
-000033a0: 7661 6c75 6520 3d20 300d 0a20 2020 2020  value = 0..     
-000033b0: 2020 2023 2047 6574 7469 6e67 2064 6174     # Getting dat
-000033c0: 6120 666f 7220 7468 6520 7768 6f6c 6520  a for the whole 
-000033d0: 6772 6964 0d0a 2020 2020 2020 2020 280d  grid..        (.
-000033e0: 0a20 2020 2020 2020 2020 2020 2078 5f69  .            x_i
-000033f0: 6e69 742c 0d0a 2020 2020 2020 2020 2020  nit,..          
-00003400: 2020 6365 6c6c 5f73 697a 655f 782c 0d0a    cell_size_x,..
-00003410: 2020 2020 2020 2020 2020 2020 7879 5f73              xy_s
-00003420: 7061 6e2c 0d0a 2020 2020 2020 2020 2020  pan,..          
-00003430: 2020 795f 696e 6974 2c0d 0a20 2020 2020    y_init,..     
-00003440: 2020 2020 2020 2079 795f 7370 616e 2c0d         yy_span,.
-00003450: 0a20 2020 2020 2020 2020 2020 2063 656c  .            cel
-00003460: 6c5f 7369 7a65 5f79 2c0d 0a20 2020 2020  l_size_y,..     
-00003470: 2020 2029 203d 2073 7263 2e47 6574 4765     ) = src.GetGe
-00003480: 6f54 7261 6e73 666f 726d 2829 0d0a 2020  oTransform()..  
-00003490: 2020 2020 2020 6966 2063 656c 6c5f 7369        if cell_si
-000034a0: 7a65 5f78 2021 3d20 6365 6c6c 5f73 697a  ze_x != cell_siz
-000034b0: 655f 793a 0d0a 2020 2020 2020 2020 2020  e_y:..          
-000034c0: 2020 6966 2063 656c 6c5f 7369 7a65 5f78    if cell_size_x
-000034d0: 2021 3d20 2d31 202a 2063 656c 6c5f 7369   != -1 * cell_si
-000034e0: 7a65 5f79 3a0d 0a20 2020 2020 2020 2020  ze_y:..         
-000034f0: 2020 2020 2020 206c 6f67 6765 722e 7761         logger.wa
-00003500: 726e 696e 6728 0d0a 2020 2020 2020 2020  rning(..        
-00003510: 2020 2020 2020 2020 2020 2020 6622 5468              f"Th
-00003520: 6520 6769 7665 6e20 7261 7374 6572 2064  e given raster d
-00003530: 6f65 7320 6e6f 7420 6861 7665 2061 2073  oes not have a s
-00003540: 7175 6172 6520 6365 6c6c 732c 2074 6865  quare cells, the
-00003550: 2063 656c 6c20 7369 7a65 2069 7320 7b63   cell size is {c
-00003560: 656c 6c5f 7369 7a65 5f78 7d2a 7b63 656c  ell_size_x}*{cel
-00003570: 6c5f 7369 7a65 5f79 7d20 220d 0a20 2020  l_size_y} "..   
-00003580: 2020 2020 2020 2020 2020 2020 2029 0d0a               )..
-00003590: 0d0a 2020 2020 2020 2020 726f 7773 2c20  ..        rows, 
-000035a0: 636f 6c73 203d 2073 7263 2e52 6561 6441  cols = src.ReadA
-000035b0: 7341 7272 6179 2829 2e73 6861 7065 0d0a  sArray().shape..
-000035c0: 0d0a 2020 2020 2020 2020 2320 6461 7461  ..        # data
-000035d0: 2069 6e20 7468 6520 6172 7261 790d 0a20   in the array.. 
-000035e0: 2020 2020 2020 206e 6f5f 7661 6c20 3d20         no_val = 
-000035f0: 7372 632e 4765 7452 6173 7465 7242 616e  src.GetRasterBan
-00003600: 6428 3129 2e47 6574 4e6f 4461 7461 5661  d(1).GetNoDataVa
-00003610: 6c75 6528 290d 0a20 2020 2020 2020 2061  lue()..        a
-00003620: 7272 203d 2073 7263 2e52 6561 6441 7341  rr = src.ReadAsA
-00003630: 7272 6179 2829 0d0a 0d0a 2020 2020 2020  rray()....      
-00003640: 2020 2320 6361 6c63 756c 6174 6520 7468    # calculate th
-00003650: 6520 636f 6f72 6469 6e61 7465 7320 6f66  e coordinates of
-00003660: 2061 6c6c 2063 656c 6c73 0d0a 2020 2020   all cells..    
-00003670: 2020 2020 7820 3d20 6e70 2e61 7272 6179      x = np.array
-00003680: 285b 785f 696e 6974 202b 2063 656c 6c5f  ([x_init + cell_
-00003690: 7369 7a65 5f78 202a 2028 6920 2b20 6164  size_x * (i + ad
-000036a0: 645f 7661 6c75 6529 2066 6f72 2069 2069  d_value) for i i
-000036b0: 6e20 7261 6e67 6528 636f 6c73 295d 290d  n range(cols)]).
-000036c0: 0a20 2020 2020 2020 2079 203d 206e 702e  .        y = np.
-000036d0: 6172 7261 7928 5b79 5f69 6e69 7420 2b20  array([y_init + 
-000036e0: 6365 6c6c 5f73 697a 655f 7920 2a20 2869  cell_size_y * (i
-000036f0: 202b 2061 6464 5f76 616c 7565 2920 666f   + add_value) fo
-00003700: 7220 6920 696e 2072 616e 6765 2872 6f77  r i in range(row
-00003710: 7329 5d29 0d0a 2020 2020 2020 2020 616c  s)])..        al
-00003720: 6c5f 6365 6c6c 7320 3d20 5b5b 2878 692c  l_cells = [[(xi,
-00003730: 2079 6929 2066 6f72 2079 6920 696e 2079   yi) for yi in y
-00003740: 5d20 666f 7220 7869 2069 6e20 785d 0d0a  ] for xi in x]..
-00003750: 0d0a 2020 2020 2020 2020 6966 206d 6173  ..        if mas
-00003760: 6b3a 0d0a 2020 2020 2020 2020 2020 2020  k:..            
-00003770: 2320 6578 6563 6c75 6465 2074 6865 206e  # execlude the n
-00003780: 6f5f 6461 7461 5f76 616c 7565 7320 6365  o_data_values ce
-00003790: 6c6c 732e 0d0a 2020 2020 2020 2020 2020  lls...          
-000037a0: 2020 6d61 736b 6564 5f63 656c 6c73 203d    masked_cells =
-000037b0: 205b 5d0d 0a0d 0a20 2020 2020 2020 2020   []....         
-000037c0: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
-000037d0: 6528 726f 7773 293a 0d0a 2020 2020 2020  e(rows):..      
-000037e0: 2020 2020 2020 2020 2020 666f 7220 6a20            for j 
-000037f0: 696e 2072 616e 6765 2863 6f6c 7329 3a0d  in range(cols):.
-00003800: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003810: 2020 2020 2069 6620 6e6f 7420 6e70 2e69       if not np.i
-00003820: 7363 6c6f 7365 2861 7272 5b69 2c20 6a5d  sclose(arr[i, j]
-00003830: 2c20 6e6f 5f76 616c 2c20 7274 6f6c 3d30  , no_val, rtol=0
-00003840: 2e30 3031 293a 0d0a 2020 2020 2020 2020  .001):..        
-00003850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003860: 6d61 736b 6564 5f63 656c 6c73 2e61 7070  masked_cells.app
-00003870: 656e 6428 616c 6c5f 6365 6c6c 735b 6a5d  end(all_cells[j]
-00003880: 5b69 5d29 0d0a 0d0a 2020 2020 2020 2020  [i])....        
-00003890: 2020 2020 636f 6f72 6473 203d 206e 702e      coords = np.
-000038a0: 6172 7261 7928 6d61 736b 6564 5f63 656c  array(masked_cel
-000038b0: 6c73 290d 0a20 2020 2020 2020 2065 6c73  ls)..        els
-000038c0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-000038d0: 6365 6c6c 7320 3d20 5b5d 0d0a 2020 2020  cells = []..    
-000038e0: 2020 2020 2020 2020 2320 6765 7420 636f          # get co
-000038f0: 6f72 6469 6e61 7465 7320 6f66 2061 6c6c  ordinates of all
-00003900: 2063 656c 6c73 0d0a 2020 2020 2020 2020   cells..        
-00003910: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
-00003920: 6765 2872 6f77 7329 3a0d 0a20 2020 2020  ge(rows):..     
-00003930: 2020 2020 2020 2020 2020 2066 6f72 206a             for j
-00003940: 2069 6e20 7261 6e67 6528 636f 6c73 293a   in range(cols):
-00003950: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00003960: 2020 2020 2020 6365 6c6c 732e 6170 7065        cells.appe
-00003970: 6e64 2861 6c6c 5f63 656c 6c73 5b6a 5d5b  nd(all_cells[j][
-00003980: 695d 290d 0a0d 0a20 2020 2020 2020 2020  i])....         
-00003990: 2020 2063 6f6f 7264 7320 3d20 6e70 2e61     coords = np.a
-000039a0: 7272 6179 2863 656c 6c73 290d 0a20 2020  rray(cells)..   
-000039b0: 2020 2020 2020 2020 2023 2046 6978 4d45           # FixME
-000039c0: 3a20 7468 6520 6265 6c6f 7720 6c69 6e65  : the below line
-000039d0: 2067 6976 6573 2065 7272 6f72 0d0a 2020   gives error..  
-000039e0: 2020 2020 2020 2020 2020 2320 636f 6f72            # coor
-000039f0: 6473 203d 206e 702e 6172 7261 7928 616c  ds = np.array(al
-00003a00: 6c5f 6365 6c6c 7329 0d0a 2020 2020 2020  l_cells)..      
-00003a10: 2020 2020 2020 2320 7820 3d20 636f 6f72        # x = coor
-00003a20: 6473 5b3a 2c20 3a2c 2030 5d2e 666c 6174  ds[:, :, 0].flat
-00003a30: 7465 6e28 290d 0a20 2020 2020 2020 2020  ten()..         
-00003a40: 2020 2023 2079 203d 2063 6f6f 7264 735b     # y = coords[
-00003a50: 3a2c 203a 2c20 315d 2e66 6c61 7474 656e  :, :, 1].flatten
-00003a60: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
-00003a70: 2320 636f 6f72 6473 203d 206e 702e 6172  # coords = np.ar
-00003a80: 7261 7928 5b78 2c20 795d 2923 2e74 7261  ray([x, y])#.tra
-00003a90: 6e73 706f 7365 2829 0d0a 0d0a 2020 2020  nspose()....    
-00003aa0: 2020 2020 7265 7475 726e 2063 6f6f 7264      return coord
-00003ab0: 730d 0a0d 0a20 2020 2040 7374 6174 6963  s....    @static
-00003ac0: 6d65 7468 6f64 0d0a 2020 2020 6465 6620  method..    def 
-00003ad0: 6765 7443 656c 6c50 6f6c 7967 6f6e 7328  getCellPolygons(
-00003ae0: 7372 633a 2044 6174 6173 6574 2c20 6d61  src: Dataset, ma
-00003af0: 736b 3d46 616c 7365 2920 2d3e 2047 656f  sk=False) -> Geo
-00003b00: 4461 7461 4672 616d 653a 0d0a 2020 2020  DataFrame:..    
-00003b10: 2020 2020 2222 2247 6574 2061 2070 6f6c      """Get a pol
-00003b20: 7967 6f6e 2073 6861 7065 6c79 2067 656f  ygon shapely geo
-00003b30: 6d65 7472 7920 666f 7220 7468 6520 7261  metry for the ra
-00003b40: 7374 6572 2063 656c 6c73 2e0d 0a0d 0a20  ster cells..... 
-00003b50: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-00003b60: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-00003b70: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2073  -----..        s
-00003b80: 7263 3a20 5b44 6174 6173 6574 5d0d 0a20  rc: [Dataset].. 
-00003b90: 2020 2020 2020 2020 2020 2052 6173 7465             Raste
-00003ba0: 7220 6461 7461 7365 740d 0a20 2020 2020  r dataset..     
-00003bb0: 2020 206d 6173 6b3a 205b 626f 6f6c 5d0d     mask: [bool].
-00003bc0: 0a20 2020 2020 2020 2020 2020 2054 7275  .            Tru
-00003bd0: 6520 746f 2067 6574 2074 6865 2070 6f6c  e to get the pol
-00003be0: 7967 6f6e 7320 6f66 2074 6865 2063 656c  ygons of the cel
-00003bf0: 6c73 2069 6e73 6964 6520 7468 6520 646f  ls inside the do
-00003c00: 6d61 696e 2e0d 0a0d 0a20 2020 2020 2020  main.....       
-00003c10: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
-00003c20: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
-00003c30: 2020 2047 656f 4461 7461 4672 616d 653a     GeoDataFrame:
-00003c40: 0d0a 2020 2020 2020 2020 2020 2020 7769  ..            wi
-00003c50: 7468 2074 776f 2063 6f6c 756d 6e73 2c20  th two columns, 
-00003c60: 6765 6f6d 6574 7279 2c20 616e 6420 6964  geometry, and id
-00003c70: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-00003c80: 2020 2020 2020 2063 6f6f 7264 7320 3d20         coords = 
-00003c90: 5261 7374 6572 2e67 6574 4365 6c6c 436f  Raster.getCellCo
-00003ca0: 6f72 6473 2873 7263 2c20 6c6f 6361 7469  ords(src, locati
-00003cb0: 6f6e 3d22 636f 726e 6572 222c 206d 6173  on="corner", mas
-00003cc0: 6b3d 6d61 736b 290d 0a20 2020 2020 2020  k=mask)..       
-00003cd0: 2063 656c 6c5f 7369 7a65 203d 2073 7263   cell_size = src
-00003ce0: 2e47 6574 4765 6f54 7261 6e73 666f 726d  .GetGeoTransform
-00003cf0: 2829 5b31 5d0d 0a20 2020 2020 2020 2065  ()[1]..        e
-00003d00: 7073 6720 3d20 5261 7374 6572 2e67 6574  psg = Raster.get
-00003d10: 4550 5347 2873 7263 290d 0a20 2020 2020  EPSG(src)..     
-00003d20: 2020 2078 203d 206e 702e 7a65 726f 7328     x = np.zeros(
-00003d30: 2863 6f6f 7264 732e 7368 6170 655b 305d  (coords.shape[0]
-00003d40: 2c20 3429 290d 0a20 2020 2020 2020 2079  , 4))..        y
-00003d50: 203d 206e 702e 7a65 726f 7328 2863 6f6f   = np.zeros((coo
-00003d60: 7264 732e 7368 6170 655b 305d 2c20 3429  rds.shape[0], 4)
-00003d70: 290d 0a20 2020 2020 2020 2023 2066 696c  )..        # fil
-00003d80: 6c20 7468 6520 746f 7020 6c65 6674 2063  l the top left c
-00003d90: 6f72 6e65 7220 706f 696e 740d 0a20 2020  orner point..   
-00003da0: 2020 2020 2078 5b3a 2c20 305d 203d 2063       x[:, 0] = c
-00003db0: 6f6f 7264 735b 3a2c 2030 5d0d 0a20 2020  oords[:, 0]..   
-00003dc0: 2020 2020 2079 5b3a 2c20 305d 203d 2063       y[:, 0] = c
-00003dd0: 6f6f 7264 735b 3a2c 2031 5d0d 0a20 2020  oords[:, 1]..   
-00003de0: 2020 2020 2023 2066 696c 6c20 7468 6520       # fill the 
-00003df0: 746f 7020 7269 6768 740d 0a20 2020 2020  top right..     
-00003e00: 2020 2078 5b3a 2c20 315d 203d 2078 5b3a     x[:, 1] = x[:
-00003e10: 2c20 305d 202b 2063 656c 6c5f 7369 7a65  , 0] + cell_size
-00003e20: 0d0a 2020 2020 2020 2020 795b 3a2c 2031  ..        y[:, 1
-00003e30: 5d20 3d20 795b 3a2c 2030 5d0d 0a20 2020  ] = y[:, 0]..   
-00003e40: 2020 2020 2023 2066 696c 6c20 7468 6520       # fill the 
-00003e50: 626f 7474 6f6d 2072 6967 6874 0d0a 2020  bottom right..  
-00003e60: 2020 2020 2020 785b 3a2c 2032 5d20 3d20        x[:, 2] = 
-00003e70: 785b 3a2c 2030 5d20 2b20 6365 6c6c 5f73  x[:, 0] + cell_s
-00003e80: 697a 650d 0a20 2020 2020 2020 2079 5b3a  ize..        y[:
-00003e90: 2c20 325d 203d 2079 5b3a 2c20 305d 202d  , 2] = y[:, 0] -
-00003ea0: 2063 656c 6c5f 7369 7a65 0d0a 0d0a 2020   cell_size....  
-00003eb0: 2020 2020 2020 2320 6669 6c6c 2074 6865        # fill the
-00003ec0: 2062 6f74 746f 6d20 6c65 6674 0d0a 2020   bottom left..  
-00003ed0: 2020 2020 2020 785b 3a2c 2033 5d20 3d20        x[:, 3] = 
-00003ee0: 785b 3a2c 2030 5d0d 0a20 2020 2020 2020  x[:, 0]..       
-00003ef0: 2079 5b3a 2c20 335d 203d 2079 5b3a 2c20   y[:, 3] = y[:, 
-00003f00: 305d 202d 2063 656c 6c5f 7369 7a65 0d0a  0] - cell_size..
-00003f10: 0d0a 2020 2020 2020 2020 636f 6f72 6473  ..        coords
-00003f20: 5f74 7570 6c65 7320 3d20 5b6c 6973 7428  _tuples = [list(
-00003f30: 7a69 7028 785b 3a2c 2069 5d2c 2079 5b3a  zip(x[:, i], y[:
-00003f40: 2c20 695d 2929 2066 6f72 2069 2069 6e20  , i])) for i in 
-00003f50: 7261 6e67 6528 3429 5d0d 0a20 2020 2020  range(4)]..     
-00003f60: 2020 2070 6f6c 7973 5f63 6f6f 7264 7320     polys_coords 
-00003f70: 3d20 5b0d 0a20 2020 2020 2020 2020 2020  = [..           
-00003f80: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
-00003f90: 2020 2020 636f 6f72 6473 5f74 7570 6c65      coords_tuple
-00003fa0: 735b 305d 5b69 5d2c 0d0a 2020 2020 2020  s[0][i],..      
-00003fb0: 2020 2020 2020 2020 2020 636f 6f72 6473            coords
-00003fc0: 5f74 7570 6c65 735b 315d 5b69 5d2c 0d0a  _tuples[1][i],..
-00003fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003fe0: 636f 6f72 6473 5f74 7570 6c65 735b 325d  coords_tuples[2]
-00003ff0: 5b69 5d2c 0d0a 2020 2020 2020 2020 2020  [i],..          
-00004000: 2020 2020 2020 636f 6f72 6473 5f74 7570        coords_tup
-00004010: 6c65 735b 335d 5b69 5d2c 0d0a 2020 2020  les[3][i],..    
-00004020: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
-00004030: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-00004040: 7261 6e67 6528 6c65 6e28 7829 290d 0a20  range(len(x)).. 
-00004050: 2020 2020 2020 205d 0d0a 2020 2020 2020         ]..      
-00004060: 2020 706f 6c79 676f 6e73 203d 206c 6973    polygons = lis
-00004070: 7428 6d61 7028 5665 6374 6f72 2e63 7265  t(map(Vector.cre
-00004080: 6174 6550 6f6c 7967 6f6e 2c20 706f 6c79  atePolygon, poly
-00004090: 735f 636f 6f72 6473 2929 0d0a 2020 2020  s_coords))..    
-000040a0: 2020 2020 6764 6620 3d20 6770 642e 4765      gdf = gpd.Ge
-000040b0: 6f44 6174 6146 7261 6d65 2867 656f 6d65  oDataFrame(geome
-000040c0: 7472 793d 706f 6c79 676f 6e73 290d 0a20  try=polygons).. 
-000040d0: 2020 2020 2020 2067 6466 2e73 6574 5f63         gdf.set_c
-000040e0: 7273 2865 7073 673d 6570 7367 2c20 696e  rs(epsg=epsg, in
-000040f0: 706c 6163 653d 5472 7565 290d 0a20 2020  place=True)..   
-00004100: 2020 2020 2067 6466 5b22 6964 225d 203d       gdf["id"] =
-00004110: 2067 6466 2e69 6e64 6578 0d0a 2020 2020   gdf.index..    
-00004120: 2020 2020 7265 7475 726e 2067 6466 0d0a      return gdf..
-00004130: 0d0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
-00004140: 686f 640d 0a20 2020 2064 6566 2067 6574  hod..    def get
-00004150: 4365 6c6c 506f 696e 7473 280d 0a20 2020  CellPoints(..   
-00004160: 2020 2020 2073 7263 3a20 4461 7461 7365       src: Datase
-00004170: 742c 206c 6f63 6174 696f 6e3a 2073 7472  t, location: str
-00004180: 203d 2022 6365 6e74 6572 222c 206d 6173   = "center", mas
-00004190: 6b3d 4661 6c73 650d 0a20 2020 2029 202d  k=False..    ) -
-000041a0: 3e20 4765 6f44 6174 6146 7261 6d65 3a0d  > GeoDataFrame:.
-000041b0: 0a20 2020 2020 2020 2022 2222 4765 7420  .        """Get 
-000041c0: 6120 706f 696e 7420 7368 6170 656c 7920  a point shapely 
-000041d0: 6765 6f6d 6574 7279 2066 6f72 2074 6865  geometry for the
-000041e0: 2072 6173 7465 7220 6365 6c6c 7320 6365   raster cells ce
-000041f0: 6e74 6572 2070 6f69 6e74 2e0d 0a0d 0a20  nter point..... 
-00004200: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-00004210: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-00004220: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2073  -----..        s
-00004230: 7263 3a20 5b44 6174 6173 6574 5d0d 0a20  rc: [Dataset].. 
-00004240: 2020 2020 2020 2020 2020 2052 6173 7465             Raste
-00004250: 7220 6461 7461 7365 740d 0a20 2020 2020  r dataset..     
-00004260: 2020 206c 6f63 6174 696f 6e3a 205b 7374     location: [st
-00004270: 725d 0d0a 2020 2020 2020 2020 2020 2020  r]..            
-00004280: 6c6f 6361 7469 6f6e 206f 6620 7468 6520  location of the 
-00004290: 706f 696e 742c 205b 2263 6f72 6e65 7222  point, ["corner"
-000042a0: 2c20 2263 656e 7465 7222 5d2e 2044 6566  , "center"]. Def
-000042b0: 6175 6c74 2069 7320 2263 656e 7465 7222  ault is "center"
-000042c0: 2e0d 0a20 2020 2020 2020 206d 6173 6b3a  ...        mask:
-000042d0: 205b 626f 6f6c 5d0d 0a20 2020 2020 2020   [bool]..       
-000042e0: 2020 2020 2054 7275 6520 746f 2067 6574       True to get
-000042f0: 2074 6865 2070 6f6c 7967 6f6e 7320 6f66   the polygons of
-00004300: 2074 6865 2063 656c 6c73 2069 6e73 6964   the cells insid
-00004310: 6520 7468 6520 646f 6d61 696e 2e0d 0a0d  e the domain....
-00004320: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00004330: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00004340: 2d0d 0a20 2020 2020 2020 2047 656f 4461  -..        GeoDa
-00004350: 7461 4672 616d 653a 0d0a 2020 2020 2020  taFrame:..      
-00004360: 2020 2020 2020 7769 7468 2074 776f 2063        with two c
-00004370: 6f6c 756d 6e73 2c20 6765 6f6d 6574 7279  olumns, geometry
-00004380: 2c20 616e 6420 6964 0d0a 2020 2020 2020  , and id..      
-00004390: 2020 2222 220d 0a20 2020 2020 2020 2063    """..        c
-000043a0: 6f6f 7264 7320 3d20 5261 7374 6572 2e67  oords = Raster.g
-000043b0: 6574 4365 6c6c 436f 6f72 6473 2873 7263  etCellCoords(src
-000043c0: 2c20 6c6f 6361 7469 6f6e 3d6c 6f63 6174  , location=locat
-000043d0: 696f 6e2c 206d 6173 6b3d 6d61 736b 290d  ion, mask=mask).
-000043e0: 0a20 2020 2020 2020 2065 7073 6720 3d20  .        epsg = 
-000043f0: 5261 7374 6572 2e67 6574 4550 5347 2873  Raster.getEPSG(s
-00004400: 7263 290d 0a0d 0a20 2020 2020 2020 2063  rc)....        c
-00004410: 6f6f 7264 735f 7475 706c 6573 203d 206c  oords_tuples = l
-00004420: 6973 7428 7a69 7028 636f 6f72 6473 5b3a  ist(zip(coords[:
-00004430: 2c20 305d 2c20 636f 6f72 6473 5b3a 2c20  , 0], coords[:, 
-00004440: 315d 2929 0d0a 2020 2020 2020 2020 706f  1]))..        po
-00004450: 696e 7473 203d 2056 6563 746f 722e 6372  ints = Vector.cr
-00004460: 6561 7465 506f 696e 7428 636f 6f72 6473  eatePoint(coords
-00004470: 5f74 7570 6c65 7329 0d0a 2020 2020 2020  _tuples)..      
-00004480: 2020 6764 6620 3d20 6770 642e 4765 6f44    gdf = gpd.GeoD
-00004490: 6174 6146 7261 6d65 2867 656f 6d65 7472  ataFrame(geometr
-000044a0: 793d 706f 696e 7473 290d 0a20 2020 2020  y=points)..     
-000044b0: 2020 2067 6466 2e73 6574 5f63 7273 2865     gdf.set_crs(e
-000044c0: 7073 673d 6570 7367 2c20 696e 706c 6163  psg=epsg, inplac
-000044d0: 653d 5472 7565 290d 0a20 2020 2020 2020  e=True)..       
-000044e0: 2067 6466 5b22 6964 225d 203d 2067 6466   gdf["id"] = gdf
-000044f0: 2e69 6e64 6578 0d0a 2020 2020 2020 2020  .index..        
-00004500: 7265 7475 726e 2067 6466 0d0a 0d0a 2020  return gdf....  
-00004510: 2020 4073 7461 7469 636d 6574 686f 640d    @staticmethod.
-00004520: 0a20 2020 2064 6566 2073 6176 6552 6173  .    def saveRas
-00004530: 7465 7228 7372 633a 2044 6174 6173 6574  ter(src: Dataset
-00004540: 2c20 7061 7468 3a20 7374 7229 202d 3e20  , path: str) -> 
-00004550: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2022  None:..        "
-00004560: 2222 7361 7665 5261 7374 6572 2e0d 0a0d  ""saveRaster....
-00004570: 0a20 2020 2020 2020 2020 2020 2073 6176  .            sav
-00004580: 6552 6173 7465 7220 7361 7665 7320 6120  eRaster saves a 
-00004590: 7261 7374 6572 2074 6f20 6120 7061 7468  raster to a path
-000045a0: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
-000045b0: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
-000045c0: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
-000045d0: 2020 2020 7372 633a 205b 6764 616c 206f      src: [gdal o
-000045e0: 626a 6563 745d 0d0a 2020 2020 2020 2020  bject]..        
-000045f0: 2020 2020 6764 616c 2064 6174 6173 6574      gdal dataset
-00004600: 206f 7062 6a65 6374 0d0a 2020 2020 2020   opbject..      
-00004610: 2020 7061 7468 3a20 5b73 7472 696e 675d    path: [string]
-00004620: 0d0a 2020 2020 2020 2020 2020 2020 6120  ..            a 
-00004630: 7061 7468 2069 6e63 6c75 646e 6720 7468  path includng th
-00004640: 6520 6e61 6d65 206f 6620 7468 6520 7261  e name of the ra
-00004650: 7374 6572 2061 6e64 2065 7874 656e 7469  ster and extenti
-00004660: 6f6e 206c 696b 650d 0a20 2020 2020 2020  on like..       
-00004670: 2020 2020 2070 6174 683d 2264 6174 612f       path="data/
-00004680: 6372 6f70 7065 642e 7469 6622 0d0a 0d0a  cropped.tif"....
-00004690: 2020 2020 2020 2020 5265 7475 726e 730d          Returns.
-000046a0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-000046b0: 0d0a 2020 2020 2020 2020 7468 6520 6675  ..        the fu
-000046c0: 6e63 7469 6f6e 2064 6f65 7320 6e6f 7420  nction does not 
-000046d0: 7265 7475 726e 2061 6e64 2064 6174 6120  return and data 
-000046e0: 6275 7420 6f6e 6c79 2073 6176 6520 7468  but only save th
-000046f0: 6520 7261 7374 6572 2074 6f20 7468 6520  e raster to the 
-00004700: 6861 7264 2064 7269 7665 0d0a 0d0a 2020  hard drive....  
-00004710: 2020 2020 2020 4578 616d 706c 6573 0d0a        Examples..
-00004720: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00004730: 0d0a 2020 2020 2020 2020 3e3e 3e20 6764  ..        >>> gd
-00004740: 616c 5f72 6173 7465 725f 6f62 6a20 3d20  al_raster_obj = 
-00004750: 6764 616c 2e4f 7065 6e28 2270 6174 682f  gdal.Open("path/
-00004760: 746f 2f66 696c 652f 2a2a 2a2e 7469 6622  to/file/***.tif"
-00004770: 290d 0a20 2020 2020 2020 203e 3e3e 206f  )..        >>> o
-00004780: 7574 7075 745f 7061 7468 203d 2022 6578  utput_path = "ex
-00004790: 616d 706c 6573 2f47 4953 2f64 6174 612f  amples/GIS/data/
-000047a0: 7361 7665 5f72 6173 7465 725f 7465 7374  save_raster_test
-000047b0: 2e74 6966 220d 0a20 2020 2020 2020 203e  .tif"..        >
-000047c0: 3e3e 2052 6173 7465 722e 7361 7665 5261  >> Raster.saveRa
-000047d0: 7374 6572 2867 6461 6c5f 7261 7374 6572  ster(gdal_raster
-000047e0: 5f6f 626a 2c20 6f75 7470 7574 5f70 6174  _obj, output_pat
-000047f0: 6829 0d0a 2020 2020 2020 2020 2222 220d  h)..        """.
-00004800: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-00004810: 6973 696e 7374 616e 6365 2873 7263 2c20  isinstance(src, 
-00004820: 6764 616c 2e44 6174 6173 6574 293a 0d0a  gdal.Dataset):..
-00004830: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00004840: 6520 5479 7065 4572 726f 7228 0d0a 2020  e TypeError(..  
-00004850: 2020 2020 2020 2020 2020 2020 2020 2272                "r
-00004860: 6173 7465 7220 7061 7261 6d65 7465 7220  aster parameter 
-00004870: 7368 6f75 6c64 2062 6520 7265 6164 2075  should be read u
-00004880: 7369 6e67 2067 6461 6c20 6461 7461 7365  sing gdal datase
-00004890: 7420 706c 6561 7365 2072 6561 6420 6974  t please read it
-000048a0: 2075 7369 6e67 2067 6461 6c22 0d0a 2020   using gdal"..  
-000048b0: 2020 2020 2020 2020 2020 290d 0a0d 0a20            ).... 
-000048c0: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
-000048d0: 696e 7374 616e 6365 2870 6174 682c 2073  instance(path, s
-000048e0: 7472 293a 0d0a 2020 2020 2020 2020 2020  tr):..          
-000048f0: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
-00004900: 7228 2252 6173 7465 725f 7061 7468 2069  r("Raster_path i
-00004910: 6e70 7574 2073 686f 756c 6420 6265 2073  nput should be s
-00004920: 7472 696e 6720 7479 7065 2229 0d0a 2020  tring type")..  
-00004930: 2020 2020 2020 2320 696e 7075 7420 7661        # input va
-00004940: 6c75 6573 0d0a 2020 2020 2020 2020 6578  lues..        ex
-00004950: 7420 3d20 7061 7468 5b2d 343a 5d0d 0a20  t = path[-4:].. 
-00004960: 2020 2020 2020 2069 6620 6e6f 7420 6578         if not ex
-00004970: 7420 3d3d 2022 2e74 6966 223a 0d0a 2020  t == ".tif":..  
-00004980: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00004990: 5661 6c75 6545 7272 6f72 2822 706c 6561  ValueError("plea
-000049a0: 7365 2061 6464 2074 6865 2065 7874 656e  se add the exten
-000049b0: 7369 6f6e 2061 7420 7468 6520 656e 6420  sion at the end 
-000049c0: 6f66 2074 6865 2070 6174 6820 696e 7075  of the path inpu
-000049d0: 7422 290d 0a0d 0a20 2020 2020 2020 2064  t")....        d
-000049e0: 7269 7665 7220 3d20 6764 616c 2e47 6574  river = gdal.Get
-000049f0: 4472 6976 6572 4279 4e61 6d65 2822 4754  DriverByName("GT
-00004a00: 6966 6622 290d 0a20 2020 2020 2020 2064  iff")..        d
-00004a10: 7374 5f64 7320 3d20 6472 6976 6572 2e43  st_ds = driver.C
-00004a20: 7265 6174 6543 6f70 7928 7061 7468 2c20  reateCopy(path, 
-00004a30: 7372 632c 2030 290d 0a20 2020 2020 2020  src, 0)..       
-00004a40: 2064 7374 5f64 7320 3d20 4e6f 6e65 2020   dst_ds = None  
-00004a50: 2320 466c 7573 6820 7468 6520 6461 7461  # Flush the data
-00004a60: 7365 7420 746f 2064 6973 6b0d 0a20 2020  set to disk..   
-00004a70: 2020 2020 2023 2070 7269 6e74 2074 6f20       # print to 
-00004a80: 676f 2061 726f 756e 6420 7468 6520 6173  go around the as
-00004a90: 7369 676e 6564 2062 7574 206e 6576 6572  signed but never
-00004aa0: 2075 7365 6420 7072 652d 636f 6d6d 6974   used pre-commit
-00004ab0: 2069 7373 7565 0d0a 2020 2020 2020 2020   issue..        
-00004ac0: 7072 696e 7428 6473 745f 6473 290d 0a0d  print(dst_ds)...
-00004ad0: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
-00004ae0: 6f64 0d0a 2020 2020 6465 6620 6372 6561  od..    def crea
-00004af0: 7465 5261 7374 6572 280d 0a20 2020 2020  teRaster(..     
-00004b00: 2020 2070 6174 683a 2073 7472 203d 204e     path: str = N
-00004b10: 6f6e 652c 0d0a 2020 2020 2020 2020 6172  one,..        ar
-00004b20: 723a 2055 6e69 6f6e 5b73 7472 2c20 4461  r: Union[str, Da
-00004b30: 7461 7365 742c 206e 702e 6e64 6172 7261  taset, np.ndarra
-00004b40: 795d 203d 2022 222c 0d0a 2020 2020 2020  y] = "",..      
-00004b50: 2020 6765 6f3a 2055 6e69 6f6e 5b73 7472    geo: Union[str
-00004b60: 2c20 7475 706c 655d 203d 2022 222c 0d0a  , tuple] = "",..
-00004b70: 2020 2020 2020 2020 6570 7367 3a20 556e          epsg: Un
-00004b80: 696f 6e5b 7374 722c 2069 6e74 5d20 3d20  ion[str, int] = 
-00004b90: 2222 2c0d 0a20 2020 2020 2020 206e 6f64  "",..        nod
-00004ba0: 6174 6176 616c 7565 3a20 416e 7920 3d20  atavalue: Any = 
-00004bb0: 4445 4641 554c 545f 4e4f 5f44 4154 415f  DEFAULT_NO_DATA_
-00004bc0: 5641 4c55 452c 0d0a 2020 2020 2020 2020  VALUE,..        
-00004bd0: 6261 6e64 3a20 696e 7420 3d20 312c 0d0a  band: int = 1,..
-00004be0: 2020 2020 2920 2d3e 2055 6e69 6f6e 5b44      ) -> Union[D
-00004bf0: 6174 6173 6574 2c20 4e6f 6e65 5d3a 0d0a  ataset, None]:..
-00004c00: 2020 2020 2020 2020 2222 2263 7265 6174          """creat
-00004c10: 6552 6173 7465 722e 0d0a 0d0a 2020 2020  eRaster.....    
-00004c20: 2020 2020 6372 6561 7465 5261 7374 6572      createRaster
-00004c30: 206d 6574 686f 6420 6372 6561 7465 7320   method creates 
-00004c40: 6120 7261 7374 6572 2066 726f 6d20 6120  a raster from a 
-00004c50: 6769 7665 6e20 6172 7261 7920 616e 6420  given array and 
-00004c60: 6765 6f74 7261 6e73 666f 726d 2064 6174  geotransform dat
-00004c70: 610d 0a20 2020 2020 2020 2061 6e64 2073  a..        and s
-00004c80: 6176 6520 7468 6520 7469 6620 6669 6c65  ave the tif file
-00004c90: 2069 6620 6120 5061 7468 2069 7320 6769   if a Path is gi
-00004ca0: 7665 6e20 6f72 2069 7420 7769 6c6c 2072  ven or it will r
-00004cb0: 6574 7572 6e20 7468 6520 6764 616c 2e44  eturn the gdal.D
-00004cc0: 6174 6173 6574 0d0a 0d0a 2020 2020 2020  ataset....      
-00004cd0: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
-00004ce0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00004cf0: 0d0a 2020 2020 2020 2020 7061 7468 203a  ..        path :
-00004d00: 205b 7374 725d 2c20 6f70 7469 6f6e 616c   [str], optional
-00004d10: 0d0a 2020 2020 2020 2020 2020 2020 5061  ..            Pa
-00004d20: 7468 2074 6f20 7361 7665 2074 6865 2052  th to save the R
-00004d30: 6173 7465 722c 2069 6620 2727 2069 7320  aster, if '' is 
-00004d40: 6769 7665 6e20 6120 6d65 6d6f 7279 2072  given a memory r
-00004d50: 6173 7465 7220 7769 6c6c 2062 6520 7265  aster will be re
-00004d60: 7475 726e 6564 2e20 5468 6520 6465 6661  turned. The defa
-00004d70: 756c 7420 6973 2027 272e 0d0a 2020 2020  ult is ''...    
-00004d80: 2020 2020 6172 7220 3a20 5b61 7272 6179      arr : [array
-00004d90: 5d2c 206f 7074 696f 6e61 6c0d 0a20 2020  ], optional..   
-00004da0: 2020 2020 2020 2020 206e 756d 7079 2061           numpy a
-00004db0: 7272 6179 2e20 5468 6520 6465 6661 756c  rray. The defaul
-00004dc0: 7420 6973 2027 272e 0d0a 2020 2020 2020  t is ''...      
-00004dd0: 2020 6765 6f20 3a20 5b6c 6973 745d 2c20    geo : [list], 
-00004de0: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
-00004df0: 2020 2020 2020 6765 6f74 7261 6e73 666f        geotransfo
-00004e00: 726d 206c 6973 7420 5b6d 696e 696d 756d  rm list [minimum
-00004e10: 206c 6f6e 2c20 7069 7865 6c73 697a 652c   lon, pixelsize,
-00004e20: 2072 6f74 6174 696f 6e2c 206d 6178 696d   rotation, maxim
-00004e30: 756d 206c 6174 2c20 726f 7461 7469 6f6e  um lat, rotation
-00004e40: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00004e50: 2020 2070 6978 656c 7369 7a65 5d2e 2054     pixelsize]. T
-00004e60: 6865 2064 6566 6175 6c74 2069 7320 2727  he default is ''
-00004e70: 2e0d 0a20 2020 2020 2020 206e 6f64 6174  ...        nodat
-00004e80: 6176 616c 7565 203a 2054 5950 452c 206f  avalue : TYPE, o
-00004e90: 7074 696f 6e61 6c0d 0a20 2020 2020 2020  ptional..       
-00004ea0: 2020 2020 2044 4553 4352 4950 5449 4f4e       DESCRIPTION
-00004eb0: 2e20 5468 6520 6465 6661 756c 7420 6973  . The default is
-00004ec0: 202d 3939 3939 2e0d 0a20 2020 2020 2020   -9999...       
-00004ed0: 2065 7073 673a 205b 696e 7465 6765 725d   epsg: [integer]
-00004ee0: 0d0a 2020 2020 2020 2020 2020 2020 696e  ..            in
-00004ef0: 7465 6765 7220 7265 6665 7265 6e63 6520  teger reference 
-00004f00: 6e75 6d62 6572 2074 6f20 7468 6520 6e65  number to the ne
-00004f10: 7720 7072 6f6a 6563 7469 6f6e 2028 6874  w projection (ht
-00004f20: 7470 733a 2f2f 6570 7367 2e69 6f2f 290d  tps://epsg.io/).
-00004f30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004f40: 2028 6465 6661 756c 7420 3338 3537 2074   (default 3857 t
-00004f50: 6865 2072 6566 6572 656e 6365 206e 6f20  he reference no 
-00004f60: 6f66 2057 4753 3834 2077 6562 206d 6572  of WGS84 web mer
-00004f70: 6361 746f 7220 290d 0a20 2020 2020 2020  cator )..       
-00004f80: 2062 616e 643a 205b 696e 745d 0d0a 2020   band: [int]..  
-00004f90: 2020 2020 2020 2020 2020 6261 6e64 206e            band n
-00004fa0: 756d 6265 722e 0d0a 0d0a 2020 2020 2020  umber.....      
-00004fb0: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
-00004fc0: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
-00004fd0: 2020 2020 6473 7420 3a20 5b67 6461 6c2e      dst : [gdal.
-00004fe0: 4461 7461 7365 742f 7361 7665 2072 6173  Dataset/save ras
-00004ff0: 7465 7220 746f 2064 7269 7665 5d2e 0d0a  ter to drive]...
-00005000: 2020 2020 2020 2020 2020 2020 6966 2061              if a
-00005010: 2070 6174 6820 6973 2067 6976 656e 2074   path is given t
-00005020: 6865 2063 7265 6174 6564 2072 6173 7465  he created raste
-00005030: 7220 7769 6c6c 2062 6520 7361 7665 6420  r will be saved 
-00005040: 746f 2064 7269 7665 2c20 6966 206e 6f74  to drive, if not
-00005050: 0d0a 2020 2020 2020 2020 2020 2020 6120  ..            a 
-00005060: 6764 616c 2e44 6174 6173 6574 2077 696c  gdal.Dataset wil
-00005070: 6c20 6265 2072 6574 7572 6e65 642e 0d0a  l be returned...
-00005080: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-00005090: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
-000050a0: 2020 2020 2020 2069 6620 6e70 2e69 736e         if np.isn
-000050b0: 616e 286e 6f64 6174 6176 616c 7565 293a  an(nodatavalue):
-000050c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000050d0: 2020 6e6f 6461 7461 7661 6c75 6520 3d20    nodatavalue = 
-000050e0: 4445 4641 554c 545f 4e4f 5f44 4154 415f  DEFAULT_NO_DATA_
-000050f0: 5641 4c55 450d 0a20 2020 2020 2020 2065  VALUE..        e
-00005100: 7863 6570 7420 5479 7065 4572 726f 723a  xcept TypeError:
-00005110: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-00005120: 6e70 2e69 736e 616e 2066 6169 6c73 2073  np.isnan fails s
-00005130: 6f6d 6574 696d 6573 2077 6974 6820 7468  ometimes with th
-00005140: 6520 666f 6c6c 6f77 696e 6720 6572 726f  e following erro
-00005150: 720d 0a20 2020 2020 2020 2020 2020 2023  r..            #
-00005160: 2054 7970 6545 7272 6f72 3a20 7566 756e   TypeError: ufun
-00005170: 6320 2769 736e 616e 2720 6e6f 7420 7375  c 'isnan' not su
-00005180: 7070 6f72 7465 6420 666f 7220 7468 6520  pported for the 
-00005190: 696e 7075 7420 7479 7065 732c 2061 6e64  input types, and
-000051a0: 2074 6865 2069 6e70 7574 7320 636f 756c   the inputs coul
-000051b0: 6420 6e6f 7420 6265 2073 6166 656c 7920  d not be safely 
-000051c0: 636f 6572 6365 6420 746f 2061 6e79 2073  coerced to any s
-000051d0: 7570 706f 7274 6564 2074 7970 6573 2061  upported types a
-000051e0: 6363 6f72 6469 6e67 2074 6f20 7468 6520  ccording to the 
-000051f0: 6361 7374 696e 6720 7275 6c65 2027 2773  casting rule ''s
-00005200: 6166 6527 270d 0a20 2020 2020 2020 2020  afe''..         
-00005210: 2020 2069 6620 7064 2e69 736e 756c 6c28     if pd.isnull(
-00005220: 6e6f 6461 7461 7661 6c75 6529 3a0d 0a20  nodatavalue):.. 
-00005230: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00005240: 6f64 6174 6176 616c 7565 203d 2044 4546  odatavalue = DEF
-00005250: 4155 4c54 5f4e 4f5f 4441 5441 5f56 414c  AULT_NO_DATA_VAL
-00005260: 5545 0d0a 0d0a 2020 2020 2020 2020 6966  UE....        if
-00005270: 2070 6174 6820 6973 204e 6f6e 653a 0d0a   path is None:..
-00005280: 2020 2020 2020 2020 2020 2020 6472 6976              driv
-00005290: 6572 5f74 7970 6520 3d20 224d 454d 220d  er_type = "MEM".
-000052a0: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-000052b0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-000052c0: 6f74 2069 7369 6e73 7461 6e63 6528 7061  ot isinstance(pa
-000052d0: 7468 2c20 7374 7229 3a0d 0a20 2020 2020  th, str):..     
-000052e0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-000052f0: 2054 7970 6545 7272 6f72 2822 6669 7273   TypeError("firs
-00005300: 7420 7061 7261 6d65 7465 7220 5061 7468  t parameter Path
-00005310: 2073 686f 756c 6420 6265 2073 7472 696e   should be strin
-00005320: 6722 290d 0a0d 0a20 2020 2020 2020 2020  g")....         
-00005330: 2020 2064 7269 7665 725f 7479 7065 203d     driver_type =
-00005340: 2022 4754 6966 6622 0d0a 0d0a 2020 2020   "GTiff"....    
-00005350: 2020 2020 636f 6c73 203d 2069 6e74 2861      cols = int(a
-00005360: 7272 2e73 6861 7065 5b31 5d29 0d0a 2020  rr.shape[1])..  
-00005370: 2020 2020 2020 726f 7773 203d 2069 6e74        rows = int
-00005380: 2861 7272 2e73 6861 7065 5b30 5d29 0d0a  (arr.shape[0])..
-00005390: 2020 2020 2020 2020 6261 6e64 7320 3d20          bands = 
-000053a0: 310d 0a20 2020 2020 2020 2064 7479 7065  1..        dtype
-000053b0: 203d 206e 756d 7079 5f74 6f5f 6764 616c   = numpy_to_gdal
-000053c0: 5f64 7479 7065 2861 7272 290d 0a20 2020  _dtype(arr)..   
-000053d0: 2020 2020 2064 7374 5f64 7320 3d20 5261       dst_ds = Ra
-000053e0: 7374 6572 2e5f 6372 6561 7465 4461 7461  ster._createData
-000053f0: 7365 7428 0d0a 2020 2020 2020 2020 2020  set(..          
-00005400: 2020 636f 6c73 2c20 726f 7773 2c20 6261    cols, rows, ba
-00005410: 6e64 732c 2064 7479 7065 2c20 6472 6976  nds, dtype, driv
-00005420: 6572 3d64 7269 7665 725f 7479 7065 2c20  er=driver_type, 
-00005430: 7061 7468 3d70 6174 680d 0a20 2020 2020  path=path..     
-00005440: 2020 2029 0d0a 0d0a 2020 2020 2020 2020     )....        
-00005450: 7372 7365 203d 2052 6173 7465 722e 5f63  srse = Raster._c
-00005460: 7265 6174 6553 5266 726f 6d45 5053 4728  reateSRfromEPSG(
-00005470: 6570 7367 3d65 7073 6729 0d0a 2020 2020  epsg=epsg)..    
-00005480: 2020 2020 6473 745f 6473 2e53 6574 5072      dst_ds.SetPr
-00005490: 6f6a 6563 7469 6f6e 2873 7273 652e 4578  ojection(srse.Ex
-000054a0: 706f 7274 546f 576b 7428 2929 0d0a 2020  portToWkt())..  
-000054b0: 2020 2020 2020 6473 745f 6473 203d 2052        dst_ds = R
-000054c0: 6173 7465 722e 7365 744e 6f44 6174 6156  aster.setNoDataV
-000054d0: 616c 7565 2864 7374 5f64 732c 206e 6f5f  alue(dst_ds, no_
-000054e0: 6461 7461 5f76 616c 7565 3d6e 6f64 6174  data_value=nodat
-000054f0: 6176 616c 7565 290d 0a0d 0a20 2020 2020  avalue)....     
-00005500: 2020 2064 7374 5f64 732e 5365 7447 656f     dst_ds.SetGeo
-00005510: 5472 616e 7366 6f72 6d28 6765 6f29 0d0a  Transform(geo)..
-00005520: 2020 2020 2020 2020 6473 745f 6473 2e47          dst_ds.G
-00005530: 6574 5261 7374 6572 4261 6e64 2831 292e  etRasterBand(1).
-00005540: 5772 6974 6541 7272 6179 2861 7272 290d  WriteArray(arr).
-00005550: 0a0d 0a20 2020 2020 2020 2069 6620 7061  ...        if pa
-00005560: 7468 2069 7320 4e6f 6e65 3a0d 0a20 2020  th is None:..   
-00005570: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00005580: 6473 745f 6473 0d0a 2020 2020 2020 2020  dst_ds..        
-00005590: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-000055a0: 2020 2064 7374 5f64 7320 3d20 4e6f 6e65     dst_ds = None
-000055b0: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-000055c0: 7475 726e 0d0a 0d0a 2020 2020 4073 7461  turn....    @sta
-000055d0: 7469 636d 6574 686f 640d 0a20 2020 2064  ticmethod..    d
-000055e0: 6566 2072 6173 7465 724c 696b 6528 0d0a  ef rasterLike(..
-000055f0: 2020 2020 2020 2020 7372 633a 2044 6174          src: Dat
-00005600: 6173 6574 2c20 6172 7261 793a 206e 702e  aset, array: np.
-00005610: 6e64 6172 7261 792c 2064 7269 7665 723a  ndarray, driver:
-00005620: 2073 7472 203d 2022 4754 6966 6622 2c20   str = "GTiff", 
-00005630: 7061 7468 3a20 7374 7220 3d20 4e6f 6e65  path: str = None
-00005640: 0d0a 2020 2020 2920 2d3e 2055 6e69 6f6e  ..    ) -> Union
-00005650: 5b44 6174 6173 6574 2c20 4e6f 6e65 5d3a  [Dataset, None]:
-00005660: 0d0a 2020 2020 2020 2020 2222 2272 6173  ..        """ras
-00005670: 7465 724c 696b 652e 0d0a 0d0a 2020 2020  terLike.....    
-00005680: 2020 2020 7261 7374 6572 4c69 6b65 206d      rasterLike m
-00005690: 6574 686f 6420 6372 6561 7465 7320 6120  ethod creates a 
-000056a0: 4765 6f74 6966 6620 7261 7374 6572 206c  Geotiff raster l
-000056b0: 696b 6520 616e 6f74 6865 7220 696e 7075  ike another inpu
-000056c0: 7420 7261 7374 6572 2c20 6e65 7720 7261  t raster, new ra
-000056d0: 7374 6572 0d0a 2020 2020 2020 2020 7769  ster..        wi
-000056e0: 6c6c 2068 6176 6520 7468 6520 7361 6d65  ll have the same
-000056f0: 2070 726f 6a65 6374 696f 6e2c 2063 6f6f   projection, coo
-00005700: 7264 696e 6174 6573 206f 7220 7468 6520  rdinates or the 
-00005710: 746f 7020 6c65 6674 2063 6f72 6e65 7220  top left corner 
-00005720: 6f66 2074 6865 206f 7269 6769 6e61 6c0d  of the original.
-00005730: 0a20 2020 2020 2020 2072 6173 7465 722c  .        raster,
-00005740: 2063 656c 6c20 7369 7a65 2c20 6e6f 6461   cell size, noda
-00005750: 7461 2076 656c 7565 2c20 616e 6420 6e75  ta velue, and nu
-00005760: 6d62 6572 206f 6620 726f 7773 2061 6e64  mber of rows and
-00005770: 2063 6f6c 756d 6e73 0d0a 2020 2020 2020   columns..      
-00005780: 2020 7468 6520 7261 7374 6572 2061 6e64    the raster and
-00005790: 2074 6865 2064 656d 2073 686f 756c 6420   the dem should 
-000057a0: 6861 7665 2074 6865 2073 616d 6520 6e75  have the same nu
-000057b0: 6d62 6572 206f 6620 636f 6c75 6d6e 7320  mber of columns 
-000057c0: 616e 6420 726f 7773 0d0a 0d0a 2020 2020  and rows....    
-000057d0: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
-000057e0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-000057f0: 2d2d 0d0a 2020 2020 2020 2020 7372 6320  --..        src 
-00005800: 3a20 5b67 6461 6c2e 6461 7461 7365 745d  : [gdal.dataset]
-00005810: 0d0a 2020 2020 2020 2020 2020 2020 736f  ..            so
-00005820: 7572 6365 2072 6173 7465 7220 746f 2067  urce raster to g
-00005830: 6574 2074 6865 2073 7061 7469 616c 2069  et the spatial i
-00005840: 6e66 6f72 6d61 7469 6f6e 0d0a 2020 2020  nformation..    
-00005850: 2020 2020 6172 7261 7920 3a20 5b6e 756d      array : [num
-00005860: 7079 2061 7272 6179 5d0d 0a20 2020 2020  py array]..     
-00005870: 2020 2020 2020 2074 6f20 7374 6f72 6520         to store 
-00005880: 696e 2074 6865 206e 6577 2072 6173 7465  in the new raste
-00005890: 720d 0a20 2020 2020 2020 2064 7269 7665  r..        drive
-000058a0: 723a 5b73 7472 5d0d 0a20 2020 2020 2020  r:[str]..       
-000058b0: 2020 2020 2067 6461 6c20 6472 6976 6572       gdal driver
-000058c0: 2074 7970 652e 2044 6566 6175 6c74 2069   type. Default i
-000058d0: 7320 2247 5469 6666 220d 0a20 2020 2020  s "GTiff"..     
-000058e0: 2020 2070 6174 6820 3a20 5b53 7472 696e     path : [Strin
-000058f0: 675d 0d0a 2020 2020 2020 2020 2020 2020  g]..            
-00005900: 7061 7468 2074 6f20 7361 7665 2074 6865  path to save the
-00005910: 206e 6577 2072 6173 7465 7220 696e 636c   new raster incl
-00005920: 7564 696e 6720 6e65 7720 7261 7374 6572  uding new raster
-00005930: 206e 616d 6520 616e 6420 6578 7465 6e73   name and extens
-00005940: 696f 6e20 282e 7469 6629 0d0a 0d0a 2020  ion (.tif)....  
-00005950: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
-00005960: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
-00005970: 2020 2020 2020 2020 4e6f 6e65 3a0d 0a20          None:.. 
-00005980: 2020 2020 2020 2020 2020 2069 6620 7468             if th
-00005990: 6520 6472 6976 6572 2069 7320 2247 5469  e driver is "GTi
-000059a0: 6666 2220 7468 6520 6675 6e63 7469 6f6e  ff" the function
-000059b0: 2077 696c 6c20 7361 7665 2074 6865 206e   will save the n
-000059c0: 6577 2072 6173 7465 7220 746f 2074 6865  ew raster to the
-000059d0: 2067 6976 656e 2070 6174 682e 0d0a 2020   given path...  
-000059e0: 2020 2020 2020 4461 7461 7365 743a 0d0a        Dataset:..
-000059f0: 2020 2020 2020 2020 2020 2020 6966 2074              if t
-00005a00: 6865 2064 7269 7665 7220 6973 2022 4d45  he driver is "ME
-00005a10: 4d22 2074 6865 2066 756e 6374 696f 6e20  M" the function 
-00005a20: 7769 6c6c 2072 6574 7572 6e20 7468 6520  will return the 
-00005a30: 6372 6561 7465 6420 7261 7374 6572 2069  created raster i
-00005a40: 6e20 6d65 6d6f 7279 2e0d 0a0d 0a20 2020  n memory.....   
-00005a50: 2020 2020 2045 7861 6d70 6c65 0d0a 2020       Example..  
-00005a60: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
-00005a70: 2020 2020 2020 203e 3e3e 2061 7272 6179         >>> array
-00005a80: 203d 206e 702e 6c6f 6164 2822 5241 494e   = np.load("RAIN
-00005a90: 5f35 6b2e 6e70 7922 290d 0a20 2020 2020  _5k.npy")..     
-00005aa0: 2020 203e 3e3e 2073 7263 203d 2067 6461     >>> src = gda
-00005ab0: 6c2e 4f70 656e 2822 4445 4d2e 7469 6622  l.Open("DEM.tif"
-00005ac0: 290d 0a20 2020 2020 2020 203e 3e3e 206e  )..        >>> n
-00005ad0: 616d 6520 3d20 2272 6169 6e2e 7469 6622  ame = "rain.tif"
-00005ae0: 0d0a 2020 2020 2020 2020 3e3e 3e20 5261  ..        >>> Ra
-00005af0: 7374 6572 2e72 6173 7465 724c 696b 6528  ster.rasterLike(
-00005b00: 7372 632c 2061 7272 6179 2c20 6472 6976  src, array, driv
-00005b10: 6572 3d22 4754 6966 6622 2c20 7061 7468  er="GTiff", path
-00005b20: 3d6e 616d 6529 0d0a 2020 2020 2020 2020  =name)..        
-00005b30: 2d20 6f72 2063 7265 6174 6520 6120 7261  - or create a ra
-00005b40: 7374 6572 2069 6e20 6d65 6d6f 7279 0d0a  ster in memory..
-00005b50: 2020 2020 2020 2020 3e3e 3e20 6172 7261          >>> arra
-00005b60: 7920 3d20 6e70 2e6c 6f61 6428 2252 4149  y = np.load("RAI
-00005b70: 4e5f 356b 2e6e 7079 2229 0d0a 2020 2020  N_5k.npy")..    
-00005b80: 2020 2020 3e3e 3e20 7372 6320 3d20 6764      >>> src = gd
-00005b90: 616c 2e4f 7065 6e28 2244 454d 2e74 6966  al.Open("DEM.tif
-00005ba0: 2229 0d0a 2020 2020 2020 2020 3e3e 3e20  ")..        >>> 
-00005bb0: 6473 7420 3d20 5261 7374 6572 2e72 6173  dst = Raster.ras
-00005bc0: 7465 724c 696b 6528 7372 632c 2061 7272  terLike(src, arr
-00005bd0: 6179 2c20 6472 6976 6572 3d22 4d45 4d22  ay, driver="MEM"
-00005be0: 290d 0a20 2020 2020 2020 2022 2222 0d0a  )..        """..
-00005bf0: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
-00005c00: 7369 6e73 7461 6e63 6528 7372 632c 2067  sinstance(src, g
-00005c10: 6461 6c2e 4461 7461 7365 7429 3a0d 0a20  dal.Dataset):.. 
-00005c20: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00005c30: 2054 7970 6545 7272 6f72 280d 0a20 2020   TypeError(..   
-00005c40: 2020 2020 2020 2020 2020 2020 2022 7372               "sr
-00005c50: 6320 7368 6f75 6c64 2062 6520 7265 6164  c should be read
-00005c60: 2075 7369 6e67 2067 6461 6c20 2867 6461   using gdal (gda
-00005c70: 6c20 6461 7461 7365 7420 706c 6561 7365  l dataset please
-00005c80: 2072 6561 6420 6974 2075 7369 6e67 2067   read it using g
-00005c90: 6461 6c20 6c69 6272 6172 7929 2022 0d0a  dal library) "..
-00005ca0: 2020 2020 2020 2020 2020 2020 290d 0a0d              )...
-00005cb0: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-00005cc0: 6973 696e 7374 616e 6365 2861 7272 6179  isinstance(array
-00005cd0: 2c20 6e70 2e6e 6461 7272 6179 293a 0d0a  , np.ndarray):..
-00005ce0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00005cf0: 6520 5479 7065 4572 726f 7228 2261 7272  e TypeError("arr
-00005d00: 6179 2073 686f 756c 6420 6265 206f 6620  ay should be of 
-00005d10: 7479 7065 206e 756d 7079 2061 7272 6179  type numpy array
-00005d20: 2229 0d0a 0d0a 2020 2020 2020 2020 6261  ")....        ba
-00005d30: 6e64 7320 3d20 310d 0a20 2020 2020 2020  nds = 1..       
-00005d40: 2064 7479 7065 203d 206e 756d 7079 5f74   dtype = numpy_t
-00005d50: 6f5f 6764 616c 5f64 7479 7065 2861 7272  o_gdal_dtype(arr
-00005d60: 6179 290d 0a20 2020 2020 2020 2063 6f6c  ay)..        col
-00005d70: 732c 2072 6f77 732c 2070 726a 2c20 5f2c  s, rows, prj, _,
-00005d80: 2067 742c 206e 6f5f 6461 7461 5f76 616c   gt, no_data_val
-00005d90: 7565 2c20 5f20 3d20 5261 7374 6572 2e67  ue, _ = Raster.g
-00005da0: 6574 5261 7374 6572 4465 7461 696c 7328  etRasterDetails(
-00005db0: 7372 6329 0d0a 0d0a 2020 2020 2020 2020  src)....        
-00005dc0: 6473 7420 3d20 5261 7374 6572 2e5f 6372  dst = Raster._cr
-00005dd0: 6561 7465 4461 7461 7365 7428 636f 6c73  eateDataset(cols
-00005de0: 2c20 726f 7773 2c20 6261 6e64 732c 2064  , rows, bands, d
-00005df0: 7479 7065 2c20 6472 6976 6572 3d64 7269  type, driver=dri
-00005e00: 7665 722c 2070 6174 683d 7061 7468 290d  ver, path=path).
-00005e10: 0a0d 0a20 2020 2020 2020 2064 7374 2e53  ...        dst.S
-00005e20: 6574 4765 6f54 7261 6e73 666f 726d 2867  etGeoTransform(g
-00005e30: 7429 0d0a 2020 2020 2020 2020 6473 742e  t)..        dst.
-00005e40: 5365 7450 726f 6a65 6374 696f 6e28 7072  SetProjection(pr
-00005e50: 6a29 0d0a 2020 2020 2020 2020 2320 7365  j)..        # se
-00005e60: 7474 696e 6720 7468 6520 4e6f 4461 7461  tting the NoData
-00005e70: 5661 6c75 6520 646f 6573 206e 6f74 2061  Value does not a
-00005e80: 6363 6570 7420 646f 7562 6c65 2070 7265  ccept double pre
-00005e90: 6369 7369 6f6e 206e 756d 6265 7273 0d0a  cision numbers..
-00005ea0: 2020 2020 2020 2020 6473 7420 3d20 5261          dst = Ra
-00005eb0: 7374 6572 2e73 6574 4e6f 4461 7461 5661  ster.setNoDataVa
-00005ec0: 6c75 6528 6473 742c 206e 6f5f 6461 7461  lue(dst, no_data
-00005ed0: 5f76 616c 7565 3d6e 6f5f 6461 7461 5f76  _value=no_data_v
-00005ee0: 616c 7565 5b30 5d29 0d0a 0d0a 2020 2020  alue[0])....    
-00005ef0: 2020 2020 6473 742e 4765 7452 6173 7465      dst.GetRaste
-00005f00: 7242 616e 6428 3129 2e57 7269 7465 4172  rBand(1).WriteAr
-00005f10: 7261 7928 6172 7261 7929 0d0a 2020 2020  ray(array)..    
-00005f20: 2020 2020 6966 2064 7269 7665 7220 3d3d      if driver ==
-00005f30: 2022 4754 6966 6622 3a0d 0a20 2020 2020   "GTiff":..     
-00005f40: 2020 2020 2020 2064 7374 2e46 6c75 7368         dst.Flush
-00005f50: 4361 6368 6528 290d 0a20 2020 2020 2020  Cache()..       
-00005f60: 2020 2020 2064 7374 203d 204e 6f6e 650d       dst = None.
-00005f70: 0a0d 0a20 2020 2020 2020 2072 6574 7572  ...        retur
-00005f80: 6e20 6473 740d 0a0d 0a20 2020 2040 7374  n dst....    @st
-00005f90: 6174 6963 6d65 7468 6f64 0d0a 2020 2020  aticmethod..    
-00005fa0: 6465 6620 6d61 7041 6c67 6562 7261 2873  def mapAlgebra(s
-00005fb0: 7263 3a20 4461 7461 7365 742c 2066 756e  rc: Dataset, fun
-00005fc0: 2c20 6261 6e64 3a20 696e 7420 3d20 3129  , band: int = 1)
-00005fd0: 202d 3e20 4461 7461 7365 743a 0d0a 2020   -> Dataset:..  
-00005fe0: 2020 2020 2020 2222 226d 6170 416c 6765        """mapAlge
-00005ff0: 6272 612e 0d0a 0d0a 2020 2020 2020 2020  bra.....        
-00006000: 6d61 7041 6c67 6562 7261 2065 7865 6375  mapAlgebra execu
-00006010: 7465 7320 6120 6d61 7468 656d 6174 6963  tes a mathematic
-00006020: 616c 206f 7065 7261 7469 6f6e 206f 6e20  al operation on 
-00006030: 7261 7374 6572 2061 7272 6179 2061 6e64  raster array and
-00006040: 2072 6574 7572 6e73 0d0a 2020 2020 2020   returns..      
-00006050: 2020 7468 6520 7265 7375 6c74 0d0a 0d0a    the result....
-00006060: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-00006070: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
-00006080: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-00006090: 7372 6320 3a20 5b67 6461 6c2e 6461 7461  src : [gdal.data
-000060a0: 7365 745d 0d0a 2020 2020 2020 2020 2020  set]..          
-000060b0: 2020 736f 7572 6365 2072 6173 7465 7220    source raster 
-000060c0: 746f 2074 6861 7420 796f 7520 7761 6e74  to that you want
-000060d0: 2074 6f20 6d61 6b65 2073 6f6d 6520 6361   to make some ca
-000060e0: 6c63 756c 6174 696f 6e20 6f6e 2069 7473  lculation on its
-000060f0: 2076 616c 7565 730d 0a20 2020 2020 2020   values..       
-00006100: 2066 756e 3a20 5b66 756e 6374 696f 6e5d   fun: [function]
-00006110: 0d0a 2020 2020 2020 2020 2020 2020 6465  ..            de
-00006120: 6669 6e65 6420 6675 6e63 7469 6f6e 2074  fined function t
-00006130: 6861 7420 7461 6b65 7320 6f6e 6520 696e  hat takes one in
-00006140: 7075 7420 7768 6963 6820 6973 2074 6865  put which is the
-00006150: 2063 656c 6c20 7661 6c75 652e 0d0a 2020   cell value...  
-00006160: 2020 2020 2020 6261 6e64 3a20 5b69 6e74        band: [int
-00006170: 5d0d 0a20 2020 2020 2020 2020 2020 2062  ]..            b
-00006180: 616e 6420 6e75 6d62 6572 2e0d 0a0d 0a20  and number..... 
-00006190: 2020 2020 2020 2052 6574 7572 6e73 0d0a         Returns..
-000061a0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0d          -------.
-000061b0: 0a20 2020 2020 2020 2044 6174 6173 6574  .        Dataset
-000061c0: 0d0a 2020 2020 2020 2020 2020 2020 6764  ..            gd
-000061d0: 616c 2064 6174 6173 6574 206f 626a 6563  al dataset objec
-000061e0: 740d 0a0d 0a20 2020 2020 2020 2045 7861  t....        Exa
-000061f0: 6d70 6c65 730d 0a20 2020 2020 2020 202d  mples..        -
-00006200: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00006210: 203e 3e3e 2073 7263 5f72 6173 7465 7220   >>> src_raster 
-00006220: 3d20 6764 616c 2e4f 7065 6e28 2265 7661  = gdal.Open("eva
-00006230: 702e 7469 6622 290d 0a20 2020 2020 2020  p.tif")..       
-00006240: 203e 3e3e 2066 756e 6320 3d20 6e70 2e61   >>> func = np.a
-00006250: 6273 0d0a 2020 2020 2020 2020 3e3e 3e20  bs..        >>> 
-00006260: 6e65 775f 7261 7374 6572 203d 2052 6173  new_raster = Ras
-00006270: 7465 722e 6d61 7041 6c67 6562 7261 2873  ter.mapAlgebra(s
-00006280: 7263 5f72 6173 7465 722c 2066 756e 6329  rc_raster, func)
-00006290: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-000062a0: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
-000062b0: 696e 7374 616e 6365 2873 7263 2c20 6764  instance(src, gd
-000062c0: 616c 2e44 6174 6173 6574 293a 0d0a 2020  al.Dataset):..  
-000062d0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-000062e0: 5479 7065 4572 726f 7228 0d0a 2020 2020  TypeError(..    
-000062f0: 2020 2020 2020 2020 2020 2020 2273 7263              "src
-00006300: 2073 686f 756c 6420 6265 2072 6561 6420   should be read 
-00006310: 7573 696e 6720 6764 616c 2028 6764 616c  using gdal (gdal
-00006320: 2064 6174 6173 6574 2070 6c65 6173 6520   dataset please 
-00006330: 7265 6164 2069 7420 7573 696e 6720 6764  read it using gd
-00006340: 616c 206c 6962 7261 7279 2920 220d 0a20  al library) ".. 
-00006350: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
-00006360: 2020 2020 2020 6966 206e 6f74 2063 616c        if not cal
-00006370: 6c61 626c 6528 6675 6e29 3a0d 0a20 2020  lable(fun):..   
-00006380: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-00006390: 7970 6545 7272 6f72 2822 7365 636f 6e64  ypeError("second
-000063a0: 2061 7267 756d 656e 7420 7368 6f75 6c64   argument should
-000063b0: 2062 6520 6120 6675 6e63 7469 6f6e 2229   be a function")
-000063c0: 0d0a 0d0a 2020 2020 2020 2020 7372 635f  ....        src_
-000063d0: 6774 203d 2073 7263 2e47 6574 4765 6f54  gt = src.GetGeoT
-000063e0: 7261 6e73 666f 726d 2829 0d0a 2020 2020  ransform()..    
-000063f0: 2020 2020 7372 635f 7072 6f6a 203d 2073      src_proj = s
-00006400: 7263 2e47 6574 5072 6f6a 6563 7469 6f6e  rc.GetProjection
-00006410: 2829 0d0a 2020 2020 2020 2020 7372 635f  ()..        src_
-00006420: 726f 7720 3d20 7372 632e 5261 7374 6572  row = src.Raster
-00006430: 5953 697a 650d 0a20 2020 2020 2020 2073  YSize..        s
-00006440: 7263 5f63 6f6c 203d 2073 7263 2e52 6173  rc_col = src.Ras
-00006450: 7465 7258 5369 7a65 0d0a 2020 2020 2020  terXSize..      
-00006460: 2020 6e6f 7661 6c20 3d20 6e70 2e66 6c6f    noval = np.flo
-00006470: 6174 3332 2873 7263 2e47 6574 5261 7374  at32(src.GetRast
-00006480: 6572 4261 6e64 2862 616e 6429 2e47 6574  erBand(band).Get
-00006490: 4e6f 4461 7461 5661 6c75 6528 2929 0d0a  NoDataValue())..
-000064a0: 2020 2020 2020 2020 7372 635f 6172 7261          src_arra
-000064b0: 7920 3d20 7372 632e 5265 6164 4173 4172  y = src.ReadAsAr
-000064c0: 7261 7928 290d 0a20 2020 2020 2020 2064  ray()..        d
-000064d0: 7479 7065 203d 2073 7263 2e47 6574 5261  type = src.GetRa
-000064e0: 7374 6572 4261 6e64 2831 292e 4461 7461  sterBand(1).Data
-000064f0: 5479 7065 0d0a 2020 2020 2020 2020 7372  Type..        sr
-00006500: 635f 7372 6566 203d 206f 7372 2e53 7061  c_sref = osr.Spa
-00006510: 7469 616c 5265 6665 7265 6e63 6528 776b  tialReference(wk
-00006520: 743d 7372 635f 7072 6f6a 290d 0a0d 0a20  t=src_proj).... 
-00006530: 2020 2020 2020 2023 2066 696c 6c20 7468         # fill th
-00006540: 6520 6e65 7720 6172 7261 7920 7769 7468  e new array with
-00006550: 2074 6865 206e 6f64 6174 6120 7661 6c75   the nodata valu
-00006560: 650d 0a20 2020 2020 2020 206e 6577 5f61  e..        new_a
-00006570: 7272 6179 203d 206e 702e 6f6e 6573 2828  rray = np.ones((
-00006580: 7372 635f 726f 772c 2073 7263 5f63 6f6c  src_row, src_col
-00006590: 2929 202a 206e 6f76 616c 0d0a 2020 2020  )) * noval..    
-000065a0: 2020 2020 2320 6578 6563 7574 6520 7468      # execute th
-000065b0: 6520 6675 6e63 7469 6f6e 206f 6e20 6561  e function on ea
-000065c0: 6368 2063 656c 6c0d 0a20 2020 2020 2020  ch cell..       
-000065d0: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-000065e0: 7372 635f 726f 7729 3a0d 0a20 2020 2020  src_row):..     
-000065f0: 2020 2020 2020 2066 6f72 206a 2069 6e20         for j in 
-00006600: 7261 6e67 6528 7372 635f 636f 6c29 3a0d  range(src_col):.
-00006610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006620: 2069 6620 6e6f 7420 6e70 2e69 7363 6c6f   if not np.isclo
-00006630: 7365 2873 7263 5f61 7272 6179 5b69 2c20  se(src_array[i, 
-00006640: 6a5d 2c20 6e6f 7661 6c2c 2072 746f 6c3d  j], noval, rtol=
-00006650: 302e 3030 3129 3a0d 0a20 2020 2020 2020  0.001):..       
-00006660: 2020 2020 2020 2020 2020 2020 206e 6577               new
-00006670: 5f61 7272 6179 5b69 2c20 6a5d 203d 2066  _array[i, j] = f
-00006680: 756e 2873 7263 5f61 7272 6179 5b69 2c20  un(src_array[i, 
-00006690: 6a5d 290d 0a0d 0a20 2020 2020 2020 2023  j])....        #
-000066a0: 2063 7265 6174 6520 7468 6520 6f75 7470   create the outp
-000066b0: 7574 2072 6173 7465 720d 0a20 2020 2020  ut raster..     
-000066c0: 2020 2064 7374 203d 2052 6173 7465 722e     dst = Raster.
-000066d0: 5f63 7265 6174 6544 6174 6173 6574 2873  _createDataset(s
-000066e0: 7263 5f63 6f6c 2c20 7372 635f 726f 772c  rc_col, src_row,
-000066f0: 2031 2c20 6474 7970 652c 2064 7269 7665   1, dtype, drive
-00006700: 723d 224d 454d 2229 0d0a 2020 2020 2020  r="MEM")..      
-00006710: 2020 2320 7365 7420 7468 6520 6765 6f74    # set the geot
-00006720: 7261 6e73 666f 726d 0d0a 2020 2020 2020  ransform..      
-00006730: 2020 6473 742e 5365 7447 656f 5472 616e    dst.SetGeoTran
-00006740: 7366 6f72 6d28 7372 635f 6774 290d 0a20  sform(src_gt).. 
-00006750: 2020 2020 2020 2023 2073 6574 2074 6865         # set the
-00006760: 2070 726f 6a65 6374 696f 6e0d 0a20 2020   projection..   
-00006770: 2020 2020 2064 7374 2e53 6574 5072 6f6a       dst.SetProj
-00006780: 6563 7469 6f6e 2873 7263 5f73 7265 662e  ection(src_sref.
-00006790: 4578 706f 7274 546f 576b 7428 2929 0d0a  ExportToWkt())..
-000067a0: 2020 2020 2020 2020 2320 7365 7420 7468          # set th
-000067b0: 6520 6e6f 2064 6174 6120 7661 6c75 650d  e no data value.
-000067c0: 0a20 2020 2020 2020 206e 6f5f 6461 7461  .        no_data
-000067d0: 5f76 616c 7565 203d 2073 7263 2e47 6574  _value = src.Get
-000067e0: 5261 7374 6572 4261 6e64 2862 616e 6429  RasterBand(band)
-000067f0: 2e47 6574 4e6f 4461 7461 5661 6c75 6528  .GetNoDataValue(
-00006800: 290d 0a20 2020 2020 2020 2064 7374 203d  )..        dst =
-00006810: 2052 6173 7465 722e 7365 744e 6f44 6174   Raster.setNoDat
-00006820: 6156 616c 7565 2864 7374 2c20 6e6f 5f64  aValue(dst, no_d
-00006830: 6174 615f 7661 6c75 653d 6e6f 5f64 6174  ata_value=no_dat
-00006840: 615f 7661 6c75 6529 0d0a 2020 2020 2020  a_value)..      
-00006850: 2020 6473 742e 4765 7452 6173 7465 7242    dst.GetRasterB
-00006860: 616e 6428 6261 6e64 292e 5772 6974 6541  and(band).WriteA
-00006870: 7272 6179 286e 6577 5f61 7272 6179 290d  rray(new_array).
-00006880: 0a0d 0a20 2020 2020 2020 2072 6574 7572  ...        retur
-00006890: 6e20 6473 740d 0a0d 0a20 2020 2040 7374  n dst....    @st
-000068a0: 6174 6963 6d65 7468 6f64 0d0a 2020 2020  aticmethod..    
-000068b0: 6465 6620 7261 7374 6572 4669 6c6c 280d  def rasterFill(.
-000068c0: 0a20 2020 2020 2020 2073 7263 3a20 4461  .        src: Da
-000068d0: 7461 7365 742c 2076 616c 3a20 556e 696f  taset, val: Unio
-000068e0: 6e5b 666c 6f61 742c 2069 6e74 5d2c 2064  n[float, int], d
-000068f0: 7269 7665 723a 2073 7472 203d 2022 4754  river: str = "GT
-00006900: 6966 6622 2c20 7061 7468 3a20 7374 7220  iff", path: str 
-00006910: 3d20 4e6f 6e65 0d0a 2020 2020 2920 2d3e  = None..    ) ->
-00006920: 2055 6e69 6f6e 5b4e 6f6e 652c 2044 6174   Union[None, Dat
-00006930: 6173 6574 5d3a 0d0a 2020 2020 2020 2020  aset]:..        
-00006940: 2222 2272 6173 7465 7246 696c 6c2e 0d0a  """rasterFill...
-00006950: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
-00006960: 7374 6572 4669 6c6c 2074 616b 6573 2061  sterFill takes a
-00006970: 2072 6173 7465 7220 616e 6420 6669 6c6c   raster and fill
-00006980: 2069 7420 7769 7468 206f 6e65 2076 616c   it with one val
-00006990: 7565 0d0a 0d0a 2020 2020 2020 2020 5061  ue....        Pa
-000069a0: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
-000069b0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-000069c0: 2020 2020 2020 7372 6320 3a20 5b67 6461        src : [gda
-000069d0: 6c2e 6461 7461 7365 745d 0d0a 2020 2020  l.dataset]..    
-000069e0: 2020 2020 2020 2020 736f 7572 6365 2072          source r
-000069f0: 6173 7465 720d 0a20 2020 2020 2020 2076  aster..        v
-00006a00: 616c 3a20 5b6e 756d 6572 6963 5d0d 0a20  al: [numeric].. 
-00006a10: 2020 2020 2020 2020 2020 206e 756d 6572             numer
-00006a20: 6963 2076 616c 7565 0d0a 2020 2020 2020  ic value..      
-00006a30: 2020 6472 6976 6572 3a20 5b73 7472 5d0d    driver: [str].
-00006a40: 0a20 2020 2020 2020 2020 2020 2064 7269  .            dri
-00006a50: 7665 7220 7479 7065 205b 2247 5469 6666  ver type ["GTiff
-00006a60: 222c 2022 4d45 4d22 5d0d 0a20 2020 2020  ", "MEM"]..     
-00006a70: 2020 2070 6174 6820 3a20 5b73 7472 5d0d     path : [str].
-00006a80: 0a20 2020 2020 2020 2020 2020 2070 6174  .            pat
-00006a90: 6820 696e 636c 7564 696e 6720 7468 6520  h including the 
-00006aa0: 6578 7465 6e73 696f 6e20 282e 7469 6629  extension (.tif)
-00006ab0: 0d0a 0d0a 2020 2020 2020 2020 5265 7475  ....        Retu
-00006ac0: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
-00006ad0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 7261  ----..        ra
-00006ae0: 7374 6572 203a 205b 7361 7665 6420 6f6e  ster : [saved on
-00006af0: 2064 6973 6b5d 0d0a 2020 2020 2020 2020   disk]..        
-00006b00: 2020 2020 7468 6520 7261 7374 6572 2077      the raster w
-00006b10: 696c 6c20 6265 2073 6176 6564 2064 6972  ill be saved dir
-00006b20: 6563 746c 7920 746f 2074 6865 2070 6174  ectly to the pat
-00006b30: 6820 796f 7520 7072 6f76 6964 6564 2e0d  h you provided..
-00006b40: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-00006b50: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
-00006b60: 6e73 7461 6e63 6528 7372 632c 2067 6461  nstance(src, gda
-00006b70: 6c2e 4461 7461 7365 7429 3a0d 0a20 2020  l.Dataset):..   
-00006b80: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-00006b90: 7970 6545 7272 6f72 280d 0a20 2020 2020  ypeError(..     
-00006ba0: 2020 2020 2020 2020 2020 2022 7372 6320             "src 
-00006bb0: 7368 6f75 6c64 2062 6520 7265 6164 2075  should be read u
-00006bc0: 7369 6e67 2067 6461 6c20 2867 6461 6c20  sing gdal (gdal 
-00006bd0: 6461 7461 7365 7420 706c 6561 7365 2072  dataset please r
-00006be0: 6561 6420 6974 2075 7369 6e67 2067 6461  ead it using gda
-00006bf0: 6c20 6c69 6272 6172 7929 2022 0d0a 2020  l library) "..  
-00006c00: 2020 2020 2020 2020 2020 290d 0a0d 0a20            ).... 
-00006c10: 2020 2020 2020 204e 6f44 6174 6156 616c         NoDataVal
-00006c20: 203d 2073 7263 2e47 6574 5261 7374 6572   = src.GetRaster
-00006c30: 4261 6e64 2831 292e 4765 744e 6f44 6174  Band(1).GetNoDat
-00006c40: 6156 616c 7565 2829 0d0a 2020 2020 2020  aValue()..      
-00006c50: 2020 7372 635f 6172 7261 7920 3d20 7372    src_array = sr
-00006c60: 632e 5265 6164 4173 4172 7261 7928 290d  c.ReadAsArray().
-00006c70: 0a0d 0a20 2020 2020 2020 2069 6620 4e6f  ...        if No
-00006c80: 4461 7461 5661 6c20 6973 204e 6f6e 653a  DataVal is None:
-00006c90: 0d0a 2020 2020 2020 2020 2020 2020 4e6f  ..            No
-00006ca0: 4461 7461 5661 6c20 3d20 6e70 2e6e 616e  DataVal = np.nan
-00006cb0: 0d0a 0d0a 2020 2020 2020 2020 6966 206e  ....        if n
-00006cc0: 6f74 206e 702e 6973 6e61 6e28 4e6f 4461  ot np.isnan(NoDa
-00006cd0: 7461 5661 6c29 3a0d 0a20 2020 2020 2020  taVal):..       
-00006ce0: 2020 2020 2073 7263 5f61 7272 6179 5b7e       src_array[~
-00006cf0: 6e70 2e69 7363 6c6f 7365 2873 7263 5f61  np.isclose(src_a
-00006d00: 7272 6179 2c20 4e6f 4461 7461 5661 6c2c  rray, NoDataVal,
-00006d10: 2072 746f 6c3d 302e 3030 3129 5d20 3d20   rtol=0.001)] = 
-00006d20: 7661 6c0d 0a20 2020 2020 2020 2065 6c73  val..        els
-00006d30: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00006d40: 7372 635f 6172 7261 795b 7e6e 702e 6973  src_array[~np.is
-00006d50: 6e61 6e28 7372 635f 6172 7261 7929 5d20  nan(src_array)] 
-00006d60: 3d20 7661 6c0d 0a20 2020 2020 2020 2064  = val..        d
-00006d70: 7374 203d 2052 6173 7465 722e 7261 7374  st = Raster.rast
-00006d80: 6572 4c69 6b65 2873 7263 2c20 7372 635f  erLike(src, src_
-00006d90: 6172 7261 792c 2064 7269 7665 723d 6472  array, driver=dr
-00006da0: 6976 6572 2c20 7061 7468 3d70 6174 6829  iver, path=path)
-00006db0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00006dc0: 2064 7374 0d0a 0d0a 2020 2020 4073 7461   dst....    @sta
-00006dd0: 7469 636d 6574 686f 640d 0a20 2020 2064  ticmethod..    d
-00006de0: 6566 2072 6573 616d 706c 6552 6173 7465  ef resampleRaste
-00006df0: 7228 0d0a 2020 2020 2020 2020 7372 633a  r(..        src:
-00006e00: 2044 6174 6173 6574 2c20 6365 6c6c 5f73   Dataset, cell_s
-00006e10: 697a 653a 2055 6e69 6f6e 5b69 6e74 2c20  ize: Union[int, 
-00006e20: 666c 6f61 745d 2c20 7265 7361 6d70 6c65  float], resample
-00006e30: 5f74 6563 686e 6971 7565 3a20 7374 7220  _technique: str 
-00006e40: 3d20 224e 6561 7265 7374 220d 0a20 2020  = "Nearest"..   
-00006e50: 2029 202d 3e20 4461 7461 7365 743a 0d0a   ) -> Dataset:..
-00006e60: 2020 2020 2020 2020 2222 2272 6573 616d          """resam
-00006e70: 706c 6552 6173 7465 722e 0d0a 0d0a 2020  pleRaster.....  
-00006e80: 2020 2020 2020 7265 7361 6d70 6c65 5261        resampleRa
-00006e90: 7374 6572 2072 6570 726f 6a65 6374 2061  ster reproject a
-00006ea0: 2072 6173 7465 7220 746f 2061 6e79 2070   raster to any p
-00006eb0: 726f 6a65 6374 696f 6e0d 0a20 2020 2020  rojection..     
-00006ec0: 2020 2028 6465 6661 756c 7420 7468 6520     (default the 
-00006ed0: 5747 5338 3420 7765 6220 6d65 7263 6174  WGS84 web mercat
-00006ee0: 6f72 2070 726f 6a65 6374 696f 6e2c 2077  or projection, w
-00006ef0: 6974 686f 7574 2072 6573 616d 706c 696e  ithout resamplin
-00006f00: 6729 0d0a 2020 2020 2020 2020 5468 6520  g)..        The 
-00006f10: 6675 6e63 7469 6f6e 2072 6574 7572 6e73  function returns
-00006f20: 2061 2047 4441 4c20 696e 2d6d 656d 6f72   a GDAL in-memor
-00006f30: 7920 6669 6c65 206f 626a 6563 742c 2077  y file object, w
-00006f40: 6865 7265 2079 6f75 2063 616e 2052 6561  here you can Rea
-00006f50: 6441 7341 7272 6179 2065 7463 2e0d 0a0d  dAsArray etc....
-00006f60: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00006f70: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
-00006f80: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00006f90: 2073 7263 203a 205b 6764 616c 2e44 6174   src : [gdal.Dat
-00006fa0: 6173 6574 5d0d 0a20 2020 2020 2020 2020  aset]..         
-00006fb0: 2020 2020 6764 616c 2072 6173 7465 7220      gdal raster 
-00006fc0: 2873 7263 3d67 6461 6c2e 4f70 656e 2822  (src=gdal.Open("
-00006fd0: 6465 6d2e 7469 6622 2929 0d0a 2020 2020  dem.tif"))..    
-00006fe0: 2020 2020 6365 6c6c 5f73 697a 6520 3a20      cell_size : 
-00006ff0: 5b69 6e74 6567 6572 5d0d 0a20 2020 2020  [integer]..     
-00007000: 2020 2020 2020 2020 6e65 7720 6365 6c6c          new cell
-00007010: 2073 697a 6520 746f 2072 6573 616d 706c   size to resampl
-00007020: 6520 7468 6520 7261 7374 6572 2e0d 0a20  e the raster... 
-00007030: 2020 2020 2020 2020 2020 2028 6465 6661             (defa
-00007040: 756c 7420 656d 7074 7920 736f 2072 6173  ult empty so ras
-00007050: 7465 7220 7769 6c6c 206e 6f74 2062 6520  ter will not be 
-00007060: 7265 7361 6d70 6c65 6429 0d0a 2020 2020  resampled)..    
-00007070: 2020 2020 7265 7361 6d70 6c65 5f74 6563      resample_tec
-00007080: 686e 6971 7565 203a 205b 5374 7269 6e67  hnique : [String
-00007090: 5d0d 0a20 2020 2020 2020 2020 2020 2072  ]..            r
-000070a0: 6573 616d 706c 696e 6720 7465 6368 6e69  esampling techni
-000070b0: 7175 6520 6465 6661 756c 7420 6973 2022  que default is "
-000070c0: 4e65 6172 6573 7422 0d0a 2020 2020 2020  Nearest"..      
-000070d0: 2020 2020 2020 6874 7470 733a 2f2f 6769        https://gi
-000070e0: 7367 656f 6772 6170 6879 2e63 6f6d 2f72  sgeography.com/r
-000070f0: 6173 7465 722d 7265 7361 6d70 6c69 6e67  aster-resampling
-00007100: 2f0d 0a20 2020 2020 2020 2020 2020 2022  /..            "
-00007110: 4e65 6172 6573 7422 2066 6f72 206e 6561  Nearest" for nea
-00007120: 7265 7374 206e 6569 6768 626f 7572 2c22  rest neighbour,"
-00007130: 6375 6269 6322 2066 6f72 2063 7562 6963  cubic" for cubic
-00007140: 2063 6f6e 766f 6c75 7469 6f6e 2c0d 0a20   convolution,.. 
-00007150: 2020 2020 2020 2020 2020 2022 6269 6c69             "bili
-00007160: 6e65 6172 2220 666f 7220 6269 6c69 6e65  near" for biline
-00007170: 6172 0d0a 0d0a 2020 2020 2020 2020 5265  ar....        Re
-00007180: 7475 726e 730d 0a20 2020 2020 2020 202d  turns..        -
-00007190: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-000071a0: 7261 7374 6572 203a 205b 6764 616c 2e44  raster : [gdal.D
-000071b0: 6174 6173 6574 5d0d 0a20 2020 2020 2020  ataset]..       
-000071c0: 2020 2020 2020 6764 616c 206f 626a 6563        gdal objec
-000071d0: 7420 2879 6f75 2063 616e 2072 6561 6420  t (you can read 
-000071e0: 6974 2062 7920 5265 6164 4173 4172 7261  it by ReadAsArra
-000071f0: 7929 0d0a 2020 2020 2020 2020 2222 220d  y)..        """.
-00007200: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-00007210: 6973 696e 7374 616e 6365 2873 7263 2c20  isinstance(src, 
-00007220: 6764 616c 2e44 6174 6173 6574 293a 0d0a  gdal.Dataset):..
-00007230: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00007240: 6520 5479 7065 4572 726f 7228 0d0a 2020  e TypeError(..  
-00007250: 2020 2020 2020 2020 2020 2020 2020 2273                "s
-00007260: 7263 2073 686f 756c 6420 6265 2072 6561  rc should be rea
-00007270: 6420 7573 696e 6720 6764 616c 2028 6764  d using gdal (gd
-00007280: 616c 2064 6174 6173 6574 2070 6c65 6173  al dataset pleas
-00007290: 6520 7265 6164 2069 7420 7573 696e 6720  e read it using 
-000072a0: 6764 616c 206c 6962 7261 7279 2920 220d  gdal library) ".
-000072b0: 0a20 2020 2020 2020 2020 2020 2029 0d0a  .            )..
-000072c0: 0d0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-000072d0: 2069 7369 6e73 7461 6e63 6528 7265 7361   isinstance(resa
-000072e0: 6d70 6c65 5f74 6563 686e 6971 7565 2c20  mple_technique, 
-000072f0: 7374 7229 3a0d 0a20 2020 2020 2020 2020  str):..         
-00007300: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
-00007310: 6f72 280d 0a20 2020 2020 2020 2020 2020  or(..           
-00007320: 2020 2020 2022 2070 6c65 6173 6520 656e       " please en
-00007330: 7465 7220 636f 7272 6563 7420 7265 7361  ter correct resa
-00007340: 6d70 6c65 5f74 6563 686e 6971 7565 206d  mple_technique m
-00007350: 6f72 6520 696e 666f 726d 6174 696f 6e20  ore information 
-00007360: 7365 6520 646f 636d 656e 7461 7469 6f6e  see docmentation
-00007370: 2022 0d0a 2020 2020 2020 2020 2020 2020   "..            
-00007380: 290d 0a0d 0a20 2020 2020 2020 2069 6620  )....        if 
-00007390: 7265 7361 6d70 6c65 5f74 6563 686e 6971  resample_techniq
-000073a0: 7565 203d 3d20 224e 6561 7265 7374 223a  ue == "Nearest":
-000073b0: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-000073c0: 7361 6d70 6c65 5f74 6563 686e 6971 7565  sample_technique
-000073d0: 203d 2067 6461 6c2e 4752 415f 4e65 6172   = gdal.GRA_Near
-000073e0: 6573 744e 6569 6768 626f 7572 0d0a 2020  estNeighbour..  
-000073f0: 2020 2020 2020 656c 6966 2072 6573 616d        elif resam
-00007400: 706c 655f 7465 6368 6e69 7175 6520 3d3d  ple_technique ==
-00007410: 2022 6375 6269 6322 3a0d 0a20 2020 2020   "cubic":..     
-00007420: 2020 2020 2020 2072 6573 616d 706c 655f         resample_
-00007430: 7465 6368 6e69 7175 6520 3d20 6764 616c  technique = gdal
-00007440: 2e47 5241 5f43 7562 6963 0d0a 2020 2020  .GRA_Cubic..    
-00007450: 2020 2020 656c 6966 2072 6573 616d 706c      elif resampl
-00007460: 655f 7465 6368 6e69 7175 6520 3d3d 2022  e_technique == "
-00007470: 6269 6c69 6e65 6172 223a 0d0a 2020 2020  bilinear":..    
-00007480: 2020 2020 2020 2020 7265 7361 6d70 6c65          resample
-00007490: 5f74 6563 686e 6971 7565 203d 2067 6461  _technique = gda
-000074a0: 6c2e 4752 415f 4269 6c69 6e65 6172 0d0a  l.GRA_Bilinear..
-000074b0: 0d0a 2020 2020 2020 2020 7372 635f 7072  ..        src_pr
-000074c0: 6f6a 203d 2073 7263 2e47 6574 5072 6f6a  oj = src.GetProj
-000074d0: 6563 7469 6f6e 2829 0d0a 2020 2020 2020  ection()..      
-000074e0: 2020 7372 635f 6774 203d 2073 7263 2e47    src_gt = src.G
-000074f0: 6574 4765 6f54 7261 6e73 666f 726d 2829  etGeoTransform()
-00007500: 0d0a 2020 2020 2020 2020 7372 635f 7820  ..        src_x 
-00007510: 3d20 7372 632e 5261 7374 6572 5853 697a  = src.RasterXSiz
-00007520: 650d 0a20 2020 2020 2020 2073 7263 5f79  e..        src_y
-00007530: 203d 2073 7263 2e52 6173 7465 7259 5369   = src.RasterYSi
-00007540: 7a65 0d0a 0d0a 2020 2020 2020 2020 7372  ze....        sr
-00007550: 5f73 7263 203d 206f 7372 2e53 7061 7469  _src = osr.Spati
-00007560: 616c 5265 6665 7265 6e63 6528 776b 743d  alReference(wkt=
-00007570: 7372 635f 7072 6f6a 290d 0a0d 0a20 2020  src_proj)....   
-00007580: 2020 2020 2075 6c78 203d 2073 7263 5f67       ulx = src_g
-00007590: 745b 305d 0d0a 2020 2020 2020 2020 756c  t[0]..        ul
-000075a0: 7920 3d20 7372 635f 6774 5b33 5d0d 0a20  y = src_gt[3].. 
-000075b0: 2020 2020 2020 2023 2074 7261 6e73 666f         # transfo
-000075c0: 726d 2074 6865 2072 6967 6874 206c 6f77  rm the right low
-000075d0: 6572 2063 6f72 6e65 7220 706f 696e 740d  er corner point.
-000075e0: 0a20 2020 2020 2020 206c 7278 203d 2073  .        lrx = s
-000075f0: 7263 5f67 745b 305d 202b 2073 7263 5f67  rc_gt[0] + src_g
-00007600: 745b 315d 202a 2073 7263 5f78 0d0a 2020  t[1] * src_x..  
-00007610: 2020 2020 2020 6c72 7920 3d20 7372 635f        lry = src_
-00007620: 6774 5b33 5d20 2b20 7372 635f 6774 5b35  gt[3] + src_gt[5
-00007630: 5d20 2a20 7372 635f 790d 0a0d 0a20 2020  ] * src_y....   
-00007640: 2020 2020 2070 6978 656c 5f73 7061 6369       pixel_spaci
-00007650: 6e67 203d 2063 656c 6c5f 7369 7a65 0d0a  ng = cell_size..
-00007660: 2020 2020 2020 2020 2320 6e65 7720 6765          # new ge
-00007670: 6f74 7261 6e73 666f 726d 0d0a 2020 2020  otransform..    
-00007680: 2020 2020 6e65 775f 6765 6f20 3d20 280d      new_geo = (.
-00007690: 0a20 2020 2020 2020 2020 2020 2073 7263  .            src
-000076a0: 5f67 745b 305d 2c0d 0a20 2020 2020 2020  _gt[0],..       
-000076b0: 2020 2020 2070 6978 656c 5f73 7061 6369       pixel_spaci
-000076c0: 6e67 2c0d 0a20 2020 2020 2020 2020 2020  ng,..           
-000076d0: 2073 7263 5f67 745b 325d 2c0d 0a20 2020   src_gt[2],..   
-000076e0: 2020 2020 2020 2020 2073 7263 5f67 745b           src_gt[
-000076f0: 335d 2c0d 0a20 2020 2020 2020 2020 2020  3],..           
-00007700: 2073 7263 5f67 745b 345d 2c0d 0a20 2020   src_gt[4],..   
-00007710: 2020 2020 2020 2020 202d 3120 2a20 7069           -1 * pi
-00007720: 7865 6c5f 7370 6163 696e 672c 0d0a 2020  xel_spacing,..  
-00007730: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
-00007740: 2023 2063 7265 6174 6520 6120 6e65 7720   # create a new 
-00007750: 7261 7374 6572 0d0a 2020 2020 2020 2020  raster..        
-00007760: 636f 6c73 203d 2069 6e74 286e 702e 726f  cols = int(np.ro
-00007770: 756e 6428 6162 7328 6c72 7820 2d20 756c  und(abs(lrx - ul
-00007780: 7829 202f 2070 6978 656c 5f73 7061 6369  x) / pixel_spaci
-00007790: 6e67 2929 0d0a 2020 2020 2020 2020 726f  ng))..        ro
-000077a0: 7773 203d 2069 6e74 286e 702e 726f 756e  ws = int(np.roun
-000077b0: 6428 6162 7328 756c 7920 2d20 6c72 7929  d(abs(uly - lry)
-000077c0: 202f 2070 6978 656c 5f73 7061 6369 6e67   / pixel_spacing
-000077d0: 2929 0d0a 2020 2020 2020 2020 6474 7970  ))..        dtyp
-000077e0: 6520 3d20 7372 632e 4765 7452 6173 7465  e = src.GetRaste
-000077f0: 7242 616e 6428 3129 2e44 6174 6154 7970  rBand(1).DataTyp
-00007800: 650d 0a0d 0a20 2020 2020 2020 2064 7374  e....        dst
-00007810: 203d 2052 6173 7465 722e 5f63 7265 6174   = Raster._creat
-00007820: 6544 6174 6173 6574 2863 6f6c 732c 2072  eDataset(cols, r
-00007830: 6f77 732c 2031 2c20 6474 7970 6529 0d0a  ows, 1, dtype)..
-00007840: 0d0a 2020 2020 2020 2020 2320 7365 7420  ..        # set 
-00007850: 7468 6520 6765 6f74 7261 6e73 666f 726d  the geotransform
-00007860: 0d0a 2020 2020 2020 2020 6473 742e 5365  ..        dst.Se
-00007870: 7447 656f 5472 616e 7366 6f72 6d28 6e65  tGeoTransform(ne
-00007880: 775f 6765 6f29 0d0a 2020 2020 2020 2020  w_geo)..        
-00007890: 2320 7365 7420 7468 6520 7072 6f6a 6563  # set the projec
-000078a0: 7469 6f6e 0d0a 2020 2020 2020 2020 6473  tion..        ds
-000078b0: 742e 5365 7450 726f 6a65 6374 696f 6e28  t.SetProjection(
-000078c0: 7372 5f73 7263 2e45 7870 6f72 7454 6f57  sr_src.ExportToW
-000078d0: 6b74 2829 290d 0a20 2020 2020 2020 2023  kt())..        #
-000078e0: 2073 6574 2074 6865 206e 6f20 6461 7461   set the no data
-000078f0: 2076 616c 7565 0d0a 2020 2020 2020 2020   value..        
-00007900: 6e6f 5f64 6174 615f 7661 6c75 6520 3d20  no_data_value = 
-00007910: 7372 632e 4765 7452 6173 7465 7242 616e  src.GetRasterBan
-00007920: 6428 3129 2e47 6574 4e6f 4461 7461 5661  d(1).GetNoDataVa
-00007930: 6c75 6528 290d 0a20 2020 2020 2020 2064  lue()..        d
-00007940: 7374 203d 2052 6173 7465 722e 7365 744e  st = Raster.setN
-00007950: 6f44 6174 6156 616c 7565 2864 7374 2c20  oDataValue(dst, 
-00007960: 6e6f 5f64 6174 615f 7661 6c75 6529 0d0a  no_data_value)..
-00007970: 2020 2020 2020 2020 2320 7065 7266 6f72          # perfor
-00007980: 6d20 7468 6520 7072 6f6a 6563 7469 6f6e  m the projection
-00007990: 2026 2072 6573 616d 706c 696e 670d 0a20   & resampling.. 
-000079a0: 2020 2020 2020 2067 6461 6c2e 5265 7072         gdal.Repr
-000079b0: 6f6a 6563 7449 6d61 6765 280d 0a20 2020  ojectImage(..   
-000079c0: 2020 2020 2020 2020 2073 7263 2c20 6473           src, ds
-000079d0: 742c 2073 725f 7372 632e 4578 706f 7274  t, sr_src.Export
-000079e0: 546f 576b 7428 292c 2073 725f 7372 632e  ToWkt(), sr_src.
-000079f0: 4578 706f 7274 546f 576b 7428 292c 2072  ExportToWkt(), r
-00007a00: 6573 616d 706c 655f 7465 6368 6e69 7175  esample_techniqu
-00007a10: 650d 0a20 2020 2020 2020 2029 0d0a 0d0a  e..        )....
-00007a20: 2020 2020 2020 2020 7265 7475 726e 2064          return d
-00007a30: 7374 0d0a 0d0a 2020 2020 4073 7461 7469  st....    @stati
-00007a40: 636d 6574 686f 640d 0a20 2020 2064 6566  cmethod..    def
-00007a50: 2070 726f 6a65 6374 5261 7374 6572 280d   projectRaster(.
-00007a60: 0a20 2020 2020 2020 2073 7263 3a20 4461  .        src: Da
-00007a70: 7461 7365 742c 2074 6f5f 6570 7367 3a20  taset, to_epsg: 
-00007a80: 696e 742c 2072 6573 616d 706c 655f 7465  int, resample_te
-00007a90: 6368 6e69 7175 653a 2073 7472 203d 2022  chnique: str = "
-00007aa0: 4e65 6172 6573 7422 2c20 6f70 7469 6f6e  Nearest", option
-00007ab0: 3a20 696e 7420 3d20 320d 0a20 2020 2029  : int = 2..    )
-00007ac0: 202d 3e20 4461 7461 7365 743a 0d0a 2020   -> Dataset:..  
-00007ad0: 2020 2020 2020 2222 2270 726f 6a65 6374        """project
-00007ae0: 5261 7374 6572 2e0d 0a0d 0a20 2020 2020  Raster.....     
-00007af0: 2020 2070 726f 6a65 6374 5261 7374 6572     projectRaster
-00007b00: 2072 6570 726f 6a65 6374 7320 6120 7261   reprojects a ra
-00007b10: 7374 6572 2074 6f20 616e 7920 7072 6f6a  ster to any proj
-00007b20: 6563 7469 6f6e 0d0a 2020 2020 2020 2020  ection..        
-00007b30: 2864 6566 6175 6c74 2074 6865 2057 4753  (default the WGS
-00007b40: 3834 2077 6562 206d 6572 6361 746f 7220  84 web mercator 
-00007b50: 7072 6f6a 6563 7469 6f6e 2c20 7769 7468  projection, with
-00007b60: 6f75 7420 7265 7361 6d70 6c69 6e67 290d  out resampling).
-00007b70: 0a20 2020 2020 2020 2054 6865 2066 756e  .        The fun
-00007b80: 6374 696f 6e20 7265 7475 726e 7320 6120  ction returns a 
-00007b90: 4744 414c 2069 6e2d 6d65 6d6f 7279 2066  GDAL in-memory f
-00007ba0: 696c 6520 6f62 6a65 6374 2c20 7768 6572  ile object, wher
-00007bb0: 6520 796f 7520 6361 6e20 5265 6164 4173  e you can ReadAs
-00007bc0: 4172 7261 7920 6574 632e 0d0a 0d0a 2020  Array etc.....  
-00007bd0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-00007be0: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00007bf0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 7372  ----..        sr
-00007c00: 633a 205b 6764 616c 206f 626a 6563 745d  c: [gdal object]
-00007c10: 0d0a 2020 2020 2020 2020 2020 2020 6764  ..            gd
-00007c20: 616c 2064 6174 6173 6574 2028 7372 633d  al dataset (src=
-00007c30: 6764 616c 2e4f 7065 6e28 2264 656d 2e74  gdal.Open("dem.t
-00007c40: 6966 2229 290d 0a20 2020 2020 2020 2074  if"))..        t
-00007c50: 6f5f 6570 7367 3a20 5b69 6e74 6567 6572  o_epsg: [integer
-00007c60: 5d0d 0a20 2020 2020 2020 2020 2020 2072  ]..            r
-00007c70: 6566 6572 656e 6365 206e 756d 6265 7220  eference number 
-00007c80: 746f 2074 6865 206e 6577 2070 726f 6a65  to the new proje
-00007c90: 6374 696f 6e20 2868 7474 7073 3a2f 2f65  ction (https://e
-00007ca0: 7073 672e 696f 2f29 0d0a 2020 2020 2020  psg.io/)..      
-00007cb0: 2020 2020 2020 2864 6566 6175 6c74 2033        (default 3
-00007cc0: 3835 3720 7468 6520 7265 6665 7265 6e63  857 the referenc
-00007cd0: 6520 6e6f 206f 6620 5747 5338 3420 7765  e no of WGS84 we
-00007ce0: 6220 6d65 7263 6174 6f72 2029 0d0a 2020  b mercator )..  
-00007cf0: 2020 2020 2020 7265 7361 6d70 6c65 5f74        resample_t
-00007d00: 6563 686e 6971 7565 3a20 5b53 7472 696e  echnique: [Strin
-00007d10: 675d 0d0a 2020 2020 2020 2020 2020 2020  g]..            
-00007d20: 7265 7361 6d70 6c69 6e67 2074 6563 686e  resampling techn
-00007d30: 6971 7565 2064 6566 6175 6c74 2069 7320  ique default is 
-00007d40: 224e 6561 7265 7374 220d 0a20 2020 2020  "Nearest"..     
-00007d50: 2020 2020 2020 2068 7474 7073 3a2f 2f67         https://g
-00007d60: 6973 6765 6f67 7261 7068 792e 636f 6d2f  isgeography.com/
-00007d70: 7261 7374 6572 2d72 6573 616d 706c 696e  raster-resamplin
-00007d80: 672f 0d0a 2020 2020 2020 2020 2020 2020  g/..            
-00007d90: 224e 6561 7265 7374 2220 666f 7220 6e65  "Nearest" for ne
-00007da0: 6172 6573 7420 6e65 6967 6862 6f75 722c  arest neighbour,
-00007db0: 2263 7562 6963 2220 666f 7220 6375 6269  "cubic" for cubi
-00007dc0: 6320 636f 6e76 6f6c 7574 696f 6e2c 0d0a  c convolution,..
-00007dd0: 2020 2020 2020 2020 2020 2020 2262 696c              "bil
-00007de0: 696e 6561 7222 2066 6f72 2062 696c 696e  inear" for bilin
-00007df0: 6561 720d 0a20 2020 2020 2020 206f 7074  ear..        opt
-00007e00: 696f 6e20 3a20 5b31 206f 7220 325d 0d0a  ion : [1 or 2]..
-00007e10: 2020 2020 2020 2020 2020 2020 6f70 7469              opti
-00007e20: 6f6e 2032 2075 7365 7320 7468 6520 6764  on 2 uses the gd
-00007e30: 612e 7772 6170 2066 756e 6374 696f 6e2c  a.wrap function,
-00007e40: 206f 7074 696f 6e20 3120 7573 6573 2074   option 1 uses t
-00007e50: 6865 2067 6461 2e52 6570 726f 6a65 6374  he gda.Reproject
-00007e60: 496d 6167 6520 6675 6e63 7469 6f6e 0d0a  Image function..
-00007e70: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-00007e80: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-00007e90: 2d2d 0d0a 2020 2020 2020 2020 7261 7374  --..        rast
-00007ea0: 6572 3a0d 0a20 2020 2020 2020 2020 2020  er:..           
-00007eb0: 2067 6461 6c20 6461 7461 7365 7420 2879   gdal dataset (y
-00007ec0: 6f75 2063 616e 2072 6561 6420 6974 2062  ou can read it b
-00007ed0: 7920 5265 6164 4173 4172 7261 7929 0d0a  y ReadAsArray)..
-00007ee0: 0d0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
-00007ef0: 6573 0d0a 2020 2020 2020 2020 2d2d 2d2d  es..        ----
-00007f00: 2d2d 2d2d 0d0a 2020 2020 2020 2020 3e3e  ----..        >>
-00007f10: 3e20 7072 6f6a 6563 7465 645f 7261 7374  > projected_rast
-00007f20: 6572 203d 2052 6173 7465 722e 7072 6f6a  er = Raster.proj
-00007f30: 6563 7452 6173 7465 7228 7372 632c 2074  ectRaster(src, t
-00007f40: 6f5f 6570 7367 3d33 3835 3729 0d0a 2020  o_epsg=3857)..  
-00007f50: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-00007f60: 2020 2023 2069 6e70 7574 2064 6174 6120     # input data 
-00007f70: 7661 6c69 6461 7469 6f6e 0d0a 2020 2020  validation..    
-00007f80: 2020 2020 2320 6461 7461 2074 7970 650d      # data type.
-00007f90: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-00007fa0: 6973 696e 7374 616e 6365 2873 7263 2c20  isinstance(src, 
-00007fb0: 6764 616c 2e44 6174 6173 6574 293a 0d0a  gdal.Dataset):..
-00007fc0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00007fd0: 6520 5479 7065 4572 726f 7228 0d0a 2020  e TypeError(..  
-00007fe0: 2020 2020 2020 2020 2020 2020 2020 2273                "s
-00007ff0: 7263 2073 686f 756c 6420 6265 2072 6561  rc should be rea
-00008000: 6420 7573 696e 6720 6764 616c 2028 6764  d using gdal (gd
-00008010: 616c 2064 6174 6173 6574 2070 6c65 6173  al dataset pleas
-00008020: 6520 7265 6164 2069 7420 7573 696e 6720  e read it using 
-00008030: 6764 616c 220d 0a20 2020 2020 2020 2020  gdal"..         
-00008040: 2020 2020 2020 2066 2220 6c69 6272 6172         f" librar
-00008050: 7929 2067 6976 656e 207b 7479 7065 2873  y) given {type(s
-00008060: 7263 297d 220d 0a20 2020 2020 2020 2020  rc)}"..         
-00008070: 2020 2029 0d0a 2020 2020 2020 2020 6966     )..        if
-00008080: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-00008090: 746f 5f65 7073 672c 2069 6e74 293a 0d0a  to_epsg, int):..
-000080a0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-000080b0: 6520 5479 7065 4572 726f 7228 0d0a 2020  e TypeError(..  
-000080c0: 2020 2020 2020 2020 2020 2020 2020 2270                "p
-000080d0: 6c65 6173 6520 656e 7465 7220 636f 7272  lease enter corr
-000080e0: 6563 7420 696e 7465 6765 7220 6e75 6d62  ect integer numb
-000080f0: 6572 2066 6f72 2074 6f5f 6570 7367 206d  er for to_epsg m
-00008100: 6f72 6520 696e 666f 726d 6174 696f 6e20  ore information 
-00008110: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
-00008120: 2020 2066 2268 7474 7073 3a2f 2f65 7073     f"https://eps
-00008130: 672e 696f 2f2c 2067 6976 656e 207b 7479  g.io/, given {ty
-00008140: 7065 2874 6f5f 6570 7367 297d 220d 0a20  pe(to_epsg)}".. 
-00008150: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
-00008160: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
-00008170: 6e73 7461 6e63 6528 7265 7361 6d70 6c65  nstance(resample
-00008180: 5f74 6563 686e 6971 7565 2c20 7374 7229  _technique, str)
-00008190: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
-000081a0: 6169 7365 2054 7970 6545 7272 6f72 280d  aise TypeError(.
-000081b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000081c0: 2022 706c 6561 7365 2065 6e74 6572 2063   "please enter c
-000081d0: 6f72 7265 6374 2072 6573 616d 706c 655f  orrect resample_
-000081e0: 7465 6368 6e69 7175 6520 6d6f 7265 2069  technique more i
-000081f0: 6e66 6f72 6d61 7469 6f6e 2073 6565 2022  nformation see "
-00008200: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00008210: 2020 2264 6f63 6d65 6e74 6174 696f 6e20    "docmentation 
-00008220: 220d 0a20 2020 2020 2020 2020 2020 2029  "..            )
-00008230: 0d0a 0d0a 2020 2020 2020 2020 6966 2072  ....        if r
-00008240: 6573 616d 706c 655f 7465 6368 6e69 7175  esample_techniqu
-00008250: 6520 3d3d 2022 4e65 6172 6573 7422 3a0d  e == "Nearest":.
-00008260: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-00008270: 616d 706c 655f 7465 6368 6e69 7175 6520  ample_technique 
-00008280: 3d20 6764 616c 2e47 5241 5f4e 6561 7265  = gdal.GRA_Neare
-00008290: 7374 4e65 6967 6862 6f75 720d 0a20 2020  stNeighbour..   
-000082a0: 2020 2020 2065 6c69 6620 7265 7361 6d70       elif resamp
-000082b0: 6c65 5f74 6563 686e 6971 7565 203d 3d20  le_technique == 
-000082c0: 2263 7562 6963 223a 0d0a 2020 2020 2020  "cubic":..      
-000082d0: 2020 2020 2020 7265 7361 6d70 6c65 5f74        resample_t
-000082e0: 6563 686e 6971 7565 203d 2067 6461 6c2e  echnique = gdal.
-000082f0: 4752 415f 4375 6269 630d 0a20 2020 2020  GRA_Cubic..     
-00008300: 2020 2065 6c69 6620 7265 7361 6d70 6c65     elif resample
-00008310: 5f74 6563 686e 6971 7565 203d 3d20 2262  _technique == "b
-00008320: 696c 696e 6561 7222 3a0d 0a20 2020 2020  ilinear":..     
-00008330: 2020 2020 2020 2072 6573 616d 706c 655f         resample_
-00008340: 7465 6368 6e69 7175 6520 3d20 6764 616c  technique = gdal
-00008350: 2e47 5241 5f42 696c 696e 6561 720d 0a0d  .GRA_Bilinear...
-00008360: 0a20 2020 2020 2020 2069 6620 6f70 7469  .        if opti
-00008370: 6f6e 203d 3d20 313a 0d0a 2020 2020 2020  on == 1:..      
-00008380: 2020 2020 2020 7372 635f 7072 6f6a 203d        src_proj =
-00008390: 2073 7263 2e47 6574 5072 6f6a 6563 7469   src.GetProjecti
-000083a0: 6f6e 2829 0d0a 2020 2020 2020 2020 2020  on()..          
-000083b0: 2020 7372 635f 6774 203d 2073 7263 2e47    src_gt = src.G
-000083c0: 6574 4765 6f54 7261 6e73 666f 726d 2829  etGeoTransform()
-000083d0: 0d0a 2020 2020 2020 2020 2020 2020 7372  ..            sr
-000083e0: 635f 7820 3d20 7372 632e 5261 7374 6572  c_x = src.Raster
-000083f0: 5853 697a 650d 0a20 2020 2020 2020 2020  XSize..         
-00008400: 2020 2073 7263 5f79 203d 2073 7263 2e52     src_y = src.R
-00008410: 6173 7465 7259 5369 7a65 0d0a 0d0a 2020  asterYSize....  
-00008420: 2020 2020 2020 2020 2020 7372 635f 7372            src_sr
-00008430: 203d 206f 7372 2e53 7061 7469 616c 5265   = osr.SpatialRe
-00008440: 6665 7265 6e63 6528 776b 743d 7372 635f  ference(wkt=src_
-00008450: 7072 6f6a 290d 0a20 2020 2020 2020 2020  proj)..         
-00008460: 2020 2073 7263 5f65 7073 6720 3d20 7372     src_epsg = sr
-00008470: 635f 7372 2e47 6574 4174 7472 5661 6c75  c_sr.GetAttrValu
-00008480: 6528 2241 5554 484f 5249 5459 222c 2031  e("AUTHORITY", 1
-00008490: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
-000084a0: 2023 2323 2064 6973 7469 6e61 7469 6f6e   ### distination
-000084b0: 2072 6173 7465 720d 0a20 2020 2020 2020   raster..       
-000084c0: 2020 2020 2023 2073 7061 7469 616c 2072       # spatial r
-000084d0: 6566 0d0a 2020 2020 2020 2020 2020 2020  ef..            
-000084e0: 6473 745f 7372 203d 206f 7372 2e53 7061  dst_sr = osr.Spa
-000084f0: 7469 616c 5265 6665 7265 6e63 6528 290d  tialReference().
-00008500: 0a20 2020 2020 2020 2020 2020 2064 7374  .            dst
-00008510: 5f73 722e 496d 706f 7274 4672 6f6d 4550  _sr.ImportFromEP
-00008520: 5347 2874 6f5f 6570 7367 290d 0a0d 0a20  SG(to_epsg).... 
-00008530: 2020 2020 2020 2020 2020 2023 2069 6e20             # in 
-00008540: 6361 7365 2074 6865 2073 6f75 7263 6520  case the source 
-00008550: 6372 7320 6973 2047 4353 2061 6e64 206c  crs is GCS and l
-00008560: 6f6e 6769 7475 6465 2069 7320 696e 2074  ongitude is in t
-00008570: 6865 2077 6573 7420 6865 6d69 7370 6865  he west hemisphe
-00008580: 7265 2067 6461 6c0d 0a20 2020 2020 2020  re gdal..       
-00008590: 2020 2020 2023 2072 6561 6473 206c 6f6e       # reads lon
-000085a0: 6769 7475 6465 2066 726f 6d20 3020 746f  gitude from 0 to
-000085b0: 2033 3630 2061 6e64 2074 7261 6e73 666f   360 and transfo
-000085c0: 726d 6174 696f 6e20 6661 6374 6f72 2077  rmation factor w
-000085d0: 6f6e 7420 776f 726b 2077 6974 6820 7661  ont work with va
-000085e0: 6c75 6573 0d0a 2020 2020 2020 2020 2020  lues..          
-000085f0: 2020 2320 6772 6561 7465 7220 7468 616e    # greater than
-00008600: 2031 3830 0d0a 2020 2020 2020 2020 2020   180..          
-00008610: 2020 6966 2073 7263 5f65 7073 6720 213d    if src_epsg !=
-00008620: 2073 7472 2874 6f5f 6570 7367 293a 0d0a   str(to_epsg):..
-00008630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008640: 6966 2073 7263 5f65 7073 6720 3d3d 2022  if src_epsg == "
-00008650: 3433 3236 2220 616e 6420 7372 635f 6774  4326" and src_gt
-00008660: 5b30 5d20 3e20 3138 303a 0d0a 2020 2020  [0] > 180:..    
-00008670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008680: 6c6e 675f 6e65 7720 3d20 7372 635f 6774  lng_new = src_gt
-00008690: 5b30 5d20 2d20 3336 300d 0a20 2020 2020  [0] - 360..     
-000086a0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-000086b0: 2074 7261 6e73 666f 726d 6174 696f 6e20   transformation 
-000086c0: 6661 6374 6f72 730d 0a20 2020 2020 2020  factors..       
-000086d0: 2020 2020 2020 2020 2020 2020 2074 7820               tx 
-000086e0: 3d20 6f73 722e 436f 6f72 6469 6e61 7465  = osr.Coordinate
-000086f0: 5472 616e 7366 6f72 6d61 7469 6f6e 2873  Transformation(s
-00008700: 7263 5f73 722c 2064 7374 5f73 7229 0d0a  rc_sr, dst_sr)..
-00008710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008720: 2020 2020 2320 7472 616e 7366 6f72 6d20      # transform 
-00008730: 7468 6520 7269 6768 7420 7570 7065 7220  the right upper 
-00008740: 636f 726e 6572 2070 6f69 6e74 0d0a 2020  corner point..  
-00008750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008760: 2020 2875 6c78 2c20 756c 792c 2075 6c7a    (ulx, uly, ulz
-00008770: 2920 3d20 7478 2e54 7261 6e73 666f 726d  ) = tx.Transform
-00008780: 506f 696e 7428 6c6e 675f 6e65 772c 2073  Point(lng_new, s
-00008790: 7263 5f67 745b 335d 290d 0a20 2020 2020  rc_gt[3])..     
-000087a0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-000087b0: 2074 7261 6e73 666f 726d 2074 6865 2072   transform the r
-000087c0: 6967 6874 206c 6f77 6572 2063 6f72 6e65  ight lower corne
-000087d0: 7220 706f 696e 740d 0a20 2020 2020 2020  r point..       
-000087e0: 2020 2020 2020 2020 2020 2020 2028 6c72               (lr
-000087f0: 782c 206c 7279 2c20 6c72 7a29 203d 2074  x, lry, lrz) = t
-00008800: 782e 5472 616e 7366 6f72 6d50 6f69 6e74  x.TransformPoint
-00008810: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-00008820: 2020 2020 2020 2020 2020 206c 6e67 5f6e             lng_n
-00008830: 6577 202b 2073 7263 5f67 745b 315d 202a  ew + src_gt[1] *
-00008840: 2073 7263 5f78 2c20 7372 635f 6774 5b33   src_x, src_gt[3
-00008850: 5d20 2b20 7372 635f 6774 5b35 5d20 2a20  ] + src_gt[5] * 
-00008860: 7372 635f 790d 0a20 2020 2020 2020 2020  src_y..         
-00008870: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
-00008880: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00008890: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-000088a0: 2020 2020 2020 2020 2078 7320 3d20 5b73           xs = [s
-000088b0: 7263 5f67 745b 305d 2c20 7372 635f 6774  rc_gt[0], src_gt
-000088c0: 5b30 5d20 2b20 7372 635f 6774 5b31 5d20  [0] + src_gt[1] 
-000088d0: 2a20 7372 635f 785d 0d0a 2020 2020 2020  * src_x]..      
-000088e0: 2020 2020 2020 2020 2020 2020 2020 7973                ys
-000088f0: 203d 205b 7372 635f 6774 5b33 5d2c 2073   = [src_gt[3], s
-00008900: 7263 5f67 745b 335d 202b 2073 7263 5f67  rc_gt[3] + src_g
-00008910: 745b 355d 202a 2073 7263 5f79 5d0d 0a0d  t[5] * src_y]...
-00008920: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008930: 2020 2020 2066 726f 6d5f 6570 7367 203d       from_epsg =
-00008940: 2069 6e74 2873 7263 5f65 7073 6729 0d0a   int(src_epsg)..
-00008950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008960: 2020 2020 5b75 6c79 2c20 6c72 795d 2c20      [uly, lry], 
-00008970: 5b75 6c78 2c20 6c72 785d 203d 2056 6563  [ulx, lrx] = Vec
-00008980: 746f 722e 7265 7072 6f6a 6563 7450 6f69  tor.reprojectPoi
-00008990: 6e74 7328 0d0a 2020 2020 2020 2020 2020  nts(..          
-000089a0: 2020 2020 2020 2020 2020 2020 2020 7973                ys
-000089b0: 2c20 7873 2c20 6672 6f6d 5f65 7073 673d  , xs, from_epsg=
-000089c0: 6672 6f6d 5f65 7073 672c 2074 6f5f 6570  from_epsg, to_ep
-000089d0: 7367 3d74 6f5f 6570 7367 0d0a 2020 2020  sg=to_epsg..    
-000089e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000089f0: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-00008a00: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00008a10: 2020 2020 2020 756c 7820 3d20 7372 635f        ulx = src_
-00008a20: 6774 5b30 5d0d 0a20 2020 2020 2020 2020  gt[0]..         
-00008a30: 2020 2020 2020 2075 6c79 203d 2073 7263         uly = src
-00008a40: 5f67 745b 335d 0d0a 2020 2020 2020 2020  _gt[3]..        
-00008a50: 2020 2020 2020 2020 6c72 7820 3d20 7372          lrx = sr
-00008a60: 635f 6774 5b30 5d20 2b20 7372 635f 6774  c_gt[0] + src_gt
-00008a70: 5b31 5d20 2a20 7372 635f 780d 0a20 2020  [1] * src_x..   
-00008a80: 2020 2020 2020 2020 2020 2020 206c 7279               lry
-00008a90: 203d 2073 7263 5f67 745b 335d 202b 2073   = src_gt[3] + s
-00008aa0: 7263 5f67 745b 355d 202a 2073 7263 5f79  rc_gt[5] * src_y
-00008ab0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00008ac0: 2320 6765 7420 7468 6520 6365 6c6c 2073  # get the cell s
-00008ad0: 697a 6520 696e 2074 6865 2073 6f75 7263  ize in the sourc
-00008ae0: 6520 7261 7374 6572 2061 6e64 2063 6f6e  e raster and con
-00008af0: 7665 7274 2069 7420 746f 2074 6865 206e  vert it to the n
-00008b00: 6577 2063 7273 0d0a 2020 2020 2020 2020  ew crs..        
-00008b10: 2020 2020 2320 7820 636f 6f72 6469 6e61      # x coordina
-00008b20: 7465 7320 6f72 206c 6f6e 6769 7475 6465  tes or longitude
-00008b30: 730d 0a20 2020 2020 2020 2020 2020 2078  s..            x
-00008b40: 7320 3d20 5b73 7263 5f67 745b 305d 2c20  s = [src_gt[0], 
-00008b50: 7372 635f 6774 5b30 5d20 2b20 7372 635f  src_gt[0] + src_
-00008b60: 6774 5b31 5d5d 0d0a 2020 2020 2020 2020  gt[1]]..        
-00008b70: 2020 2020 2320 7920 636f 6f72 6469 6e61      # y coordina
-00008b80: 7465 7320 6f72 206c 6174 6974 7564 6573  tes or latitudes
-00008b90: 0d0a 2020 2020 2020 2020 2020 2020 7973  ..            ys
-00008ba0: 203d 205b 7372 635f 6774 5b33 5d2c 2073   = [src_gt[3], s
-00008bb0: 7263 5f67 745b 335d 5d0d 0a0d 0a20 2020  rc_gt[3]]....   
-00008bc0: 2020 2020 2020 2020 2069 6620 7372 635f           if src_
-00008bd0: 6570 7367 2021 3d20 7374 7228 746f 5f65  epsg != str(to_e
-00008be0: 7073 6729 3a0d 0a20 2020 2020 2020 2020  psg):..         
-00008bf0: 2020 2020 2020 2023 2074 7261 6e73 666f         # transfo
-00008c00: 726d 2074 6865 2074 776f 2070 6f69 6e74  rm the two point
-00008c10: 7320 636f 6f72 6469 6e61 7465 7320 746f  s coordinates to
-00008c20: 2074 6865 206e 6577 2063 7273 2074 6f20   the new crs to 
-00008c30: 6361 6c63 756c 6174 6520 7468 6520 6e65  calculate the ne
-00008c40: 7720 6365 6c6c 2073 697a 650d 0a20 2020  w cell size..   
-00008c50: 2020 2020 2020 2020 2020 2020 2066 726f               fro
-00008c60: 6d5f 6570 7367 203d 2069 6e74 2873 7263  m_epsg = int(src
-00008c70: 5f65 7073 6729 0d0a 2020 2020 2020 2020  _epsg)..        
-00008c80: 2020 2020 2020 2020 6e65 775f 7973 2c20          new_ys, 
-00008c90: 6e65 775f 7873 203d 2056 6563 746f 722e  new_xs = Vector.
-00008ca0: 7265 7072 6f6a 6563 7450 6f69 6e74 7328  reprojectPoints(
-00008cb0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00008cc0: 2020 2020 2020 7973 2c20 7873 2c20 6672        ys, xs, fr
-00008cd0: 6f6d 5f65 7073 673d 6672 6f6d 5f65 7073  om_epsg=from_eps
-00008ce0: 672c 2074 6f5f 6570 7367 3d74 6f5f 6570  g, to_epsg=to_ep
-00008cf0: 7367 2c20 7072 6563 6973 696f 6e3d 360d  sg, precision=6.
-00008d00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008d10: 2029 2020 2320 696e 7428 6473 745f 6570   )  # int(dst_ep
-00008d20: 7367 2e47 6574 4174 7472 5661 6c75 6528  sg.GetAttrValue(
-00008d30: 2741 5554 484f 5249 5459 272c 3129 290d  'AUTHORITY',1)).
-00008d40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008d50: 2023 206e 6577 5f78 732c 206e 6577 5f79   # new_xs, new_y
-00008d60: 733d 2056 6563 746f 722e 5265 7072 6f6a  s= Vector.Reproj
-00008d70: 6563 7450 6f69 6e74 735f 3228 7973 2c78  ectPoints_2(ys,x
-00008d80: 732c 6672 6f6d 5f65 7073 673d 696e 7428  s,from_epsg=int(
-00008d90: 7372 635f 6570 7367 2e47 6574 4174 7472  src_epsg.GetAttr
-00008da0: 5661 6c75 6528 2741 5554 484f 5249 5459  Value('AUTHORITY
-00008db0: 272c 3129 292c 0d0a 2020 2020 2020 2020  ',1)),..        
-00008dc0: 2020 2020 2020 2020 2320 2020 2020 2020          #       
-00008dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008de0: 2020 2020 2020 2020 2020 2074 6f5f 6570             to_ep
-00008df0: 7367 3d69 6e74 2864 7374 5f65 7073 672e  sg=int(dst_epsg.
-00008e00: 4765 7441 7474 7256 616c 7565 2827 4155  GetAttrValue('AU
-00008e10: 5448 4f52 4954 5927 2c31 2929 290d 0a20  THORITY',1))).. 
-00008e20: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00008e30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00008e40: 2020 6e65 775f 7873 203d 2078 730d 0a20    new_xs = xs.. 
-00008e50: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00008e60: 206e 6577 5f79 7320 3d20 7973 0d0a 0d0a   new_ys = ys....
-00008e70: 2020 2020 2020 2020 2020 2020 7069 7865              pixe
-00008e80: 6c5f 7370 6163 696e 6720 3d20 6e70 2e61  l_spacing = np.a
-00008e90: 6273 286e 6577 5f78 735b 305d 202d 206e  bs(new_xs[0] - n
-00008ea0: 6577 5f78 735b 315d 290d 0a0d 0a20 2020  ew_xs[1])....   
-00008eb0: 2020 2020 2020 2020 2023 2063 7265 6174           # creat
-00008ec0: 6520 6120 6e65 7720 7261 7374 6572 0d0a  e a new raster..
-00008ed0: 2020 2020 2020 2020 2020 2020 636f 6c73              cols
-00008ee0: 203d 2069 6e74 286e 702e 726f 756e 6428   = int(np.round(
-00008ef0: 6162 7328 6c72 7820 2d20 756c 7829 202f  abs(lrx - ulx) /
-00008f00: 2070 6978 656c 5f73 7061 6369 6e67 2929   pixel_spacing))
-00008f10: 0d0a 2020 2020 2020 2020 2020 2020 726f  ..            ro
-00008f20: 7773 203d 2069 6e74 286e 702e 726f 756e  ws = int(np.roun
-00008f30: 6428 6162 7328 756c 7920 2d20 6c72 7929  d(abs(uly - lry)
-00008f40: 202f 2070 6978 656c 5f73 7061 6369 6e67   / pixel_spacing
-00008f50: 2929 0d0a 0d0a 2020 2020 2020 2020 2020  ))....          
-00008f60: 2020 6474 7970 6520 3d20 7372 632e 4765    dtype = src.Ge
-00008f70: 7452 6173 7465 7242 616e 6428 3129 2e44  tRasterBand(1).D
-00008f80: 6174 6154 7970 650d 0a20 2020 2020 2020  ataType..       
-00008f90: 2020 2020 2064 7374 203d 2052 6173 7465       dst = Raste
-00008fa0: 722e 5f63 7265 6174 6544 6174 6173 6574  r._createDataset
-00008fb0: 2863 6f6c 732c 2072 6f77 732c 2031 2c20  (cols, rows, 1, 
-00008fc0: 6474 7970 6529 0d0a 0d0a 2020 2020 2020  dtype)....      
-00008fd0: 2020 2020 2020 2320 6e65 7720 6765 6f74        # new geot
-00008fe0: 7261 6e73 666f 726d 0d0a 2020 2020 2020  ransform..      
-00008ff0: 2020 2020 2020 6e65 775f 6765 6f20 3d20        new_geo = 
-00009000: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-00009010: 2020 2075 6c78 2c0d 0a20 2020 2020 2020     ulx,..       
-00009020: 2020 2020 2020 2020 2070 6978 656c 5f73           pixel_s
-00009030: 7061 6369 6e67 2c0d 0a20 2020 2020 2020  pacing,..       
-00009040: 2020 2020 2020 2020 2073 7263 5f67 745b           src_gt[
-00009050: 325d 2c0d 0a20 2020 2020 2020 2020 2020  2],..           
-00009060: 2020 2020 2075 6c79 2c0d 0a20 2020 2020       uly,..     
-00009070: 2020 2020 2020 2020 2020 2073 7263 5f67             src_g
-00009080: 745b 345d 2c0d 0a20 2020 2020 2020 2020  t[4],..         
-00009090: 2020 2020 2020 206e 702e 7369 676e 2873         np.sign(s
-000090a0: 7263 5f67 745b 2d31 5d29 202a 2070 6978  rc_gt[-1]) * pix
-000090b0: 656c 5f73 7061 6369 6e67 2c0d 0a20 2020  el_spacing,..   
-000090c0: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
-000090d0: 2020 2020 2020 2020 2320 7365 7420 7468          # set th
-000090e0: 6520 6765 6f74 7261 6e73 666f 726d 0d0a  e geotransform..
-000090f0: 2020 2020 2020 2020 2020 2020 6473 742e              dst.
-00009100: 5365 7447 656f 5472 616e 7366 6f72 6d28  SetGeoTransform(
-00009110: 6e65 775f 6765 6f29 0d0a 2020 2020 2020  new_geo)..      
-00009120: 2020 2020 2020 2320 7365 7420 7468 6520        # set the 
-00009130: 7072 6f6a 6563 7469 6f6e 0d0a 2020 2020  projection..    
-00009140: 2020 2020 2020 2020 6473 742e 5365 7450          dst.SetP
-00009150: 726f 6a65 6374 696f 6e28 6473 745f 7372  rojection(dst_sr
-00009160: 2e45 7870 6f72 7454 6f57 6b74 2829 290d  .ExportToWkt()).
-00009170: 0a20 2020 2020 2020 2020 2020 2023 2073  .            # s
-00009180: 6574 2074 6865 206e 6f20 6461 7461 2076  et the no data v
-00009190: 616c 7565 0d0a 2020 2020 2020 2020 2020  alue..          
-000091a0: 2020 6e6f 5f64 6174 615f 7661 6c75 6520    no_data_value 
-000091b0: 3d20 7372 632e 4765 7452 6173 7465 7242  = src.GetRasterB
-000091c0: 616e 6428 3129 2e47 6574 4e6f 4461 7461  and(1).GetNoData
-000091d0: 5661 6c75 6528 290d 0a20 2020 2020 2020  Value()..       
-000091e0: 2020 2020 2064 7374 203d 2052 6173 7465       dst = Raste
-000091f0: 722e 7365 744e 6f44 6174 6156 616c 7565  r.setNoDataValue
-00009200: 2864 7374 2c20 6e6f 5f64 6174 615f 7661  (dst, no_data_va
-00009210: 6c75 6529 0d0a 2020 2020 2020 2020 2020  lue)..          
-00009220: 2020 2320 7065 7266 6f72 6d20 7468 6520    # perform the 
-00009230: 7072 6f6a 6563 7469 6f6e 2026 2072 6573  projection & res
-00009240: 616d 706c 696e 670d 0a20 2020 2020 2020  ampling..       
-00009250: 2020 2020 2067 6461 6c2e 5265 7072 6f6a       gdal.Reproj
-00009260: 6563 7449 6d61 6765 280d 0a20 2020 2020  ectImage(..     
-00009270: 2020 2020 2020 2020 2020 2073 7263 2c0d             src,.
-00009280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009290: 2064 7374 2c0d 0a20 2020 2020 2020 2020   dst,..         
-000092a0: 2020 2020 2020 2073 7263 5f73 722e 4578         src_sr.Ex
-000092b0: 706f 7274 546f 576b 7428 292c 0d0a 2020  portToWkt(),..  
-000092c0: 2020 2020 2020 2020 2020 2020 2020 6473                ds
-000092d0: 745f 7372 2e45 7870 6f72 7454 6f57 6b74  t_sr.ExportToWkt
-000092e0: 2829 2c0d 0a20 2020 2020 2020 2020 2020  (),..           
-000092f0: 2020 2020 2072 6573 616d 706c 655f 7465       resample_te
-00009300: 6368 6e69 7175 652c 0d0a 2020 2020 2020  chnique,..      
-00009310: 2020 2020 2020 290d 0a0d 0a20 2020 2020        )....     
-00009320: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00009330: 2020 2020 2020 6473 7420 3d20 6764 616c        dst = gdal
-00009340: 2e57 6172 7028 2222 2c20 7372 632c 2064  .Warp("", src, d
-00009350: 7374 5352 533d 2245 5053 473a 2220 2b20  stSRS="EPSG:" + 
-00009360: 7374 7228 746f 5f65 7073 6729 2c20 666f  str(to_epsg), fo
-00009370: 726d 6174 3d22 5652 5422 290d 0a0d 0a20  rmat="VRT").... 
-00009380: 2020 2020 2020 2072 6574 7572 6e20 6473         return ds
-00009390: 740d 0a0d 0a20 2020 2023 2054 4f44 4f3a  t....    # TODO:
-000093a0: 206d 6572 6765 2052 6570 726f 6a65 6374   merge Reproject
-000093b0: 4461 7461 7365 7420 616e 6420 5072 6f6a  Dataset and Proj
-000093c0: 6563 7452 6173 7465 7220 7468 6579 2061  ectRaster they a
-000093d0: 7265 2061 6c6d 6f73 7420 7468 6520 7361  re almost the sa
-000093e0: 6d65 0d0a 2020 2020 2320 544f 444f 3a20  me..    # TODO: 
-000093f0: 7374 696c 6c20 6e65 6564 7320 746f 2062  still needs to b
-00009400: 6520 7465 7374 6564 0d0a 2020 2020 4073  e tested..    @s
-00009410: 7461 7469 636d 6574 686f 640d 0a20 2020  taticmethod..   
-00009420: 2064 6566 2072 6570 726f 6a65 6374 4461   def reprojectDa
-00009430: 7461 7365 7428 0d0a 2020 2020 2020 2020  taset(..        
-00009440: 7372 633a 2044 6174 6173 6574 2c0d 0a20  src: Dataset,.. 
-00009450: 2020 2020 2020 2074 6f5f 6570 7367 3a20         to_epsg: 
-00009460: 696e 7420 3d20 3338 3537 2c0d 0a20 2020  int = 3857,..   
-00009470: 2020 2020 2063 656c 6c5f 7369 7a65 3a20       cell_size: 
-00009480: 696e 7420 3d20 5b5d 2c0d 0a20 2020 2020  int = [],..     
-00009490: 2020 2072 6573 616d 706c 655f 7465 6368     resample_tech
-000094a0: 6e69 7175 653a 2073 7472 203d 2022 4e65  nique: str = "Ne
-000094b0: 6172 6573 7422 2c0d 0a20 2020 2029 202d  arest",..    ) -
-000094c0: 3e20 4461 7461 7365 743a 0d0a 2020 2020  > Dataset:..    
-000094d0: 2020 2020 2222 2252 6570 726f 6a65 6374      """Reproject
-000094e0: 4461 7461 7365 742e 0d0a 0d0a 2020 2020  Dataset.....    
-000094f0: 2020 2020 5265 7072 6f6a 6563 7444 6174      ReprojectDat
-00009500: 6173 6574 2072 6570 726f 6a65 6374 7320  aset reprojects 
-00009510: 616e 6420 7265 7361 6d70 6c65 7320 6120  and resamples a 
-00009520: 666f 6c64 6572 206f 6620 7261 7374 6572  folder of raster
-00009530: 7320 746f 2061 6e79 2070 726f 6a65 6374  s to any project
-00009540: 696f 6e0d 0a20 2020 2020 2020 2028 6465  ion..        (de
-00009550: 6661 756c 7420 7468 6520 5747 5338 3420  fault the WGS84 
-00009560: 7765 6220 6d65 7263 6174 6f72 2070 726f  web mercator pro
-00009570: 6a65 6374 696f 6e2c 2077 6974 686f 7574  jection, without
-00009580: 2072 6573 616d 706c 696e 6729 0d0a 0d0a   resampling)....
-00009590: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-000095a0: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
-000095b0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-000095c0: 7372 633a 205b 6764 616c 2064 6174 6173  src: [gdal datas
-000095d0: 6574 5d0d 0a20 2020 2020 2020 2020 2020  et]..           
-000095e0: 2067 6461 6c20 6461 7461 7365 7420 6f62   gdal dataset ob
-000095f0: 6a65 6374 2028 7372 633d 6764 616c 2e4f  ject (src=gdal.O
-00009600: 7065 6e28 2264 656d 2e74 6966 2229 290d  pen("dem.tif")).
-00009610: 0a20 2020 2020 2020 2074 6f5f 6570 7367  .        to_epsg
-00009620: 3a20 5b69 6e74 6567 6572 5d0d 0a20 2020  : [integer]..   
-00009630: 2020 2020 2020 2020 2020 7265 6665 7265            refere
-00009640: 6e63 6520 6e75 6d62 6572 2074 6f20 7468  nce number to th
-00009650: 6520 6e65 7720 7072 6f6a 6563 7469 6f6e  e new projection
-00009660: 2028 6874 7470 733a 2f2f 6570 7367 2e69   (https://epsg.i
-00009670: 6f2f 290d 0a20 2020 2020 2020 2020 2020  o/)..           
-00009680: 2028 6465 6661 756c 7420 3338 3537 2074   (default 3857 t
-00009690: 6865 2072 6566 6572 656e 6365 206e 6f20  he reference no 
-000096a0: 6f66 2057 4753 3834 2077 6562 206d 6572  of WGS84 web mer
-000096b0: 6361 746f 7220 290d 0a20 2020 2020 2020  cator )..       
-000096c0: 2063 656c 6c5f 7369 7a65 3a20 5b69 6e74   cell_size: [int
-000096d0: 6567 6572 5d0d 0a20 2020 2020 2020 2020  eger]..         
-000096e0: 2020 2020 6e75 6d62 6572 2074 6f20 7265      number to re
-000096f0: 7361 6d70 6c65 2074 6865 2072 6173 7465  sample the raste
-00009700: 7220 6365 6c6c 2073 697a 6520 746f 2061  r cell size to a
-00009710: 206e 6577 2063 656c 6c20 7369 7a65 0d0a   new cell size..
-00009720: 2020 2020 2020 2020 2020 2020 2864 6566              (def
-00009730: 6175 6c74 2065 6d70 7479 2073 6f20 7261  ault empty so ra
-00009740: 7374 6572 2077 696c 6c20 6e6f 7420 6265  ster will not be
-00009750: 2072 6573 616d 706c 6564 290d 0a20 2020   resampled)..   
-00009760: 2020 2020 2072 6573 616d 706c 655f 7465       resample_te
-00009770: 6368 6e69 7175 653a 205b 5374 7269 6e67  chnique: [String
-00009780: 5d0d 0a20 2020 2020 2020 2020 2020 2072  ]..            r
-00009790: 6573 616d 706c 696e 6720 7465 6368 6e69  esampling techni
-000097a0: 7175 6520 6465 6661 756c 7420 6973 2022  que default is "
-000097b0: 4e65 6172 6573 7422 0d0a 2020 2020 2020  Nearest"..      
-000097c0: 2020 2020 2020 6874 7470 733a 2f2f 6769        https://gi
-000097d0: 7367 656f 6772 6170 6879 2e63 6f6d 2f72  sgeography.com/r
-000097e0: 6173 7465 722d 7265 7361 6d70 6c69 6e67  aster-resampling
-000097f0: 2f0d 0a20 2020 2020 2020 2020 2020 2022  /..            "
-00009800: 4e65 6172 6573 7422 2066 6f72 206e 6561  Nearest" for nea
-00009810: 7265 7374 206e 6569 6768 626f 7572 2c22  rest neighbour,"
-00009820: 6375 6269 6322 2066 6f72 2063 7562 6963  cubic" for cubic
-00009830: 2063 6f6e 766f 6c75 7469 6f6e 2c0d 0a20   convolution,.. 
-00009840: 2020 2020 2020 2020 2020 2022 6269 6c69             "bili
-00009850: 6e65 6172 2220 666f 7220 6269 6c69 6e65  near" for biline
-00009860: 6172 0d0a 0d0a 2020 2020 2020 2020 5265  ar....        Re
-00009870: 7475 726e 730d 0a20 2020 2020 2020 202d  turns..        -
-00009880: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-00009890: 7261 7374 6572 3a20 5b67 6461 6c20 4461  raster: [gdal Da
-000098a0: 7461 7365 745d 0d0a 2020 2020 2020 2020  taset]..        
-000098b0: 2020 2020 2061 2047 4441 4c20 696e 2d6d       a GDAL in-m
-000098c0: 656d 6f72 7920 6669 6c65 206f 626a 6563  emory file objec
-000098d0: 742c 2077 6865 7265 2079 6f75 2063 616e  t, where you can
-000098e0: 2052 6561 6441 7341 7272 6179 2065 7463   ReadAsArray etc
-000098f0: 2e0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
-00009900: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
-00009910: 7369 6e73 7461 6e63 6528 7372 632c 2067  sinstance(src, g
-00009920: 6461 6c2e 4461 7461 7365 7429 3a0d 0a20  dal.Dataset):.. 
-00009930: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00009940: 2054 7970 6545 7272 6f72 280d 0a20 2020   TypeError(..   
-00009950: 2020 2020 2020 2020 2020 2020 2022 7372               "sr
-00009960: 6320 7368 6f75 6c64 2062 6520 7265 6164  c should be read
-00009970: 2075 7369 6e67 2067 6461 6c20 2867 6461   using gdal (gda
-00009980: 6c20 6461 7461 7365 7420 706c 6561 7365  l dataset please
-00009990: 2072 6561 6420 6974 2075 7369 6e67 2067   read it using g
-000099a0: 6461 6c22 0d0a 2020 2020 2020 2020 2020  dal"..          
-000099b0: 2020 2020 2020 6622 206c 6962 7261 7279        f" library
-000099c0: 2920 6769 7665 6e20 7b74 7970 6528 7372  ) given {type(sr
-000099d0: 6329 7d22 0d0a 2020 2020 2020 2020 2020  c)}"..          
-000099e0: 2020 290d 0a20 2020 2020 2020 2069 6620    )..        if 
-000099f0: 6e6f 7420 6973 696e 7374 616e 6365 2874  not isinstance(t
-00009a00: 6f5f 6570 7367 2c20 696e 7429 3a0d 0a20  o_epsg, int):.. 
-00009a10: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00009a20: 2054 7970 6545 7272 6f72 280d 0a20 2020   TypeError(..   
-00009a30: 2020 2020 2020 2020 2020 2020 2022 706c               "pl
-00009a40: 6561 7365 2065 6e74 6572 2063 6f72 7265  ease enter corre
-00009a50: 6374 2069 6e74 6567 6572 206e 756d 6265  ct integer numbe
-00009a60: 7220 666f 7220 746f 5f65 7073 6720 6d6f  r for to_epsg mo
-00009a70: 7265 2069 6e66 6f72 6d61 7469 6f6e 2022  re information "
-00009a80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00009a90: 2020 6622 6874 7470 733a 2f2f 6570 7367    f"https://epsg
-00009aa0: 2e69 6f2f 2c20 6769 7665 6e20 7b74 7970  .io/, given {typ
-00009ab0: 6528 746f 5f65 7073 6729 7d22 0d0a 2020  e(to_epsg)}"..  
-00009ac0: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
-00009ad0: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
-00009ae0: 7374 616e 6365 2872 6573 616d 706c 655f  stance(resample_
-00009af0: 7465 6368 6e69 7175 652c 2073 7472 293a  technique, str):
-00009b00: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
-00009b10: 6973 6520 5479 7065 4572 726f 7228 0d0a  ise TypeError(..
-00009b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009b30: 2270 6c65 6173 6520 656e 7465 7220 636f  "please enter co
-00009b40: 7272 6563 7420 7265 7361 6d70 6c65 5f74  rrect resample_t
-00009b50: 6563 686e 6971 7565 206d 6f72 6520 696e  echnique more in
-00009b60: 666f 726d 6174 696f 6e20 7365 6520 220d  formation see ".
-00009b70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009b80: 2022 646f 636d 656e 7461 7469 6f6e 2022   "docmentation "
-00009b90: 0d0a 2020 2020 2020 2020 2020 2020 290d  ..            ).
-00009ba0: 0a0d 0a20 2020 2020 2020 2069 6620 6365  ...        if ce
-00009bb0: 6c6c 5f73 697a 653a 0d0a 2020 2020 2020  ll_size:..      
-00009bc0: 2020 2020 2020 6173 7365 7274 2069 7369        assert isi
-00009bd0: 6e73 7461 6e63 6528 6365 6c6c 5f73 697a  nstance(cell_siz
-00009be0: 652c 2069 6e74 2920 6f72 2069 7369 6e73  e, int) or isins
-00009bf0: 7461 6e63 6528 0d0a 2020 2020 2020 2020  tance(..        
-00009c00: 2020 2020 2020 2020 6365 6c6c 5f73 697a          cell_siz
-00009c10: 652c 2066 6c6f 6174 0d0a 2020 2020 2020  e, float..      
-00009c20: 2020 2020 2020 292c 2022 706c 6561 7365        ), "please
-00009c30: 2065 6e74 6572 2061 6e20 696e 7465 6765   enter an intege
-00009c40: 7220 6f72 2066 6c6f 6174 2063 656c 6c20  r or float cell 
-00009c50: 7369 7a65 220d 0a0d 0a20 2020 2020 2020  size"....       
-00009c60: 2069 6620 7265 7361 6d70 6c65 5f74 6563   if resample_tec
-00009c70: 686e 6971 7565 203d 3d20 224e 6561 7265  hnique == "Neare
-00009c80: 7374 223a 0d0a 2020 2020 2020 2020 2020  st":..          
-00009c90: 2020 7265 7361 6d70 6c65 5f74 6563 686e    resample_techn
-00009ca0: 6971 7565 203d 2067 6461 6c2e 4752 415f  ique = gdal.GRA_
-00009cb0: 4e65 6172 6573 744e 6569 6768 626f 7572  NearestNeighbour
-00009cc0: 0d0a 2020 2020 2020 2020 656c 6966 2072  ..        elif r
-00009cd0: 6573 616d 706c 655f 7465 6368 6e69 7175  esample_techniqu
-00009ce0: 6520 3d3d 2022 6375 6269 6322 3a0d 0a20  e == "cubic":.. 
-00009cf0: 2020 2020 2020 2020 2020 2072 6573 616d             resam
-00009d00: 706c 655f 7465 6368 6e69 7175 6520 3d20  ple_technique = 
-00009d10: 6764 616c 2e47 5241 5f43 7562 6963 0d0a  gdal.GRA_Cubic..
-00009d20: 2020 2020 2020 2020 656c 6966 2072 6573          elif res
-00009d30: 616d 706c 655f 7465 6368 6e69 7175 6520  ample_technique 
-00009d40: 3d3d 2022 6269 6c69 6e65 6172 223a 0d0a  == "bilinear":..
-00009d50: 2020 2020 2020 2020 2020 2020 7265 7361              resa
-00009d60: 6d70 6c65 5f74 6563 686e 6971 7565 203d  mple_technique =
-00009d70: 2067 6461 6c2e 4752 415f 4269 6c69 6e65   gdal.GRA_Biline
-00009d80: 6172 0d0a 0d0a 2020 2020 2020 2020 7372  ar....        sr
-00009d90: 635f 7072 6f6a 203d 2073 7263 2e47 6574  c_proj = src.Get
-00009da0: 5072 6f6a 6563 7469 6f6e 2829 0d0a 2020  Projection()..  
-00009db0: 2020 2020 2020 7372 635f 6774 203d 2073        src_gt = s
-00009dc0: 7263 2e47 6574 4765 6f54 7261 6e73 666f  rc.GetGeoTransfo
-00009dd0: 726d 2829 0d0a 2020 2020 2020 2020 7372  rm()..        sr
-00009de0: 635f 7820 3d20 7372 632e 5261 7374 6572  c_x = src.Raster
-00009df0: 5853 697a 650d 0a20 2020 2020 2020 2073  XSize..        s
-00009e00: 7263 5f79 203d 2073 7263 2e52 6173 7465  rc_y = src.Raste
-00009e10: 7259 5369 7a65 0d0a 2020 2020 2020 2020  rYSize..        
-00009e20: 6474 7970 6520 3d20 7372 632e 4765 7452  dtype = src.GetR
-00009e30: 6173 7465 7242 616e 6428 3129 2e44 6174  asterBand(1).Dat
-00009e40: 6154 7970 650d 0a20 2020 2020 2020 2023  aType..        #
-00009e50: 2073 7061 7469 616c 2072 6566 0d0a 2020   spatial ref..  
-00009e60: 2020 2020 2020 7372 635f 7372 203d 206f        src_sr = o
-00009e70: 7372 2e53 7061 7469 616c 5265 6665 7265  sr.SpatialRefere
-00009e80: 6e63 6528 776b 743d 7372 635f 7072 6f6a  nce(wkt=src_proj
-00009e90: 290d 0a20 2020 2020 2020 2073 7263 5f65  )..        src_e
-00009ea0: 7073 6720 3d20 7372 635f 7372 2e47 6574  psg = src_sr.Get
-00009eb0: 4174 7472 5661 6c75 6528 2241 5554 484f  AttrValue("AUTHO
-00009ec0: 5249 5459 222c 2031 290d 0a0d 0a20 2020  RITY", 1)....   
-00009ed0: 2020 2020 2023 2064 6973 7469 6e61 7469       # distinati
-00009ee0: 6f6e 0d0a 2020 2020 2020 2020 2320 7370  on..        # sp
-00009ef0: 6174 6961 6c20 7265 660d 0a20 2020 2020  atial ref..     
-00009f00: 2020 2064 7374 5f65 7073 6720 3d20 6f73     dst_epsg = os
-00009f10: 722e 5370 6174 6961 6c52 6566 6572 656e  r.SpatialReferen
-00009f20: 6365 2829 0d0a 2020 2020 2020 2020 6473  ce()..        ds
-00009f30: 745f 6570 7367 2e49 6d70 6f72 7446 726f  t_epsg.ImportFro
-00009f40: 6d45 5053 4728 746f 5f65 7073 6729 0d0a  mEPSG(to_epsg)..
-00009f50: 2020 2020 2020 2020 2320 7472 616e 7366          # transf
-00009f60: 6f72 6d61 7469 6f6e 2066 6163 746f 7273  ormation factors
-00009f70: 0d0a 2020 2020 2020 2020 7478 203d 206f  ..        tx = o
-00009f80: 7372 2e43 6f6f 7264 696e 6174 6554 7261  sr.CoordinateTra
-00009f90: 6e73 666f 726d 6174 696f 6e28 7372 635f  nsformation(src_
-00009fa0: 7372 2c20 6473 745f 6570 7367 290d 0a0d  sr, dst_epsg)...
-00009fb0: 0a20 2020 2020 2020 2023 2069 6e63 6173  .        # incas
-00009fc0: 6520 7468 6520 736f 7572 6365 2063 7273  e the source crs
-00009fd0: 2069 7320 4743 5320 616e 6420 6c6f 6e67   is GCS and long
-00009fe0: 6974 7564 6520 6973 2069 6e20 7468 6520  itude is in the 
-00009ff0: 7765 7374 2068 656d 6973 7068 6572 6520  west hemisphere 
-0000a000: 6764 616c 0d0a 2020 2020 2020 2020 2320  gdal..        # 
-0000a010: 7265 6164 7320 6c6f 6e67 6974 7564 6520  reads longitude 
-0000a020: 6672 6f6e 2030 2074 6f20 3336 3020 616e  fron 0 to 360 an
-0000a030: 6420 7472 616e 7366 6f72 6d61 7469 6f6e  d transformation
-0000a040: 2066 6163 746f 7220 776f 6e74 2077 6f72   factor wont wor
-0000a050: 6b20 7769 7468 2076 616c 6575 730d 0a20  k with valeus.. 
-0000a060: 2020 2020 2020 2023 2067 7265 6174 6572         # greater
-0000a070: 2074 6861 6e20 3138 300d 0a20 2020 2020   than 180..     
-0000a080: 2020 2069 6620 7372 635f 6570 7367 203d     if src_epsg =
-0000a090: 3d20 2234 3332 3622 2061 6e64 2073 7263  = "4326" and src
-0000a0a0: 5f67 745b 305d 203e 2031 3830 3a0d 0a20  _gt[0] > 180:.. 
-0000a0b0: 2020 2020 2020 2020 2020 206c 6e67 5f6e             lng_n
-0000a0c0: 6577 203d 2073 7263 5f67 745b 305d 202d  ew = src_gt[0] -
-0000a0d0: 2033 3630 0d0a 2020 2020 2020 2020 2020   360..          
-0000a0e0: 2020 2320 7472 616e 7366 6f72 6d20 7468    # transform th
-0000a0f0: 6520 7269 6768 7420 7570 7065 7220 636f  e right upper co
-0000a100: 726e 6572 2070 6f69 6e74 0d0a 2020 2020  rner point..    
-0000a110: 2020 2020 2020 2020 2875 6c78 2c20 756c          (ulx, ul
-0000a120: 792c 2075 6c7a 2920 3d20 7478 2e54 7261  y, ulz) = tx.Tra
-0000a130: 6e73 666f 726d 506f 696e 7428 6c6e 675f  nsformPoint(lng_
-0000a140: 6e65 772c 2073 7263 5f67 745b 335d 290d  new, src_gt[3]).
-0000a150: 0a20 2020 2020 2020 2020 2020 2023 2074  .            # t
-0000a160: 7261 6e73 666f 726d 2074 6865 2072 6967  ransform the rig
-0000a170: 6874 206c 6f77 6572 2063 6f72 6e65 7220  ht lower corner 
-0000a180: 706f 696e 740d 0a20 2020 2020 2020 2020  point..         
-0000a190: 2020 2028 6c72 782c 206c 7279 2c20 6c72     (lrx, lry, lr
-0000a1a0: 7a29 203d 2074 782e 5472 616e 7366 6f72  z) = tx.Transfor
-0000a1b0: 6d50 6f69 6e74 280d 0a20 2020 2020 2020  mPoint(..       
-0000a1c0: 2020 2020 2020 2020 206c 6e67 5f6e 6577           lng_new
-0000a1d0: 202b 2073 7263 5f67 745b 315d 202a 2073   + src_gt[1] * s
-0000a1e0: 7263 5f78 2c20 7372 635f 6774 5b33 5d20  rc_x, src_gt[3] 
-0000a1f0: 2b20 7372 635f 6774 5b35 5d20 2a20 7372  + src_gt[5] * sr
-0000a200: 635f 790d 0a20 2020 2020 2020 2020 2020  c_y..           
-0000a210: 2029 0d0a 2020 2020 2020 2020 656c 7365   )..        else
-0000a220: 3a0d 0a20 2020 2020 2020 2020 2020 2023  :..            #
-0000a230: 2074 7261 6e73 666f 726d 2074 6865 2072   transform the r
-0000a240: 6967 6874 2075 7070 6572 2063 6f72 6e65  ight upper corne
-0000a250: 7220 706f 696e 740d 0a20 2020 2020 2020  r point..       
-0000a260: 2020 2020 2028 756c 782c 2075 6c79 2c20       (ulx, uly, 
-0000a270: 756c 7a29 203d 2074 782e 5472 616e 7366  ulz) = tx.Transf
-0000a280: 6f72 6d50 6f69 6e74 2873 7263 5f67 745b  ormPoint(src_gt[
-0000a290: 305d 2c20 7372 635f 6774 5b33 5d29 0d0a  0], src_gt[3])..
-0000a2a0: 2020 2020 2020 2020 2020 2020 2320 7472              # tr
-0000a2b0: 616e 7366 6f72 6d20 7468 6520 7269 6768  ansform the righ
-0000a2c0: 7420 6c6f 7765 7220 636f 726e 6572 2070  t lower corner p
-0000a2d0: 6f69 6e74 0d0a 2020 2020 2020 2020 2020  oint..          
-0000a2e0: 2020 286c 7278 2c20 6c72 792c 206c 727a    (lrx, lry, lrz
-0000a2f0: 2920 3d20 7478 2e54 7261 6e73 666f 726d  ) = tx.Transform
-0000a300: 506f 696e 7428 0d0a 2020 2020 2020 2020  Point(..        
-0000a310: 2020 2020 2020 2020 7372 635f 6774 5b30          src_gt[0
-0000a320: 5d20 2b20 7372 635f 6774 5b31 5d20 2a20  ] + src_gt[1] * 
-0000a330: 7372 635f 782c 2073 7263 5f67 745b 335d  src_x, src_gt[3]
-0000a340: 202b 2073 7263 5f67 745b 355d 202a 2073   + src_gt[5] * s
-0000a350: 7263 5f79 0d0a 2020 2020 2020 2020 2020  rc_y..          
-0000a360: 2020 290d 0a0d 0a20 2020 2020 2020 2069    )....        i
-0000a370: 6620 6e6f 7420 6365 6c6c 5f73 697a 653a  f not cell_size:
-0000a380: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-0000a390: 7468 6520 7265 7375 6c74 2072 6173 7465  the result raste
-0000a3a0: 7220 6861 7320 7468 6520 7361 6d65 2070  r has the same p
-0000a3b0: 6978 6365 6c20 7369 7a65 2061 7320 7468  ixcel size as th
-0000a3c0: 6520 736f 7572 6365 0d0a 2020 2020 2020  e source..      
-0000a3d0: 2020 2020 2020 2320 6368 6563 6b20 6966        # check if
-0000a3e0: 2074 6865 2063 6f6f 7264 696e 6174 6520   the coordinate 
-0000a3f0: 7379 7374 656d 2069 7320 4743 5320 636f  system is GCS co
-0000a400: 6e76 6572 7420 7468 6520 6469 7374 616e  nvert the distan
-0000a410: 6365 2066 726f 6d20 616e 6775 6c61 7220  ce from angular 
-0000a420: 746f 206d 6574 7269 630d 0a20 2020 2020  to metric..     
-0000a430: 2020 2020 2020 2069 6620 7372 635f 6570         if src_ep
-0000a440: 7367 203d 3d20 2234 3332 3622 3a0d 0a20  sg == "4326":.. 
-0000a450: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0000a460: 6f6f 7264 735f 3120 3d20 2873 7263 5f67  oords_1 = (src_g
-0000a470: 745b 335d 2c20 7372 635f 6774 5b30 5d29  t[3], src_gt[0])
-0000a480: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000a490: 2020 636f 6f72 6473 5f32 203d 2028 7372    coords_2 = (sr
-0000a4a0: 635f 6774 5b33 5d2c 2073 7263 5f67 745b  c_gt[3], src_gt[
-0000a4b0: 305d 202b 2073 7263 5f67 745b 315d 290d  0] + src_gt[1]).
-0000a4c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a4d0: 2023 2020 2020 2020 2020 2020 2020 7069   #            pi
-0000a4e0: 7865 6c5f 7370 6163 696e 673d 6765 6f70  xel_spacing=geop
-0000a4f0: 792e 6469 7374 616e 6365 2e76 696e 6365  y.distance.vince
-0000a500: 6e74 7928 636f 6f72 6473 5f31 2c20 636f  nty(coords_1, co
-0000a510: 6f72 6473 5f32 292e 6d0d 0a20 2020 2020  ords_2).m..     
-0000a520: 2020 2020 2020 2020 2020 2070 6978 656c             pixel
-0000a530: 5f73 7061 6369 6e67 203d 2056 6563 746f  _spacing = Vecto
-0000a540: 722e 4743 5344 6973 7461 6e63 6528 636f  r.GCSDistance(co
-0000a550: 6f72 6473 5f31 2c20 636f 6f72 6473 5f32  ords_1, coords_2
-0000a560: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-0000a570: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-0000a580: 2020 2020 2020 7069 7865 6c5f 7370 6163        pixel_spac
-0000a590: 696e 6720 3d20 7372 635f 6774 5b31 5d0d  ing = src_gt[1].
-0000a5a0: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-0000a5b0: 2020 2020 2020 2020 2020 2020 2320 6966              # if
-0000a5c0: 2073 7263 5f65 7073 672e 4765 7441 7474   src_epsg.GetAtt
-0000a5d0: 7256 616c 7565 2827 4155 5448 4f52 4954  rValue('AUTHORIT
-0000a5e0: 5927 2c20 3129 2021 3d20 2234 3332 3622  Y', 1) != "4326"
-0000a5f0: 3a0d 0a20 2020 2020 2020 2020 2020 2023  :..            #
-0000a600: 2020 2020 2061 7373 6572 7420 2863 656c       assert (cel
-0000a610: 6c5f 7369 7a65 203e 2031 292c 2022 706c  l_size > 1), "pl
-0000a620: 6561 7365 2065 6e74 6572 2063 656c 6c20  ease enter cell 
-0000a630: 7369 7a65 2067 7265 6174 6572 2074 6861  size greater tha
-0000a640: 6e20 3122 0d0a 2020 2020 2020 2020 2020  n 1"..          
-0000a650: 2020 2320 6966 2074 6865 2075 7365 7220    # if the user 
-0000a660: 696e 7075 7420 6120 6365 6c6c 2073 697a  input a cell siz
-0000a670: 6520 7265 7361 6d70 6c65 2074 6865 2072  e resample the r
-0000a680: 6173 7465 720d 0a20 2020 2020 2020 2020  aster..         
-0000a690: 2020 2070 6978 656c 5f73 7061 6369 6e67     pixel_spacing
-0000a6a0: 203d 2063 656c 6c5f 7369 7a65 0d0a 0d0a   = cell_size....
-0000a6b0: 2020 2020 2020 2020 2320 6372 6561 7465          # create
-0000a6c0: 2061 206e 6577 2072 6173 7465 720d 0a20   a new raster.. 
-0000a6d0: 2020 2020 2020 2063 6f6c 7320 3d20 696e         cols = in
-0000a6e0: 7428 6e70 2e72 6f75 6e64 2861 6273 286c  t(np.round(abs(l
-0000a6f0: 7278 202d 2075 6c78 2920 2f20 7069 7865  rx - ulx) / pixe
-0000a700: 6c5f 7370 6163 696e 6729 290d 0a20 2020  l_spacing))..   
-0000a710: 2020 2020 2072 6f77 7320 3d20 696e 7428       rows = int(
-0000a720: 6e70 2e72 6f75 6e64 2861 6273 2875 6c79  np.round(abs(uly
-0000a730: 202d 206c 7279 2920 2f20 7069 7865 6c5f   - lry) / pixel_
-0000a740: 7370 6163 696e 6729 290d 0a20 2020 2020  spacing))..     
-0000a750: 2020 2064 7374 203d 2052 6173 7465 722e     dst = Raster.
-0000a760: 5f63 7265 6174 6544 6174 6173 6574 2863  _createDataset(c
-0000a770: 6f6c 732c 2072 6f77 732c 2031 2c20 6474  ols, rows, 1, dt
-0000a780: 7970 652c 2064 7269 7665 723d 224d 454d  ype, driver="MEM
-0000a790: 2229 0d0a 0d0a 2020 2020 2020 2020 2320  ")....        # 
-0000a7a0: 6e65 7720 6765 6f74 7261 6e73 666f 726d  new geotransform
-0000a7b0: 0d0a 2020 2020 2020 2020 6e65 775f 6765  ..        new_ge
-0000a7c0: 6f20 3d20 2875 6c78 2c20 7069 7865 6c5f  o = (ulx, pixel_
-0000a7d0: 7370 6163 696e 672c 2073 7263 5f67 745b  spacing, src_gt[
-0000a7e0: 325d 2c20 756c 792c 2073 7263 5f67 745b  2], uly, src_gt[
-0000a7f0: 345d 2c20 2d70 6978 656c 5f73 7061 6369  4], -pixel_spaci
-0000a800: 6e67 290d 0a20 2020 2020 2020 2023 2073  ng)..        # s
-0000a810: 6574 2074 6865 2067 656f 7472 616e 7366  et the geotransf
-0000a820: 6f72 6d0d 0a20 2020 2020 2020 2064 7374  orm..        dst
-0000a830: 2e53 6574 4765 6f54 7261 6e73 666f 726d  .SetGeoTransform
-0000a840: 286e 6577 5f67 656f 290d 0a20 2020 2020  (new_geo)..     
-0000a850: 2020 2023 2073 6574 2074 6865 2070 726f     # set the pro
-0000a860: 6a65 6374 696f 6e0d 0a20 2020 2020 2020  jection..       
-0000a870: 2064 7374 2e53 6574 5072 6f6a 6563 7469   dst.SetProjecti
-0000a880: 6f6e 2864 7374 5f65 7073 672e 4578 706f  on(dst_epsg.Expo
-0000a890: 7274 546f 576b 7428 2929 0d0a 2020 2020  rtToWkt())..    
-0000a8a0: 2020 2020 2320 7365 7420 7468 6520 6e6f      # set the no
-0000a8b0: 2064 6174 6120 7661 6c75 650d 0a20 2020   data value..   
-0000a8c0: 2020 2020 206e 6f5f 6461 7461 5f76 616c       no_data_val
-0000a8d0: 7565 203d 2073 7263 2e47 6574 5261 7374  ue = src.GetRast
-0000a8e0: 6572 4261 6e64 2831 292e 4765 744e 6f44  erBand(1).GetNoD
-0000a8f0: 6174 6156 616c 7565 2829 0d0a 2020 2020  ataValue()..    
-0000a900: 2020 2020 6473 7420 3d20 5261 7374 6572      dst = Raster
-0000a910: 2e73 6574 4e6f 4461 7461 5661 6c75 6528  .setNoDataValue(
-0000a920: 6473 742c 206e 6f5f 6461 7461 5f76 616c  dst, no_data_val
-0000a930: 7565 290d 0a20 2020 2020 2020 2023 2070  ue)..        # p
-0000a940: 6572 666f 726d 2074 6865 2070 726f 6a65  erform the proje
-0000a950: 6374 696f 6e20 2620 7265 7361 6d70 6c69  ction & resampli
-0000a960: 6e67 0d0a 2020 2020 2020 2020 6764 616c  ng..        gdal
-0000a970: 2e52 6570 726f 6a65 6374 496d 6167 6528  .ReprojectImage(
-0000a980: 0d0a 2020 2020 2020 2020 2020 2020 7372  ..            sr
-0000a990: 632c 2064 7374 2c20 7372 635f 7372 2e45  c, dst, src_sr.E
-0000a9a0: 7870 6f72 7454 6f57 6b74 2829 2c20 6473  xportToWkt(), ds
-0000a9b0: 745f 6570 7367 2e45 7870 6f72 7454 6f57  t_epsg.ExportToW
-0000a9c0: 6b74 2829 2c20 7265 7361 6d70 6c65 5f74  kt(), resample_t
-0000a9d0: 6563 686e 6971 7565 0d0a 2020 2020 2020  echnique..      
-0000a9e0: 2020 290d 0a0d 0a20 2020 2020 2020 2072    )....        r
-0000a9f0: 6574 7572 6e20 6473 740d 0a0d 0a20 2020  eturn dst....   
-0000aa00: 2040 7374 6174 6963 6d65 7468 6f64 0d0a   @staticmethod..
-0000aa10: 2020 2020 6465 6620 6372 6f70 416c 6c69      def cropAlli
-0000aa20: 676e 6564 280d 0a20 2020 2020 2020 2073  gned(..        s
-0000aa30: 7263 3a20 556e 696f 6e5b 4461 7461 7365  rc: Union[Datase
-0000aa40: 742c 206e 702e 6e64 6172 7261 795d 2c0d  t, np.ndarray],.
-0000aa50: 0a20 2020 2020 2020 206d 6173 6b3a 2055  .        mask: U
-0000aa60: 6e69 6f6e 5b44 6174 6173 6574 2c20 6e70  nion[Dataset, np
-0000aa70: 2e6e 6461 7272 6179 5d2c 0d0a 2020 2020  .ndarray],..    
-0000aa80: 2020 2020 6d61 736b 5f6e 6f76 616c 3a20      mask_noval: 
-0000aa90: 556e 696f 6e5b 696e 742c 2066 6c6f 6174  Union[int, float
-0000aaa0: 5d20 3d20 4e6f 6e65 2c0d 0a20 2020 2029  ] = None,..    )
-0000aab0: 202d 3e20 556e 696f 6e5b 6e70 2e6e 6461   -> Union[np.nda
-0000aac0: 7272 6179 2c20 4461 7461 7365 745d 3a0d  rray, Dataset]:.
-0000aad0: 0a20 2020 2020 2020 2022 2222 6372 6f70  .        """crop
-0000aae0: 416c 6c69 676e 6564 2e0d 0a0d 0a20 2020  Alligned.....   
-0000aaf0: 2020 2020 2063 726f 7041 6c6c 6967 6e65       cropAlligne
-0000ab00: 6420 636c 6970 2f63 726f 7020 286d 6174  d clip/crop (mat
-0000ab10: 6368 6573 2074 6865 206c 6f63 6174 696f  ches the locatio
-0000ab20: 6e20 6f66 206e 6f64 6174 6120 7661 6c75  n of nodata valu
-0000ab30: 6520 6672 6f6d 2073 7263 2072 6173 7465  e from src raste
-0000ab40: 7220 746f 2064 7374 0d0a 2020 2020 2020  r to dst..      
-0000ab50: 2020 7261 7374 6572 292c 2042 6f74 6820    raster), Both 
-0000ab60: 7261 7374 6572 7320 6861 7665 2074 6f20  rasters have to 
-0000ab70: 6861 7665 2074 6865 2073 616d 6520 6469  have the same di
-0000ab80: 6d65 6e73 696f 6e73 2028 6e6f 206f 6620  mensions (no of 
-0000ab90: 726f 7773 2026 2063 6f6c 756d 6e73 290d  rows & columns).
-0000aba0: 0a20 2020 2020 2020 2073 6f20 4d61 7463  .        so Matc
-0000abb0: 6852 6173 7465 7241 6c69 676e 6d65 6e74  hRasterAlignment
-0000abc0: 2073 686f 756c 6420 6265 2075 7365 6420   should be used 
-0000abd0: 7072 696f 7220 746f 2074 6869 7320 6675  prior to this fu
-0000abe0: 6e63 7469 6f6e 2074 6f20 616c 6967 6e20  nction to align 
-0000abf0: 626f 7468 0d0a 2020 2020 2020 2020 7261  both..        ra
-0000ac00: 7374 6572 730d 0a0d 0a20 2020 2020 2020  sters....       
-0000ac10: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-0000ac20: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-0000ac30: 0a20 2020 2020 2020 2073 7263 3a20 5b67  .        src: [g
-0000ac40: 6461 6c2e 6461 7461 7365 742f 6e70 2e6e  dal.dataset/np.n
-0000ac50: 6461 7272 6179 5d0d 0a20 2020 2020 2020  darray]..       
-0000ac60: 2020 2020 2072 6173 7465 7220 796f 7520       raster you 
-0000ac70: 7761 6e74 2074 6f20 636c 6970 2f73 746f  want to clip/sto
-0000ac80: 7265 204e 6f44 6174 6156 616c 7565 2069  re NoDataValue i
-0000ac90: 6e20 6974 7320 6365 6c6c 730d 0a20 2020  n its cells..   
-0000aca0: 2020 2020 2020 2020 2065 7861 6374 6c79           exactly
-0000acb0: 2074 6865 2073 616d 6520 6c69 6b65 206d   the same like m
-0000acc0: 6173 6b20 7261 7374 6572 0d0a 2020 2020  ask raster..    
-0000acd0: 2020 2020 6d61 736b 3a20 5b67 6461 6c2e      mask: [gdal.
-0000ace0: 6461 7461 7365 742f 6e70 2e6e 6461 7272  dataset/np.ndarr
-0000acf0: 6179 5d0d 0a20 2020 2020 2020 2020 2020  ay]..           
-0000ad00: 206d 6173 6b20 7261 7374 6572 2074 6f20   mask raster to 
-0000ad10: 6765 7420 7468 6520 6c6f 6361 7469 6f6e  get the location
-0000ad20: 206f 6620 7468 6520 4e6f 4461 7461 5661   of the NoDataVa
-0000ad30: 6c75 6520 616e 640d 0a20 2020 2020 2020  lue and..       
-0000ad40: 2020 2020 2077 6865 7265 2069 7420 6973       where it is
-0000ad50: 2069 6e20 7468 6520 6172 7261 790d 0a20   in the array.. 
-0000ad60: 2020 2020 2020 206d 6173 6b5f 6e6f 7661         mask_nova
-0000ad70: 6c3a 205b 6e75 6d65 7269 635d 0d0a 2020  l: [numeric]..  
-0000ad80: 2020 2020 2020 2020 2020 696e 2063 6173            in cas
-0000ad90: 6520 7468 6520 6d61 736b 2069 7320 6e70  e the mask is np
-0000ada0: 2e6e 6461 7272 6179 2c20 7468 6520 6d61  .ndarray, the ma
-0000adb0: 736b 5f6e 6f76 616c 2068 6176 6520 746f  sk_noval have to
-0000adc0: 2062 6520 6769 7665 6e2e 0d0a 0d0a 2020   be given.....  
-0000add0: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
-0000ade0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
-0000adf0: 2020 2020 2020 2020 6473 743a 205b 6764          dst: [gd
-0000ae00: 616c 2e64 6174 6173 6574 5d0d 0a20 2020  al.dataset]..   
-0000ae10: 2020 2020 2020 2020 2074 6865 2073 6563           the sec
-0000ae20: 6f6e 6420 7261 7374 6572 2077 6974 6820  ond raster with 
-0000ae30: 4e6f 4461 7461 5661 6c75 6520 7374 6f72  NoDataValue stor
-0000ae40: 6564 2069 6e20 6974 7320 6365 6c6c 730d  ed in its cells.
-0000ae50: 0a20 2020 2020 2020 2020 2020 2065 7861  .            exa
-0000ae60: 6374 6c79 2074 6865 2073 616d 6520 6c69  ctly the same li
-0000ae70: 6b65 2073 7263 2072 6173 7465 720d 0a20  ke src raster.. 
-0000ae80: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-0000ae90: 2020 2020 2320 6966 2074 6865 206d 6173      # if the mas
-0000aea0: 6b20 6f62 6a65 6374 2069 7320 7261 7374  k object is rast
-0000aeb0: 6572 0d0a 2020 2020 2020 2020 6966 2069  er..        if i
-0000aec0: 7369 6e73 7461 6e63 6528 6d61 736b 2c20  sinstance(mask, 
-0000aed0: 6764 616c 2e44 6174 6173 6574 293a 0d0a  gdal.Dataset):..
-0000aee0: 2020 2020 2020 2020 2020 2020 6d61 736b              mask
-0000aef0: 5f67 7420 3d20 6d61 736b 2e47 6574 4765  _gt = mask.GetGe
-0000af00: 6f54 7261 6e73 666f 726d 2829 0d0a 2020  oTransform()..  
-0000af10: 2020 2020 2020 2020 2020 6d61 736b 5f70            mask_p
-0000af20: 726f 6a20 3d20 6d61 736b 2e47 6574 5072  roj = mask.GetPr
-0000af30: 6f6a 6563 7469 6f6e 2829 0d0a 2020 2020  ojection()..    
-0000af40: 2020 2020 2020 2020 6d61 736b 5f73 7265          mask_sre
-0000af50: 6620 3d20 6f73 722e 5370 6174 6961 6c52  f = osr.SpatialR
-0000af60: 6566 6572 656e 6365 2877 6b74 3d6d 6173  eference(wkt=mas
-0000af70: 6b5f 7072 6f6a 290d 0a20 2020 2020 2020  k_proj)..       
-0000af80: 2020 2020 206d 6173 6b5f 6570 7367 203d       mask_epsg =
-0000af90: 2069 6e74 286d 6173 6b5f 7372 6566 2e47   int(mask_sref.G
-0000afa0: 6574 4174 7472 5661 6c75 6528 2241 5554  etAttrValue("AUT
-0000afb0: 484f 5249 5459 222c 2031 2929 0d0a 0d0a  HORITY", 1))....
-0000afc0: 2020 2020 2020 2020 2020 2020 726f 7720              row 
-0000afd0: 3d20 6d61 736b 2e52 6173 7465 7259 5369  = mask.RasterYSi
-0000afe0: 7a65 0d0a 2020 2020 2020 2020 2020 2020  ze..            
-0000aff0: 636f 6c20 3d20 6d61 736b 2e52 6173 7465  col = mask.Raste
-0000b000: 7258 5369 7a65 0d0a 2020 2020 2020 2020  rXSize..        
-0000b010: 2020 2020 6d61 736b 5f6e 6f76 616c 203d      mask_noval =
-0000b020: 206d 6173 6b2e 4765 7452 6173 7465 7242   mask.GetRasterB
-0000b030: 616e 6428 3129 2e47 6574 4e6f 4461 7461  and(1).GetNoData
-0000b040: 5661 6c75 6528 290d 0a20 2020 2020 2020  Value()..       
-0000b050: 2020 2020 206d 6173 6b5f 6172 7261 7920       mask_array 
-0000b060: 3d20 6d61 736b 2e52 6561 6441 7341 7272  = mask.ReadAsArr
-0000b070: 6179 2829 0d0a 2020 2020 2020 2020 656c  ay()..        el
-0000b080: 6966 2069 7369 6e73 7461 6e63 6528 6d61  if isinstance(ma
-0000b090: 736b 2c20 6e70 2e6e 6461 7272 6179 293a  sk, np.ndarray):
-0000b0a0: 0d0a 2020 2020 2020 2020 2020 2020 6d73  ..            ms
-0000b0b0: 6720 3d20 2220 596f 7520 6861 7665 2074  g = " You have t
-0000b0c0: 6f20 656e 7465 7220 7468 6520 7661 6c75  o enter the valu
-0000b0d0: 6520 6f66 2074 6865 206e 6f5f 7661 6c20  e of the no_val 
-0000b0e0: 7061 7261 6d65 7465 7220 7768 656e 2074  parameter when t
-0000b0f0: 6865 206d 6173 6b20 6973 2061 206e 756d  he mask is a num
-0000b100: 7079 2061 7272 6179 220d 0a20 2020 2020  py array"..     
-0000b110: 2020 2020 2020 2061 7373 6572 7420 6d61         assert ma
-0000b120: 736b 5f6e 6f76 616c 2069 7320 6e6f 7420  sk_noval is not 
-0000b130: 4e6f 6e65 2c20 6d73 670d 0a20 2020 2020  None, msg..     
-0000b140: 2020 2020 2020 206d 6173 6b5f 6172 7261         mask_arra
-0000b150: 7920 3d20 6d61 736b 2e63 6f70 7928 290d  y = mask.copy().
-0000b160: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-0000b170: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0000b180: 6520 5479 7065 4572 726f 7228 0d0a 2020  e TypeError(..  
-0000b190: 2020 2020 2020 2020 2020 2020 2020 2254                "T
-0000b1a0: 6865 2073 6563 6f6e 6420 7061 7261 6d65  he second parame
-0000b1b0: 7465 7220 276d 6173 6b27 2068 6173 2074  ter 'mask' has t
-0000b1c0: 6f20 6265 2065 6974 6865 7220 6764 616c  o be either gdal
-0000b1d0: 2e44 6174 6173 6574 206f 7220 6e75 6d70  .Dataset or nump
-0000b1e0: 7920 6172 7261 7922 0d0a 2020 2020 2020  y array"..      
-0000b1f0: 2020 2020 2020 2020 2020 6622 6769 7665            f"give
-0000b200: 6e20 2d20 7b74 7970 6528 6d61 736b 297d  n - {type(mask)}
-0000b210: 220d 0a20 2020 2020 2020 2020 2020 2029  "..            )
-0000b220: 0d0a 0d0a 2020 2020 2020 2020 2320 6966  ....        # if
-0000b230: 2074 6865 2074 6f20 6265 2063 6c69 7070   the to be clipp
-0000b240: 6564 206f 626a 6563 7420 6973 2072 6173  ed object is ras
-0000b250: 7465 720d 0a20 2020 2020 2020 2069 6620  ter..        if 
-0000b260: 6973 696e 7374 616e 6365 2873 7263 2c20  isinstance(src, 
-0000b270: 6764 616c 2e44 6174 6173 6574 293a 0d0a  gdal.Dataset):..
-0000b280: 2020 2020 2020 2020 2020 2020 7372 635f              src_
-0000b290: 6774 203d 2073 7263 2e47 6574 4765 6f54  gt = src.GetGeoT
-0000b2a0: 7261 6e73 666f 726d 2829 0d0a 2020 2020  ransform()..    
-0000b2b0: 2020 2020 2020 2020 7372 635f 7072 6f6a          src_proj
-0000b2c0: 203d 2073 7263 2e47 6574 5072 6f6a 6563   = src.GetProjec
-0000b2d0: 7469 6f6e 2829 0d0a 2020 2020 2020 2020  tion()..        
-0000b2e0: 2020 2020 726f 7720 3d20 7372 632e 5261      row = src.Ra
-0000b2f0: 7374 6572 5953 697a 650d 0a20 2020 2020  sterYSize..     
-0000b300: 2020 2020 2020 2063 6f6c 203d 2073 7263         col = src
-0000b310: 2e52 6173 7465 7258 5369 7a65 0d0a 2020  .RasterXSize..  
-0000b320: 2020 2020 2020 2020 2020 7372 635f 6e6f            src_no
-0000b330: 7661 6c20 3d20 7372 632e 4765 7452 6173  val = src.GetRas
-0000b340: 7465 7242 616e 6428 3129 2e47 6574 4e6f  terBand(1).GetNo
-0000b350: 4461 7461 5661 6c75 6528 290d 0a20 2020  DataValue()..   
-0000b360: 2020 2020 2020 2020 2073 7263 5f73 7265           src_sre
-0000b370: 6620 3d20 6f73 722e 5370 6174 6961 6c52  f = osr.SpatialR
-0000b380: 6566 6572 656e 6365 2877 6b74 3d73 7263  eference(wkt=src
-0000b390: 5f70 726f 6a29 0d0a 2020 2020 2020 2020  _proj)..        
-0000b3a0: 2020 2020 7372 635f 6570 7367 203d 2069      src_epsg = i
-0000b3b0: 6e74 2873 7263 5f73 7265 662e 4765 7441  nt(src_sref.GetA
-0000b3c0: 7474 7256 616c 7565 2822 4155 5448 4f52  ttrValue("AUTHOR
-0000b3d0: 4954 5922 2c20 3129 290d 0a20 2020 2020  ITY", 1))..     
-0000b3e0: 2020 2020 2020 2073 7263 5f61 7272 6179         src_array
-0000b3f0: 203d 2073 7263 2e52 6561 6441 7341 7272   = src.ReadAsArr
-0000b400: 6179 2829 0d0a 2020 2020 2020 2020 2020  ay()..          
-0000b410: 2020 6474 7970 6520 3d20 7372 632e 4765    dtype = src.Ge
-0000b420: 7452 6173 7465 7242 616e 6428 3129 2e44  tRasterBand(1).D
-0000b430: 6174 6154 7970 650d 0a20 2020 2020 2020  ataType..       
-0000b440: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
-0000b450: 2873 7263 2c20 6e70 2e6e 6461 7272 6179  (src, np.ndarray
-0000b460: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-0000b470: 2320 6966 2074 6865 206f 626a 6563 7420  # if the object 
-0000b480: 746f 2062 6520 6372 6f70 7065 6420 6973  to be cropped is
-0000b490: 2061 7272 6179 0d0a 2020 2020 2020 2020   array..        
-0000b4a0: 2020 2020 7372 635f 6172 7261 7920 3d20      src_array = 
-0000b4b0: 7372 632e 636f 7079 2829 0d0a 2020 2020  src.copy()..    
-0000b4c0: 2020 2020 2020 2020 6474 7970 6520 3d20          dtype = 
-0000b4d0: 7372 632e 6474 7970 650d 0a0d 0a20 2020  src.dtype....   
-0000b4e0: 2020 2020 2023 2063 6865 636b 2070 726f       # check pro
-0000b4f0: 6a0d 0a20 2020 2020 2020 2069 6620 6e6f  j..        if no
-0000b500: 7420 6d61 736b 5f61 7272 6179 2e73 6861  t mask_array.sha
-0000b510: 7065 203d 3d20 7372 635f 6172 7261 792e  pe == src_array.
-0000b520: 7368 6170 653a 0d0a 2020 2020 2020 2020  shape:..        
-0000b530: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-0000b540: 7272 6f72 280d 0a20 2020 2020 2020 2020  rror(..         
-0000b550: 2020 2020 2020 2022 7477 6f20 7261 7374         "two rast
-0000b560: 6572 7320 6861 7320 6469 6666 6572 656e  ers has differen
-0000b570: 7420 6e6f 206f 6620 636f 6c75 6d6e 7320  t no of columns 
-0000b580: 6f72 2072 6f77 7320 706c 6561 7365 2072  or rows please r
-0000b590: 6573 616d 706c 6520 6f72 206d 6174 6368  esample or match
-0000b5a0: 2062 6f74 6820 7261 7374 6572 7322 0d0a   both rasters"..
-0000b5b0: 2020 2020 2020 2020 2020 2020 290d 0a0d              )...
-0000b5c0: 0a20 2020 2020 2020 2023 2069 6620 626f  .        # if bo
-0000b5d0: 7468 2069 6e70 7574 7320 6172 6520 7261  th inputs are ra
-0000b5e0: 7374 6572 730d 0a20 2020 2020 2020 2069  sters..        i
-0000b5f0: 6620 6973 696e 7374 616e 6365 286d 6173  f isinstance(mas
-0000b600: 6b2c 2067 6461 6c2e 4461 7461 7365 7429  k, gdal.Dataset)
-0000b610: 2061 6e64 2069 7369 6e73 7461 6e63 6528   and isinstance(
-0000b620: 7372 632c 2067 6461 6c2e 4461 7461 7365  src, gdal.Datase
-0000b630: 7429 3a0d 0a20 2020 2020 2020 2020 2020  t):..           
-0000b640: 2069 6620 6e6f 7420 7372 635f 6774 203d   if not src_gt =
-0000b650: 3d20 6d61 736b 5f67 743a 0d0a 2020 2020  = mask_gt:..    
-0000b660: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0000b670: 6520 5661 6c75 6545 7272 6f72 280d 0a20  e ValueError(.. 
-0000b680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b690: 2020 2022 6c6f 6361 7469 6f6e 206f 6620     "location of 
-0000b6a0: 7570 7065 7220 6c65 6674 2063 6f72 6e65  upper left corne
-0000b6b0: 7220 6f66 2062 6f74 6820 7261 7374 6572  r of both raster
-0000b6c0: 7320 6172 6520 6e6f 7420 7468 6520 7361  s are not the sa
-0000b6d0: 6d65 206f 7220 6365 6c6c 2073 697a 6520  me or cell size 
-0000b6e0: 6973 2022 0d0a 2020 2020 2020 2020 2020  is "..          
-0000b6f0: 2020 2020 2020 2020 2020 2264 6966 6665            "diffe
-0000b700: 7265 6e74 2070 6c65 6173 6520 6d61 7463  rent please matc
-0000b710: 6820 626f 7468 2072 6173 7465 7273 2066  h both rasters f
-0000b720: 6972 7374 2022 0d0a 2020 2020 2020 2020  irst "..        
-0000b730: 2020 2020 2020 2020 290d 0a0d 0a20 2020          )....   
-0000b740: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-0000b750: 6d61 736b 5f65 7073 6720 3d3d 2073 7263  mask_epsg == src
-0000b760: 5f65 7073 673a 0d0a 2020 2020 2020 2020  _epsg:..        
-0000b770: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0000b780: 6c75 6545 7272 6f72 280d 0a20 2020 2020  lueError(..     
-0000b790: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0000b7a0: 5261 7374 6572 2041 2026 2042 2061 7265  Raster A & B are
-0000b7b0: 2075 7369 6e67 2064 6966 6665 7265 6e74   using different
-0000b7c0: 2063 6f6f 7264 696e 6174 6520 7379 7374   coordinate syst
-0000b7d0: 656d 2070 6c65 6173 6520 7265 7072 6f6a  em please reproj
-0000b7e0: 6563 7420 6f6e 6520 6f66 2074 6865 6d20  ect one of them 
-0000b7f0: 746f 2022 0d0a 2020 2020 2020 2020 2020  to "..          
-0000b800: 2020 2020 2020 2020 2020 2274 6865 206f            "the o
-0000b810: 7468 6572 2072 6173 7465 7220 636f 6f72  ther raster coor
-0000b820: 6469 6e61 7465 2073 7973 7465 6d22 0d0a  dinate system"..
-0000b830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b840: 290d 0a0d 0a20 2020 2020 2020 2073 7263  )....        src
-0000b850: 5f61 7272 6179 5b6e 702e 6973 636c 6f73  _array[np.isclos
-0000b860: 6528 6d61 736b 5f61 7272 6179 2c20 6d61  e(mask_array, ma
-0000b870: 736b 5f6e 6f76 616c 2c20 7274 6f6c 3d30  sk_noval, rtol=0
-0000b880: 2e30 3031 295d 203d 206d 6173 6b5f 6e6f  .001)] = mask_no
-0000b890: 7661 6c0d 0a0d 0a20 2020 2020 2020 2023  val....        #
-0000b8a0: 2061 6c69 676e 2066 756e 6374 696f 6e20   align function 
-0000b8b0: 6f6e 6c79 2065 7175 6174 6520 7468 6520  only equate the 
-0000b8c0: 6e6f 206f 6620 726f 7773 2061 6e64 2063  no of rows and c
-0000b8d0: 6f6c 756d 6e73 206f 6e6c 790d 0a20 2020  olumns only..   
-0000b8e0: 2020 2020 2023 206d 6174 6368 206e 6f64       # match nod
-0000b8f0: 6174 6176 616c 7565 2069 6e73 6572 7473  atavalue inserts
-0000b900: 206e 6f64 6174 6176 616c 7565 2069 6e20   nodatavalue in 
-0000b910: 7372 6320 7261 7374 6572 2074 6f20 616c  src raster to al
-0000b920: 6c20 706c 6163 6573 206c 696b 6520 6d61  l places like ma
-0000b930: 736b 0d0a 2020 2020 2020 2020 2320 7374  sk..        # st
-0000b940: 696c 6c20 706c 6163 6573 2074 6861 7420  ill places that 
-0000b950: 6861 7320 6e6f 6461 7461 7661 6c75 6520  has nodatavalue 
-0000b960: 696e 2074 6865 2073 7263 2072 6173 7465  in the src raste
-0000b970: 7220 6275 7420 6974 2069 7320 6e6f 7420  r but it is not 
-0000b980: 6e6f 6461 7461 7661 6c75 6520 696e 2074  nodatavalue in t
-0000b990: 6865 206d 6173 6b0d 0a20 2020 2020 2020  he mask..       
-0000b9a0: 2023 2061 6e64 206e 6f77 2068 6173 2074   # and now has t
-0000b9b0: 6f20 6265 2066 696c 6c65 6420 7769 7468  o be filled with
-0000b9c0: 2076 616c 7565 730d 0a20 2020 2020 2020   values..       
-0000b9d0: 2023 2063 6f6d 7061 7265 206e 6f20 6f66   # compare no of
-0000b9e0: 2065 6c65 6d65 6e74 2074 6861 7420 6973   element that is
-0000b9f0: 206e 6f74 206e 6f64 6174 6176 616c 7565   not nodatavalue
-0000ba00: 2069 6e20 626f 7468 2072 6173 7465 7273   in both rasters
-0000ba10: 2074 6f20 6d61 6b65 2073 7572 6520 7468   to make sure th
-0000ba20: 6579 2061 7265 206d 6174 6368 6564 0d0a  ey are matched..
-0000ba30: 2020 2020 2020 2020 2320 6966 2062 6f74          # if bot
-0000ba40: 6820 696e 7075 7473 2061 7265 2072 6173  h inputs are ras
-0000ba50: 7465 7273 0d0a 2020 2020 2020 2020 6966  ters..        if
-0000ba60: 2069 7369 6e73 7461 6e63 6528 6d61 736b   isinstance(mask
-0000ba70: 2c20 6764 616c 2e44 6174 6173 6574 2920  , gdal.Dataset) 
-0000ba80: 616e 6420 6973 696e 7374 616e 6365 2873  and isinstance(s
-0000ba90: 7263 2c20 6764 616c 2e44 6174 6173 6574  rc, gdal.Dataset
-0000baa0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-0000bab0: 2320 7468 6572 6520 6d69 6768 7420 6265  # there might be
-0000bac0: 2063 656c 6c73 2074 6861 7420 6172 6520   cells that are 
-0000bad0: 6f75 7420 6f66 2064 6f6d 6169 6e20 696e  out of domain in
-0000bae0: 2074 6865 2073 7263 2062 7574 206e 6f74   the src but not
-0000baf0: 206f 7574 206f 6620 646f 6d61 696e 2069   out of domain i
-0000bb00: 6e20 7468 6520 6d61 736b 0d0a 2020 2020  n the mask..    
-0000bb10: 2020 2020 2020 2020 2320 736f 2063 6861          # so cha
-0000bb20: 6e67 6520 616c 6c20 7468 6520 7372 635f  nge all the src_
-0000bb30: 6e6f 7661 6c20 746f 206d 6173 6b5f 6e6f  noval to mask_no
-0000bb40: 7661 6c20 696e 2074 6865 2073 7263 5f61  val in the src_a
-0000bb50: 7272 6179 0d0a 2020 2020 2020 2020 2020  rray..          
-0000bb60: 2020 7372 635f 6172 7261 795b 6e70 2e69    src_array[np.i
-0000bb70: 7363 6c6f 7365 2873 7263 5f61 7272 6179  sclose(src_array
-0000bb80: 2c20 7372 635f 6e6f 7661 6c2c 2072 746f  , src_noval, rto
-0000bb90: 6c3d 302e 3030 3129 5d20 3d20 6d61 736b  l=0.001)] = mask
-0000bba0: 5f6e 6f76 616c 0d0a 2020 2020 2020 2020  _noval..        
-0000bbb0: 2020 2020 2320 7468 656e 2063 6f75 6e74      # then count
-0000bbc0: 2074 6865 6d20 286f 7574 206f 6620 646f   them (out of do
-0000bbd0: 6d61 696e 2063 656c 6c73 2920 696e 2074  main cells) in t
-0000bbe0: 6865 2073 7263 5f61 7272 6179 0d0a 2020  he src_array..  
-0000bbf0: 2020 2020 2020 2020 2020 656c 656d 5f73            elem_s
-0000bc00: 7263 203d 206e 702e 7369 7a65 2873 7263  rc = np.size(src
-0000bc10: 5f61 7272 6179 5b3a 2c20 3a5d 2920 2d20  _array[:, :]) - 
-0000bc20: 6e70 2e63 6f75 6e74 5f6e 6f6e 7a65 726f  np.count_nonzero
-0000bc30: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-0000bc40: 2020 2028 7372 635f 6172 7261 795b 6e70     (src_array[np
-0000bc50: 2e69 7363 6c6f 7365 2873 7263 5f61 7272  .isclose(src_arr
-0000bc60: 6179 2c20 6d61 736b 5f6e 6f76 616c 2c20  ay, mask_noval, 
-0000bc70: 7274 6f6c 3d30 2e30 3031 295d 290d 0a20  rtol=0.001)]).. 
-0000bc80: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
-0000bc90: 2020 2020 2020 2020 2020 2320 636f 756e            # coun
-0000bca0: 7420 7468 6520 6f75 7420 6f66 2064 6f6d  t the out of dom
-0000bcb0: 6961 6e20 6365 6c6c 7320 696e 2074 6865  ian cells in the
-0000bcc0: 206d 6173 6b0d 0a20 2020 2020 2020 2020   mask..         
-0000bcd0: 2020 2065 6c65 6d5f 6d61 736b 203d 206e     elem_mask = n
-0000bce0: 702e 7369 7a65 286d 6173 6b5f 6172 7261  p.size(mask_arra
-0000bcf0: 795b 3a2c 203a 5d29 202d 206e 702e 636f  y[:, :]) - np.co
-0000bd00: 756e 745f 6e6f 6e7a 6572 6f28 0d0a 2020  unt_nonzero(..  
-0000bd10: 2020 2020 2020 2020 2020 2020 2020 286d                (m
-0000bd20: 6173 6b5f 6172 7261 795b 6e70 2e69 7363  ask_array[np.isc
-0000bd30: 6c6f 7365 286d 6173 6b5f 6172 7261 792c  lose(mask_array,
-0000bd40: 206d 6173 6b5f 6e6f 7661 6c2c 2072 746f   mask_noval, rto
-0000bd50: 6c3d 302e 3030 3129 5d29 0d0a 2020 2020  l=0.001)])..    
-0000bd60: 2020 2020 2020 2020 290d 0a0d 0a20 2020          )....   
-0000bd70: 2020 2020 2020 2020 2023 2069 6620 6e6f           # if no
-0000bd80: 7420 6571 7561 6c20 7468 656e 2073 746f  t equal then sto
-0000bd90: 7265 2069 6e64 6963 6573 206f 6620 7468  re indices of th
-0000bda0: 6f73 6520 6365 6c6c 7320 7468 6174 2064  ose cells that d
-0000bdb0: 6f65 736e 2774 206d 6174 6368 730d 0a20  oesn't matchs.. 
-0000bdc0: 2020 2020 2020 2020 2020 2069 6620 656c             if el
-0000bdd0: 656d 5f6d 6173 6b20 3e20 656c 656d 5f73  em_mask > elem_s
-0000bde0: 7263 3a0d 0a20 2020 2020 2020 2020 2020  rc:..           
-0000bdf0: 2020 2020 2072 6f77 7320 3d20 5b0d 0a20       rows = [.. 
-0000be00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000be10: 2020 2069 0d0a 2020 2020 2020 2020 2020     i..          
-0000be20: 2020 2020 2020 2020 2020 666f 7220 6920            for i 
-0000be30: 696e 2072 616e 6765 2872 6f77 290d 0a20  in range(row).. 
-0000be40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000be50: 2020 2066 6f72 206a 2069 6e20 7261 6e67     for j in rang
-0000be60: 6528 636f 6c29 0d0a 2020 2020 2020 2020  e(col)..        
-0000be70: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-0000be80: 702e 6973 636c 6f73 6528 7372 635f 6172  p.isclose(src_ar
-0000be90: 7261 795b 692c 206a 5d2c 206d 6173 6b5f  ray[i, j], mask_
-0000bea0: 6e6f 7661 6c2c 2072 746f 6c3d 302e 3030  noval, rtol=0.00
-0000beb0: 3129 0d0a 2020 2020 2020 2020 2020 2020  1)..            
-0000bec0: 2020 2020 2020 2020 616e 6420 6e6f 7420          and not 
-0000bed0: 6e70 2e69 7363 6c6f 7365 286d 6173 6b5f  np.isclose(mask_
-0000bee0: 6172 7261 795b 692c 206a 5d2c 206d 6173  array[i, j], mas
-0000bef0: 6b5f 6e6f 7661 6c2c 2072 746f 6c3d 302e  k_noval, rtol=0.
-0000bf00: 3030 3129 0d0a 2020 2020 2020 2020 2020  001)..          
-0000bf10: 2020 2020 2020 5d0d 0a20 2020 2020 2020        ]..       
-0000bf20: 2020 2020 2020 2020 2063 6f6c 7320 3d20           cols = 
-0000bf30: 5b0d 0a20 2020 2020 2020 2020 2020 2020  [..             
-0000bf40: 2020 2020 2020 206a 0d0a 2020 2020 2020         j..      
-0000bf50: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-0000bf60: 7220 6920 696e 2072 616e 6765 2872 6f77  r i in range(row
-0000bf70: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0000bf80: 2020 2020 2020 2066 6f72 206a 2069 6e20         for j in 
-0000bf90: 7261 6e67 6528 636f 6c29 0d0a 2020 2020  range(col)..    
-0000bfa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bfb0: 6966 206e 702e 6973 636c 6f73 6528 7372  if np.isclose(sr
-0000bfc0: 635f 6172 7261 795b 692c 206a 5d2c 206d  c_array[i, j], m
-0000bfd0: 6173 6b5f 6e6f 7661 6c2c 2072 746f 6c3d  ask_noval, rtol=
-0000bfe0: 302e 3030 3129 0d0a 2020 2020 2020 2020  0.001)..        
-0000bff0: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-0000c000: 6e6f 7420 6e70 2e69 7363 6c6f 7365 286d  not np.isclose(m
-0000c010: 6173 6b5f 6172 7261 795b 692c 206a 5d2c  ask_array[i, j],
-0000c020: 206d 6173 6b5f 6e6f 7661 6c2c 2072 746f   mask_noval, rto
-0000c030: 6c3d 302e 3030 3129 0d0a 2020 2020 2020  l=0.001)..      
-0000c040: 2020 2020 2020 2020 2020 5d0d 0a20 2020            ]..   
-0000c050: 2020 2020 2020 2020 2023 2069 6e74 6572           # inter
-0000c060: 706f 6c61 7465 2074 686f 7365 206d 6973  polate those mis
-0000c070: 7369 6e67 2063 656c 6c73 2062 7920 6e65  sing cells by ne
-0000c080: 6172 6573 7420 6e65 6967 6862 6f75 720d  arest neighbour.
-0000c090: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0000c0a0: 656c 656d 5f6d 6173 6b20 3e20 656c 656d  elem_mask > elem
-0000c0b0: 5f73 7263 3a0d 0a20 2020 2020 2020 2020  _src:..         
-0000c0c0: 2020 2020 2020 2073 7263 5f61 7272 6179         src_array
-0000c0d0: 203d 2052 6173 7465 722e 6e65 6172 6573   = Raster.neares
-0000c0e0: 744e 6569 6768 626f 7572 2873 7263 5f61  tNeighbour(src_a
-0000c0f0: 7272 6179 2c20 6d61 736b 5f6e 6f76 616c  rray, mask_noval
-0000c100: 2c20 726f 7773 2c20 636f 6c73 290d 0a0d  , rows, cols)...
-0000c110: 0a20 2020 2020 2020 2023 2069 6620 7468  .        # if th
-0000c120: 6520 6473 7420 6973 2061 2072 6173 7465  e dst is a raste
-0000c130: 720d 0a20 2020 2020 2020 2069 6620 6973  r..        if is
-0000c140: 696e 7374 616e 6365 2873 7263 2c20 6764  instance(src, gd
-0000c150: 616c 2e44 6174 6173 6574 293a 0d0a 2020  al.Dataset):..  
-0000c160: 2020 2020 2020 2020 2020 6473 7420 3d20            dst = 
-0000c170: 5261 7374 6572 2e5f 6372 6561 7465 4461  Raster._createDa
-0000c180: 7461 7365 7428 636f 6c2c 2072 6f77 2c20  taset(col, row, 
-0000c190: 312c 2064 7479 7065 2c20 6472 6976 6572  1, dtype, driver
-0000c1a0: 3d22 4d45 4d22 290d 0a20 2020 2020 2020  ="MEM")..       
-0000c1b0: 2020 2020 2023 2062 7574 2077 6974 6820       # but with 
-0000c1c0: 6c6f 7420 6f66 2063 6f6d 7075 7461 7469  lot of computati
-0000c1d0: 6f6e 0d0a 2020 2020 2020 2020 2020 2020  on..            
-0000c1e0: 2320 6966 2074 6865 206d 6173 6b20 6973  # if the mask is
-0000c1f0: 2061 6e20 6172 7261 7920 616e 6420 7468   an array and th
-0000c200: 6520 6d61 736b 5f67 7420 6973 206e 6f74  e mask_gt is not
-0000c210: 2064 6566 696e 6564 2075 7365 2074 6865   defined use the
-0000c220: 2073 7263 5f67 7420 6173 2062 6f74 6820   src_gt as both 
-0000c230: 7468 6520 6d61 736b 2061 6e64 2074 6865  the mask and the
-0000c240: 2073 7263 0d0a 2020 2020 2020 2020 2020   src..          
-0000c250: 2020 2320 6172 6520 616c 6967 6e65 6420    # are aligned 
-0000c260: 736f 2074 6865 7920 6861 7665 2074 6865  so they have the
-0000c270: 2073 616d 2067 740d 0a20 2020 2020 2020   sam gt..       
-0000c280: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
-0000c290: 2020 2020 2020 2020 2020 2023 2073 6574             # set
-0000c2a0: 2074 6865 2067 656f 7472 616e 7366 6f72   the geotransfor
-0000c2b0: 6d0d 0a20 2020 2020 2020 2020 2020 2020  m..             
-0000c2c0: 2020 2064 7374 2e53 6574 4765 6f54 7261     dst.SetGeoTra
-0000c2d0: 6e73 666f 726d 286d 6173 6b5f 6774 290d  nsform(mask_gt).
-0000c2e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c2f0: 2023 2073 6574 2074 6865 2070 726f 6a65   # set the proje
-0000c300: 6374 696f 6e0d 0a20 2020 2020 2020 2020  ction..         
-0000c310: 2020 2020 2020 2064 7374 2e53 6574 5072         dst.SetPr
-0000c320: 6f6a 6563 7469 6f6e 286d 6173 6b5f 7372  ojection(mask_sr
-0000c330: 6566 2e45 7870 6f72 7454 6f57 6b74 2829  ef.ExportToWkt()
-0000c340: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-0000c350: 7863 6570 7420 556e 626f 756e 644c 6f63  xcept UnboundLoc
-0000c360: 616c 4572 726f 723a 0d0a 2020 2020 2020  alError:..      
-0000c370: 2020 2020 2020 2020 2020 6473 742e 5365            dst.Se
-0000c380: 7447 656f 5472 616e 7366 6f72 6d28 7372  tGeoTransform(sr
-0000c390: 635f 6774 290d 0a20 2020 2020 2020 2020  c_gt)..         
-0000c3a0: 2020 2020 2020 2064 7374 2e53 6574 5072         dst.SetPr
-0000c3b0: 6f6a 6563 7469 6f6e 2873 7263 5f73 7265  ojection(src_sre
-0000c3c0: 662e 4578 706f 7274 546f 576b 7428 2929  f.ExportToWkt())
-0000c3d0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-0000c3e0: 2320 7365 7420 7468 6520 6e6f 2064 6174  # set the no dat
-0000c3f0: 6120 7661 6c75 650d 0a20 2020 2020 2020  a value..       
-0000c400: 2020 2020 2064 7374 203d 2052 6173 7465       dst = Raste
-0000c410: 722e 7365 744e 6f44 6174 6156 616c 7565  r.setNoDataValue
-0000c420: 2864 7374 2c20 6d61 736b 5f6e 6f76 616c  (dst, mask_noval
-0000c430: 290d 0a20 2020 2020 2020 2020 2020 2064  )..            d
-0000c440: 7374 2e47 6574 5261 7374 6572 4261 6e64  st.GetRasterBand
-0000c450: 2831 292e 5772 6974 6541 7272 6179 2873  (1).WriteArray(s
-0000c460: 7263 5f61 7272 6179 290d 0a0d 0a20 2020  rc_array)....   
-0000c470: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0000c480: 6473 740d 0a20 2020 2020 2020 2065 6c73  dst..        els
-0000c490: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0000c4a0: 7265 7475 726e 2073 7263 5f61 7272 6179  return src_array
-0000c4b0: 0d0a 0d0a 2020 2020 4073 7461 7469 636d  ....    @staticm
-0000c4c0: 6574 686f 640d 0a20 2020 2064 6566 2063  ethod..    def c
-0000c4d0: 726f 7041 6c69 676e 6564 466f 6c64 6572  ropAlignedFolder
-0000c4e0: 280d 0a20 2020 2020 2020 2073 7263 5f64  (..        src_d
-0000c4f0: 6972 3a20 7374 722c 0d0a 2020 2020 2020  ir: str,..      
-0000c500: 2020 6d61 736b 3a20 556e 696f 6e5b 4461    mask: Union[Da
-0000c510: 7461 7365 742c 2073 7472 5d2c 0d0a 2020  taset, str],..  
-0000c520: 2020 2020 2020 7361 7665 746f 3a20 7374        saveto: st
-0000c530: 722c 0d0a 2020 2020 2920 2d3e 204e 6f6e  r,..    ) -> Non
-0000c540: 653a 0d0a 2020 2020 2020 2020 2222 2263  e:..        """c
-0000c550: 726f 7041 6c69 676e 6564 466f 6c64 6572  ropAlignedFolder
-0000c560: 2e0d 0a0d 0a20 2020 2020 2020 2020 2020  .....           
-0000c570: 2063 726f 7041 6c69 676e 6564 466f 6c64   cropAlignedFold
-0000c580: 6572 206d 6174 6368 6573 2074 6865 206c  er matches the l
-0000c590: 6f63 6174 696f 6e20 6f66 206e 6f64 6174  ocation of nodat
-0000c5a0: 6120 7661 6c75 6520 6672 6f6d 2073 7263  a value from src
-0000c5b0: 2072 6173 7465 7220 746f 2064 7374 0d0a   raster to dst..
-0000c5c0: 2020 2020 2020 2020 2020 2020 7261 7374              rast
-0000c5d0: 6572 2c20 4d61 736b 2069 7320 7768 6572  er, Mask is wher
-0000c5e0: 6520 7468 6520 4e6f 4461 7461 7661 6c75  e the NoDatavalu
-0000c5f0: 6520 7769 6c6c 2062 6520 7461 6b65 6e20  e will be taken 
-0000c600: 616e 6420 7468 6520 6c6f 6361 7469 6f6e  and the location
-0000c610: 206f 660d 0a20 2020 2020 2020 2020 2020   of..           
-0000c620: 2074 6869 7320 7661 6c75 6520 7372 635f   this value src_
-0000c630: 6469 7220 6973 2070 6174 6820 746f 2074  dir is path to t
-0000c640: 6865 2066 6f6c 6465 7220 7768 6572 6520  he folder where 
-0000c650: 7261 7374 6572 7320 6578 6973 7420 7768  rasters exist wh
-0000c660: 6572 6520 7765 0d0a 2020 2020 2020 2020  ere we..        
-0000c670: 2020 2020 6e65 6564 2074 6f20 7075 7420      need to put 
-0000c680: 7468 6520 4e6f 4461 7461 5661 6c75 6520  the NoDataValue 
-0000c690: 6f66 2074 6865 206d 6173 6b20 696e 2052  of the mask in R
-0000c6a0: 6173 7465 7242 2061 7420 7468 6520 7361  asterB at the sa
-0000c6b0: 6d65 206c 6f63 6174 696f 6e73 0d0a 0d0a  me locations....
-0000c6c0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-0000c6d0: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
-0000c6e0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-0000c6f0: 7372 635f 6469 7220 3a20 5b53 7472 696e  src_dir : [Strin
-0000c700: 675d 0d0a 2020 2020 2020 2020 2020 2020  g]..            
-0000c710: 7061 7468 206f 6620 7468 6520 666f 6c64  path of the fold
-0000c720: 6572 206f 6620 7468 6520 7261 7374 6572  er of the raster
-0000c730: 7320 796f 7520 7761 6e74 2074 6f20 7365  s you want to se
-0000c740: 7420 4e6f 6461 7461 2056 616c 7565 0d0a  t Nodata Value..
-0000c750: 2020 2020 2020 2020 2020 2020 6f6e 2074              on t
-0000c760: 6865 2073 616d 6520 6c6f 6361 7469 6f6e  he same location
-0000c770: 206f 6620 4e6f 6461 7461 5661 6c75 6520   of NodataValue 
-0000c780: 6f66 2052 6173 7465 7220 412c 2074 6865  of Raster A, the
-0000c790: 2066 6f6c 6465 7220 7368 6f75 6c64 0d0a   folder should..
-0000c7a0: 2020 2020 2020 2020 2020 2020 6e6f 7420              not 
-0000c7b0: 6861 7665 2061 6e79 206f 7468 6572 2066  have any other f
-0000c7c0: 696c 6573 2065 7863 6570 7420 7468 6520  iles except the 
-0000c7d0: 7261 7374 6572 730d 0a20 2020 2020 2020  rasters..       
-0000c7e0: 206d 6173 6b20 3a20 5b53 7472 696e 672f   mask : [String/
-0000c7f0: 6764 616c 2e44 6174 6173 6574 5d0d 0a20  gdal.Dataset].. 
-0000c800: 2020 2020 2020 2020 2020 2070 6174 682f             path/
-0000c810: 6764 616c 2e44 6174 6173 6574 206f 6620  gdal.Dataset of 
-0000c820: 7468 6520 6d61 736b 2072 6173 7465 7220  the mask raster 
-0000c830: 746f 2063 726f 7020 7468 6520 7261 7374  to crop the rast
-0000c840: 6572 7320 2874 6f20 6765 7420 7468 6520  ers (to get the 
-0000c850: 4e6f 4461 7461 2076 616c 7565 0d0a 2020  NoData value..  
-0000c860: 2020 2020 2020 2020 2020 616e 6420 6974            and it
-0000c870: 206c 6f63 6174 696f 6e20 696e 2074 6865   location in the
-0000c880: 2061 7272 6179 2920 4d61 736b 2073 686f   array) Mask sho
-0000c890: 756c 6420 696e 636c 7564 6520 7468 6520  uld include the 
-0000c8a0: 6e61 6d65 206f 6620 7468 6520 7261 7374  name of the rast
-0000c8b0: 6572 2061 6e64 2074 6865 0d0a 2020 2020  er and the..    
-0000c8c0: 2020 2020 2020 2020 6578 7465 6e73 696f          extensio
-0000c8d0: 6e20 6c69 6b65 2022 6461 7461 2f64 656d  n like "data/dem
-0000c8e0: 2e74 6966 222c 206f 7220 796f 7520 6361  .tif", or you ca
-0000c8f0: 6e20 7265 6164 2074 6865 206d 6173 6b20  n read the mask 
-0000c900: 7261 7374 6572 2075 7369 6e67 2067 6461  raster using gda
-0000c910: 6c20 616e 6420 7573 650d 0a20 2020 2020  l and use..     
-0000c920: 2020 2020 2020 2069 7320 7468 6520 6669         is the fi
-0000c930: 7273 7420 7061 7261 6d65 7465 7220 746f  rst parameter to
-0000c940: 2074 6865 2066 756e 6374 696f 6e2e 0d0a   the function...
-0000c950: 2020 2020 2020 2020 7361 7665 746f 203a          saveto :
-0000c960: 205b 5374 7269 6e67 5d0d 0a20 2020 2020   [String]..     
-0000c970: 2020 2020 2020 2070 6174 6820 7768 6572         path wher
-0000c980: 6520 6e65 7720 7261 7374 6572 7320 6172  e new rasters ar
-0000c990: 6520 676f 696e 6720 746f 2062 6520 7361  e going to be sa
-0000c9a0: 7665 6420 7769 7468 2065 7861 6374 0d0a  ved with exact..
-0000c9b0: 2020 2020 2020 2020 2020 2020 7361 6d65              same
-0000c9c0: 206f 6c64 206e 616d 6573 0d0a 0d0a 2020   old names....  
-0000c9d0: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
-0000c9e0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
-0000c9f0: 2020 2020 2020 2020 6e65 7720 7261 7374          new rast
-0000ca00: 6572 7320 6861 7665 2074 6865 2076 616c  ers have the val
-0000ca10: 7565 7320 6672 6f6d 2072 6173 7465 7273  ues from rasters
-0000ca20: 2069 6e20 425f 696e 7075 745f 7061 7468   in B_input_path
-0000ca30: 2077 6974 6820 7468 6520 4e6f 4461 7461   with the NoData
-0000ca40: 5661 6c75 6520 696e 2074 6865 2073 616d  Value in the sam
-0000ca50: 650d 0a20 2020 2020 2020 206c 6f63 6174  e..        locat
-0000ca60: 696f 6e73 206c 696b 6520 7261 7374 6572  ions like raster
-0000ca70: 2041 0d0a 0d0a 2020 2020 2020 2020 4578   A....        Ex
-0000ca80: 616d 706c 6573 0d0a 2020 2020 2020 2020  amples..        
-0000ca90: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-0000caa0: 2020 3e3e 3e20 6465 6d5f 7061 7468 203d    >>> dem_path =
-0000cab0: 2022 6578 616d 706c 6573 2f47 4953 2f64   "examples/GIS/d
-0000cac0: 6174 612f 6163 6334 3030 302e 7469 6622  ata/acc4000.tif"
-0000cad0: 0d0a 2020 2020 2020 2020 3e3e 3e20 7372  ..        >>> sr
-0000cae0: 635f 7061 7468 203d 2022 6578 616d 706c  c_path = "exampl
-0000caf0: 6573 2f47 4953 2f64 6174 612f 616c 6967  es/GIS/data/alig
-0000cb00: 6e65 645f 7261 7374 6572 732f 220d 0a20  ned_rasters/".. 
-0000cb10: 2020 2020 2020 203e 3e3e 206f 7574 5f70         >>> out_p
-0000cb20: 6174 6820 3d20 2265 7861 6d70 6c65 732f  ath = "examples/
-0000cb30: 4749 532f 6461 7461 2f63 726f 705f 616c  GIS/data/crop_al
-0000cb40: 6967 6e65 645f 666f 6c64 6572 2f22 0d0a  igned_folder/"..
-0000cb50: 2020 2020 2020 2020 3e3e 3e20 5261 7374          >>> Rast
-0000cb60: 6572 2e63 726f 7041 6c69 676e 6564 466f  er.cropAlignedFo
-0000cb70: 6c64 6572 2864 656d 5f70 6174 682c 2073  lder(dem_path, s
-0000cb80: 7263 5f70 6174 682c 206f 7574 5f70 6174  rc_path, out_pat
-0000cb90: 6829 0d0a 2020 2020 2020 2020 2222 220d  h)..        """.
-0000cba0: 0a20 2020 2020 2020 2023 2069 6620 7468  .        # if th
-0000cbb0: 6520 6d61 736b 2069 7320 6120 7374 7269  e mask is a stri
-0000cbc0: 6e67 0d0a 2020 2020 2020 2020 6966 2069  ng..        if i
-0000cbd0: 7369 6e73 7461 6e63 6528 6d61 736b 2c20  sinstance(mask, 
-0000cbe0: 7374 7229 3a0d 0a20 2020 2020 2020 2020  str):..         
-0000cbf0: 2020 2023 2063 6865 636b 2077 6574 6865     # check wethe
-0000cc00: 7220 7468 6520 7061 7468 2065 7869 7374  r the path exist
-0000cc10: 7320 6f72 206e 6f74 0d0a 2020 2020 2020  s or not..      
-0000cc20: 2020 2020 2020 6966 206e 6f74 206f 732e        if not os.
-0000cc30: 7061 7468 2e65 7869 7374 7328 6d61 736b  path.exists(mask
-0000cc40: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-0000cc50: 2020 2020 7261 6973 6520 4669 6c65 4e6f      raise FileNo
-0000cc60: 7446 6f75 6e64 4572 726f 7228 0d0a 2020  tFoundError(..  
+00000290: 2070 7972 616d 6964 732e 7574 696c 7320   pyramids.utils 
+000002a0: 696d 706f 7274 2028 0d0a 2020 2020 6764  import (..    gd
+000002b0: 616c 5f74 6f5f 6f67 725f 6474 7970 652c  al_to_ogr_dtype,
+000002c0: 0d0a 2020 2020 494e 5445 5250 4f4c 4154  ..    INTERPOLAT
+000002d0: 494f 4e5f 4d45 5448 4f44 532c 0d0a 2020  ION_METHODS,..  
+000002e0: 2020 4e55 4d50 595f 4744 414c 5f44 4154    NUMPY_GDAL_DAT
+000002f0: 415f 5459 5045 532c 0d0a 2020 2020 6764  A_TYPES,..    gd
+00000300: 616c 5f74 6f5f 6e75 6d70 795f 6474 7970  al_to_numpy_dtyp
+00000310: 652c 0d0a 2020 2020 6e75 6d70 795f 746f  e,..    numpy_to
+00000320: 5f67 6461 6c5f 6474 7970 652c 0d0a 2020  _gdal_dtype,..  
+00000330: 2020 6372 6561 7465 5f74 696d 655f 636f    create_time_co
+00000340: 6e76 6572 7369 6f6e 5f66 756e 632c 0d0a  nversion_func,..
+00000350: 2020 2020 4361 7461 6c6f 672c 0d0a 2020      Catalog,..  
+00000360: 2020 696d 706f 7274 5f63 6c65 6f70 6174    import_cleopat
+00000370: 7261 2c0d 0a29 0d0a 6672 6f6d 2070 7972  ra,..)..from pyr
+00000380: 616d 6964 732e 6572 726f 7273 2069 6d70  amids.errors imp
+00000390: 6f72 7420 280d 0a20 2020 2052 6561 644f  ort (..    ReadO
+000003a0: 6e6c 7945 7272 6f72 2c0d 0a20 2020 2044  nlyError,..    D
+000003b0: 6174 6173 6574 4e6f 466f 756e 6445 7272  atasetNoFoundErr
+000003c0: 6f72 2c0d 0a20 2020 204e 6f44 6174 6156  or,..    NoDataV
+000003d0: 616c 7565 4572 726f 722c 0d0a 2020 2020  alueError,..    
+000003e0: 416c 6967 6e6d 656e 7445 7272 6f72 2c0d  AlignmentError,.
+000003f0: 0a20 2020 2044 7269 7665 724e 6f74 4578  .    DriverNotEx
+00000400: 6973 7445 7272 6f72 2c0d 0a29 0d0a 0d0a  istError,..)....
+00000410: 7472 793a 0d0a 2020 2020 6672 6f6d 206f  try:..    from o
+00000420: 7367 656f 5f75 7469 6c73 2069 6d70 6f72  sgeo_utils impor
+00000430: 7420 6764 616c 5f6d 6572 6765 0d0a 6578  t gdal_merge..ex
+00000440: 6365 7074 204d 6f64 756c 654e 6f74 466f  cept ModuleNotFo
+00000450: 756e 6445 7272 6f72 3a0d 0a20 2020 206c  undError:..    l
+00000460: 6f67 6765 722e 7761 726e 696e 6728 0d0a  ogger.warning(..
+00000470: 2020 2020 2020 2020 226f 7367 656f 5f75          "osgeo_u
+00000480: 7469 6c73 206d 6f64 756c 6520 646f 6573  tils module does
+00000490: 206e 6f74 2065 7869 7374 2074 7279 2069   not exist try i
+000004a0: 6e73 7461 6c6c 2070 6970 2069 6e73 7461  nstall pip insta
+000004b0: 6c6c 206f 7367 656f 2d75 7469 6c73 2022  ll osgeo-utils "
+000004c0: 0d0a 2020 2020 290d 0a0d 0a66 726f 6d20  ..    )....from 
+000004d0: 6870 632e 6669 6c74 6572 2069 6d70 6f72  hpc.filter impor
+000004e0: 7420 6765 745f 7069 7865 6c73 2c20 6765  t get_pixels, ge
+000004f0: 745f 696e 6469 6365 7332 2c20 6765 745f  t_indices2, get_
+00000500: 7069 7865 6c73 322c 206c 6f63 6174 655f  pixels2, locate_
+00000510: 7661 6c75 6573 0d0a 6672 6f6d 2070 7972  values..from pyr
+00000520: 616d 6964 732e 6665 6174 7572 6563 6f6c  amids.featurecol
+00000530: 6c65 6374 696f 6e20 696d 706f 7274 2046  lection import F
+00000540: 6561 7475 7265 436f 6c6c 6563 7469 6f6e  eatureCollection
+00000550: 0d0a 6672 6f6d 2070 7972 616d 6964 7320  ..from pyramids 
+00000560: 696d 706f 7274 2069 6f0d 0a0d 0a44 4546  import io....DEF
+00000570: 4155 4c54 5f4e 4f5f 4441 5441 5f56 414c  AULT_NO_DATA_VAL
+00000580: 5545 203d 202d 3939 3939 0d0a 4341 5441  UE = -9999..CATA
+00000590: 4c4f 4720 3d20 4361 7461 6c6f 6728 7261  LOG = Catalog(ra
+000005a0: 7374 6572 5f64 7269 7665 723d 5472 7565  ster_driver=True
+000005b0: 290d 0a0d 0a23 2042 7920 6465 6661 756c  )....# By defaul
+000005c0: 742c 2074 6865 2047 4441 4c20 616e 6420  t, the GDAL and 
+000005d0: 4f47 5220 5079 7468 6f6e 2062 696e 6469  OGR Python bindi
+000005e0: 6e67 7320 646f 206e 6f74 2072 6169 7365  ngs do not raise
+000005f0: 2065 7863 6570 7469 6f6e 7320 7768 656e   exceptions when
+00000600: 2065 7272 6f72 7320 6f63 6375 722e 2049   errors occur. I
+00000610: 6e73 7465 6164 2074 6865 7920 7265 7475  nstead they retu
+00000620: 726e 2061 6e20 6572 726f 720d 0a23 2076  rn an error..# v
+00000630: 616c 7565 2073 7563 6820 6173 204e 6f6e  alue such as Non
+00000640: 6520 616e 6420 7772 6974 6520 616e 2065  e and write an e
+00000650: 7272 6f72 206d 6573 7361 6765 2074 6f20  rror message to 
+00000660: 7379 732e 7374 646f 7574 2c20 746f 2072  sys.stdout, to r
+00000670: 6570 6f72 7420 6572 726f 7273 2062 7920  eport errors by 
+00000680: 7261 6973 696e 6720 6578 6365 7074 696f  raising exceptio
+00000690: 6e73 2e20 596f 7520 6361 6e20 656e 6162  ns. You can enab
+000006a0: 6c65 0d0a 2320 7468 6973 2062 6568 6176  le..# this behav
+000006b0: 696f 7220 696e 2047 4441 4c20 616e 6420  ior in GDAL and 
+000006c0: 4f47 5220 6279 2063 616c 6c69 6e67 2074  OGR by calling t
+000006d0: 6865 2055 7365 4578 6365 7074 696f 6e73  he UseExceptions
+000006e0: 2829 0d0a 6764 616c 2e55 7365 4578 6365  ()..gdal.UseExce
+000006f0: 7074 696f 6e73 2829 0d0a 2320 6764 616c  ptions()..# gdal
+00000700: 2e45 7272 6f72 5265 7365 7428 290d 0a0d  .ErrorReset()...
+00000710: 0a0d 0a63 6c61 7373 2044 6174 6173 6574  ...class Dataset
+00000720: 3a0d 0a20 2020 2022 2222 4461 7461 7365  :..    """Datase
+00000730: 7420 636c 6173 7320 636f 6e74 6169 6e73  t class contains
+00000740: 206d 6574 686f 6473 2074 6f20 6465 616c   methods to deal
+00000750: 2077 6974 6820 7261 7374 6572 7320 616e   with rasters an
+00000760: 6420 6e65 7463 6466 2066 696c 6573 2c20  d netcdf files, 
+00000770: 6368 616e 6765 2070 726f 6a65 6374 696f  change projectio
+00000780: 6e20 616e 6420 636f 6f72 6469 6e61 7465  n and coordinate
+00000790: 2073 7973 7465 6d73 2e22 2222 0d0a 0d0a   systems."""....
+000007a0: 2020 2020 6465 6661 756c 745f 6e6f 5f64      default_no_d
+000007b0: 6174 615f 7661 6c75 6520 3d20 4445 4641  ata_value = DEFA
+000007c0: 554c 545f 4e4f 5f44 4154 415f 5641 4c55  ULT_NO_DATA_VALU
+000007d0: 450d 0a0d 0a20 2020 2064 6566 205f 5f69  E....    def __i
+000007e0: 6e69 745f 5f28 7365 6c66 2c20 7372 633a  nit__(self, src:
+000007f0: 2067 6461 6c2e 4461 7461 7365 7429 3a0d   gdal.Dataset):.
+00000800: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+00000810: 6973 696e 7374 616e 6365 2873 7263 2c20  isinstance(src, 
+00000820: 6764 616c 2e44 6174 6173 6574 293a 0d0a  gdal.Dataset):..
+00000830: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00000840: 6520 5479 7065 4572 726f 7228 0d0a 2020  e TypeError(..  
+00000850: 2020 2020 2020 2020 2020 2020 2020 2273                "s
+00000860: 7263 2073 686f 756c 6420 6265 2072 6561  rc should be rea
+00000870: 6420 7573 696e 6720 6764 616c 2028 6764  d using gdal (gd
+00000880: 616c 2064 6174 6173 6574 2070 6c65 6173  al dataset pleas
+00000890: 6520 7265 6164 2069 7420 7573 696e 6720  e read it using 
+000008a0: 6764 616c 220d 0a20 2020 2020 2020 2020  gdal"..         
+000008b0: 2020 2020 2020 2066 2220 6c69 6272 6172         f" librar
+000008c0: 7929 2067 6976 656e 207b 7479 7065 2873  y) given {type(s
+000008d0: 7263 297d 220d 0a20 2020 2020 2020 2020  rc)}"..         
+000008e0: 2020 2029 0d0a 2020 2020 2020 2020 7365     )..        se
+000008f0: 6c66 2e5f 7261 7374 6572 203d 2073 7263  lf._raster = src
+00000900: 0d0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
+00000910: 6765 6f74 7261 6e73 666f 726d 203d 2073  geotransform = s
+00000920: 7263 2e47 6574 4765 6f54 7261 6e73 666f  rc.GetGeoTransfo
+00000930: 726d 2829 0d0a 2020 2020 2020 2020 7365  rm()..        se
+00000940: 6c66 2e5f 6365 6c6c 5f73 697a 6520 3d20  lf._cell_size = 
+00000950: 7365 6c66 2e67 656f 7472 616e 7366 6f72  self.geotransfor
+00000960: 6d5b 315d 0d0a 2020 2020 2020 2020 7365  m[1]..        se
+00000970: 6c66 2e5f 6d65 7461 5f64 6174 6120 3d20  lf._meta_data = 
+00000980: 7372 632e 4765 744d 6574 6164 6174 6128  src.GetMetadata(
+00000990: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+000009a0: 5f66 696c 655f 6e61 6d65 203d 2073 7263  _file_name = src
+000009b0: 2e47 6574 4465 7363 7269 7074 696f 6e28  .GetDescription(
+000009c0: 290d 0a20 2020 2020 2020 2023 2070 726f  )..        # pro
+000009d0: 6a65 6374 696f 6e20 6461 7461 0d0a 2020  jection data..  
+000009e0: 2020 2020 2020 2320 7468 6520 6570 7367        # the epsg
+000009f0: 2070 726f 7065 7274 7920 7265 7475 726e   property return
+00000a00: 7320 7468 6520 7661 6c75 6520 6f66 2074  s the value of t
+00000a10: 6865 205f 6570 7367 2061 7474 7269 6275  he _epsg attribu
+00000a20: 7465 2073 6f20 6966 2074 6865 2070 726f  te so if the pro
+00000a30: 6a65 6374 696f 6e20 6368 616e 6765 7320  jection changes 
+00000a40: 696e 2061 6e79 2066 756e 6374 696f 6e20  in any function 
+00000a50: 7468 650d 0a20 2020 2020 2020 2023 2066  the..        # f
+00000a60: 756e 6374 696f 6e20 7368 6f75 6c64 2061  unction should a
+00000a70: 6c73 6f20 6368 616e 6765 2074 6865 2076  lso change the v
+00000a80: 616c 7565 206f 6620 7468 6520 5f65 7073  alue of the _eps
+00000a90: 6720 6174 7472 6962 7574 652e 0d0a 2020  g attribute...  
+00000aa0: 2020 2020 2020 7365 6c66 2e5f 6570 7367        self._epsg
+00000ab0: 203d 2073 656c 662e 5f67 6574 5f65 7073   = self._get_eps
+00000ac0: 6728 290d 0a20 2020 2020 2020 2023 2076  g()..        # v
+00000ad0: 6172 6961 626c 6573 2061 6e64 2073 7562  ariables and sub
+00000ae0: 7365 7473 0d0a 2020 2020 2020 2020 7365  sets..        se
+00000af0: 6c66 2e73 7562 7365 7473 203d 2073 7263  lf.subsets = src
+00000b00: 2e47 6574 5375 6244 6174 6173 6574 7328  .GetSubDatasets(
+00000b10: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+00000b20: 5f76 6172 6961 626c 6573 203d 2073 656c  _variables = sel
+00000b30: 662e 6765 745f 7661 7269 6162 6c65 7328  f.get_variables(
+00000b40: 290d 0a20 2020 2020 2020 2023 2061 7272  )..        # arr
+00000b50: 6179 2061 6e64 2064 696d 656e 7369 6f6e  ay and dimension
+00000b60: 730d 0a20 2020 2020 2020 2073 656c 662e  s..        self.
+00000b70: 5f72 6f77 7320 3d20 7372 632e 5261 7374  _rows = src.Rast
+00000b80: 6572 5953 697a 650d 0a20 2020 2020 2020  erYSize..       
+00000b90: 2073 656c 662e 5f63 6f6c 756d 6e73 203d   self._columns =
+00000ba0: 2073 7263 2e52 6173 7465 7258 5369 7a65   src.RasterXSize
+00000bb0: 0d0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
+00000bc0: 6261 6e64 5f63 6f75 6e74 203d 2073 7263  band_count = src
+00000bd0: 2e52 6173 7465 7243 6f75 6e74 0d0a 2020  .RasterCount..  
+00000be0: 2020 2020 2020 6966 206c 656e 2873 656c        if len(sel
+00000bf0: 662e 7375 6273 6574 7329 203e 2030 3a0d  f.subsets) > 0:.
+00000c00: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00000c10: 662e 5f74 696d 655f 7374 616d 7020 3d20  f._time_stamp = 
+00000c20: 7365 6c66 2e5f 6765 745f 7469 6d65 5f76  self._get_time_v
+00000c30: 6172 6961 626c 6528 290d 0a20 2020 2020  ariable()..     
+00000c40: 2020 2020 2020 2073 656c 662e 5f6c 6174         self._lat
+00000c50: 2c20 7365 6c66 2e5f 6c6f 6e20 3d20 7365  , self._lon = se
+00000c60: 6c66 2e5f 6765 745f 6c61 745f 6c6f 6e28  lf._get_lat_lon(
+00000c70: 290d 0a0d 0a20 2020 2020 2020 2073 656c  )....        sel
+00000c80: 662e 5f6e 6f5f 6461 7461 5f76 616c 7565  f._no_data_value
+00000c90: 203d 205b 0d0a 2020 2020 2020 2020 2020   = [..          
+00000ca0: 2020 7372 632e 4765 7452 6173 7465 7242    src.GetRasterB
+00000cb0: 616e 6428 6929 2e47 6574 4e6f 4461 7461  and(i).GetNoData
+00000cc0: 5661 6c75 6528 2920 666f 7220 6920 696e  Value() for i in
+00000cd0: 2072 616e 6765 2831 2c20 7365 6c66 2e62   range(1, self.b
+00000ce0: 616e 645f 636f 756e 7420 2b20 3129 0d0a  and_count + 1)..
+00000cf0: 2020 2020 2020 2020 5d0d 0a20 2020 2020          ]..     
+00000d00: 2020 2073 656c 662e 5f64 7479 7065 203d     self._dtype =
+00000d10: 205b 0d0a 2020 2020 2020 2020 2020 2020   [..            
+00000d20: 7372 632e 4765 7452 6173 7465 7242 616e  src.GetRasterBan
+00000d30: 6428 6929 2e44 6174 6154 7970 6520 666f  d(i).DataType fo
+00000d40: 7220 6920 696e 2072 616e 6765 2831 2c20  r i in range(1, 
+00000d50: 7365 6c66 2e62 616e 645f 636f 756e 7420  self.band_count 
+00000d60: 2b20 3129 0d0a 2020 2020 2020 2020 5d0d  + 1)..        ].
+00000d70: 0a0d 0a20 2020 2020 2020 2073 656c 662e  ...        self.
+00000d80: 5f62 616e 645f 6e61 6d65 7320 3d20 7365  _band_names = se
+00000d90: 6c66 2e67 6574 5f62 616e 645f 6e61 6d65  lf.get_band_name
+00000da0: 7328 290d 0a0d 0a20 2020 2064 6566 205f  s()....    def _
+00000db0: 5f73 7472 5f5f 2873 656c 6629 3a0d 0a20  _str__(self):.. 
+00000dc0: 2020 2020 2020 206d 6573 7361 6765 203d         message =
+00000dd0: 2066 2222 220d 0a20 2020 2020 2020 2020   f"""..         
+00000de0: 2020 2046 696c 653a 207b 7365 6c66 2e66     File: {self.f
+00000df0: 696c 655f 6e61 6d65 7d0d 0a20 2020 2020  ile_name}..     
+00000e00: 2020 2020 2020 2043 656c 6c20 7369 7a65         Cell size
+00000e10: 3a20 7b73 656c 662e 6365 6c6c 5f73 697a  : {self.cell_siz
+00000e20: 657d 0d0a 2020 2020 2020 2020 2020 2020  e}..            
+00000e30: 4550 5347 3a20 7b73 656c 662e 6570 7367  EPSG: {self.epsg
+00000e40: 7d0d 0a20 2020 2020 2020 2020 2020 2056  }..            V
+00000e50: 6172 6961 626c 6573 3a20 7b73 656c 662e  ariables: {self.
+00000e60: 7661 7269 6162 6c65 737d 0d0a 2020 2020  variables}..    
+00000e70: 2020 2020 2020 2020 4e75 6d62 6572 206f          Number o
+00000e80: 6620 4261 6e64 733a 207b 7365 6c66 2e62  f Bands: {self.b
+00000e90: 616e 645f 636f 756e 747d 0d0a 2020 2020  and_count}..    
+00000ea0: 2020 2020 2020 2020 4261 6e64 206e 616d          Band nam
+00000eb0: 6573 3a20 7b73 656c 662e 6261 6e64 5f6e  es: {self.band_n
+00000ec0: 616d 6573 7d0d 0a20 2020 2020 2020 2020  ames}..         
+00000ed0: 2020 2044 696d 656e 7369 6f6e 3a20 7b73     Dimension: {s
+00000ee0: 656c 662e 726f 7773 202a 2073 656c 662e  elf.rows * self.
+00000ef0: 636f 6c75 6d6e 737d 0d0a 2020 2020 2020  columns}..      
+00000f00: 2020 2020 2020 4d61 736b 3a20 7b73 656c        Mask: {sel
+00000f10: 662e 5f6e 6f5f 6461 7461 5f76 616c 7565  f._no_data_value
+00000f20: 5b30 5d7d 0d0a 2020 2020 2020 2020 2020  [0]}..          
+00000f30: 2020 4461 7461 2074 7970 653a 207b 7365    Data type: {se
+00000f40: 6c66 2e64 7479 7065 5b30 5d7d 0d0a 2020  lf.dtype[0]}..  
+00000f50: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+00000f60: 2020 2072 6574 7572 6e20 6d65 7373 6167     return messag
+00000f70: 650d 0a0d 0a20 2020 2064 6566 205f 5f72  e....    def __r
+00000f80: 6570 725f 5f28 7365 6c66 293a 0d0a 2020  epr__(self):..  
+00000f90: 2020 2020 2020 6d65 7373 6167 6520 3d20        message = 
+00000fa0: 2222 220d 0a20 2020 2020 2020 2020 2020  """..           
+00000fb0: 2046 696c 653a 207b 307d 0d0a 2020 2020   File: {0}..    
+00000fc0: 2020 2020 2020 2020 4365 6c6c 2073 697a          Cell siz
+00000fd0: 653a 207b 317d 0d0a 2020 2020 2020 2020  e: {1}..        
+00000fe0: 2020 2020 4550 5347 3a20 7b32 7d0d 0a20      EPSG: {2}.. 
+00000ff0: 2020 2020 2020 2020 2020 2056 6172 6961             Varia
+00001000: 626c 6573 3a20 7b33 7d0d 0a20 2020 2020  bles: {3}..     
+00001010: 2020 2020 2020 204e 756d 6265 7220 6f66         Number of
+00001020: 2042 616e 6473 3a20 7b34 7d0d 0a20 2020   Bands: {4}..   
+00001030: 2020 2020 2020 2020 2042 616e 6420 6e61           Band na
+00001040: 6d65 733a 207b 357d 0d0a 2020 2020 2020  mes: {5}..      
+00001050: 2020 2020 2020 4469 6d65 6e73 696f 6e3a        Dimension:
+00001060: 207b 367d 202a 207b 377d 0d0a 2020 2020   {6} * {7}..    
+00001070: 2020 2020 2020 2020 4d61 736b 3a20 7b38          Mask: {8
+00001080: 7d0d 0a20 2020 2020 2020 2020 2020 2044  }..            D
+00001090: 6174 6120 7479 7065 3a20 7b39 7d0d 0a20  ata type: {9}.. 
+000010a0: 2020 2020 2020 2020 2020 2070 726f 6a65             proje
+000010b0: 6374 696f 6e3a 207b 3130 7d0d 0a20 2020  ction: {10}..   
+000010c0: 2020 2020 2020 2020 204d 6574 6164 6174           Metadat
+000010d0: 613a 207b 3131 7d0d 0a20 2020 2020 2020  a: {11}..       
+000010e0: 2022 2222 2e66 6f72 6d61 7428 0d0a 2020   """.format(..  
+000010f0: 2020 2020 2020 2020 2020 7365 6c66 2e66            self.f
+00001100: 696c 655f 6e61 6d65 2c0d 0a20 2020 2020  ile_name,..     
+00001110: 2020 2020 2020 2073 656c 662e 6365 6c6c         self.cell
+00001120: 5f73 697a 652c 0d0a 2020 2020 2020 2020  _size,..        
+00001130: 2020 2020 7365 6c66 2e65 7073 672c 0d0a      self.epsg,..
+00001140: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00001150: 2e76 6172 6961 626c 6573 2c0d 0a20 2020  .variables,..   
+00001160: 2020 2020 2020 2020 2073 656c 662e 6261           self.ba
+00001170: 6e64 5f63 6f75 6e74 2c0d 0a20 2020 2020  nd_count,..     
+00001180: 2020 2020 2020 2073 656c 662e 6261 6e64         self.band
+00001190: 5f6e 616d 6573 2c0d 0a20 2020 2020 2020  _names,..       
+000011a0: 2020 2020 2073 656c 662e 726f 7773 2c0d       self.rows,.
+000011b0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000011c0: 662e 636f 6c75 6d6e 732c 0d0a 2020 2020  f.columns,..    
+000011d0: 2020 2020 2020 2020 7365 6c66 2e5f 6e6f          self._no
+000011e0: 5f64 6174 615f 7661 6c75 655b 305d 2c0d  _data_value[0],.
+000011f0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00001200: 662e 6474 7970 655b 305d 2c0d 0a20 2020  f.dtype[0],..   
+00001210: 2020 2020 2020 2020 2073 656c 662e 6372           self.cr
+00001220: 732c 0d0a 2020 2020 2020 2020 2020 2020  s,..            
+00001230: 7365 6c66 2e6d 6574 615f 6461 7461 2c0d  self.meta_data,.
+00001240: 0a20 2020 2020 2020 2029 0d0a 2020 2020  .        )..    
+00001250: 2020 2020 7265 7475 726e 206d 6573 7361      return messa
+00001260: 6765 0d0a 0d0a 2020 2020 4070 726f 7065  ge....    @prope
+00001270: 7274 790d 0a20 2020 2064 6566 2072 6173  rty..    def ras
+00001280: 7465 7228 7365 6c66 2920 2d3e 2067 6461  ter(self) -> gda
+00001290: 6c2e 4461 7461 7365 743a 0d0a 2020 2020  l.Dataset:..    
+000012a0: 2020 2020 2222 2247 4441 4c20 4461 7461      """GDAL Data
+000012b0: 7365 7422 2222 0d0a 2020 2020 2020 2020  set"""..        
+000012c0: 7265 7475 726e 2073 656c 662e 5f72 6173  return self._ras
+000012d0: 7465 720d 0a0d 0a20 2020 2040 7261 7374  ter....    @rast
+000012e0: 6572 2e73 6574 7465 720d 0a20 2020 2064  er.setter..    d
+000012f0: 6566 2072 6173 7465 7228 7365 6c66 2c20  ef raster(self, 
+00001300: 7661 6c75 653a 2067 6461 6c2e 4461 7461  value: gdal.Data
+00001310: 7365 7429 3a0d 0a20 2020 2020 2020 2073  set):..        s
+00001320: 656c 662e 5f72 6173 7465 7220 3d20 7661  elf._raster = va
+00001330: 6c75 650d 0a0d 0a20 2020 2040 7072 6f70  lue....    @prop
+00001340: 6572 7479 0d0a 2020 2020 6465 6620 7661  erty..    def va
+00001350: 6c75 6573 2873 656c 6629 202d 3e20 6e70  lues(self) -> np
+00001360: 2e6e 6461 7272 6179 3a0d 0a20 2020 2020  .ndarray:..     
+00001370: 2020 2072 6574 7572 6e20 7365 6c66 2e72     return self.r
+00001380: 6561 645f 6172 7261 7928 6261 6e64 3d4e  ead_array(band=N
+00001390: 6f6e 6529 0d0a 0d0a 2020 2020 4070 726f  one)....    @pro
+000013a0: 7065 7274 790d 0a20 2020 2064 6566 2072  perty..    def r
+000013b0: 6f77 7328 7365 6c66 2920 2d3e 2069 6e74  ows(self) -> int
+000013c0: 3a0d 0a20 2020 2020 2020 2022 2222 4e75  :..        """Nu
+000013d0: 6d62 6572 206f 6620 726f 7773 2069 6e20  mber of rows in 
+000013e0: 7468 6520 7261 7374 6572 2061 7272 6179  the raster array
+000013f0: 2e22 2222 0d0a 2020 2020 2020 2020 7265  ."""..        re
+00001400: 7475 726e 2073 656c 662e 5f72 6f77 730d  turn self._rows.
+00001410: 0a0d 0a20 2020 2040 7072 6f70 6572 7479  ...    @property
+00001420: 0d0a 2020 2020 6465 6620 636f 6c75 6d6e  ..    def column
+00001430: 7328 7365 6c66 2920 2d3e 2069 6e74 3a0d  s(self) -> int:.
+00001440: 0a20 2020 2020 2020 2022 2222 4e75 6d62  .        """Numb
+00001450: 6572 206f 6620 636f 6c75 6d6e 7320 696e  er of columns in
+00001460: 2074 6865 2072 6173 7465 7220 6172 7261   the raster arra
+00001470: 792e 2222 220d 0a20 2020 2020 2020 2072  y."""..        r
+00001480: 6574 7572 6e20 7365 6c66 2e5f 636f 6c75  eturn self._colu
+00001490: 6d6e 730d 0a0d 0a20 2020 2040 7072 6f70  mns....    @prop
+000014a0: 6572 7479 0d0a 2020 2020 6465 6620 7368  erty..    def sh
+000014b0: 6170 6528 7365 6c66 293a 0d0a 2020 2020  ape(self):..    
+000014c0: 2020 2020 2222 2244 6174 6173 6574 2073      """Dataset s
+000014d0: 6861 7065 2222 220d 0a20 2020 2020 2020  hape"""..       
+000014e0: 2072 6574 7572 6e20 7365 6c66 2e62 616e   return self.ban
+000014f0: 645f 636f 756e 742c 2073 656c 662e 726f  d_count, self.ro
+00001500: 7773 2c20 7365 6c66 2e63 6f6c 756d 6e73  ws, self.columns
+00001510: 0d0a 0d0a 2020 2020 4070 726f 7065 7274  ....    @propert
+00001520: 790d 0a20 2020 2064 6566 2067 656f 7472  y..    def geotr
+00001530: 616e 7366 6f72 6d28 7365 6c66 293a 0d0a  ansform(self):..
+00001540: 2020 2020 2020 2020 2222 2257 4b54 2070          """WKT p
+00001550: 726f 6a65 6374 696f 6e2e 2222 220d 0a20  rojection.""".. 
+00001560: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00001570: 6c66 2e5f 6765 6f74 7261 6e73 666f 726d  lf._geotransform
+00001580: 0d0a 0d0a 2020 2020 4070 726f 7065 7274  ....    @propert
+00001590: 790d 0a20 2020 2064 6566 2070 6976 6f74  y..    def pivot
+000015a0: 5f70 6f69 6e74 2873 656c 6629 3a0d 0a20  _point(self):.. 
+000015b0: 2020 2020 2020 2022 2222 546f 7020 6c65         """Top le
+000015c0: 6674 2063 6f72 6e65 7220 636f 6f72 6469  ft corner coordi
+000015d0: 6e61 7465 732e 2222 220d 0a20 2020 2020  nates."""..     
+000015e0: 2020 2078 6d69 6e2c 205f 2c20 5f2c 2079     xmin, _, _, y
+000015f0: 6d61 782c 205f 2c20 5f20 3d20 7365 6c66  max, _, _ = self
+00001600: 2e5f 6765 6f74 7261 6e73 666f 726d 0d0a  ._geotransform..
+00001610: 2020 2020 2020 2020 7265 7475 726e 2078          return x
+00001620: 6d69 6e2c 2079 6d61 780d 0a0d 0a20 2020  min, ymax....   
+00001630: 2040 7072 6f70 6572 7479 0d0a 2020 2020   @property..    
+00001640: 6465 6620 626f 756e 6473 2873 656c 6629  def bounds(self)
+00001650: 202d 3e20 4765 6f44 6174 6146 7261 6d65   -> GeoDataFrame
+00001660: 3a0d 0a20 2020 2020 2020 2022 2222 626f  :..        """bo
+00001670: 756e 6473 2222 220d 0a20 2020 2020 2020  unds"""..       
+00001680: 2072 6574 7572 6e20 7365 6c66 2e5f 6361   return self._ca
+00001690: 6c63 756c 6174 655f 626f 756e 6473 2829  lculate_bounds()
+000016a0: 0d0a 0d0a 2020 2020 4070 726f 7065 7274  ....    @propert
+000016b0: 790d 0a20 2020 2064 6566 2062 626f 7828  y..    def bbox(
+000016c0: 7365 6c66 2920 2d3e 204c 6973 743a 0d0a  self) -> List:..
+000016d0: 2020 2020 2020 2020 2222 225b 786d 696e          """[xmin
+000016e0: 2c20 796d 696e 2c20 786d 6178 2c20 796d  , ymin, xmax, ym
+000016f0: 6178 5d22 2222 0d0a 2020 2020 2020 2020  ax]"""..        
+00001700: 7265 7475 726e 2073 656c 662e 5f63 616c  return self._cal
+00001710: 6375 6c61 7465 5f62 626f 7828 290d 0a0d  culate_bbox()...
+00001720: 0a20 2020 2040 7072 6f70 6572 7479 0d0a  .    @property..
+00001730: 2020 2020 6465 6620 6570 7367 2873 656c      def epsg(sel
+00001740: 6629 3a0d 0a20 2020 2020 2020 2022 2222  f):..        """
+00001750: 574b 5420 7072 6f6a 6563 7469 6f6e 2e22  WKT projection."
+00001760: 2222 0d0a 2020 2020 2020 2020 7265 7475  ""..        retu
+00001770: 726e 2073 656c 662e 5f65 7073 670d 0a0d  rn self._epsg...
+00001780: 0a20 2020 2040 7072 6f70 6572 7479 0d0a  .    @property..
+00001790: 2020 2020 6465 6620 6c6f 6e28 7365 6c66      def lon(self
+000017a0: 293a 0d0a 2020 2020 2020 2020 2222 224c  ):..        """L
+000017b0: 6f6e 6769 7475 6465 2063 6f6f 7264 696e  ongitude coordin
+000017c0: 6174 6573 2222 220d 0a20 2020 2020 2020  ates"""..       
+000017d0: 2069 6620 6e6f 7420 6861 7361 7474 7228   if not hasattr(
+000017e0: 7365 6c66 2c20 225f 6c6f 6e22 293a 0d0a  self, "_lon"):..
+000017f0: 2020 2020 2020 2020 2020 2020 7069 766f              pivo
+00001800: 745f 7820 3d20 7365 6c66 2e70 6976 6f74  t_x = self.pivot
+00001810: 5f70 6f69 6e74 5b30 5d0d 0a20 2020 2020  _point[0]..     
+00001820: 2020 2020 2020 2063 656c 6c5f 7369 7a65         cell_size
+00001830: 203d 2073 656c 662e 6365 6c6c 5f73 697a   = self.cell_siz
+00001840: 650d 0a20 2020 2020 2020 2020 2020 2078  e..            x
+00001850: 5f63 6f6f 7264 7320 3d20 5b0d 0a20 2020  _coords = [..   
+00001860: 2020 2020 2020 2020 2020 2020 2070 6976               piv
+00001870: 6f74 5f78 202b 2069 202a 2063 656c 6c5f  ot_x + i * cell_
+00001880: 7369 7a65 202b 2063 656c 6c5f 7369 7a65  size + cell_size
+00001890: 202f 2032 2066 6f72 2069 2069 6e20 7261   / 2 for i in ra
+000018a0: 6e67 6528 7365 6c66 2e63 6f6c 756d 6e73  nge(self.columns
+000018b0: 290d 0a20 2020 2020 2020 2020 2020 205d  )..            ]
+000018c0: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+000018d0: 0a20 2020 2020 2020 2020 2020 2023 2069  .            # i
+000018e0: 6e20 6361 7365 2074 6865 206c 6174 2061  n case the lat a
+000018f0: 6e64 206c 6f6e 2061 7265 2072 6561 6420  nd lon are read 
+00001900: 6672 6f6d 2074 6865 206e 6574 6364 6620  from the netcdf 
+00001910: 6669 6c65 206a 7573 7420 7265 6164 2074  file just read t
+00001920: 6865 2076 616c 7565 7320 6672 6f6d 2074  he values from t
+00001930: 6865 2066 696c 650d 0a20 2020 2020 2020  he file..       
+00001940: 2020 2020 2078 5f63 6f6f 7264 7320 3d20       x_coords = 
+00001950: 7365 6c66 2e5f 6c6f 6e0d 0a20 2020 2020  self._lon..     
+00001960: 2020 2072 6574 7572 6e20 6e70 2e61 7272     return np.arr
+00001970: 6179 2878 5f63 6f6f 7264 7329 0d0a 0d0a  ay(x_coords)....
+00001980: 2020 2020 4070 726f 7065 7274 790d 0a20      @property.. 
+00001990: 2020 2064 6566 206c 6174 2873 656c 6629     def lat(self)
+000019a0: 3a0d 0a20 2020 2020 2020 2022 2222 4c61  :..        """La
+000019b0: 7469 7475 6465 2d63 6f6f 7264 696e 6174  titude-coordinat
+000019c0: 6522 2222 0d0a 2020 2020 2020 2020 6966  e"""..        if
+000019d0: 206e 6f74 2068 6173 6174 7472 2873 656c   not hasattr(sel
+000019e0: 662c 2022 5f6c 6174 2229 3a0d 0a20 2020  f, "_lat"):..   
+000019f0: 2020 2020 2020 2020 2070 6976 6f74 5f79           pivot_y
+00001a00: 203d 2073 656c 662e 7069 766f 745f 706f   = self.pivot_po
+00001a10: 696e 745b 315d 0d0a 2020 2020 2020 2020  int[1]..        
+00001a20: 2020 2020 6365 6c6c 5f73 697a 6520 3d20      cell_size = 
+00001a30: 7365 6c66 2e63 656c 6c5f 7369 7a65 0d0a  self.cell_size..
+00001a40: 2020 2020 2020 2020 2020 2020 795f 636f              y_co
+00001a50: 6f72 6473 203d 205b 0d0a 2020 2020 2020  ords = [..      
+00001a60: 2020 2020 2020 2020 2020 7069 766f 745f            pivot_
+00001a70: 7920 2d20 6920 2a20 6365 6c6c 5f73 697a  y - i * cell_siz
+00001a80: 6520 2d20 6365 6c6c 5f73 697a 6520 2f20  e - cell_size / 
+00001a90: 3220 666f 7220 6920 696e 2072 616e 6765  2 for i in range
+00001aa0: 2873 656c 662e 726f 7773 290d 0a20 2020  (self.rows)..   
+00001ab0: 2020 2020 2020 2020 205d 0d0a 2020 2020           ]..    
+00001ac0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00001ad0: 2020 2020 2020 2023 2069 6e20 6361 7365         # in case
+00001ae0: 2074 6865 206c 6174 2061 6e64 206c 6f6e   the lat and lon
+00001af0: 2061 7265 2072 6561 6420 6672 6f6d 2074   are read from t
+00001b00: 6865 206e 6574 6364 6620 6669 6c65 206a  he netcdf file j
+00001b10: 7573 7420 7265 6164 2074 6865 2076 616c  ust read the val
+00001b20: 7565 7320 6672 6f6d 2074 6865 2066 696c  ues from the fil
+00001b30: 650d 0a20 2020 2020 2020 2020 2020 2079  e..            y
+00001b40: 5f63 6f6f 7264 7320 3d20 7365 6c66 2e5f  _coords = self._
+00001b50: 6c61 740d 0a20 2020 2020 2020 2072 6574  lat..        ret
+00001b60: 7572 6e20 6e70 2e61 7272 6179 2879 5f63  urn np.array(y_c
+00001b70: 6f6f 7264 7329 0d0a 0d0a 2020 2020 4070  oords)....    @p
+00001b80: 726f 7065 7274 790d 0a20 2020 2064 6566  roperty..    def
+00001b90: 2078 2873 656c 6629 3a0d 0a20 2020 2020   x(self):..     
+00001ba0: 2020 2022 2222 782d 636f 6f72 6469 6e61     """x-coordina
+00001bb0: 7465 2222 220d 0a20 2020 2020 2020 2023  te"""..        #
+00001bc0: 2058 5f63 6f6f 7264 696e 6174 6520 3d20   X_coordinate = 
+00001bd0: 7570 7065 726c 6566 7420 636f 726e 6572  upperleft corner
+00001be0: 2078 202b 2069 6e64 6578 202a 2063 656c   x + index * cel
+00001bf0: 6c20 7369 7a65 202b 2063 656c 7369 7a65  l size + celsize
+00001c00: 2f32 0d0a 2020 2020 2020 2020 6966 206e  /2..        if n
+00001c10: 6f74 2068 6173 6174 7472 2873 656c 662c  ot hasattr(self,
+00001c20: 2022 5f6c 6f6e 2229 3a0d 0a20 2020 2020   "_lon"):..     
+00001c30: 2020 2020 2020 2070 6976 6f74 5f78 203d         pivot_x =
+00001c40: 2073 656c 662e 7069 766f 745f 706f 696e   self.pivot_poin
+00001c50: 745b 305d 0d0a 2020 2020 2020 2020 2020  t[0]..          
+00001c60: 2020 6365 6c6c 5f73 697a 6520 3d20 7365    cell_size = se
+00001c70: 6c66 2e63 656c 6c5f 7369 7a65 0d0a 2020  lf.cell_size..  
+00001c80: 2020 2020 2020 2020 2020 785f 636f 6f72            x_coor
+00001c90: 6473 203d 205b 0d0a 2020 2020 2020 2020  ds = [..        
+00001ca0: 2020 2020 2020 2020 7069 766f 745f 7820          pivot_x 
+00001cb0: 2b20 6920 2a20 6365 6c6c 5f73 697a 6520  + i * cell_size 
+00001cc0: 2b20 6365 6c6c 5f73 697a 6520 2f20 3220  + cell_size / 2 
+00001cd0: 666f 7220 6920 696e 2072 616e 6765 2873  for i in range(s
+00001ce0: 656c 662e 636f 6c75 6d6e 7329 0d0a 2020  elf.columns)..  
+00001cf0: 2020 2020 2020 2020 2020 5d0d 0a20 2020            ]..   
+00001d00: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+00001d10: 2020 2020 2020 2020 2320 696e 2063 6173          # in cas
+00001d20: 6520 7468 6520 6c61 7420 616e 6420 6c6f  e the lat and lo
+00001d30: 6e20 6172 6520 7265 6164 2066 726f 6d20  n are read from 
+00001d40: 7468 6520 6e65 7463 6466 2066 696c 6520  the netcdf file 
+00001d50: 6a75 7374 2072 6561 6420 7468 6520 7661  just read the va
+00001d60: 6c75 6573 2066 726f 6d20 7468 6520 6669  lues from the fi
+00001d70: 6c65 0d0a 2020 2020 2020 2020 2020 2020  le..            
+00001d80: 785f 636f 6f72 6473 203d 2073 656c 662e  x_coords = self.
+00001d90: 5f6c 6f6e 0d0a 2020 2020 2020 2020 7265  _lon..        re
+00001da0: 7475 726e 206e 702e 6172 7261 7928 785f  turn np.array(x_
+00001db0: 636f 6f72 6473 290d 0a0d 0a20 2020 2040  coords)....    @
+00001dc0: 7072 6f70 6572 7479 0d0a 2020 2020 6465  property..    de
+00001dd0: 6620 7928 7365 6c66 293a 0d0a 2020 2020  f y(self):..    
+00001de0: 2020 2020 2222 2279 2d63 6f6f 7264 696e      """y-coordin
+00001df0: 6174 6522 2222 0d0a 2020 2020 2020 2020  ate"""..        
+00001e00: 2320 585f 636f 6f72 6469 6e61 7465 203d  # X_coordinate =
+00001e10: 2075 7070 6572 6c65 6674 2063 6f72 6e65   upperleft corne
+00001e20: 7220 7820 2b20 696e 6465 7820 2a20 6365  r x + index * ce
+00001e30: 6c6c 2073 697a 6520 2b20 6365 6c73 697a  ll size + celsiz
+00001e40: 652f 320d 0a20 2020 2020 2020 2069 6620  e/2..        if 
+00001e50: 6e6f 7420 6861 7361 7474 7228 7365 6c66  not hasattr(self
+00001e60: 2c20 225f 6c61 7422 293a 0d0a 2020 2020  , "_lat"):..    
+00001e70: 2020 2020 2020 2020 7069 766f 745f 7920          pivot_y 
+00001e80: 3d20 7365 6c66 2e70 6976 6f74 5f70 6f69  = self.pivot_poi
+00001e90: 6e74 5b31 5d0d 0a20 2020 2020 2020 2020  nt[1]..         
+00001ea0: 2020 2063 656c 6c5f 7369 7a65 203d 2073     cell_size = s
+00001eb0: 656c 662e 6365 6c6c 5f73 697a 650d 0a20  elf.cell_size.. 
+00001ec0: 2020 2020 2020 2020 2020 2079 5f63 6f6f             y_coo
+00001ed0: 7264 7320 3d20 5b0d 0a20 2020 2020 2020  rds = [..       
+00001ee0: 2020 2020 2020 2020 2070 6976 6f74 5f79           pivot_y
+00001ef0: 202d 2069 202a 2063 656c 6c5f 7369 7a65   - i * cell_size
+00001f00: 202d 2063 656c 6c5f 7369 7a65 202f 2032   - cell_size / 2
+00001f10: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+00001f20: 7365 6c66 2e72 6f77 7329 0d0a 2020 2020  self.rows)..    
+00001f30: 2020 2020 2020 2020 5d0d 0a20 2020 2020          ]..     
+00001f40: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00001f50: 2020 2020 2020 2320 696e 2063 6173 6520        # in case 
+00001f60: 7468 6520 6c61 7420 616e 6420 6c6f 6e20  the lat and lon 
+00001f70: 6172 6520 7265 6164 2066 726f 6d20 7468  are read from th
+00001f80: 6520 6e65 7463 6466 2066 696c 6520 6a75  e netcdf file ju
+00001f90: 7374 2072 6561 6420 7468 6520 7661 6c75  st read the valu
+00001fa0: 6573 2066 726f 6d20 7468 6520 6669 6c65  es from the file
+00001fb0: 0d0a 2020 2020 2020 2020 2020 2020 795f  ..            y_
+00001fc0: 636f 6f72 6473 203d 2073 656c 662e 5f6c  coords = self._l
+00001fd0: 6174 0d0a 2020 2020 2020 2020 7265 7475  at..        retu
+00001fe0: 726e 206e 702e 6172 7261 7928 795f 636f  rn np.array(y_co
+00001ff0: 6f72 6473 290d 0a0d 0a20 2020 2040 7072  ords)....    @pr
+00002000: 6f70 6572 7479 0d0a 2020 2020 6465 6620  operty..    def 
+00002010: 6372 7328 7365 6c66 2920 2d3e 2073 7472  crs(self) -> str
+00002020: 3a0d 0a20 2020 2020 2020 2022 2222 436f  :..        """Co
+00002030: 6f72 6469 6e61 7465 2072 6566 6572 656e  ordinate referen
+00002040: 6365 2073 7973 7465 6d2e 2222 220d 0a20  ce system.""".. 
+00002050: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00002060: 6c66 2e5f 6765 745f 6372 7328 290d 0a0d  lf._get_crs()...
+00002070: 0a20 2020 2040 6372 732e 7365 7474 6572  .    @crs.setter
+00002080: 0d0a 2020 2020 6465 6620 6372 7328 7365  ..    def crs(se
+00002090: 6c66 2c20 7661 6c75 653a 2073 7472 293a  lf, value: str):
+000020a0: 0d0a 2020 2020 2020 2020 2222 2243 6f6f  ..        """Coo
+000020b0: 7264 696e 6174 6520 7265 6665 7265 6e63  rdinate referenc
+000020c0: 6520 7379 7374 656d 2e22 2222 0d0a 2020  e system."""..  
+000020d0: 2020 2020 2020 7365 6c66 2e73 6574 5f63        self.set_c
+000020e0: 7273 2876 616c 7565 290d 0a0d 0a20 2020  rs(value)....   
+000020f0: 2040 7072 6f70 6572 7479 0d0a 2020 2020   @property..    
+00002100: 6465 6620 6365 6c6c 5f73 697a 6528 7365  def cell_size(se
+00002110: 6c66 2920 2d3e 2069 6e74 3a0d 0a20 2020  lf) -> int:..   
+00002120: 2020 2020 2022 2222 4365 6c6c 2073 697a       """Cell siz
+00002130: 652e 2222 220d 0a20 2020 2020 2020 2072  e."""..        r
+00002140: 6574 7572 6e20 7365 6c66 2e5f 6365 6c6c  eturn self._cell
+00002150: 5f73 697a 650d 0a0d 0a20 2020 2040 7072  _size....    @pr
+00002160: 6f70 6572 7479 0d0a 2020 2020 6465 6620  operty..    def 
+00002170: 6261 6e64 5f63 6f75 6e74 2873 656c 6629  band_count(self)
+00002180: 3a0d 0a20 2020 2020 2020 2022 2222 4e75  :..        """Nu
+00002190: 6d62 6572 206f 6620 6261 6e64 7320 696e  mber of bands in
+000021a0: 2074 6865 2072 6173 7465 722e 2222 220d   the raster.""".
+000021b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000021c0: 7365 6c66 2e5f 6261 6e64 5f63 6f75 6e74  self._band_count
+000021d0: 0d0a 0d0a 2020 2020 4070 726f 7065 7274  ....    @propert
+000021e0: 790d 0a20 2020 2064 6566 2062 616e 645f  y..    def band_
+000021f0: 6e61 6d65 7328 7365 6c66 293a 0d0a 2020  names(self):..  
+00002200: 2020 2020 2020 2222 2242 616e 6420 6e61        """Band na
+00002210: 6d65 732e 2222 220d 0a20 2020 2020 2020  mes."""..       
+00002220: 2072 6574 7572 6e20 7365 6c66 2e5f 6261   return self._ba
+00002230: 6e64 5f6e 616d 6573 0d0a 0d0a 2020 2020  nd_names....    
+00002240: 4070 726f 7065 7274 790d 0a20 2020 2064  @property..    d
+00002250: 6566 2076 6172 6961 626c 6573 2873 656c  ef variables(sel
+00002260: 6629 3a0d 0a20 2020 2020 2020 2022 2222  f):..        """
+00002270: 5661 7269 6162 6c65 7320 696e 2074 6865  Variables in the
+00002280: 2072 6173 7465 7220 2872 6573 616d 626c   raster (resambl
+00002290: 6573 2074 6865 2076 6172 6961 626c 6573  es the variables
+000022a0: 2069 6e20 6e65 7463 6466 2066 696c 6573   in netcdf files
+000022b0: 2e29 2222 220d 0a20 2020 2020 2020 2072  .)"""..        r
+000022c0: 6574 7572 6e20 7365 6c66 2e5f 7661 7269  eturn self._vari
+000022d0: 6162 6c65 730d 0a0d 0a20 2020 2040 7072  ables....    @pr
+000022e0: 6f70 6572 7479 0d0a 2020 2020 6465 6620  operty..    def 
+000022f0: 6e6f 5f64 6174 615f 7661 6c75 6528 7365  no_data_value(se
+00002300: 6c66 293a 0d0a 2020 2020 2020 2020 2222  lf):..        ""
+00002310: 224e 6f20 6461 7461 2076 616c 7565 2074  "No data value t
+00002320: 6861 7420 6d61 726b 7320 7468 6520 6365  hat marks the ce
+00002330: 6c6c 7320 6f75 7420 6f66 2074 6865 2064  lls out of the d
+00002340: 6f6d 6169 6e22 2222 0d0a 2020 2020 2020  omain"""..      
+00002350: 2020 7265 7475 726e 2073 656c 662e 5f6e    return self._n
+00002360: 6f5f 6461 7461 5f76 616c 7565 0d0a 0d0a  o_data_value....
+00002370: 2020 2020 4070 726f 7065 7274 790d 0a20      @property.. 
+00002380: 2020 2064 6566 206d 6574 615f 6461 7461     def meta_data
+00002390: 2873 656c 6629 3a0d 0a20 2020 2020 2020  (self):..       
+000023a0: 2022 2222 4d65 7461 2064 6174 6122 2222   """Meta data"""
+000023b0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+000023c0: 2073 656c 662e 5f6d 6574 615f 6461 7461   self._meta_data
+000023d0: 0d0a 0d0a 2020 2020 4070 726f 7065 7274  ....    @propert
+000023e0: 790d 0a20 2020 2064 6566 2064 7479 7065  y..    def dtype
+000023f0: 2873 656c 6629 3a0d 0a20 2020 2020 2020  (self):..       
+00002400: 2022 2222 4461 7461 2054 7970 6522 2222   """Data Type"""
+00002410: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00002420: 2073 656c 662e 5f64 7479 7065 0d0a 0d0a   self._dtype....
+00002430: 2020 2020 4070 726f 7065 7274 790d 0a20      @property.. 
+00002440: 2020 2064 6566 2066 696c 655f 6e61 6d65     def file_name
+00002450: 2873 656c 6629 3a0d 0a20 2020 2020 2020  (self):..       
+00002460: 2022 2222 6669 6c65 206e 616d 6522 2222   """file name"""
+00002470: 0d0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
+00002480: 662e 5f66 696c 655f 6e61 6d65 2e73 7461  f._file_name.sta
+00002490: 7274 7377 6974 6828 224e 4554 4344 4622  rtswith("NETCDF"
+000024a0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+000024b0: 6e61 6d65 203d 2073 656c 662e 5f66 696c  name = self._fil
+000024c0: 655f 6e61 6d65 2e73 706c 6974 2822 3a22  e_name.split(":"
+000024d0: 295b 315d 5b31 3a2d 315d 0d0a 2020 2020  )[1][1:-1]..    
+000024e0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+000024f0: 2020 2020 2020 206e 616d 6520 3d20 7365         name = se
+00002500: 6c66 2e5f 6669 6c65 5f6e 616d 650d 0a20  lf._file_name.. 
+00002510: 2020 2020 2020 2072 6574 7572 6e20 6e61         return na
+00002520: 6d65 0d0a 0d0a 2020 2020 4070 726f 7065  me....    @prope
+00002530: 7274 790d 0a20 2020 2064 6566 2074 696d  rty..    def tim
+00002540: 655f 7374 616d 7028 7365 6c66 293a 0d0a  e_stamp(self):..
+00002550: 2020 2020 2020 2020 2222 2254 696d 6520          """Time 
+00002560: 7374 616d 7022 2222 0d0a 2020 2020 2020  stamp"""..      
+00002570: 2020 7265 7475 726e 2073 656c 662e 5f74    return self._t
+00002580: 696d 655f 7374 616d 700d 0a0d 0a20 2020  ime_stamp....   
+00002590: 2040 7072 6f70 6572 7479 0d0a 2020 2020   @property..    
+000025a0: 6465 6620 6472 6976 6572 5f74 7970 6528  def driver_type(
+000025b0: 7365 6c66 293a 0d0a 2020 2020 2020 2020  self):..        
+000025c0: 2222 2244 7269 7665 7220 5479 7065 2222  """Driver Type""
+000025d0: 220d 0a20 2020 2020 2020 2064 7269 7665  "..        drive
+000025e0: 725f 7479 7065 203d 2073 656c 662e 7261  r_type = self.ra
+000025f0: 7374 6572 2e47 6574 4472 6976 6572 2829  ster.GetDriver()
+00002600: 2e47 6574 4465 7363 7269 7074 696f 6e28  .GetDescription(
+00002610: 290d 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+00002620: 6e20 4341 5441 4c4f 472e 6765 745f 6472  n CATALOG.get_dr
+00002630: 6976 6572 5f6e 616d 6528 6472 6976 6572  iver_name(driver
+00002640: 5f74 7970 6529 0d0a 0d0a 2020 2020 4063  _type)....    @c
+00002650: 6c61 7373 6d65 7468 6f64 0d0a 2020 2020  lassmethod..    
+00002660: 6465 6620 7265 6164 5f66 696c 6528 636c  def read_file(cl
+00002670: 732c 2070 6174 683a 2073 7472 2c20 7265  s, path: str, re
+00002680: 6164 5f6f 6e6c 793d 5472 7565 293a 0d0a  ad_only=True):..
+00002690: 2020 2020 2020 2020 2222 2272 6561 6420          """read 
+000026a0: 6669 6c65 2e0d 0a0d 0a20 2020 2020 2020  file.....       
+000026b0: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+000026c0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
+000026d0: 0a20 2020 2020 2020 2070 6174 6820 3a20  .        path : 
+000026e0: 5b73 7472 5d0d 0a20 2020 2020 2020 2020  [str]..         
+000026f0: 2020 2050 6174 6820 6f66 2066 696c 6520     Path of file 
+00002700: 746f 206f 7065 6e28 776f 726b 7320 666f  to open(works fo
+00002710: 7220 6173 6369 692c 2067 656f 7469 6666  r ascii, geotiff
+00002720: 292e 0d0a 2020 2020 2020 2020 7265 6164  )...        read
+00002730: 5f6f 6e6c 7920 3a20 5b62 6f6f 6c5d 0d0a  _only : [bool]..
+00002740: 2020 2020 2020 2020 2020 2020 4669 6c65              File
+00002750: 206d 6f64 652c 2073 6574 2074 6f20 4661   mode, set to Fa
+00002760: 6c73 6520 746f 206f 7065 6e20 696e 2022  lse to open in "
+00002770: 7570 6461 7465 2220 6d6f 6465 2e0d 0a0d  update" mode....
+00002780: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+00002790: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+000027a0: 2d0d 0a20 2020 2020 2020 2047 4441 4c20  -..        GDAL 
+000027b0: 6461 7461 7365 740d 0a20 2020 2020 2020  dataset..       
+000027c0: 2022 2222 0d0a 2020 2020 2020 2020 7372   """..        sr
+000027d0: 6320 3d20 696f 2e72 6561 645f 6669 6c65  c = io.read_file
+000027e0: 2870 6174 682c 2072 6561 645f 6f6e 6c79  (path, read_only
+000027f0: 290d 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+00002800: 6e20 636c 7328 7372 6329 0d0a 0d0a 2020  n cls(src)....  
+00002810: 2020 4063 6c61 7373 6d65 7468 6f64 0d0a    @classmethod..
+00002820: 2020 2020 6465 6620 5f63 7265 6174 655f      def _create_
+00002830: 656d 7074 795f 6472 6976 6572 280d 0a20  empty_driver(.. 
+00002840: 2020 2020 2020 2063 6c73 2c20 7372 633a         cls, src:
+00002850: 2067 6461 6c2e 4461 7461 7365 742c 2070   gdal.Dataset, p
+00002860: 6174 683a 2073 7472 203d 204e 6f6e 652c  ath: str = None,
+00002870: 2062 616e 6473 3a20 696e 7420 3d20 312c   bands: int = 1,
+00002880: 206e 6f5f 6461 7461 5f76 616c 7565 3d4e   no_data_value=N
+00002890: 6f6e 650d 0a20 2020 2029 3a0d 0a20 2020  one..    ):..   
+000028a0: 2020 2020 2022 2222 4372 6561 7465 2061       """Create a
+000028b0: 206e 6577 2065 6d70 7479 2064 7269 7665   new empty drive
+000028c0: 7220 6672 6f6d 2061 6e6f 7468 6572 2064  r from another d
+000028d0: 6174 6173 6574 2e0d 0a0d 0a20 2020 2020  ataset.....     
+000028e0: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
+000028f0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00002900: 2d0d 0a20 2020 2020 2020 2073 7263 203a  -..        src :
+00002910: 205b 6764 616c 2e44 6174 6163 7562 655d   [gdal.Datacube]
+00002920: 0d0a 2020 2020 2020 2020 2020 2020 6764  ..            gd
+00002930: 616c 2064 6174 6173 6574 0d0a 2020 2020  al dataset..    
+00002940: 2020 2020 7061 7468 203a 2073 7472 0d0a      path : str..
+00002950: 2020 2020 2020 2020 6261 6e64 7320 3a20          bands : 
+00002960: 696e 7420 6f72 204e 6f6e 650d 0a20 2020  int or None..   
+00002970: 2020 2020 2020 2020 204e 756d 6265 7220           Number 
+00002980: 6f66 2062 616e 6473 2074 6f20 6372 6561  of bands to crea
+00002990: 7465 2069 6e20 7468 6520 6f75 7470 7574  te in the output
+000029a0: 2072 6173 7465 722e 0d0a 2020 2020 2020   raster...      
+000029b0: 2020 6e6f 5f64 6174 615f 7661 6c75 6520    no_data_value 
+000029c0: 3a20 666c 6f61 7420 6f72 204e 6f6e 650d  : float or None.
+000029d0: 0a20 2020 2020 2020 2020 2020 204e 6f20  .            No 
+000029e0: 6461 7461 2076 616c 7565 2c20 6966 204e  data value, if N
+000029f0: 6f6e 6520 7573 6573 2074 6865 2073 616d  one uses the sam
+00002a00: 6520 6173 2060 6073 7263 6060 2e0d 0a0d  e as ``src``....
+00002a10: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+00002a20: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00002a30: 2d0d 0a20 2020 2020 2020 2067 6461 6c2e  -..        gdal.
+00002a40: 4461 7461 5365 740d 0a20 2020 2020 2020  DataSet..       
+00002a50: 2022 2222 0d0a 2020 2020 2020 2020 6261   """..        ba
+00002a60: 6e64 7320 3d20 696e 7428 6261 6e64 7329  nds = int(bands)
+00002a70: 2069 6620 6261 6e64 7320 6973 206e 6f74   if bands is not
+00002a80: 204e 6f6e 6520 656c 7365 2073 7263 2e52   None else src.R
+00002a90: 6173 7465 7243 6f75 6e74 0d0a 2020 2020  asterCount..    
+00002aa0: 2020 2020 2320 6372 6561 7465 2074 6865      # create the
+00002ab0: 206f 6268 6563 740d 0a20 2020 2020 2020   obhect..       
+00002ac0: 2073 7263 5f6f 626a 203d 2063 6c73 2873   src_obj = cls(s
+00002ad0: 7263 290d 0a20 2020 2020 2020 2023 2043  rc)..        # C
+00002ae0: 7265 6174 6520 7468 6520 6472 6976 6572  reate the driver
+00002af0: 2e0d 0a20 2020 2020 2020 2064 7374 203d  ...        dst =
+00002b00: 2073 7263 5f6f 626a 2e5f 6372 6561 7465   src_obj._create
+00002b10: 5f67 6461 6c5f 6461 7461 7365 7428 0d0a  _gdal_dataset(..
+00002b20: 2020 2020 2020 2020 2020 2020 7372 635f              src_
+00002b30: 6f62 6a2e 636f 6c75 6d6e 732c 2073 7263  obj.columns, src
+00002b40: 5f6f 626a 2e72 6f77 732c 2062 616e 6473  _obj.rows, bands
+00002b50: 2c20 7372 635f 6f62 6a2e 6474 7970 655b  , src_obj.dtype[
+00002b60: 305d 2c20 7061 7468 3d70 6174 680d 0a20  0], path=path.. 
+00002b70: 2020 2020 2020 2029 0d0a 0d0a 2020 2020         )....    
+00002b80: 2020 2020 2320 5365 7420 7468 6520 7072      # Set the pr
+00002b90: 6f6a 6563 7469 6f6e 2e0d 0a20 2020 2020  ojection...     
+00002ba0: 2020 2064 7374 2e53 6574 4765 6f54 7261     dst.SetGeoTra
+00002bb0: 6e73 666f 726d 2873 7263 5f6f 626a 2e67  nsform(src_obj.g
+00002bc0: 656f 7472 616e 7366 6f72 6d29 0d0a 2020  eotransform)..  
+00002bd0: 2020 2020 2020 6473 742e 5365 7450 726f        dst.SetPro
+00002be0: 6a65 6374 696f 6e28 7372 635f 6f62 6a2e  jection(src_obj.
+00002bf0: 7261 7374 6572 2e47 6574 5072 6f6a 6563  raster.GetProjec
+00002c00: 7469 6f6e 5265 6628 2929 0d0a 2020 2020  tionRef())..    
+00002c10: 2020 2020 6473 7420 3d20 636c 7328 6473      dst = cls(ds
+00002c20: 7429 0d0a 2020 2020 2020 2020 6966 206e  t)..        if n
+00002c30: 6f5f 6461 7461 5f76 616c 7565 2069 7320  o_data_value is 
+00002c40: 6e6f 7420 4e6f 6e65 3a0d 0a20 2020 2020  not None:..     
+00002c50: 2020 2020 2020 2064 7374 2e5f 7365 745f         dst._set_
+00002c60: 6e6f 5f64 6174 615f 7661 6c75 6528 6e6f  no_data_value(no
+00002c70: 5f64 6174 615f 7661 6c75 653d 666c 6f61  _data_value=floa
+00002c80: 7428 6e6f 5f64 6174 615f 7661 6c75 6529  t(no_data_value)
+00002c90: 290d 0a0d 0a20 2020 2020 2020 2072 6574  )....        ret
+00002ca0: 7572 6e20 6473 740d 0a0d 0a20 2020 2040  urn dst....    @
+00002cb0: 636c 6173 736d 6574 686f 640d 0a20 2020  classmethod..   
+00002cc0: 2064 6566 205f 6372 6561 7465 5f64 7269   def _create_dri
+00002cd0: 7665 725f 6672 6f6d 5f73 6372 6174 6368  ver_from_scratch
+00002ce0: 280d 0a20 2020 2020 2020 2063 6c73 2c0d  (..        cls,.
+00002cf0: 0a20 2020 2020 2020 2063 656c 6c5f 7369  .        cell_si
+00002d00: 7a65 3a20 696e 742c 0d0a 2020 2020 2020  ze: int,..      
+00002d10: 2020 726f 7773 3a20 696e 742c 0d0a 2020    rows: int,..  
+00002d20: 2020 2020 2020 636f 6c75 6d6e 733a 2069        columns: i
+00002d30: 6e74 2c0d 0a20 2020 2020 2020 2064 7479  nt,..        dty
+00002d40: 7065 3a20 696e 742c 0d0a 2020 2020 2020  pe: int,..      
+00002d50: 2020 6261 6e64 733a 2069 6e74 2c0d 0a20    bands: int,.. 
+00002d60: 2020 2020 2020 2074 6f70 5f6c 6566 745f         top_left_
+00002d70: 636f 6f72 6473 3a20 5475 706c 652c 0d0a  coords: Tuple,..
+00002d80: 2020 2020 2020 2020 6570 7367 3a20 696e          epsg: in
+00002d90: 742c 0d0a 2020 2020 2020 2020 6e6f 5f64  t,..        no_d
+00002da0: 6174 615f 7661 6c75 653a 2041 6e79 203d  ata_value: Any =
+00002db0: 204e 6f6e 652c 0d0a 2020 2020 2020 2020   None,..        
+00002dc0: 7061 7468 3a20 7374 7220 3d20 4e6f 6e65  path: str = None
+00002dd0: 2c0d 0a20 2020 2029 3a0d 0a20 2020 2020  ,..    ):..     
+00002de0: 2020 2022 2222 4372 6561 7465 2061 206e     """Create a n
+00002df0: 6577 2065 6d70 7479 2064 7269 7665 7220  ew empty driver 
+00002e00: 6672 6f6d 2061 6e6f 7468 6572 2064 6174  from another dat
+00002e10: 6173 6574 2e0d 0a0d 0a20 2020 2020 2020  aset.....       
+00002e20: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+00002e30: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
+00002e40: 0a20 2020 2020 2020 2063 656c 6c5f 7369  .        cell_si
+00002e50: 7a65 3a20 5b41 6e79 5d0d 0a20 2020 2020  ze: [Any]..     
+00002e60: 2020 2020 2020 2063 656c 6c20 7369 7a65         cell size
+00002e70: 2e0d 0a20 2020 2020 2020 2072 6f77 733a  ...        rows:
+00002e80: 205b 696e 745d 0d0a 2020 2020 2020 2020   [int]..        
+00002e90: 2020 2020 6e75 6d62 6572 206f 6620 726f      number of ro
+00002ea0: 7773 2e0d 0a20 2020 2020 2020 2063 6f6c  ws...        col
+00002eb0: 756d 6e73 3a20 5b69 6e74 5d0d 0a20 2020  umns: [int]..   
+00002ec0: 2020 2020 2020 2020 206e 756d 6265 7220           number 
+00002ed0: 6f66 2063 6f6c 756d 6e73 2e0d 0a20 2020  of columns...   
+00002ee0: 2020 2020 2064 7479 7065 3a20 5b69 6e74       dtype: [int
+00002ef0: 5d0d 0a20 2020 2020 2020 2020 2020 2064  ]..            d
+00002f00: 6174 6120 7479 7065 2e0d 0a20 2020 2020  ata type...     
+00002f10: 2020 2062 616e 6473 203a 2069 6e74 206f     bands : int o
+00002f20: 7220 4e6f 6e65 0d0a 2020 2020 2020 2020  r None..        
+00002f30: 2020 2020 4e75 6d62 6572 206f 6620 6261      Number of ba
+00002f40: 6e64 7320 746f 2063 7265 6174 6520 696e  nds to create in
+00002f50: 2074 6865 206f 7574 7075 7420 7261 7374   the output rast
+00002f60: 6572 2e0d 0a20 2020 2020 2020 2074 6f70  er...        top
+00002f70: 5f6c 6566 745f 636f 6f72 6473 3a20 5b54  _left_coords: [T
+00002f80: 7570 6c65 5d0d 0a20 2020 2020 2020 2020  uple]..         
+00002f90: 2020 2063 6f6f 7264 696e 6174 6573 206f     coordinates o
+00002fa0: 6620 7468 6520 746f 7020 6c65 6674 2063  f the top left c
+00002fb0: 6f72 6e65 7220 706f 696e 742e 0d0a 2020  orner point...  
+00002fc0: 2020 2020 2020 6570 7367 3a20 5b69 6e74        epsg: [int
+00002fd0: 5d0d 0a20 2020 2020 2020 2020 2020 2065  ]..            e
+00002fe0: 7073 6720 6e75 6d62 6572 2074 6f20 6964  psg number to id
+00002ff0: 656e 7469 6679 2074 6865 2070 726f 6a65  entify the proje
+00003000: 6374 696f 6e20 6f66 2074 6865 2063 6f6f  ction of the coo
+00003010: 7264 696e 6174 6573 2069 6e20 7468 6520  rdinates in the 
+00003020: 6372 6561 7465 6420 7261 7374 6572 2e0d  created raster..
+00003030: 0a20 2020 2020 2020 206e 6f5f 6461 7461  .        no_data
+00003040: 5f76 616c 7565 203a 2066 6c6f 6174 206f  _value : float o
+00003050: 7220 4e6f 6e65 0d0a 2020 2020 2020 2020  r None..        
+00003060: 2020 2020 4e6f 2064 6174 6120 7661 6c75      No data valu
+00003070: 652c 2069 6620 4e6f 6e65 2075 7365 7320  e, if None uses 
+00003080: 7468 6520 7361 6d65 2061 7320 6060 7372  the same as ``sr
+00003090: 6360 602e 0d0a 2020 2020 2020 2020 7061  c``...        pa
+000030a0: 7468 203a 205b 7374 725d 0d0a 2020 2020  th : [str]..    
+000030b0: 2020 2020 2020 2020 7061 7468 206f 6e20          path on 
+000030c0: 6469 736b 2e0d 0a0d 0a20 2020 2020 2020  disk.....       
+000030d0: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
+000030e0: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
+000030f0: 2020 2067 6461 6c2e 4461 7461 5365 740d     gdal.DataSet.
+00003100: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+00003110: 2020 2020 2020 2320 4372 6561 7465 2074        # Create t
+00003120: 6865 2064 7269 7665 722e 0d0a 2020 2020  he driver...    
+00003130: 2020 2020 6473 7420 3d20 4461 7461 7365      dst = Datase
+00003140: 742e 5f63 7265 6174 655f 6764 616c 5f64  t._create_gdal_d
+00003150: 6174 6173 6574 2863 6f6c 756d 6e73 2c20  ataset(columns, 
+00003160: 726f 7773 2c20 6261 6e64 732c 2064 7479  rows, bands, dty
+00003170: 7065 2c20 7061 7468 3d70 6174 6829 0d0a  pe, path=path)..
+00003180: 2020 2020 2020 2020 6765 6f74 7261 6e73          geotrans
+00003190: 666f 726d 203d 2028 0d0a 2020 2020 2020  form = (..      
+000031a0: 2020 2020 2020 746f 705f 6c65 6674 5f63        top_left_c
+000031b0: 6f6f 7264 735b 305d 2c0d 0a20 2020 2020  oords[0],..     
+000031c0: 2020 2020 2020 2063 656c 6c5f 7369 7a65         cell_size
+000031d0: 2c0d 0a20 2020 2020 2020 2020 2020 2030  ,..            0
+000031e0: 2c0d 0a20 2020 2020 2020 2020 2020 2074  ,..            t
+000031f0: 6f70 5f6c 6566 745f 636f 6f72 6473 5b31  op_left_coords[1
+00003200: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
+00003210: 302c 0d0a 2020 2020 2020 2020 2020 2020  0,..            
+00003220: 2d31 202a 2063 656c 6c5f 7369 7a65 2c0d  -1 * cell_size,.
+00003230: 0a20 2020 2020 2020 2029 0d0a 2020 2020  .        )..    
+00003240: 2020 2020 7372 203d 2044 6174 6173 6574      sr = Dataset
+00003250: 2e5f 6372 6561 7465 5f73 725f 6672 6f6d  ._create_sr_from
+00003260: 5f65 7073 6728 6570 7367 290d 0a0d 0a20  _epsg(epsg).... 
+00003270: 2020 2020 2020 2023 2053 6574 2074 6865         # Set the
+00003280: 2070 726f 6a65 6374 696f 6e2e 0d0a 2020   projection...  
+00003290: 2020 2020 2020 6473 742e 5365 7447 656f        dst.SetGeo
+000032a0: 5472 616e 7366 6f72 6d28 6765 6f74 7261  Transform(geotra
+000032b0: 6e73 666f 726d 290d 0a20 2020 2020 2020  nsform)..       
+000032c0: 2064 7374 2e53 6574 5072 6f6a 6563 7469   dst.SetProjecti
+000032d0: 6f6e 2873 722e 4578 706f 7274 546f 576b  on(sr.ExportToWk
+000032e0: 7428 2929 0d0a 2020 2020 2020 2020 6473  t())..        ds
+000032f0: 7420 3d20 636c 7328 6473 7429 0d0a 2020  t = cls(dst)..  
+00003300: 2020 2020 2020 6966 206e 6f5f 6461 7461        if no_data
+00003310: 5f76 616c 7565 2069 7320 6e6f 7420 4e6f  _value is not No
+00003320: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
+00003330: 2064 7374 2e5f 7365 745f 6e6f 5f64 6174   dst._set_no_dat
+00003340: 615f 7661 6c75 6528 6e6f 5f64 6174 615f  a_value(no_data_
+00003350: 7661 6c75 653d 6e6f 5f64 6174 615f 7661  value=no_data_va
+00003360: 6c75 6529 0d0a 0d0a 2020 2020 2020 2020  lue)....        
+00003370: 7265 7475 726e 2064 7374 0d0a 0d0a 2020  return dst....  
+00003380: 2020 6465 6620 7265 6164 5f61 7272 6179    def read_array
+00003390: 2873 656c 662c 2062 616e 643a 2069 6e74  (self, band: int
+000033a0: 203d 204e 6f6e 6529 202d 3e20 6e70 2e6e   = None) -> np.n
+000033b0: 6461 7272 6179 3a0d 0a20 2020 2020 2020  darray:..       
+000033c0: 2022 2222 5265 6164 2041 7272 6179 0d0a   """Read Array..
+000033d0: 0d0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
+000033e0: 7265 6164 2074 6865 2076 616c 7565 7320  read the values 
+000033f0: 7374 6f72 6564 2069 6e20 6120 6769 7665  stored in a give
+00003400: 6e20 6261 6e64 2e0d 0a0d 0a20 2020 2020  n band.....     
+00003410: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
+00003420: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00003430: 2d0d 0a20 2020 2020 2020 2062 616e 6420  -..        band 
+00003440: 3a20 5b69 6e74 6567 6572 5d0d 0a20 2020  : [integer]..   
+00003450: 2020 2020 2020 2020 2074 6865 2062 616e           the ban
+00003460: 6420 796f 7520 7761 6e74 2074 6f20 6765  d you want to ge
+00003470: 7420 6974 7320 6461 7461 2e20 4465 6661  t its data. Defa
+00003480: 756c 7420 6973 2030 0d0a 0d0a 2020 2020  ult is 0....    
+00003490: 2020 2020 5265 7475 726e 730d 0a20 2020      Returns..   
+000034a0: 2020 2020 202d 2d2d 2d2d 2d2d 0d0a 2020       -------..  
+000034b0: 2020 2020 2020 6172 7261 7920 3a20 5b61        array : [a
+000034c0: 7272 6179 5d0d 0a20 2020 2020 2020 2020  rray]..         
+000034d0: 2020 2061 7272 6179 2077 6974 6820 616c     array with al
+000034e0: 6c20 7468 6520 7661 6c75 6573 2069 6e20  l the values in 
+000034f0: 7468 6520 7261 7374 6572 2e0d 0a20 2020  the raster...   
+00003500: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+00003510: 2020 6966 2062 616e 6420 6973 204e 6f6e    if band is Non
+00003520: 6520 616e 6420 7365 6c66 2e62 616e 645f  e and self.band_
+00003530: 636f 756e 7420 3e20 313a 0d0a 2020 2020  count > 1:..    
+00003540: 2020 2020 2020 2020 6172 7220 3d20 6e70          arr = np
+00003550: 2e6f 6e65 7328 0d0a 2020 2020 2020 2020  .ones(..        
+00003560: 2020 2020 2020 2020 280d 0a20 2020 2020          (..     
+00003570: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00003580: 656c 662e 6261 6e64 5f63 6f75 6e74 2c0d  elf.band_count,.
+00003590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000035a0: 2020 2020 2073 656c 662e 726f 7773 2c0d       self.rows,.
+000035b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000035c0: 2020 2020 2073 656c 662e 636f 6c75 6d6e       self.column
+000035d0: 732c 0d0a 2020 2020 2020 2020 2020 2020  s,..            
+000035e0: 2020 2020 290d 0a20 2020 2020 2020 2020      )..         
+000035f0: 2020 2029 0d0a 2020 2020 2020 2020 2020     )..          
+00003600: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
+00003610: 2873 656c 662e 6261 6e64 5f63 6f75 6e74  (self.band_count
+00003620: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00003630: 2020 2020 6172 725b 692c 203a 2c20 3a5d      arr[i, :, :]
+00003640: 203d 2073 656c 662e 5f72 6173 7465 722e   = self._raster.
+00003650: 4765 7452 6173 7465 7242 616e 6428 6920  GetRasterBand(i 
+00003660: 2b20 3129 2e52 6561 6441 7341 7272 6179  + 1).ReadAsArray
+00003670: 2829 0d0a 2020 2020 2020 2020 656c 7365  ()..        else
+00003680: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+00003690: 6620 6261 6e64 2069 7320 4e6f 6e65 3a0d  f band is None:.
+000036a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000036b0: 2062 616e 6420 3d20 300d 0a20 2020 2020   band = 0..     
+000036c0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+000036d0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000036e0: 2062 616e 6420 3e20 7365 6c66 2e62 616e   band > self.ban
+000036f0: 645f 636f 756e 7420 2d20 313a 0d0a 2020  d_count - 1:..  
+00003700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003710: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00003720: 6f72 280d 0a20 2020 2020 2020 2020 2020  or(..           
+00003730: 2020 2020 2020 2020 2020 2020 2066 2262               f"b
+00003740: 616e 6420 696e 6465 7820 7368 6f75 6c64  and index should
+00003750: 2062 6520 6265 7477 6565 6e20 3020 616e   be between 0 an
+00003760: 6420 7b73 656c 662e 6261 6e64 5f63 6f75  d {self.band_cou
+00003770: 6e74 202d 2031 7d22 0d0a 2020 2020 2020  nt - 1}"..      
+00003780: 2020 2020 2020 2020 2020 2020 2020 290d                ).
+00003790: 0a20 2020 2020 2020 2020 2020 2061 7272  .            arr
+000037a0: 203d 2073 656c 662e 7261 7374 6572 2e47   = self.raster.G
+000037b0: 6574 5261 7374 6572 4261 6e64 2862 616e  etRasterBand(ban
+000037c0: 6420 2b20 3129 2e52 6561 6441 7341 7272  d + 1).ReadAsArr
+000037d0: 6179 2829 0d0a 0d0a 2020 2020 2020 2020  ay()....        
+000037e0: 7265 7475 726e 2061 7272 0d0a 0d0a 2020  return arr....  
+000037f0: 2020 6465 6620 706c 6f74 2873 656c 662c    def plot(self,
+00003800: 2062 616e 643a 2069 6e74 203d 2030 2c20   band: int = 0, 
+00003810: 6578 636c 7564 655f 7661 6c75 653a 2041  exclude_value: A
+00003820: 6e79 203d 204e 6f6e 652c 202a 2a6b 7761  ny = None, **kwa
+00003830: 7267 7329 3a0d 0a20 2020 2020 2020 2022  rgs):..        "
+00003840: 2222 5265 6164 2041 7272 6179 0d0a 0d0a  ""Read Array....
+00003850: 2020 2020 2020 2020 2020 2020 2d20 7265              - re
+00003860: 6164 2074 6865 2076 616c 7565 7320 7374  ad the values st
+00003870: 6f72 6564 2069 6e20 6120 6769 7665 6e20  ored in a given 
+00003880: 6261 6e64 2e0d 0a0d 0a20 2020 2020 2020  band.....       
+00003890: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+000038a0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
+000038b0: 0a20 2020 2020 2020 2062 616e 6420 3a20  .        band : 
+000038c0: 5b69 6e74 6567 6572 5d0d 0a20 2020 2020  [integer]..     
+000038d0: 2020 2020 2020 2074 6865 2062 616e 6420         the band 
+000038e0: 796f 7520 7761 6e74 2074 6f20 6765 7420  you want to get 
+000038f0: 6974 7320 6461 7461 2e20 4465 6661 756c  its data. Defaul
+00003900: 7420 6973 2030 0d0a 2020 2020 2020 2020  t is 0..        
+00003910: 6578 636c 7564 655f 7661 6c75 653a 205b  exclude_value: [
+00003920: 416e 795d 0d0a 2020 2020 2020 2020 2020  Any]..          
+00003930: 2020 7661 6c75 6520 746f 2065 7865 636c    value to execl
+00003940: 7564 6520 6672 6f6d 2074 6865 2070 6c6f  ude from the plo
+00003950: 742e 2044 6566 6175 6c74 2069 7320 4e6f  t. Default is No
+00003960: 6e65 2e0d 0a20 2020 2020 2020 202a 2a6b  ne...        **k
+00003970: 7761 7267 730d 0a20 2020 2020 2020 2020  wargs..         
+00003980: 2020 2070 6f69 6e74 7320 3a20 5b61 7272     points : [arr
+00003990: 6179 5d0d 0a20 2020 2020 2020 2020 2020  ay]..           
+000039a0: 2020 2020 2033 2063 6f6c 756d 6e20 6172       3 column ar
+000039b0: 7261 7920 7769 7468 2074 6865 2066 6972  ray with the fir
+000039c0: 7374 2063 6f6c 756d 6e20 6173 2074 6865  st column as the
+000039d0: 2076 616c 7565 2079 6f75 2077 616e 7420   value you want 
+000039e0: 746f 2064 6973 706c 6179 2066 6f72 2074  to display for t
+000039f0: 6865 2070 6f69 6e74 2c20 7468 6520 7365  he point, the se
+00003a00: 636f 6e64 2069 7320 7468 6520 726f 7773  cond is the rows
+00003a10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00003a20: 2020 696e 6465 7820 6f66 2074 6865 2070    index of the p
+00003a30: 6f69 6e74 2069 6e20 7468 6520 6172 7261  oint in the arra
+00003a40: 792c 2061 6e64 2074 6865 2074 6869 7264  y, and the third
+00003a50: 2063 6f6c 756d 6e20 6173 2074 6865 2063   column as the c
+00003a60: 6f6c 756d 6e20 696e 6465 7820 696e 2074  olumn index in t
+00003a70: 6865 2061 7272 6179 2e0d 0a20 2020 2020  he array...     
+00003a80: 2020 2020 2020 2020 2020 202d 2074 6865             - the
+00003a90: 2073 6563 6f6e 6420 616e 6420 7468 6972   second and thir
+00003aa0: 6420 636f 6c75 6d6e 2074 656c 6c73 2074  d column tells t
+00003ab0: 6865 206c 6f63 6174 696f 6e20 6f66 2074  he location of t
+00003ac0: 6865 2070 6f69 6e74 2069 6e20 7468 6520  he point in the 
+00003ad0: 6172 7261 792e 0d0a 2020 2020 2020 2020  array...        
+00003ae0: 2020 2020 706f 696e 745f 636f 6c6f 723a      point_color:
+00003af0: 205b 7374 725d 0d0a 2020 2020 2020 2020   [str]..        
+00003b00: 2020 2020 2020 2020 636f 6c6f 722e 0d0a          color...
+00003b10: 2020 2020 2020 2020 2020 2020 706f 696e              poin
+00003b20: 745f 7369 7a65 3a20 5b41 6e79 5d0d 0a20  t_size: [Any].. 
+00003b30: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00003b40: 697a 6520 6f66 2074 6865 2070 6f69 6e74  ize of the point
+00003b50: 2e0d 0a20 2020 2020 2020 2020 2020 2070  ...            p
+00003b60: 6964 5f63 6f6c 6f72 3a20 5b73 7472 5d0d  id_color: [str].
+00003b70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003b80: 2074 6865 2063 6f6c 6f72 206f 6620 7468   the color of th
+00003b90: 6520 616e 6f74 6174 696f 6e20 6f66 2074  e anotation of t
+00003ba0: 6865 2070 6f69 6e74 2e20 4465 6661 756c  he point. Defaul
+00003bb0: 7420 6973 2062 6c75 652e 0d0a 2020 2020  t is blue...    
+00003bc0: 2020 2020 2020 2020 7069 645f 7369 7a65          pid_size
+00003bd0: 3a20 5b41 6e79 5d0d 0a20 2020 2020 2020  : [Any]..       
+00003be0: 2020 2020 2020 2020 2073 697a 6520 6f66           size of
+00003bf0: 2074 6865 2070 6f69 6e74 2061 6e6e 6f74   the point annot
+00003c00: 6174 696f 6e2e 0d0a 2020 2020 2020 2020  ation...        
+00003c10: 2020 2020 6669 6773 697a 6520 3a20 5b74      figsize : [t
+00003c20: 7570 6c65 5d2c 206f 7074 696f 6e61 6c0d  uple], optional.
+00003c30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003c40: 2066 6967 7572 6520 7369 7a65 2e20 5468   figure size. Th
+00003c50: 6520 6465 6661 756c 7420 6973 2028 382c  e default is (8,
+00003c60: 3829 2e0d 0a20 2020 2020 2020 2020 2020  8)...           
+00003c70: 2074 6974 6c65 203a 205b 7374 725d 2c20   title : [str], 
+00003c80: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
+00003c90: 2020 2020 2020 2020 2020 7469 746c 6520            title 
+00003ca0: 6f66 2074 6865 2070 6c6f 742e 2054 6865  of the plot. The
+00003cb0: 2064 6566 6175 6c74 2069 7320 2754 6f74   default is 'Tot
+00003cc0: 616c 2044 6973 6368 6172 6765 272e 0d0a  al Discharge'...
+00003cd0: 2020 2020 2020 2020 2020 2020 7469 746c              titl
+00003ce0: 655f 7369 7a65 203a 205b 696e 7465 6765  e_size : [intege
+00003cf0: 725d 2c20 6f70 7469 6f6e 616c 0d0a 2020  r], optional..  
+00003d00: 2020 2020 2020 2020 2020 2020 2020 7469                ti
+00003d10: 746c 6520 7369 7a65 2e20 5468 6520 6465  tle size. The de
+00003d20: 6661 756c 7420 6973 2031 352e 0d0a 2020  fault is 15...  
+00003d30: 2020 2020 2020 2020 2020 6f72 6965 6e74            orient
+00003d40: 6174 696f 6e20 3a20 5b73 7472 696e 675d  ation : [string]
+00003d50: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
+00003d60: 2020 2020 2020 2020 2020 2020 6f72 696e              orin
+00003d70: 7461 7469 6f6e 206f 6620 7468 6520 636f  tation of the co
+00003d80: 6c6f 7262 6172 2068 6f72 697a 6f6e 7461  lorbar horizonta
+00003d90: 6c2f 7665 7274 6963 616c 2e20 5468 6520  l/vertical. The 
+00003da0: 6465 6661 756c 7420 6973 2027 7665 7274  default is 'vert
+00003db0: 6963 616c 272e 0d0a 2020 2020 2020 2020  ical'...        
+00003dc0: 2020 2020 726f 7461 7469 6f6e 203a 205b      rotation : [
+00003dd0: 6e75 6d62 6572 5d2c 206f 7074 696f 6e61  number], optiona
+00003de0: 6c0d 0a20 2020 2020 2020 2020 2020 2020  l..             
+00003df0: 2020 2072 6f74 6174 696f 6e20 6f66 2074     rotation of t
+00003e00: 6865 2063 6f6c 6f72 6261 7220 6c61 6265  he colorbar labe
+00003e10: 6c2e 2054 6865 2064 6566 6175 6c74 2069  l. The default i
+00003e20: 7320 2d39 302e 0d0a 2020 2020 2020 2020  s -90...        
+00003e30: 2020 2020 6f72 6965 6e74 6174 696f 6e20      orientation 
+00003e40: 3a20 5b73 7472 696e 675d 2c20 6f70 7469  : [string], opti
+00003e50: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
+00003e60: 2020 2020 2020 6f72 696e 7461 7469 6f6e        orintation
+00003e70: 206f 6620 7468 6520 636f 6c6f 7262 6172   of the colorbar
+00003e80: 2068 6f72 697a 6f6e 7461 6c2f 7665 7274   horizontal/vert
+00003e90: 6963 616c 2e20 5468 6520 6465 6661 756c  ical. The defaul
+00003ea0: 7420 6973 2027 7665 7274 6963 616c 272e  t is 'vertical'.
+00003eb0: 0d0a 2020 2020 2020 2020 2020 2020 6362  ..            cb
+00003ec0: 6172 5f6c 656e 6774 6820 3a20 5b66 6c6f  ar_length : [flo
+00003ed0: 6174 5d2c 206f 7074 696f 6e61 6c0d 0a20  at], optional.. 
+00003ee0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00003ef0: 6174 696f 2074 6f20 636f 6e74 726f 6c20  atio to control 
+00003f00: 7468 6520 6865 6967 6874 206f 6620 7468  the height of th
+00003f10: 6520 636f 6c6f 7262 6172 2e20 5468 6520  e colorbar. The 
+00003f20: 6465 6661 756c 7420 6973 2030 2e37 352e  default is 0.75.
+00003f30: 0d0a 2020 2020 2020 2020 2020 2020 7469  ..            ti
+00003f40: 636b 735f 7370 6163 696e 6720 3a20 5b69  cks_spacing : [i
+00003f50: 6e74 6567 6572 5d2c 206f 7074 696f 6e61  nteger], optiona
+00003f60: 6c0d 0a20 2020 2020 2020 2020 2020 2020  l..             
+00003f70: 2020 2053 7061 6369 6e67 2069 6e20 7468     Spacing in th
+00003f80: 6520 636f 6c6f 7262 6172 2074 6963 6b73  e colorbar ticks
+00003f90: 2e20 5468 6520 6465 6661 756c 7420 6973  . The default is
+00003fa0: 2032 2e0d 0a20 2020 2020 2020 2020 2020   2...           
+00003fb0: 2063 6261 725f 6c61 6265 6c5f 7369 7a65   cbar_label_size
+00003fc0: 203a 2069 6e74 6567 6572 2c20 6f70 7469   : integer, opti
+00003fd0: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
+00003fe0: 2020 2020 2020 7369 7a65 206f 6620 7468        size of th
+00003ff0: 6520 636f 6c6f 7220 6261 7220 6c61 6265  e color bar labe
+00004000: 6c2e 2054 6865 2064 6566 6175 6c74 2069  l. The default i
+00004010: 7320 3132 2e0d 0a20 2020 2020 2020 2020  s 12...         
+00004020: 2020 2063 6261 725f 6c61 6265 6c20 3a20     cbar_label : 
+00004030: 7374 722c 206f 7074 696f 6e61 6c0d 0a20  str, optional.. 
+00004040: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00004050: 6162 656c 206f 6620 7468 6520 636f 6c6f  abel of the colo
+00004060: 7220 6261 722e 2054 6865 2064 6566 6175  r bar. The defau
+00004070: 6c74 2069 7320 2744 6973 6368 6172 6765  lt is 'Discharge
+00004080: 206d 332f 7327 2e0d 0a20 2020 2020 2020   m3/s'...       
+00004090: 2020 2020 2063 6f6c 6f72 5f73 6361 6c65       color_scale
+000040a0: 203a 2069 6e74 6567 6572 2c20 6f70 7469   : integer, opti
+000040b0: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
+000040c0: 2020 2020 2020 7468 6572 6520 6172 6520        there are 
+000040d0: 3520 6f70 7469 6f6e 7320 746f 2063 6861  5 options to cha
+000040e0: 6e67 6520 7468 6520 7363 616c 6520 6f66  nge the scale of
+000040f0: 2074 6865 2063 6f6c 6f72 732e 2054 6865   the colors. The
+00004100: 2064 6566 6175 6c74 2069 7320 312e 0d0a   default is 1...
+00004110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004120: 312d 2063 6f6c 6f72 5f73 6361 6c65 2031  1- color_scale 1
+00004130: 2069 7320 7468 6520 6e6f 726d 616c 2073   is the normal s
+00004140: 6361 6c65 0d0a 2020 2020 2020 2020 2020  cale..          
+00004150: 2020 2020 2020 322d 2063 6f6c 6f72 5f73        2- color_s
+00004160: 6361 6c65 2032 2069 7320 7468 6520 706f  cale 2 is the po
+00004170: 7765 7220 7363 616c 650d 0a20 2020 2020  wer scale..     
+00004180: 2020 2020 2020 2020 2020 2033 2d20 636f             3- co
+00004190: 6c6f 725f 7363 616c 6520 3320 6973 2074  lor_scale 3 is t
+000041a0: 6865 2053 796d 4c6f 674e 6f72 6d20 7363  he SymLogNorm sc
+000041b0: 616c 650d 0a20 2020 2020 2020 2020 2020  ale..           
+000041c0: 2020 2020 2034 2d20 636f 6c6f 725f 7363       4- color_sc
+000041d0: 616c 6520 3420 6973 2074 6865 2050 6f77  ale 4 is the Pow
+000041e0: 6572 4e6f 726d 2073 6361 6c65 0d0a 2020  erNorm scale..  
+000041f0: 2020 2020 2020 2020 2020 2020 2020 352d                5-
+00004200: 2063 6f6c 6f72 5f73 6361 6c65 2035 2069   color_scale 5 i
+00004210: 7320 7468 6520 426f 756e 6461 7279 4e6f  s the BoundaryNo
+00004220: 726d 2073 6361 6c65 0d0a 2020 2020 2020  rm scale..      
+00004230: 2020 2020 2020 2020 2020 2d2d 2d2d 2d2d            ------
+00004240: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004250: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004260: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004270: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ------------..  
+00004280: 2020 2020 2020 2020 2020 2020 2020 6761                ga
+00004290: 6d6d 6120 3a20 5b66 6c6f 6174 5d2c 206f  mma : [float], o
+000042a0: 7074 696f 6e61 6c0d 0a20 2020 2020 2020  ptional..       
+000042b0: 2020 2020 2020 2020 2020 2020 2076 616c               val
+000042c0: 7565 206e 6565 6465 6420 666f 7220 6f70  ue needed for op
+000042d0: 7469 6f6e 2032 202e 2054 6865 2064 6566  tion 2 . The def
+000042e0: 6175 6c74 2069 7320 312e 2f32 2e2e 0d0a  ault is 1./2....
+000042f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004300: 6c69 6e65 5f74 6872 6573 686f 6c64 203a  line_threshold :
+00004310: 205b 666c 6f61 745d 2c20 6f70 7469 6f6e   [float], option
+00004320: 616c 0d0a 2020 2020 2020 2020 2020 2020  al..            
+00004330: 2020 2020 2020 2020 7661 6c75 6520 6e65          value ne
+00004340: 6564 6564 2066 6f72 206f 7074 696f 6e20  eded for option 
+00004350: 332e 2054 6865 2064 6566 6175 6c74 2069  3. The default i
+00004360: 7320 302e 3030 3031 2e0d 0a20 2020 2020  s 0.0001...     
+00004370: 2020 2020 2020 2020 2020 206c 696e 655f             line_
+00004380: 7363 616c 6520 3a20 5b66 6c6f 6174 5d2c  scale : [float],
+00004390: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
+000043a0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+000043b0: 616c 7565 206e 6565 6465 6420 666f 7220  alue needed for 
+000043c0: 6f70 7469 6f6e 2033 2e20 5468 6520 6465  option 3. The de
+000043d0: 6661 756c 7420 6973 2030 2e30 3031 2e0d  fault is 0.001..
+000043e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000043f0: 2062 6f75 6e64 733a 205b 4c69 7374 5d0d   bounds: [List].
+00004400: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004410: 2020 2020 2061 206c 6973 7420 6f66 206e       a list of n
+00004420: 756d 6265 7220 746f 2062 6520 7573 6564  umber to be used
+00004430: 2061 7320 6120 6469 7363 7265 7465 2062   as a discrete b
+00004440: 6f75 6e64 7320 666f 7220 7468 6520 636f  ounds for the co
+00004450: 6c6f 7220 7363 616c 6520 342e 4465 6661  lor scale 4.Defa
+00004460: 756c 7420 6973 204e 6f6e 652c 0d0a 2020  ult is None,..  
+00004470: 2020 2020 2020 2020 2020 2020 2020 6d69                mi
+00004480: 6470 6f69 6e74 203a 205b 666c 6f61 745d  dpoint : [float]
+00004490: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
+000044a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000044b0: 7661 6c75 6520 6e65 6564 6564 2066 6f72  value needed for
+000044c0: 206f 7074 696f 6e20 352e 2054 6865 2064   option 5. The d
+000044d0: 6566 6175 6c74 2069 7320 302e 0d0a 2020  efault is 0...  
+000044e0: 2020 2020 2020 2020 2020 2020 2020 2d2d                --
+000044f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004500: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004510: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004520: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004530: 0d0a 2020 2020 2020 2020 2020 2020 636d  ..            cm
+00004540: 6170 203a 205b 7374 725d 2c20 6f70 7469  ap : [str], opti
+00004550: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
+00004560: 2020 2020 2020 636f 6c6f 7220 7374 796c        color styl
+00004570: 652e 2054 6865 2064 6566 6175 6c74 2069  e. The default i
+00004580: 7320 2763 6f6f 6c77 6172 6d5f 7227 2e0d  s 'coolwarm_r'..
+00004590: 0a20 2020 2020 2020 2020 2020 2064 6973  .            dis
+000045a0: 706c 6179 5f63 656c 6c5f 7661 6c75 6520  play_cell_value 
+000045b0: 3a20 5b62 6f6f 6c5d 0d0a 2020 2020 2020  : [bool]..      
+000045c0: 2020 2020 2020 2020 2020 5472 7565 2069            True i
+000045d0: 6620 796f 7520 7761 6e74 2074 6f20 6469  f you want to di
+000045e0: 7370 6c61 7920 7468 6520 7661 6c75 6573  splay the values
+000045f0: 206f 6620 7468 6520 6365 6c6c 7320 6173   of the cells as
+00004600: 2061 2074 6578 740d 0a20 2020 2020 2020   a text..       
+00004610: 2020 2020 206e 756d 5f73 697a 6520 3a20       num_size : 
+00004620: 696e 7465 6765 722c 206f 7074 696f 6e61  integer, optiona
+00004630: 6c0d 0a20 2020 2020 2020 2020 2020 2020  l..             
+00004640: 2020 2073 697a 6520 6f66 2074 6865 206e     size of the n
+00004650: 756d 6265 7273 2070 6c6f 7474 6564 2069  umbers plotted i
+00004660: 6e74 6f70 206f 6620 6561 6368 2063 656c  ntop of each cel
+00004670: 6c73 2e20 5468 6520 6465 6661 756c 7420  ls. The default 
+00004680: 6973 2038 2e0d 0a20 2020 2020 2020 2020  is 8...         
+00004690: 2020 2062 6163 6b67 726f 756e 645f 636f     background_co
+000046a0: 6c6f 725f 7468 7265 7368 6f6c 6420 3a20  lor_threshold : 
+000046b0: 5b66 6c6f 6174 2f69 6e74 6567 6572 5d2c  [float/integer],
+000046c0: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
+000046d0: 2020 2020 2020 2020 2020 2074 6872 6573             thres
+000046e0: 686f 6c64 2076 616c 7565 2069 6620 7468  hold value if th
+000046f0: 6520 7661 6c75 6520 6f66 2074 6865 2063  e value of the c
+00004700: 656c 6c20 6973 2067 7265 6174 6572 2c20  ell is greater, 
+00004710: 7468 6520 706c 6f74 7465 640d 0a20 2020  the plotted..   
+00004720: 2020 2020 2020 2020 2020 2020 206e 756d               num
+00004730: 6265 7273 2077 696c 6c20 6265 2062 6c61  bers will be bla
+00004740: 636b 2061 6e64 2069 6620 736d 616c 6c65  ck and if smalle
+00004750: 7220 7468 6520 706c 6f74 7465 6420 6e75  r the plotted nu
+00004760: 6d62 6572 2077 696c 6c20 6265 2077 6869  mber will be whi
+00004770: 7465 0d0a 2020 2020 2020 2020 2020 2020  te..            
+00004780: 2020 2020 6966 204e 6f6e 6520 6769 7665      if None give
+00004790: 6e20 7468 6520 6d61 7876 616c 7565 2f32  n the maxvalue/2
+000047a0: 2077 696c 6c20 6265 2063 6f6e 7369 6465   will be conside
+000047b0: 7265 642e 2054 6865 2064 6566 6175 6c74  red. The default
+000047c0: 2069 7320 4e6f 6e65 2e0d 0a0d 0a20 2020   is None.....   
+000047d0: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
+000047e0: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
+000047f0: 2020 2020 2020 2061 7865 733a 205b 6669         axes: [fi
+00004800: 6775 7265 2061 7865 735d 2e0d 0a20 2020  gure axes]...   
+00004810: 2020 2020 2020 2020 2074 6865 2061 7865           the axe
+00004820: 7320 6f66 2074 6865 206d 6174 706c 6f74  s of the matplot
+00004830: 6c69 6220 6669 6775 7265 0d0a 2020 2020  lib figure..    
+00004840: 2020 2020 6669 673a 205b 6d61 7470 6c6f      fig: [matplo
+00004850: 746c 6962 2066 6967 7572 6520 6f62 6a65  tlib figure obje
+00004860: 6374 5d0d 0a20 2020 2020 2020 2020 2020  ct]..           
+00004870: 2074 6865 2066 6967 7572 6520 6f62 6a65   the figure obje
+00004880: 6374 0d0a 2020 2020 2020 2020 2222 220d  ct..        """.
+00004890: 0a20 2020 2020 2020 2069 6d70 6f72 745f  .        import_
+000048a0: 636c 656f 7061 7472 6128 0d0a 2020 2020  cleopatra(..    
+000048b0: 2020 2020 2020 2020 2254 6865 2063 7572          "The cur
+000048c0: 7265 6e74 2066 756e 6372 696f 6e20 7573  rent funcrion us
+000048d0: 6573 2063 6c65 6f70 6174 7261 2070 6163  es cleopatra pac
+000048e0: 6b61 6765 2074 6f20 666f 7220 706c 6f74  kage to for plot
+000048f0: 7469 6e67 2c20 706c 6561 7365 2069 6e73  ting, please ins
+00004900: 7461 6c6c 2069 7420 6d61 6e75 616c 6c79  tall it manually
+00004910: 2c20 666f 7220 6d6f 7265 2069 6e66 6f20  , for more info 
+00004920: 220d 0a20 2020 2020 2020 2020 2020 2022  "..            "
+00004930: 6368 6563 6b20 6874 7470 733a 2f2f 6769  check https://gi
+00004940: 7468 7562 2e63 6f6d 2f53 6572 6170 6965  thub.com/Serapie
+00004950: 756d 2d6f 662d 616c 6578 2f63 6c65 6f70  um-of-alex/cleop
+00004960: 6174 7261 220d 0a20 2020 2020 2020 2029  atra"..        )
+00004970: 0d0a 2020 2020 2020 2020 6672 6f6d 2063  ..        from c
+00004980: 6c65 6f70 6174 7261 2e61 7272 6179 2069  leopatra.array i
+00004990: 6d70 6f72 7420 4172 7261 790d 0a0d 0a20  mport Array.... 
+000049a0: 2020 2020 2020 2065 7863 6c75 6465 5f76         exclude_v
+000049b0: 616c 7565 203d 2028 0d0a 2020 2020 2020  alue = (..      
+000049c0: 2020 2020 2020 5b73 656c 662e 6e6f 5f64        [self.no_d
+000049d0: 6174 615f 7661 6c75 655b 6261 6e64 5d2c  ata_value[band],
+000049e0: 2065 7863 6c75 6465 5f76 616c 7565 5d0d   exclude_value].
+000049f0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00004a00: 6578 636c 7564 655f 7661 6c75 6520 6973  exclude_value is
+00004a10: 206e 6f74 204e 6f6e 650d 0a20 2020 2020   not None..     
+00004a20: 2020 2020 2020 2065 6c73 6520 5b73 656c         else [sel
+00004a30: 662e 6e6f 5f64 6174 615f 7661 6c75 655b  f.no_data_value[
+00004a40: 6261 6e64 5d5d 0d0a 2020 2020 2020 2020  band]]..        
+00004a50: 290d 0a0d 0a20 2020 2020 2020 2061 7272  )....        arr
+00004a60: 203d 2073 656c 662e 7265 6164 5f61 7272   = self.read_arr
+00004a70: 6179 2862 616e 643d 6261 6e64 290d 0a20  ay(band=band).. 
+00004a80: 2020 2020 2020 2063 6c65 6f20 3d20 4172         cleo = Ar
+00004a90: 7261 7928 6172 722c 2065 7863 6c75 6465  ray(arr, exclude
+00004aa0: 5f76 616c 7565 3d65 7863 6c75 6465 5f76  _value=exclude_v
+00004ab0: 616c 7565 290d 0a20 2020 2020 2020 2066  alue)..        f
+00004ac0: 6967 2c20 6178 203d 2063 6c65 6f2e 706c  ig, ax = cleo.pl
+00004ad0: 6f74 282a 2a6b 7761 7267 7329 0d0a 2020  ot(**kwargs)..  
+00004ae0: 2020 2020 2020 7265 7475 726e 2066 6967        return fig
+00004af0: 2c20 6178 0d0a 0d0a 2020 2020 6465 6620  , ax....    def 
+00004b00: 5f67 6574 5f74 696d 655f 7661 7269 6162  _get_time_variab
+00004b10: 6c65 2873 656c 6629 3a0d 0a20 2020 2020  le(self):..     
+00004b20: 2020 2022 2222 0d0a 0d0a 2020 2020 2020     """....      
+00004b30: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
+00004b40: 2020 202d 2d2d 2d2d 2d2d 0d0a 0d0a 2020     -------....  
+00004b50: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+00004b60: 2020 2023 2074 696d 655f 7661 7273 203d     # time_vars =
+00004b70: 205b 2869 2c20 7365 6c66 2e6d 6574 615f   [(i, self.meta_
+00004b80: 6461 7461 2e67 6574 2869 2929 2066 6f72  data.get(i)) for
+00004b90: 2069 2069 6e20 7365 6c66 2e6d 6574 615f   i in self.meta_
+00004ba0: 6461 7461 2e6b 6579 7328 2920 6966 2069  data.keys() if i
+00004bb0: 2e73 7461 7274 7377 6974 6828 2274 696d  .startswith("tim
+00004bc0: 6522 295d 0d0a 2020 2020 2020 2020 2320  e")]..        # 
+00004bd0: 7469 6d65 5f76 6172 5f6e 616d 6520 3d20  time_var_name = 
+00004be0: 7469 6d65 5f76 6172 735b 305d 5b30 5d2e  time_vars[0][0].
+00004bf0: 7370 6c69 7428 2223 2229 5b30 5d0d 0a20  split("#")[0].. 
+00004c00: 2020 2020 2020 2065 7874 7261 5f64 696d         extra_dim
+00004c10: 203d 2073 656c 662e 6d65 7461 5f64 6174   = self.meta_dat
+00004c20: 612e 6765 7428 224e 4554 4344 465f 4449  a.get("NETCDF_DI
+00004c30: 4d5f 4558 5452 4122 290d 0a20 2020 2020  M_EXTRA")..     
+00004c40: 2020 2069 6620 6578 7472 615f 6469 6d20     if extra_dim 
+00004c50: 6973 206e 6f74 204e 6f6e 653a 0d0a 2020  is not None:..  
+00004c60: 2020 2020 2020 2020 2020 7469 6d65 5f76            time_v
+00004c70: 6172 5f6e 616d 6520 3d20 6578 7472 615f  ar_name = extra_
+00004c80: 6469 6d2e 7265 706c 6163 6528 227b 222c  dim.replace("{",
+00004c90: 2022 2229 2e72 6570 6c61 6365 2822 7d22   "").replace("}"
+00004ca0: 2c20 2222 290d 0a20 2020 2020 2020 2020  , "")..         
+00004cb0: 2020 2075 6e69 7473 203d 2073 656c 662e     units = self.
+00004cc0: 6d65 7461 5f64 6174 612e 6765 7428 6622  meta_data.get(f"
+00004cd0: 7b74 696d 655f 7661 725f 6e61 6d65 7d23  {time_var_name}#
+00004ce0: 756e 6974 7322 290d 0a20 2020 2020 2020  units")..       
+00004cf0: 2020 2020 2066 756e 6320 3d20 6372 6561       func = crea
+00004d00: 7465 5f74 696d 655f 636f 6e76 6572 7369  te_time_conversi
+00004d10: 6f6e 5f66 756e 6328 756e 6974 7329 0d0a  on_func(units)..
+00004d20: 2020 2020 2020 2020 2020 2020 7469 6d65              time
+00004d30: 5f76 616c 7320 3d20 7365 6c66 2e5f 7265  _vals = self._re
+00004d40: 6164 5f76 6172 6961 626c 6528 7469 6d65  ad_variable(time
+00004d50: 5f76 6172 5f6e 616d 6529 0d0a 2020 2020  _var_name)..    
+00004d60: 2020 2020 2020 2020 7469 6d65 5f73 7461          time_sta
+00004d70: 6d70 203d 206c 6973 7428 6d61 7028 6675  mp = list(map(fu
+00004d80: 6e63 2c20 7469 6d65 5f76 616c 735b 305d  nc, time_vals[0]
+00004d90: 2929 0d0a 2020 2020 2020 2020 656c 7365  ))..        else
+00004da0: 3a0d 0a20 2020 2020 2020 2020 2020 2074  :..            t
+00004db0: 696d 655f 7374 616d 7020 3d20 4e6f 6e65  ime_stamp = None
+00004dc0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00004dd0: 2074 696d 655f 7374 616d 700d 0a0d 0a20   time_stamp.... 
+00004de0: 2020 2064 6566 205f 6765 745f 6c61 745f     def _get_lat_
+00004df0: 6c6f 6e28 7365 6c66 293a 0d0a 2020 2020  lon(self):..    
+00004e00: 2020 2020 6c6f 6e20 3d20 7365 6c66 2e5f      lon = self._
+00004e10: 7265 6164 5f76 6172 6961 626c 6528 226c  read_variable("l
+00004e20: 6f6e 2229 0d0a 2020 2020 2020 2020 6c61  on")..        la
+00004e30: 7420 3d20 7365 6c66 2e5f 7265 6164 5f76  t = self._read_v
+00004e40: 6172 6961 626c 6528 226c 6174 2229 0d0a  ariable("lat")..
+00004e50: 2020 2020 2020 2020 7265 7475 726e 206c          return l
+00004e60: 6174 2c20 6c6f 6e0d 0a0d 0a20 2020 2064  at, lon....    d
+00004e70: 6566 205f 7265 6164 5f76 6172 6961 626c  ef _read_variabl
+00004e80: 6528 7365 6c66 2c20 7661 723a 2073 7472  e(self, var: str
+00004e90: 293a 0d0a 2020 2020 2020 2020 7265 7475  ):..        retu
+00004ea0: 726e 2067 6461 6c2e 4f70 656e 2866 224e  rn gdal.Open(f"N
+00004eb0: 4554 4344 463a 7b73 656c 662e 6669 6c65  ETCDF:{self.file
+00004ec0: 5f6e 616d 657d 3a7b 7661 727d 2229 2e52  _name}:{var}").R
+00004ed0: 6561 6441 7341 7272 6179 2829 0d0a 0d0a  eadAsArray()....
+00004ee0: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
+00004ef0: 640d 0a20 2020 2064 6566 205f 6372 6561  d..    def _crea
+00004f00: 7465 5f67 6461 6c5f 6461 7461 7365 7428  te_gdal_dataset(
+00004f10: 0d0a 2020 2020 2020 2020 636f 6c73 3a20  ..        cols: 
+00004f20: 696e 742c 0d0a 2020 2020 2020 2020 726f  int,..        ro
+00004f30: 7773 3a20 696e 742c 0d0a 2020 2020 2020  ws: int,..      
+00004f40: 2020 6261 6e64 733a 2069 6e74 2c0d 0a20    bands: int,.. 
+00004f50: 2020 2020 2020 2064 7479 7065 3a20 696e         dtype: in
+00004f60: 742c 0d0a 2020 2020 2020 2020 6472 6976  t,..        driv
+00004f70: 6572 3a20 7374 7220 3d20 224d 454d 222c  er: str = "MEM",
+00004f80: 0d0a 2020 2020 2020 2020 7061 7468 3a20  ..        path: 
+00004f90: 7374 7220 3d20 4e6f 6e65 2c0d 0a20 2020  str = None,..   
+00004fa0: 2029 202d 3e20 6764 616c 2e44 6174 6173   ) -> gdal.Datas
+00004fb0: 6574 3a0d 0a20 2020 2020 2020 2022 2222  et:..        """
+00004fc0: 4372 6561 7465 2047 4441 4c20 6472 6976  Create GDAL driv
+00004fd0: 6572 2e0d 0a0d 0a20 2020 2020 2020 2020  er.....         
+00004fe0: 2020 2063 7265 6174 6573 2061 2064 7269     creates a dri
+00004ff0: 7665 7220 616e 6420 7361 7665 2069 7420  ver and save it 
+00005000: 746f 2064 6973 6b20 616e 6420 696e 206d  to disk and in m
+00005010: 656d 6f72 7920 6966 2070 6174 6820 6973  emory if path is
+00005020: 206e 6f74 2067 6976 656e 2e0d 0a0d 0a20   not given..... 
+00005030: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+00005040: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+00005050: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2063  -----..        c
+00005060: 6f6c 733a 205b 696e 745d 0d0a 2020 2020  ols: [int]..    
+00005070: 2020 2020 2020 2020 6e75 6d62 6572 206f          number o
+00005080: 6620 636f 6c75 6d6e 732e 0d0a 2020 2020  f columns...    
+00005090: 2020 2020 726f 7773 3a20 5b69 6e74 5d0d      rows: [int].
+000050a0: 0a20 2020 2020 2020 2020 2020 206e 756d  .            num
+000050b0: 6265 7220 6f66 2072 6f77 732e 0d0a 2020  ber of rows...  
+000050c0: 2020 2020 2020 6261 6e64 733a 205b 696e        bands: [in
+000050d0: 745d 0d0a 2020 2020 2020 2020 2020 2020  t]..            
+000050e0: 6e75 6d62 6572 206f 6620 6261 6e64 732e  number of bands.
+000050f0: 0d0a 2020 2020 2020 2020 6472 6976 6572  ..        driver
+00005100: 3a20 5b73 7472 5d0d 0a20 2020 2020 2020  : [str]..       
+00005110: 2020 2020 2064 7269 7665 7220 7479 7065       driver type
+00005120: 205b 2247 5469 6666 222c 2022 4d45 4d22   ["GTiff", "MEM"
+00005130: 5d2e 0d0a 2020 2020 2020 2020 7061 7468  ]...        path
+00005140: 3a20 5b73 7472 5d0d 0a20 2020 2020 2020  : [str]..       
+00005150: 2020 2020 2070 6174 6820 746f 2073 6176       path to sav
+00005160: 6520 7468 6520 4754 6966 6620 6472 6976  e the GTiff driv
+00005170: 6572 2e0d 0a20 2020 2020 2020 2064 7479  er...        dty
+00005180: 7065 3a0d 0a20 2020 2020 2020 2020 2020  pe:..           
+00005190: 2067 6461 6c20 6461 7461 2074 7970 652c   gdal data type,
+000051a0: 2075 7365 2074 6865 2066 756e 6374 696f   use the functio
+000051b0: 6e73 2069 6e20 7468 6520 7574 696c 7320  ns in the utils 
+000051c0: 6d6f 6475 6c65 2074 6f20 6d61 7020 6461  module to map da
+000051d0: 7461 2074 7970 6573 2066 726f 6d20 6e75  ta types from nu
+000051e0: 6d70 7920 6f72 206f 6772 2074 6f20 6764  mpy or ogr to gd
+000051f0: 616c 2e0d 0a0d 0a20 2020 2020 2020 2052  al.....        R
+00005200: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
+00005210: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+00005220: 2067 6461 6c20 6472 6976 6572 0d0a 2020   gdal driver..  
+00005230: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+00005240: 2020 2069 6620 7061 7468 3a0d 0a20 2020     if path:..   
+00005250: 2020 2020 2020 2020 2064 7269 7665 7220           driver 
+00005260: 3d20 2247 5469 6666 2220 6966 2064 7269  = "GTiff" if dri
+00005270: 7665 7220 3d3d 2022 4d45 4d22 2065 6c73  ver == "MEM" els
+00005280: 6520 6472 6976 6572 0d0a 2020 2020 2020  e driver..      
+00005290: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
+000052a0: 6e73 7461 6e63 6528 7061 7468 2c20 7374  nstance(path, st
+000052b0: 7229 3a0d 0a20 2020 2020 2020 2020 2020  r):..           
+000052c0: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+000052d0: 7272 6f72 2822 5468 6520 7061 7468 2069  rror("The path i
+000052e0: 6e70 7574 2073 686f 756c 6420 6265 2073  nput should be s
+000052f0: 7472 696e 6722 290d 0a20 2020 2020 2020  tring")..       
+00005300: 2020 2020 2069 6620 6472 6976 6572 203d       if driver =
+00005310: 3d20 2247 5469 6666 223a 0d0a 2020 2020  = "GTiff":..    
+00005320: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00005330: 6f74 2070 6174 682e 656e 6473 7769 7468  ot path.endswith
+00005340: 2822 2e74 6966 2229 3a0d 0a20 2020 2020  (".tif"):..     
+00005350: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00005360: 6169 7365 2054 7970 6545 7272 6f72 280d  aise TypeError(.
+00005370: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005380: 2020 2020 2020 2020 2022 5468 6520 7061           "The pa
+00005390: 7468 2074 6f20 7361 7665 2074 6865 2063  th to save the c
+000053a0: 7265 6174 6564 2072 6173 7465 7220 7368  reated raster sh
+000053b0: 6f75 6c64 2065 6e64 2077 6974 6820 2e74  ould end with .t
+000053c0: 6966 220d 0a20 2020 2020 2020 2020 2020  if"..           
+000053d0: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
+000053e0: 2020 2020 2020 2020 2320 4c5a 5720 6973          # LZW is
+000053f0: 2061 206c 6f73 736c 6573 7320 636f 6d70   a lossless comp
+00005400: 7265 7373 696f 6e20 6d65 7468 6f64 2061  ression method a
+00005410: 6368 6965 7665 2074 6865 2068 6967 6873  chieve the highs
+00005420: 7420 636f 6d70 7265 7373 696f 6e20 6275  t compression bu
+00005430: 7420 7769 7468 206c 6f74 206f 6620 636f  t with lot of co
+00005440: 6d70 7574 6174 696f 6e0d 0a20 2020 2020  mputation..     
+00005450: 2020 2020 2020 2073 7263 203d 2067 6461         src = gda
+00005460: 6c2e 4765 7444 7269 7665 7242 794e 616d  l.GetDriverByNam
+00005470: 6528 6472 6976 6572 292e 4372 6561 7465  e(driver).Create
+00005480: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+00005490: 2020 2070 6174 682c 2063 6f6c 732c 2072     path, cols, r
+000054a0: 6f77 732c 2062 616e 6473 2c20 6474 7970  ows, bands, dtyp
+000054b0: 652c 205b 2243 4f4d 5052 4553 533d 4c5a  e, ["COMPRESS=LZ
+000054c0: 5722 5d0d 0a20 2020 2020 2020 2020 2020  W"]..           
+000054d0: 2029 0d0a 2020 2020 2020 2020 656c 7365   )..        else
+000054e0: 3a0d 0a20 2020 2020 2020 2020 2020 2023  :..            #
+000054f0: 2066 6f72 206d 656d 6f72 7920 6472 6976   for memory driv
+00005500: 6572 730d 0a20 2020 2020 2020 2020 2020  ers..           
+00005510: 2064 7269 7665 7220 3d20 224d 454d 220d   driver = "MEM".
+00005520: 0a20 2020 2020 2020 2020 2020 2073 7263  .            src
+00005530: 203d 2067 6461 6c2e 4765 7444 7269 7665   = gdal.GetDrive
+00005540: 7242 794e 616d 6528 6472 6976 6572 292e  rByName(driver).
+00005550: 4372 6561 7465 2822 222c 2063 6f6c 732c  Create("", cols,
+00005560: 2072 6f77 732c 2062 616e 6473 2c20 6474   rows, bands, dt
+00005570: 7970 6529 0d0a 2020 2020 2020 2020 7265  ype)..        re
+00005580: 7475 726e 2073 7263 0d0a 0d0a 2020 2020  turn src....    
+00005590: 4063 6c61 7373 6d65 7468 6f64 0d0a 2020  @classmethod..  
+000055a0: 2020 6465 6620 6372 6561 7465 5f66 726f    def create_fro
+000055b0: 6d5f 6172 7261 7928 0d0a 2020 2020 2020  m_array(..      
+000055c0: 2020 636c 732c 0d0a 2020 2020 2020 2020    cls,..        
+000055d0: 6172 723a 2055 6e69 6f6e 5b73 7472 2c20  arr: Union[str, 
+000055e0: 6764 616c 2e44 6174 6173 6574 2c20 6e70  gdal.Dataset, np
+000055f0: 2e6e 6461 7272 6179 5d2c 0d0a 2020 2020  .ndarray],..    
+00005600: 2020 2020 6765 6f3a 2055 6e69 6f6e 5b73      geo: Union[s
+00005610: 7472 2c20 7475 706c 655d 2c0d 0a20 2020  tr, tuple],..   
+00005620: 2020 2020 2065 7073 673a 2055 6e69 6f6e       epsg: Union
+00005630: 5b73 7472 2c20 696e 745d 2c0d 0a20 2020  [str, int],..   
+00005640: 2020 2020 206e 6f5f 6461 7461 5f76 616c       no_data_val
+00005650: 7565 3a20 556e 696f 6e5b 416e 792c 206c  ue: Union[Any, l
+00005660: 6973 745d 203d 2044 4546 4155 4c54 5f4e  ist] = DEFAULT_N
+00005670: 4f5f 4441 5441 5f56 414c 5545 2c0d 0a20  O_DATA_VALUE,.. 
+00005680: 2020 2029 3a0d 0a20 2020 2020 2020 2022     ):..        "
+00005690: 2222 6372 6561 7465 5f72 6173 7465 722e  ""create_raster.
+000056a0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+000056b0: 2d20 6372 6561 7465 5f72 6173 7465 7220  - create_raster 
+000056c0: 6d65 7468 6f64 2063 7265 6174 6573 2061  method creates a
+000056d0: 2072 6173 7465 7220 6672 6f6d 2061 2067   raster from a g
+000056e0: 6976 656e 2061 7272 6179 2061 6e64 2067  iven array and g
+000056f0: 656f 7472 616e 7366 6f72 6d20 6461 7461  eotransform data
+00005700: 0d0a 2020 2020 2020 2020 2020 2020 616e  ..            an
+00005710: 6420 7361 7665 2074 6865 2074 6966 2066  d save the tif f
+00005720: 696c 6520 6966 2061 2050 6174 6820 6973  ile if a Path is
+00005730: 2067 6976 656e 206f 7220 6974 2077 696c   given or it wil
+00005740: 6c20 7265 7475 726e 2074 6865 2067 6461  l return the gda
+00005750: 6c2e 4461 7461 6375 6265 0d0a 0d0a 2020  l.Datacube....  
+00005760: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+00005770: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00005780: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6172  ----..        ar
+00005790: 7220 3a20 5b61 7272 6179 5d2c 206f 7074  r : [array], opt
+000057a0: 696f 6e61 6c0d 0a20 2020 2020 2020 2020  ional..         
+000057b0: 2020 206e 756d 7079 2061 7272 6179 2e20     numpy array. 
+000057c0: 5468 6520 6465 6661 756c 7420 6973 2027  The default is '
+000057d0: 272e 0d0a 2020 2020 2020 2020 6765 6f20  '...        geo 
+000057e0: 3a20 5b6c 6973 745d 2c20 6f70 7469 6f6e  : [list], option
+000057f0: 616c 0d0a 2020 2020 2020 2020 2020 2020  al..            
+00005800: 6765 6f74 7261 6e73 666f 726d 206c 6973  geotransform lis
+00005810: 7420 5b6d 696e 696d 756d 206c 6f6e 2c20  t [minimum lon, 
+00005820: 7069 7865 6c73 697a 652c 2072 6f74 6174  pixelsize, rotat
+00005830: 696f 6e2c 206d 6178 696d 756d 206c 6174  ion, maximum lat
+00005840: 2c20 726f 7461 7469 6f6e 2c0d 0a20 2020  , rotation,..   
+00005850: 2020 2020 2020 2020 2020 2020 2070 6978               pix
+00005860: 656c 7369 7a65 5d2e 2054 6865 2064 6566  elsize]. The def
+00005870: 6175 6c74 2069 7320 2727 2e0d 0a20 2020  ault is ''...   
+00005880: 2020 2020 206e 6f5f 6461 7461 5f76 616c       no_data_val
+00005890: 7565 203a 2054 5950 452c 206f 7074 696f  ue : TYPE, optio
+000058a0: 6e61 6c0d 0a20 2020 2020 2020 2020 2020  nal..           
+000058b0: 2044 4553 4352 4950 5449 4f4e 2e20 5468   DESCRIPTION. Th
+000058c0: 6520 6465 6661 756c 7420 6973 202d 3939  e default is -99
+000058d0: 3939 2e0d 0a20 2020 2020 2020 2065 7073  99...        eps
+000058e0: 673a 205b 696e 7465 6765 725d 0d0a 2020  g: [integer]..  
+000058f0: 2020 2020 2020 2020 2020 696e 7465 6765            intege
+00005900: 7220 7265 6665 7265 6e63 6520 6e75 6d62  r reference numb
+00005910: 6572 2074 6f20 7468 6520 6e65 7720 7072  er to the new pr
+00005920: 6f6a 6563 7469 6f6e 2028 6874 7470 733a  ojection (https:
+00005930: 2f2f 6570 7367 2e69 6f2f 290d 0a20 2020  //epsg.io/)..   
+00005940: 2020 2020 2020 2020 2020 2020 2028 6465               (de
+00005950: 6661 756c 7420 3338 3537 2074 6865 2072  fault 3857 the r
+00005960: 6566 6572 656e 6365 206e 6f20 6f66 2057  eference no of W
+00005970: 4753 3834 2077 6562 206d 6572 6361 746f  GS84 web mercato
+00005980: 7220 290d 0a0d 0a20 2020 2020 2020 2052  r )....        R
+00005990: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
+000059a0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+000059b0: 2064 7374 203a 205b 4461 7461 5365 745d   dst : [DataSet]
+000059c0: 2e0d 0a20 2020 2020 2020 2020 2020 2044  ...            D
+000059d0: 6174 6173 6574 206f 626a 6563 7420 7769  ataset object wi
+000059e0: 6c6c 2062 6520 7265 7475 726e 6564 2e0d  ll be returned..
+000059f0: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+00005a00: 2020 2020 2020 6966 206c 656e 2861 7272        if len(arr
+00005a10: 2e73 6861 7065 2920 3d3d 2032 3a0d 0a20  .shape) == 2:.. 
+00005a20: 2020 2020 2020 2020 2020 2062 616e 6473             bands
+00005a30: 203d 2031 0d0a 2020 2020 2020 2020 2020   = 1..          
+00005a40: 2020 726f 7773 203d 2069 6e74 2861 7272    rows = int(arr
+00005a50: 2e73 6861 7065 5b30 5d29 0d0a 2020 2020  .shape[0])..    
+00005a60: 2020 2020 2020 2020 636f 6c73 203d 2069          cols = i
+00005a70: 6e74 2861 7272 2e73 6861 7065 5b31 5d29  nt(arr.shape[1])
+00005a80: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+00005a90: 0a20 2020 2020 2020 2020 2020 2062 616e  .            ban
+00005aa0: 6473 203d 2061 7272 2e73 6861 7065 5b30  ds = arr.shape[0
+00005ab0: 5d0d 0a20 2020 2020 2020 2020 2020 2072  ]..            r
+00005ac0: 6f77 7320 3d20 696e 7428 6172 722e 7368  ows = int(arr.sh
+00005ad0: 6170 655b 315d 290d 0a20 2020 2020 2020  ape[1])..       
+00005ae0: 2020 2020 2063 6f6c 7320 3d20 696e 7428       cols = int(
+00005af0: 6172 722e 7368 6170 655b 325d 290d 0a0d  arr.shape[2])...
+00005b00: 0a20 2020 2020 2020 2064 7479 7065 203d  .        dtype =
+00005b10: 206e 756d 7079 5f74 6f5f 6764 616c 5f64   numpy_to_gdal_d
+00005b20: 7479 7065 2861 7272 290d 0a20 2020 2020  type(arr)..     
+00005b30: 2020 2064 7374 5f64 7320 3d20 4461 7461     dst_ds = Data
+00005b40: 7365 742e 5f63 7265 6174 655f 6764 616c  set._create_gdal
+00005b50: 5f64 6174 6173 6574 280d 0a20 2020 2020  _dataset(..     
+00005b60: 2020 2020 2020 2063 6f6c 732c 2072 6f77         cols, row
+00005b70: 732c 2062 616e 6473 2c20 6474 7970 652c  s, bands, dtype,
+00005b80: 2064 7269 7665 723d 224d 454d 222c 2070   driver="MEM", p
+00005b90: 6174 683d 4e6f 6e65 0d0a 2020 2020 2020  ath=None..      
+00005ba0: 2020 290d 0a0d 0a20 2020 2020 2020 2073    )....        s
+00005bb0: 7273 6520 3d20 4461 7461 7365 742e 5f63  rse = Dataset._c
+00005bc0: 7265 6174 655f 7372 5f66 726f 6d5f 6570  reate_sr_from_ep
+00005bd0: 7367 2865 7073 673d 6570 7367 290d 0a20  sg(epsg=epsg).. 
+00005be0: 2020 2020 2020 2064 7374 5f64 732e 5365         dst_ds.Se
+00005bf0: 7450 726f 6a65 6374 696f 6e28 7372 7365  tProjection(srse
+00005c00: 2e45 7870 6f72 7454 6f57 6b74 2829 290d  .ExportToWkt()).
+00005c10: 0a20 2020 2020 2020 2064 7374 5f6f 626a  .        dst_obj
+00005c20: 203d 2063 6c73 2864 7374 5f64 7329 0d0a   = cls(dst_ds)..
+00005c30: 2020 2020 2020 2020 6473 745f 6f62 6a2e          dst_obj.
+00005c40: 5f73 6574 5f6e 6f5f 6461 7461 5f76 616c  _set_no_data_val
+00005c50: 7565 286e 6f5f 6461 7461 5f76 616c 7565  ue(no_data_value
+00005c60: 3d6e 6f5f 6461 7461 5f76 616c 7565 290d  =no_data_value).
+00005c70: 0a0d 0a20 2020 2020 2020 2064 7374 5f6f  ...        dst_o
+00005c80: 626a 2e72 6173 7465 722e 5365 7447 656f  bj.raster.SetGeo
+00005c90: 5472 616e 7366 6f72 6d28 6765 6f29 0d0a  Transform(geo)..
+00005ca0: 2020 2020 2020 2020 6966 2062 616e 6473          if bands
+00005cb0: 203d 3d20 313a 0d0a 2020 2020 2020 2020   == 1:..        
+00005cc0: 2020 2020 6473 745f 6f62 6a2e 7261 7374      dst_obj.rast
+00005cd0: 6572 2e47 6574 5261 7374 6572 4261 6e64  er.GetRasterBand
+00005ce0: 2831 292e 5772 6974 6541 7272 6179 2861  (1).WriteArray(a
+00005cf0: 7272 290d 0a20 2020 2020 2020 2065 6c73  rr)..        els
+00005d00: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00005d10: 666f 7220 6920 696e 2072 616e 6765 2862  for i in range(b
+00005d20: 616e 6473 293a 0d0a 2020 2020 2020 2020  ands):..        
+00005d30: 2020 2020 2020 2020 6473 745f 6f62 6a2e          dst_obj.
+00005d40: 7261 7374 6572 2e47 6574 5261 7374 6572  raster.GetRaster
+00005d50: 4261 6e64 2869 202b 2031 292e 5772 6974  Band(i + 1).Writ
+00005d60: 6541 7272 6179 2861 7272 5b69 2c20 3a2c  eArray(arr[i, :,
+00005d70: 203a 5d29 0d0a 0d0a 2020 2020 2020 2020   :])....        
+00005d80: 7265 7475 726e 2064 7374 5f6f 626a 0d0a  return dst_obj..
+00005d90: 0d0a 2020 2020 4063 6c61 7373 6d65 7468  ..    @classmeth
+00005da0: 6f64 0d0a 2020 2020 6465 6620 6461 7461  od..    def data
+00005db0: 7365 745f 6c69 6b65 280d 0a20 2020 2020  set_like(..     
+00005dc0: 2020 2063 6c73 2c0d 0a20 2020 2020 2020     cls,..       
+00005dd0: 2073 7263 2c0d 0a20 2020 2020 2020 2061   src,..        a
+00005de0: 7272 6179 3a20 6e70 2e6e 6461 7272 6179  rray: np.ndarray
+00005df0: 2c0d 0a20 2020 2020 2020 2064 7269 7665  ,..        drive
+00005e00: 723a 2073 7472 203d 2022 4d45 4d22 2c0d  r: str = "MEM",.
+00005e10: 0a20 2020 2020 2020 2070 6174 683a 2073  .        path: s
+00005e20: 7472 203d 204e 6f6e 652c 0d0a 2020 2020  tr = None,..    
+00005e30: 2920 2d3e 2055 6e69 6f6e 5b67 6461 6c2e  ) -> Union[gdal.
+00005e40: 4461 7461 7365 742c 204e 6f6e 655d 3a0d  Dataset, None]:.
+00005e50: 0a20 2020 2020 2020 2022 2222 7261 7374  .        """rast
+00005e60: 6572 4c69 6b65 2e0d 0a0d 0a20 2020 2020  erLike.....     
+00005e70: 2020 2072 6173 7465 724c 696b 6520 6d65     rasterLike me
+00005e80: 7468 6f64 2063 7265 6174 6573 2061 2047  thod creates a G
+00005e90: 656f 7469 6666 2072 6173 7465 7220 6c69  eotiff raster li
+00005ea0: 6b65 2061 6e6f 7468 6572 2069 6e70 7574  ke another input
+00005eb0: 2072 6173 7465 722c 206e 6577 2072 6173   raster, new ras
+00005ec0: 7465 720d 0a20 2020 2020 2020 2077 696c  ter..        wil
+00005ed0: 6c20 6861 7665 2074 6865 2073 616d 6520  l have the same 
+00005ee0: 7072 6f6a 6563 7469 6f6e 2c20 636f 6f72  projection, coor
+00005ef0: 6469 6e61 7465 7320 6f72 2074 6865 2074  dinates or the t
+00005f00: 6f70 206c 6566 7420 636f 726e 6572 206f  op left corner o
+00005f10: 6620 7468 6520 6f72 6967 696e 616c 0d0a  f the original..
+00005f20: 2020 2020 2020 2020 7261 7374 6572 2c20          raster, 
+00005f30: 6365 6c6c 2073 697a 652c 206e 6f64 6174  cell size, nodat
+00005f40: 6120 7665 6c75 652c 2061 6e64 206e 756d  a velue, and num
+00005f50: 6265 7220 6f66 2072 6f77 7320 616e 6420  ber of rows and 
+00005f60: 636f 6c75 6d6e 730d 0a20 2020 2020 2020  columns..       
+00005f70: 2074 6865 2072 6173 7465 7220 616e 6420   the raster and 
+00005f80: 7468 6520 6465 6d20 7368 6f75 6c64 2068  the dem should h
+00005f90: 6176 6520 7468 6520 7361 6d65 206e 756d  ave the same num
+00005fa0: 6265 7220 6f66 2063 6f6c 756d 6e73 2061  ber of columns a
+00005fb0: 6e64 2072 6f77 730d 0a0d 0a20 2020 2020  nd rows....     
+00005fc0: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
+00005fd0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00005fe0: 2d0d 0a20 2020 2020 2020 2073 7263 203a  -..        src :
+00005ff0: 205b 6764 616c 2e64 6174 6173 6574 5d0d   [gdal.dataset].
+00006000: 0a20 2020 2020 2020 2020 2020 2073 6f75  .            sou
+00006010: 7263 6520 7261 7374 6572 2074 6f20 6765  rce raster to ge
+00006020: 7420 7468 6520 7370 6174 6961 6c20 696e  t the spatial in
+00006030: 666f 726d 6174 696f 6e0d 0a20 2020 2020  formation..     
+00006040: 2020 2061 7272 6179 203a 205b 6e75 6d70     array : [nump
+00006050: 7920 6172 7261 795d 0d0a 2020 2020 2020  y array]..      
+00006060: 2020 2020 2020 746f 2073 746f 7265 2069        to store i
+00006070: 6e20 7468 6520 6e65 7720 7261 7374 6572  n the new raster
+00006080: 0d0a 2020 2020 2020 2020 6472 6976 6572  ..        driver
+00006090: 3a5b 7374 725d 0d0a 2020 2020 2020 2020  :[str]..        
+000060a0: 2020 2020 6764 616c 2064 7269 7665 7220      gdal driver 
+000060b0: 7479 7065 2e20 4465 6661 756c 7420 6973  type. Default is
+000060c0: 2022 4754 6966 6622 0d0a 2020 2020 2020   "GTiff"..      
+000060d0: 2020 7061 7468 203a 205b 5374 7269 6e67    path : [String
+000060e0: 5d0d 0a20 2020 2020 2020 2020 2020 2070  ]..            p
+000060f0: 6174 6820 746f 2073 6176 6520 7468 6520  ath to save the 
+00006100: 6e65 7720 7261 7374 6572 2069 6e63 6c75  new raster inclu
+00006110: 6469 6e67 206e 6577 2072 6173 7465 7220  ding new raster 
+00006120: 6e61 6d65 2061 6e64 2065 7874 656e 7369  name and extensi
+00006130: 6f6e 2028 2e74 6966 290d 0a0d 0a20 2020  on (.tif)....   
+00006140: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
+00006150: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
+00006160: 2020 2020 2020 204e 6f6e 653a 0d0a 2020         None:..  
+00006170: 2020 2020 2020 2020 2020 6966 2074 6865            if the
+00006180: 2064 7269 7665 7220 6973 2022 4754 6966   driver is "GTif
+00006190: 6622 2074 6865 2066 756e 6374 696f 6e20  f" the function 
+000061a0: 7769 6c6c 2073 6176 6520 7468 6520 6e65  will save the ne
+000061b0: 7720 7261 7374 6572 2074 6f20 7468 6520  w raster to the 
+000061c0: 6769 7665 6e20 7061 7468 2e0d 0a20 2020  given path...   
+000061d0: 2020 2020 2044 6174 6163 7562 653a 0d0a       Datacube:..
+000061e0: 2020 2020 2020 2020 2020 2020 6966 2074              if t
+000061f0: 6865 2064 7269 7665 7220 6973 2022 4d45  he driver is "ME
+00006200: 4d22 2074 6865 2066 756e 6374 696f 6e20  M" the function 
+00006210: 7769 6c6c 2072 6574 7572 6e20 7468 6520  will return the 
+00006220: 6372 6561 7465 6420 7261 7374 6572 2069  created raster i
+00006230: 6e20 6d65 6d6f 7279 2e0d 0a0d 0a20 2020  n memory.....   
+00006240: 2020 2020 2045 7861 6d70 6c65 0d0a 2020       Example..  
+00006250: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
+00006260: 2020 2020 2020 203e 3e3e 2061 7272 6179         >>> array
+00006270: 203d 206e 702e 6c6f 6164 2822 5241 494e   = np.load("RAIN
+00006280: 5f35 6b2e 6e70 7922 290d 0a20 2020 2020  _5k.npy")..     
+00006290: 2020 203e 3e3e 2073 7263 203d 2067 6461     >>> src = gda
+000062a0: 6c2e 4f70 656e 2822 4445 4d2e 7469 6622  l.Open("DEM.tif"
+000062b0: 290d 0a20 2020 2020 2020 203e 3e3e 206e  )..        >>> n
+000062c0: 616d 6520 3d20 2272 6169 6e2e 7469 6622  ame = "rain.tif"
+000062d0: 0d0a 2020 2020 2020 2020 3e3e 3e20 4461  ..        >>> Da
+000062e0: 7461 7365 742e 6461 7461 7365 745f 6c69  taset.dataset_li
+000062f0: 6b65 2873 7263 2c20 6172 7261 792c 2064  ke(src, array, d
+00006300: 7269 7665 723d 2247 5469 6666 222c 2070  river="GTiff", p
+00006310: 6174 683d 6e61 6d65 290d 0a20 2020 2020  ath=name)..     
+00006320: 2020 202d 206f 7220 6372 6561 7465 2061     - or create a
+00006330: 2072 6173 7465 7220 696e 206d 656d 6f72   raster in memor
+00006340: 790d 0a20 2020 2020 2020 203e 3e3e 2061  y..        >>> a
+00006350: 7272 6179 203d 206e 702e 6c6f 6164 2822  rray = np.load("
+00006360: 5241 494e 5f35 6b2e 6e70 7922 290d 0a20  RAIN_5k.npy").. 
+00006370: 2020 2020 2020 203e 3e3e 2073 7263 203d         >>> src =
+00006380: 2067 6461 6c2e 4f70 656e 2822 4445 4d2e   gdal.Open("DEM.
+00006390: 7469 6622 290d 0a20 2020 2020 2020 203e  tif")..        >
+000063a0: 3e3e 2064 7374 203d 2044 6174 6173 6574  >> dst = Dataset
+000063b0: 2e64 6174 6173 6574 5f6c 696b 6528 7372  .dataset_like(sr
+000063c0: 632c 2061 7272 6179 2c20 6472 6976 6572  c, array, driver
+000063d0: 3d22 4d45 4d22 290d 0a20 2020 2020 2020  ="MEM")..       
+000063e0: 2022 2222 0d0a 2020 2020 2020 2020 6966   """..        if
+000063f0: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+00006400: 6172 7261 792c 206e 702e 6e64 6172 7261  array, np.ndarra
+00006410: 7929 3a0d 0a20 2020 2020 2020 2020 2020  y):..           
+00006420: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+00006430: 2822 6172 7261 7920 7368 6f75 6c64 2062  ("array should b
+00006440: 6520 6f66 2074 7970 6520 6e75 6d70 7920  e of type numpy 
+00006450: 6172 7261 7922 290d 0a0d 0a20 2020 2020  array")....     
+00006460: 2020 2069 6620 6c65 6e28 6172 7261 792e     if len(array.
+00006470: 7368 6170 6529 203d 3d20 323a 0d0a 2020  shape) == 2:..  
+00006480: 2020 2020 2020 2020 2020 6261 6e64 7320            bands 
+00006490: 3d20 310d 0a20 2020 2020 2020 2065 6c73  = 1..        els
+000064a0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+000064b0: 6261 6e64 7320 3d20 6172 7261 792e 7368  bands = array.sh
+000064c0: 6170 655b 305d 0d0a 0d0a 2020 2020 2020  ape[0]....      
+000064d0: 2020 6474 7970 6520 3d20 6e75 6d70 795f    dtype = numpy_
+000064e0: 746f 5f67 6461 6c5f 6474 7970 6528 6172  to_gdal_dtype(ar
+000064f0: 7261 7929 0d0a 0d0a 2020 2020 2020 2020  ray)....        
+00006500: 6473 7420 3d20 4461 7461 7365 742e 5f63  dst = Dataset._c
+00006510: 7265 6174 655f 6764 616c 5f64 6174 6173  reate_gdal_datas
+00006520: 6574 280d 0a20 2020 2020 2020 2020 2020  et(..           
+00006530: 2073 7263 2e63 6f6c 756d 6e73 2c20 7372   src.columns, sr
+00006540: 632e 726f 7773 2c20 6261 6e64 732c 2064  c.rows, bands, d
+00006550: 7479 7065 2c20 6472 6976 6572 3d64 7269  type, driver=dri
+00006560: 7665 722c 2070 6174 683d 7061 7468 0d0a  ver, path=path..
+00006570: 2020 2020 2020 2020 290d 0a0d 0a20 2020          )....   
+00006580: 2020 2020 2064 7374 2e53 6574 4765 6f54       dst.SetGeoT
+00006590: 7261 6e73 666f 726d 2873 7263 2e67 656f  ransform(src.geo
+000065a0: 7472 616e 7366 6f72 6d29 0d0a 2020 2020  transform)..    
+000065b0: 2020 2020 6473 742e 5365 7450 726f 6a65      dst.SetProje
+000065c0: 6374 696f 6e28 7372 632e 6372 7329 0d0a  ction(src.crs)..
+000065d0: 2020 2020 2020 2020 2320 7365 7474 696e          # settin
+000065e0: 6720 7468 6520 4e6f 4461 7461 5661 6c75  g the NoDataValu
+000065f0: 6520 646f 6573 206e 6f74 2061 6363 6570  e does not accep
+00006600: 7420 646f 7562 6c65 2070 7265 6369 7369  t double precisi
+00006610: 6f6e 206e 756d 6265 7273 0d0a 2020 2020  on numbers..    
+00006620: 2020 2020 6473 745f 6f62 6a20 3d20 636c      dst_obj = cl
+00006630: 7328 6473 7429 0d0a 2020 2020 2020 2020  s(dst)..        
+00006640: 6473 745f 6f62 6a2e 5f73 6574 5f6e 6f5f  dst_obj._set_no_
+00006650: 6461 7461 5f76 616c 7565 286e 6f5f 6461  data_value(no_da
+00006660: 7461 5f76 616c 7565 3d73 7263 2e6e 6f5f  ta_value=src.no_
+00006670: 6461 7461 5f76 616c 7565 5b30 5d29 0d0a  data_value[0])..
+00006680: 0d0a 2020 2020 2020 2020 6473 745f 6f62  ..        dst_ob
+00006690: 6a2e 7261 7374 6572 2e47 6574 5261 7374  j.raster.GetRast
+000066a0: 6572 4261 6e64 2831 292e 5772 6974 6541  erBand(1).WriteA
+000066b0: 7272 6179 2861 7272 6179 290d 0a20 2020  rray(array)..   
+000066c0: 2020 2020 2069 6620 7061 7468 2069 7320       if path is 
+000066d0: 6e6f 7420 4e6f 6e65 3a0d 0a20 2020 2020  not None:..     
+000066e0: 2020 2020 2020 2064 7374 5f6f 626a 2e72         dst_obj.r
+000066f0: 6173 7465 722e 466c 7573 6843 6163 6865  aster.FlushCache
+00006700: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
+00006710: 6473 745f 6f62 6a20 3d20 4e6f 6e65 0d0a  dst_obj = None..
+00006720: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00006730: 2064 7374 5f6f 626a 0d0a 0d0a 2020 2020   dst_obj....    
+00006740: 6465 6620 5f67 6574 5f63 7273 2873 656c  def _get_crs(sel
+00006750: 6629 202d 3e20 7374 723a 0d0a 2020 2020  f) -> str:..    
+00006760: 2020 2020 2222 2247 6574 2063 6f6f 7264      """Get coord
+00006770: 696e 6174 6520 7265 6665 7265 6e63 6520  inate reference 
+00006780: 7379 7374 656d 2e22 2222 0d0a 2020 2020  system."""..    
+00006790: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+000067a0: 7261 7374 6572 2e47 6574 5072 6f6a 6563  raster.GetProjec
+000067b0: 7469 6f6e 2829 0d0a 0d0a 2020 2020 6465  tion()....    de
+000067c0: 6620 7365 745f 6372 7328 7365 6c66 2c20  f set_crs(self, 
+000067d0: 6372 733a 204f 7074 696f 6e61 6c20 3d20  crs: Optional = 
+000067e0: 4e6f 6e65 2c20 6570 7367 3a20 696e 7420  None, epsg: int 
+000067f0: 3d20 4e6f 6e65 293a 0d0a 2020 2020 2020  = None):..      
+00006800: 2020 2222 2273 6574 5f63 7273 2e0d 0a0d    """set_crs....
+00006810: 0a20 2020 2020 2020 2020 2020 2053 6574  .            Set
+00006820: 2074 6865 2043 6f6f 7264 696e 6174 6520   the Coordinate 
+00006830: 5265 6665 7265 6e63 6520 5379 7374 656d  Reference System
+00006840: 2028 4352 5329 206f 6620 610d 0a0d 0a20   (CRS) of a.... 
+00006850: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+00006860: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+00006870: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2063  -----..        c
+00006880: 7273 3a20 5b73 7472 5d0d 0a20 2020 2020  rs: [str]..     
+00006890: 2020 2020 2020 206f 7074 696f 6e61 6c20         optional 
+000068a0: 6966 2065 7073 6720 6973 2073 7065 6369  if epsg is speci
+000068b0: 6669 6564 0d0a 2020 2020 2020 2020 2020  fied..          
+000068c0: 2020 574b 5420 7374 7269 6e67 2e0d 0a20    WKT string... 
+000068d0: 2020 2020 2020 2020 2020 2069 2e65 2e20             i.e. 
+000068e0: 2747 454f 4743 535b 2257 4753 2038 3422  'GEOGCS["WGS 84"
+000068f0: 2c44 4154 554d 5b22 5747 535f 3139 3834  ,DATUM["WGS_1984
+00006900: 222c 5350 4845 524f 4944 5b22 5747 5320  ",SPHEROID["WGS 
+00006910: 3834 222c 3633 3738 3133 372c 3239 382e  84",6378137,298.
+00006920: 3235 3732 3233 3536 332c 4155 5448 4f52  257223563,AUTHOR
+00006930: 4954 595b 2245 5053 4722 2c22 3730 3330  ITY["EPSG","7030
+00006940: 225d 5d2c 0d0a 2020 2020 2020 2020 2020  "]],..          
+00006950: 2020 4155 5448 4f52 4954 595b 2245 5053    AUTHORITY["EPS
+00006960: 4722 2c22 3633 3236 225d 5d2c 5052 494d  G","6326"]],PRIM
+00006970: 454d 5b22 4772 6565 6e77 6963 6822 2c30  EM["Greenwich",0
+00006980: 2c41 5554 484f 5249 5459 5b22 4550 5347  ,AUTHORITY["EPSG
+00006990: 222c 2238 3930 3122 5d5d 2c55 4e49 545b  ","8901"]],UNIT[
+000069a0: 2264 6567 7265 6522 2c0d 0a20 2020 2020  "degree",..     
+000069b0: 2020 2020 2020 2030 2e30 3137 3435 3332         0.0174532
+000069c0: 3932 3531 3939 3433 332c 4155 5448 4f52  925199433,AUTHOR
+000069d0: 4954 595b 2245 5053 4722 2c22 3931 3232  ITY["EPSG","9122
+000069e0: 225d 5d2c 4158 4953 5b22 4c61 7469 7475  "]],AXIS["Latitu
+000069f0: 6465 222c 4e4f 5254 485d 2c41 5849 535b  de",NORTH],AXIS[
+00006a00: 224c 6f6e 6769 7475 6465 222c 4541 5354  "Longitude",EAST
+00006a10: 5d2c 4155 5448 4f52 4954 595b 2245 5053  ],AUTHORITY["EPS
+00006a20: 4722 2c22 3433 3236 225d 5d27 0d0a 2020  G","4326"]]'..  
+00006a30: 2020 2020 2020 6570 7367 3a20 5b69 6e74        epsg: [int
+00006a40: 5d0d 0a20 2020 2020 2020 2020 2020 206f  ]..            o
+00006a50: 7074 696f 6e61 6c20 6966 2063 7273 2069  ptional if crs i
+00006a60: 7320 7370 6563 6966 6965 640d 0a20 2020  s specified..   
+00006a70: 2020 2020 2020 2020 2045 5053 4720 636f           EPSG co
+00006a80: 6465 2073 7065 6369 6679 696e 6720 7468  de specifying th
+00006a90: 6520 7072 6f6a 6563 7469 6f6e 2e0d 0a20  e projection... 
+00006aa0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+00006ab0: 2020 2020 2320 6669 7273 7420 6368 616e      # first chan
+00006ac0: 6765 2074 6865 2070 726f 6a65 6374 696f  ge the projectio
+00006ad0: 6e20 6f66 2074 6865 2067 6461 6c20 6461  n of the gdal da
+00006ae0: 7461 7365 7420 6f62 6a65 6374 0d0a 2020  taset object..  
+00006af0: 2020 2020 2020 2320 7365 636f 6e64 2063        # second c
+00006b00: 6861 6e67 6520 7468 6520 6570 7367 2061  hange the epsg a
+00006b10: 7474 7269 6275 7465 206f 6620 7468 6520  ttribute of the 
+00006b20: 4461 7461 7365 7420 6f62 6a65 6374 0d0a  Dataset object..
+00006b30: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00006b40: 6472 6976 6572 5f74 7970 6520 3d3d 2022  driver_type == "
+00006b50: 6173 6369 6922 3a0d 0a20 2020 2020 2020  ascii":..       
+00006b60: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+00006b70: 7272 6f72 280d 0a20 2020 2020 2020 2020  rror(..         
+00006b80: 2020 2020 2020 2022 5365 7474 696e 6720         "Setting 
+00006b90: 4352 5320 666f 7220 4153 4349 4920 6669  CRS for ASCII fi
+00006ba0: 6c65 2069 7320 6e6f 7420 706f 7373 6962  le is not possib
+00006bb0: 6c65 2c20 796f 7520 6361 6e20 7361 7665  le, you can save
+00006bc0: 2074 6865 2066 696c 6573 2074 6f20 6120   the files to a 
+00006bd0: 6765 6f74 6966 6620 616e 6420 7468 656e  geotiff and then
+00006be0: 2072 6573 6574 2074 6865 2063 7273 220d   reset the crs".
+00006bf0: 0a20 2020 2020 2020 2020 2020 2029 0d0a  .            )..
+00006c00: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00006c10: 2020 2020 2020 2020 2020 2069 6620 6372             if cr
+00006c20: 7320 6973 206e 6f74 204e 6f6e 653a 0d0a  s is not None:..
+00006c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006c40: 7365 6c66 2e72 6173 7465 722e 5365 7450  self.raster.SetP
+00006c50: 726f 6a65 6374 696f 6e28 6372 7329 0d0a  rojection(crs)..
+00006c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006c70: 7365 6c66 2e5f 6570 7367 203d 2046 6561  self._epsg = Fea
+00006c80: 7475 7265 436f 6c6c 6563 7469 6f6e 2e67  tureCollection.g
+00006c90: 6574 5f65 7073 675f 6672 6f6d 5f50 726a  et_epsg_from_Prj
+00006ca0: 2863 7273 290d 0a20 2020 2020 2020 2020  (crs)..         
+00006cb0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00006cc0: 2020 2020 2020 2020 2020 7372 203d 2044            sr = D
+00006cd0: 6174 6173 6574 2e5f 6372 6561 7465 5f73  ataset._create_s
+00006ce0: 725f 6672 6f6d 5f65 7073 6728 6570 7367  r_from_epsg(epsg
+00006cf0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00006d00: 2020 2073 656c 662e 7261 7374 6572 2e53     self.raster.S
+00006d10: 6574 5072 6f6a 6563 7469 6f6e 2873 722e  etProjection(sr.
+00006d20: 4578 706f 7274 546f 576b 7428 2929 0d0a  ExportToWkt())..
+00006d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006d40: 7365 6c66 2e5f 6570 7367 203d 2065 7073  self._epsg = eps
+00006d50: 670d 0a0d 0a20 2020 2064 6566 205f 6765  g....    def _ge
+00006d60: 745f 6570 7367 2873 656c 6629 202d 3e20  t_epsg(self) -> 
+00006d70: 696e 743a 0d0a 2020 2020 2020 2020 2222  int:..        ""
+00006d80: 2247 6574 4550 5347 2e0d 0a0d 0a20 2020  "GetEPSG.....   
+00006d90: 2020 2020 2020 2020 2054 6869 7320 6675           This fu
+00006da0: 6e63 7469 6f6e 2072 6561 6473 2074 6865  nction reads the
+00006db0: 2070 726f 6a65 6374 696f 6e20 6f66 2061   projection of a
+00006dc0: 2047 454f 4743 5320 6669 6c65 206f 7220   GEOGCS file or 
+00006dd0: 7469 6666 2066 696c 650d 0a0d 0a20 2020  tiff file....   
+00006de0: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
+00006df0: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
+00006e00: 2020 2020 2020 2065 7073 6720 3a20 5b69         epsg : [i
+00006e10: 6e74 6567 6572 5d0d 0a20 2020 2020 2020  nteger]..       
+00006e20: 2020 2020 2065 7073 6720 6e75 6d62 6572       epsg number
+00006e30: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+00006e40: 2020 2020 2020 2070 726a 203d 2073 656c         prj = sel
+00006e50: 662e 5f67 6574 5f63 7273 2829 0d0a 2020  f._get_crs()..  
+00006e60: 2020 2020 2020 6570 7367 203d 2046 6561        epsg = Fea
+00006e70: 7475 7265 436f 6c6c 6563 7469 6f6e 2e67  tureCollection.g
+00006e80: 6574 5f65 7073 675f 6672 6f6d 5f50 726a  et_epsg_from_Prj
+00006e90: 2870 726a 290d 0a0d 0a20 2020 2020 2020  (prj)....       
+00006ea0: 2072 6574 7572 6e20 6570 7367 0d0a 0d0a   return epsg....
+00006eb0: 2020 2020 6465 6620 6765 745f 7661 7269      def get_vari
+00006ec0: 6162 6c65 7328 7365 6c66 293a 0d0a 2020  ables(self):..  
+00006ed0: 2020 2020 2020 2222 220d 0a0d 0a20 2020        """....   
+00006ee0: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
+00006ef0: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a0d        -------...
+00006f00: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+00006f10: 2020 2020 2020 7661 7269 6162 6c65 7320        variables 
+00006f20: 3d20 7b7d 0d0a 2020 2020 2020 2020 666f  = {}..        fo
+00006f30: 7220 692c 2076 6172 2069 6e20 656e 756d  r i, var in enum
+00006f40: 6572 6174 6528 7365 6c66 2e73 7562 7365  erate(self.subse
+00006f50: 7473 293a 0d0a 2020 2020 2020 2020 2020  ts):..          
+00006f60: 2020 6e61 6d65 203d 2076 6172 5b31 5d2e    name = var[1].
+00006f70: 7370 6c69 7428 2220 2229 5b31 5d0d 0a20  split(" ")[1].. 
+00006f80: 2020 2020 2020 2020 2020 2073 7263 203d             src =
+00006f90: 2067 6461 6c2e 4f70 656e 2873 656c 662e   gdal.Open(self.
+00006fa0: 7375 6273 6574 735b 695d 5b30 5d29 0d0a  subsets[i][0])..
+00006fb0: 2020 2020 2020 2020 2020 2020 7661 7269              vari
+00006fc0: 6162 6c65 735b 6e61 6d65 5d20 3d20 4461  ables[name] = Da
+00006fd0: 7461 7365 7428 7372 6329 0d0a 0d0a 2020  taset(src)....  
+00006fe0: 2020 2020 2020 7265 7475 726e 2076 6172        return var
+00006ff0: 6961 626c 6573 0d0a 0d0a 2020 2020 6465  iables....    de
+00007000: 6620 636f 756e 745f 646f 6d61 696e 5f63  f count_domain_c
+00007010: 656c 6c73 2873 656c 6629 3a0d 0a20 2020  ells(self):..   
+00007020: 2020 2020 2022 2222 436f 756e 7420 6365       """Count ce
+00007030: 6c6c 7320 696e 7369 6465 2074 6865 2064  lls inside the d
+00007040: 6f6d 6169 6e0d 0a0d 0a20 2020 2020 2020  omain....       
+00007050: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
+00007060: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
+00007070: 2020 2069 6e74 3a0d 0a20 2020 2020 2020     int:..       
+00007080: 2020 2020 204e 756d 6265 7220 6f66 2063       Number of c
+00007090: 656c 6c73 0d0a 2020 2020 2020 2020 2222  ells..        ""
+000070a0: 220d 0a20 2020 2020 2020 2023 2063 6f75  "..        # cou
+000070b0: 6e74 2063 656c 6c73 2069 6e73 6964 6520  nt cells inside 
+000070c0: 7468 6520 646f 6d61 696e 0d0a 2020 2020  the domain..    
+000070d0: 2020 2020 6172 7220 3d20 7365 6c66 2e72      arr = self.r
+000070e0: 6173 7465 722e 5265 6164 4173 4172 7261  aster.ReadAsArra
+000070f0: 7928 290d 0a20 2020 2020 2020 2064 6f6d  y()..        dom
+00007100: 6169 6e5f 636f 756e 7420 3d20 6e70 2e73  ain_count = np.s
+00007110: 697a 6528 6172 725b 3a2c 203a 5d29 202d  ize(arr[:, :]) -
+00007120: 206e 702e 636f 756e 745f 6e6f 6e7a 6572   np.count_nonzer
+00007130: 6f28 0d0a 2020 2020 2020 2020 2020 2020  o(..            
+00007140: 2861 7272 5b6e 702e 6973 636c 6f73 6528  (arr[np.isclose(
+00007150: 6172 722c 2073 656c 662e 6e6f 5f64 6174  arr, self.no_dat
+00007160: 615f 7661 6c75 655b 305d 2c20 7274 6f6c  a_value[0], rtol
+00007170: 3d30 2e30 3031 295d 290d 0a20 2020 2020  =0.001)])..     
+00007180: 2020 2029 0d0a 2020 2020 2020 2020 7265     )..        re
+00007190: 7475 726e 2064 6f6d 6169 6e5f 636f 756e  turn domain_coun
+000071a0: 740d 0a0d 0a20 2020 2040 7374 6174 6963  t....    @static
+000071b0: 6d65 7468 6f64 0d0a 2020 2020 6465 6620  method..    def 
+000071c0: 5f63 7265 6174 655f 7372 5f66 726f 6d5f  _create_sr_from_
+000071d0: 6570 7367 2865 7073 673a 2069 6e74 203d  epsg(epsg: int =
+000071e0: 204e 6f6e 6529 202d 3e20 5370 6174 6961   None) -> Spatia
+000071f0: 6c52 6566 6572 656e 6365 3a0d 0a20 2020  lReference:..   
+00007200: 2020 2020 2022 2222 4372 6561 7465 2061       """Create a
+00007210: 2073 7061 7469 616c 2072 6566 6572 656e   spatial referen
+00007220: 6365 206f 626a 6563 7420 6672 6f6d 2065  ce object from e
+00007230: 7073 6720 6e75 6d62 6572 2e0d 0a0d 0a20  psg number..... 
+00007240: 2020 2020 2020 2068 7474 7073 3a2f 2f67         https://g
+00007250: 6461 6c2e 6f72 672f 7475 746f 7269 616c  dal.org/tutorial
+00007260: 732f 6f73 725f 6170 695f 7475 742e 6874  s/osr_api_tut.ht
+00007270: 6d6c 0d0a 0d0a 2020 2020 2020 2020 5061  ml....        Pa
+00007280: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
+00007290: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+000072a0: 2020 2020 2020 6570 7367 3a20 5b69 6e74        epsg: [int
+000072b0: 5d0d 0a20 2020 2020 2020 2020 2020 2065  ]..            e
+000072c0: 7073 6720 6e75 6d62 6572 2e0d 0a0d 0a20  psg number..... 
+000072d0: 2020 2020 2020 2052 6574 7572 6e73 0d0a         Returns..
+000072e0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0d          -------.
+000072f0: 0a20 2020 2020 2020 2053 7061 7469 616c  .        Spatial
+00007300: 5265 6665 7265 6e63 6520 6f62 6a65 6374  Reference object
+00007310: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+00007320: 2020 2020 2020 2073 7220 3d20 6f73 722e         sr = osr.
+00007330: 5370 6174 6961 6c52 6566 6572 656e 6365  SpatialReference
+00007340: 2829 0d0a 2020 2020 2020 2020 7372 2e49  ()..        sr.I
+00007350: 6d70 6f72 7446 726f 6d45 5053 4728 696e  mportFromEPSG(in
+00007360: 7428 6570 7367 2929 0d0a 0d0a 2020 2020  t(epsg))....    
+00007370: 2020 2020 2320 6966 2065 7073 6720 6973      # if epsg is
+00007380: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+00007390: 2320 2020 2020 7372 2e53 6574 5765 6c6c  #     sr.SetWell
+000073a0: 4b6e 6f77 6e47 656f 6743 5328 2257 4753  KnownGeogCS("WGS
+000073b0: 3834 2229 0d0a 2020 2020 2020 2020 2320  84")..        # 
+000073c0: 656c 7365 3a0d 0a20 2020 2020 2020 2023  else:..        #
+000073d0: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
+000073e0: 2020 2023 2020 2020 2020 2020 2069 6620     #         if 
+000073f0: 6e6f 7420 7372 2e53 6574 5765 6c6c 4b6e  not sr.SetWellKn
+00007400: 6f77 6e47 656f 6743 5328 6570 7367 2920  ownGeogCS(epsg) 
+00007410: 3d3d 2036 3a0d 0a20 2020 2020 2020 2023  == 6:..        #
+00007420: 2020 2020 2020 2020 2020 2020 2073 722e               sr.
+00007430: 5365 7457 656c 6c4b 6e6f 776e 4765 6f67  SetWellKnownGeog
+00007440: 4353 2865 7073 6729 0d0a 2020 2020 2020  CS(epsg)..      
+00007450: 2020 2320 2020 2020 2020 2020 656c 7365    #         else
+00007460: 3a0d 0a20 2020 2020 2020 2023 2020 2020  :..        #    
+00007470: 2020 2020 2020 2020 2074 7279 3a0d 0a20           try:.. 
+00007480: 2020 2020 2020 2023 2020 2020 2020 2020         #        
+00007490: 2020 2020 2020 2020 2073 722e 496d 706f           sr.Impo
+000074a0: 7274 4672 6f6d 4550 5347 2869 6e74 2865  rtFromEPSG(int(e
+000074b0: 7073 6729 290d 0a20 2020 2020 2020 2023  psg))..        #
+000074c0: 2020 2020 2020 2020 2020 2020 2065 7863               exc
+000074d0: 6570 743a 0d0a 2020 2020 2020 2020 2320  ept:..        # 
+000074e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000074f0: 7372 2e49 6d70 6f72 7446 726f 6d57 6b74  sr.ImportFromWkt
+00007500: 2865 7073 6729 0d0a 2020 2020 2020 2020  (epsg)..        
+00007510: 2320 2020 2020 6578 6365 7074 3a0d 0a20  #     except:.. 
+00007520: 2020 2020 2020 2023 2020 2020 2020 2020         #        
+00007530: 2074 7279 3a0d 0a20 2020 2020 2020 2023   try:..        #
+00007540: 2020 2020 2020 2020 2020 2020 2073 722e               sr.
+00007550: 496d 706f 7274 4672 6f6d 4550 5347 2869  ImportFromEPSG(i
+00007560: 6e74 2865 7073 6729 290d 0a20 2020 2020  nt(epsg))..     
+00007570: 2020 2023 2020 2020 2020 2020 2065 7863     #         exc
+00007580: 6570 743a 0d0a 2020 2020 2020 2020 2320  ept:..        # 
+00007590: 2020 2020 2020 2020 2020 2020 7372 2e49              sr.I
+000075a0: 6d70 6f72 7446 726f 6d57 6b74 2865 7073  mportFromWkt(eps
+000075b0: 6729 0d0a 2020 2020 2020 2020 7265 7475  g)..        retu
+000075c0: 726e 2073 720d 0a0d 0a20 2020 2064 6566  rn sr....    def
+000075d0: 2067 6574 5f62 616e 645f 6e61 6d65 7328   get_band_names(
+000075e0: 7365 6c66 2920 2d3e 204c 6973 745b 7374  self) -> List[st
+000075f0: 725d 3a0d 0a20 2020 2020 2020 2022 2222  r]:..        """
+00007600: 4765 7420 6261 6e64 206e 616d 6573 2066  Get band names f
+00007610: 726f 6d20 6261 6e64 206d 6574 6120 6461  rom band meta da
+00007620: 7461 2069 6620 6578 6973 7473 206f 7468  ta if exists oth
+00007630: 6572 7769 7365 2077 696c 6c20 7265 7475  erwise will retu
+00007640: 726e 2069 6465 7820 5b31 2c32 2c20 2e2e  rn idex [1,2, ..
+00007650: 2e5d 0d0a 0d0a 2020 2020 2020 2020 5061  .]....        Pa
+00007660: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
+00007670: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 0d0a    ----------....
+00007680: 2020 2020 2020 2020 5265 7475 726e 730d          Returns.
+00007690: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000076a0: 0d0a 2020 2020 2020 2020 6c69 7374 5b73  ..        list[s
+000076b0: 7472 5d0d 0a20 2020 2020 2020 2022 2222  tr]..        """
+000076c0: 0d0a 2020 2020 2020 2020 6e61 6d65 7320  ..        names 
+000076d0: 3d20 5b5d 0d0a 2020 2020 2020 2020 666f  = []..        fo
+000076e0: 7220 6920 696e 2072 616e 6765 2831 2c20  r i in range(1, 
+000076f0: 7365 6c66 2e72 6173 7465 722e 5261 7374  self.raster.Rast
+00007700: 6572 436f 756e 7420 2b20 3129 3a0d 0a20  erCount + 1):.. 
+00007710: 2020 2020 2020 2020 2020 2062 616e 645f             band_
+00007720: 6920 3d20 7365 6c66 2e72 6173 7465 722e  i = self.raster.
+00007730: 4765 7452 6173 7465 7242 616e 6428 6929  GetRasterBand(i)
+00007740: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00007750: 6966 2062 616e 645f 692e 4765 7444 6573  if band_i.GetDes
+00007760: 6372 6970 7469 6f6e 2829 3a0d 0a20 2020  cription():..   
+00007770: 2020 2020 2020 2020 2020 2020 2023 2055               # U
+00007780: 7365 2074 6865 2062 616e 645f 6920 6465  se the band_i de
+00007790: 7363 7269 7074 696f 6e2e 0d0a 2020 2020  scription...    
+000077a0: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+000077b0: 732e 6170 7065 6e64 2862 616e 645f 692e  s.append(band_i.
+000077c0: 4765 7444 6573 6372 6970 7469 6f6e 2829  GetDescription()
+000077d0: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
+000077e0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+000077f0: 2020 2020 2020 2320 4368 6563 6b20 666f        # Check fo
+00007800: 7220 6d65 7465 6461 7461 2e0d 0a20 2020  r metedata...   
+00007810: 2020 2020 2020 2020 2020 2020 2062 616e               ban
+00007820: 645f 695f 6e61 6d65 203d 2022 4261 6e64  d_i_name = "Band
+00007830: 5f7b 7d22 2e66 6f72 6d61 7428 6261 6e64  _{}".format(band
+00007840: 5f69 2e47 6574 4261 6e64 2829 290d 0a20  _i.GetBand()).. 
+00007850: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00007860: 6574 6164 6174 6120 3d20 6261 6e64 5f69  etadata = band_i
+00007870: 2e47 6574 4461 7461 7365 7428 292e 4765  .GetDataset().Ge
+00007880: 744d 6574 6164 6174 615f 4469 6374 2829  tMetadata_Dict()
+00007890: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+000078a0: 2020 2020 2320 4966 2069 6e20 6d65 7461      # If in meta
+000078b0: 6461 7461 2c20 7265 7475 726e 2074 6865  data, return the
+000078c0: 206d 6574 6164 6174 6120 656e 7472 792c   metadata entry,
+000078d0: 2065 6c73 6520 4261 6e64 5f4e 2e0d 0a20   else Band_N... 
+000078e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000078f0: 6620 6261 6e64 5f69 5f6e 616d 6520 696e  f band_i_name in
+00007900: 206d 6574 6164 6174 6120 616e 6420 6d65   metadata and me
+00007910: 7461 6461 7461 5b62 616e 645f 695f 6e61  tadata[band_i_na
+00007920: 6d65 5d3a 0d0a 2020 2020 2020 2020 2020  me]:..          
+00007930: 2020 2020 2020 2020 2020 6e61 6d65 732e            names.
+00007940: 6170 7065 6e64 286d 6574 6164 6174 615b  append(metadata[
+00007950: 6261 6e64 5f69 5f6e 616d 655d 290d 0a20  band_i_name]).. 
+00007960: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00007970: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00007980: 2020 2020 2020 2020 2020 6e61 6d65 732e            names.
+00007990: 6170 7065 6e64 2862 616e 645f 695f 6e61  append(band_i_na
+000079a0: 6d65 290d 0a0d 0a20 2020 2020 2020 2072  me)....        r
+000079b0: 6574 7572 6e20 6e61 6d65 730d 0a0d 0a20  eturn names.... 
+000079c0: 2020 2064 6566 205f 7365 745f 6e6f 5f64     def _set_no_d
+000079d0: 6174 615f 7661 6c75 6528 0d0a 2020 2020  ata_value(..    
+000079e0: 2020 2020 7365 6c66 2c20 6e6f 5f64 6174      self, no_dat
+000079f0: 615f 7661 6c75 653a 2055 6e69 6f6e 5b41  a_value: Union[A
+00007a00: 6e79 2c20 6c69 7374 5d20 3d20 4445 4641  ny, list] = DEFA
+00007a10: 554c 545f 4e4f 5f44 4154 415f 5641 4c55  ULT_NO_DATA_VALU
+00007a20: 450d 0a20 2020 2029 3a0d 0a20 2020 2020  E..    ):..     
+00007a30: 2020 2022 2222 7365 744e 6f44 6174 6156     """setNoDataV
+00007a40: 616c 7565 2e0d 0a0d 0a20 2020 2020 2020  alue.....       
+00007a50: 2020 2020 202d 2053 6574 2074 6865 206e       - Set the n
+00007a60: 6f20 6461 7461 2076 616c 7565 2069 6e20  o data value in 
+00007a70: 6120 616c 6c20 7261 7374 6572 2062 616e  a all raster ban
+00007a80: 6473 2e0d 0a20 2020 2020 2020 2020 2020  ds...           
+00007a90: 202d 2046 696c 6c73 2074 6865 2077 686f   - Fills the who
+00007aa0: 6c65 2072 6173 7465 7220 7769 7468 2074  le raster with t
+00007ab0: 6865 206e 6f5f 6461 7461 5f76 616c 7565  he no_data_value
+00007ac0: 2e0d 0a20 2020 2020 2020 2020 2020 202d  ...            -
+00007ad0: 2075 7365 6420 6f6e 6c79 2077 6865 6e20   used only when 
+00007ae0: 6372 6561 7469 6e67 2061 6e20 656d 7074  creating an empt
+00007af0: 7920 6472 6976 6572 2e0d 0a0d 0a20 2020  y driver.....   
+00007b00: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
+00007b10: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00007b20: 2d2d 2d0d 0a20 2020 2020 2020 206e 6f5f  ---..        no_
+00007b30: 6461 7461 5f76 616c 7565 3a20 5b6e 756d  data_value: [num
+00007b40: 6572 6963 5d0d 0a20 2020 2020 2020 2020  eric]..         
+00007b50: 2020 206e 6f20 6461 7461 2076 616c 7565     no data value
+00007b60: 2074 6f20 6669 6c6c 2074 6865 206d 6173   to fill the mas
+00007b70: 6b65 6420 7061 7274 206f 6620 7468 6520  ked part of the 
+00007b80: 6172 7261 790d 0a20 2020 2020 2020 2022  array..        "
+00007b90: 2222 0d0a 2020 2020 2020 2020 6966 206e  ""..        if n
+00007ba0: 6f74 2069 7369 6e73 7461 6e63 6528 6e6f  ot isinstance(no
+00007bb0: 5f64 6174 615f 7661 6c75 652c 206c 6973  _data_value, lis
+00007bc0: 7429 3a0d 0a20 2020 2020 2020 2020 2020  t):..           
+00007bd0: 206e 6f5f 6461 7461 5f76 616c 7565 203d   no_data_value =
+00007be0: 205b 6e6f 5f64 6174 615f 7661 6c75 655d   [no_data_value]
+00007bf0: 202a 2073 656c 662e 6261 6e64 5f63 6f75   * self.band_cou
+00007c00: 6e74 0d0a 0d0a 2020 2020 2020 2020 666f  nt....        fo
+00007c10: 7220 692c 2076 616c 2069 6e20 656e 756d  r i, val in enum
+00007c20: 6572 6174 6528 7365 6c66 2e64 7479 7065  erate(self.dtype
+00007c30: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00007c40: 6966 2067 6461 6c5f 746f 5f6e 756d 7079  if gdal_to_numpy
+00007c50: 5f64 7479 7065 2876 616c 292e 5f5f 636f  _dtype(val).__co
+00007c60: 6e74 6169 6e73 5f5f 2822 666c 6f61 7422  ntains__("float"
+00007c70: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00007c80: 2020 2020 6e6f 5f64 6174 615f 7661 6c75      no_data_valu
+00007c90: 655b 695d 203d 2028 0d0a 2020 2020 2020  e[i] = (..      
+00007ca0: 2020 2020 2020 2020 2020 2020 2020 666c                fl
+00007cb0: 6f61 7428 6e6f 5f64 6174 615f 7661 6c75  oat(no_data_valu
+00007cc0: 655b 695d 2920 6966 206e 6f5f 6461 7461  e[i]) if no_data
+00007cd0: 5f76 616c 7565 5b69 5d20 6973 206e 6f74  _value[i] is not
+00007ce0: 204e 6f6e 6520 656c 7365 204e 6f6e 650d   None else None.
+00007cf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007d00: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
+00007d10: 656c 6966 2067 6461 6c5f 746f 5f6e 756d  elif gdal_to_num
+00007d20: 7079 5f64 7479 7065 2876 616c 292e 5f5f  py_dtype(val).__
+00007d30: 636f 6e74 6169 6e73 5f5f 2822 696e 7422  contains__("int"
+00007d40: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00007d50: 2020 2020 6e6f 5f64 6174 615f 7661 6c75      no_data_valu
+00007d60: 655b 695d 203d 2028 0d0a 2020 2020 2020  e[i] = (..      
+00007d70: 2020 2020 2020 2020 2020 2020 2020 696e                in
+00007d80: 7428 6e6f 5f64 6174 615f 7661 6c75 655b  t(no_data_value[
+00007d90: 695d 2920 6966 206e 6f5f 6461 7461 5f76  i]) if no_data_v
+00007da0: 616c 7565 5b69 5d20 6973 206e 6f74 204e  alue[i] is not N
+00007db0: 6f6e 6520 656c 7365 204e 6f6e 650d 0a20  one else None.. 
+00007dc0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00007dd0: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+00007de0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00007df0: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+00007e00: 7272 6f72 2822 4e6f 4461 7461 5661 6c75  rror("NoDataValu
+00007e10: 6520 6861 7320 6120 636f 6d70 6c65 7820  e has a complex 
+00007e20: 6461 7461 2074 7970 6522 290d 0a0d 0a20  data type").... 
+00007e30: 2020 2020 2020 2066 6f72 2062 616e 6420         for band 
+00007e40: 696e 2072 616e 6765 2873 656c 662e 6261  in range(self.ba
+00007e50: 6e64 5f63 6f75 6e74 293a 0d0a 2020 2020  nd_count):..    
+00007e60: 2020 2020 2020 2020 7472 793a 0d0a 2020          try:..  
+00007e70: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00007e80: 6c66 2e5f 7365 745f 6e6f 5f64 6174 615f  lf._set_no_data_
+00007e90: 7661 6c75 655f 6261 636b 656e 6428 6261  value_backend(ba
+00007ea0: 6e64 2c20 6e6f 5f64 6174 615f 7661 6c75  nd, no_data_valu
+00007eb0: 655b 6261 6e64 5d29 0d0a 2020 2020 2020  e[band])..      
+00007ec0: 2020 2020 2020 6578 6365 7074 2045 7863        except Exc
+00007ed0: 6570 7469 6f6e 2061 7320 653a 0d0a 2020  eption as e:..  
+00007ee0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00007ef0: 2073 7472 2865 292e 5f5f 636f 6e74 6169   str(e).__contai
+00007f00: 6e73 5f5f 280d 0a20 2020 2020 2020 2020  ns__(..         
+00007f10: 2020 2020 2020 2020 2020 2022 4174 7465             "Atte
+00007f20: 6d70 7420 746f 2077 7269 7465 2074 6f20  mpt to write to 
+00007f30: 7265 6164 206f 6e6c 7920 6461 7461 7365  read only datase
+00007f40: 7420 696e 2047 4441 4c52 6173 7465 7242  t in GDALRasterB
+00007f50: 616e 643a 3a46 696c 6c28 292e 220d 0a20  and::Fill().".. 
+00007f60: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00007f70: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00007f80: 2020 2020 2020 2072 6169 7365 2052 6561         raise Rea
+00007f90: 644f 6e6c 7945 7272 6f72 280d 0a20 2020  dOnlyError(..   
+00007fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007fb0: 2020 2020 2022 5468 6520 4461 7461 7365       "The Datase
+00007fc0: 7420 6973 206f 7065 6e20 7769 7468 2061  t is open with a
+00007fd0: 2072 6561 6420 6f6e 6c79 2c20 706c 6561   read only, plea
+00007fe0: 7365 2072 6561 6420 7468 6520 7261 7374  se read the rast
+00007ff0: 6572 2075 7369 6e67 2075 7064 6174 6520  er using update 
+00008000: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
+00008010: 2020 2020 2020 2020 2020 2022 6163 6365             "acce
+00008020: 7373 206d 6f64 6522 0d0a 2020 2020 2020  ss mode"..      
+00008030: 2020 2020 2020 2020 2020 2020 2020 290d                ).
+00008040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008050: 2065 6c69 6620 7374 7228 6529 2e5f 5f63   elif str(e).__c
+00008060: 6f6e 7461 696e 735f 5f28 0d0a 2020 2020  ontains__(..    
+00008070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008080: 2269 6e20 6d65 7468 6f64 2027 4261 6e64  "in method 'Band
+00008090: 5f53 6574 4e6f 4461 7461 5661 6c75 6527  _SetNoDataValue'
+000080a0: 2c20 6172 6775 6d65 6e74 2032 206f 6620  , argument 2 of 
+000080b0: 7479 7065 2027 646f 7562 6c65 2722 0d0a  type 'double'"..
+000080c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000080d0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+000080e0: 2020 2020 2020 2020 7365 6c66 2e5f 7365          self._se
+000080f0: 745f 6e6f 5f64 6174 615f 7661 6c75 655f  t_no_data_value_
+00008100: 6261 636b 656e 6428 0d0a 2020 2020 2020  backend(..      
+00008110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008120: 2020 6261 6e64 2c20 6e70 2e66 6c6f 6174    band, np.float
+00008130: 3634 286e 6f5f 6461 7461 5f76 616c 7565  64(no_data_value
+00008140: 5b62 616e 645d 290d 0a20 2020 2020 2020  [band])..       
+00008150: 2020 2020 2020 2020 2020 2020 2029 0d0a               )..
+00008160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008170: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+00008180: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00008190: 5f73 6574 5f6e 6f5f 6461 7461 5f76 616c  _set_no_data_val
+000081a0: 7565 5f62 6163 6b65 6e64 2862 616e 642c  ue_backend(band,
+000081b0: 2044 4546 4155 4c54 5f4e 4f5f 4441 5441   DEFAULT_NO_DATA
+000081c0: 5f56 414c 5545 290d 0a20 2020 2020 2020  _VALUE)..       
+000081d0: 2020 2020 2020 2020 2020 2020 206c 6f67               log
+000081e0: 6765 722e 7761 726e 696e 6728 0d0a 2020  ger.warning(..  
+000081f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008200: 2020 2020 2020 2274 6865 2074 7970 6520        "the type 
+00008210: 6f66 2074 6865 2067 6976 656e 206e 6f5f  of the given no_
+00008220: 6461 7461 5f76 616c 7565 2064 6966 6665  data_value diffe
+00008230: 7273 2066 726f 6d20 7468 6520 6474 7970  rs from the dtyp
+00008240: 6520 6f66 2074 6865 2072 6173 7465 7222  e of the raster"
+00008250: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00008260: 2020 2020 2020 2020 2020 6622 6e6f 5f64            f"no_d
+00008270: 6174 615f 7661 6c75 6520 6e6f 7720 6973  ata_value now is
+00008280: 2073 6574 2074 6f20 7b44 4546 4155 4c54   set to {DEFAULT
+00008290: 5f4e 4f5f 4441 5441 5f56 414c 5545 7d20  _NO_DATA_VALUE} 
+000082a0: 696e 2074 6865 2072 6173 7465 7222 0d0a  in the raster"..
+000082b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000082c0: 2020 2020 290d 0a0d 0a20 2020 2064 6566      )....    def
+000082d0: 205f 6361 6c63 756c 6174 655f 6262 6f78   _calculate_bbox
+000082e0: 2873 656c 6629 202d 3e20 4c69 7374 3a0d  (self) -> List:.
+000082f0: 0a20 2020 2020 2020 2022 2222 6361 6c63  .        """calc
+00008300: 756c 6174 6520 626f 756e 6469 6e67 2062  ulate bounding b
+00008310: 6f78 2222 220d 0a20 2020 2020 2020 2078  ox"""..        x
+00008320: 6d69 6e2c 2079 6d61 7820 3d20 7365 6c66  min, ymax = self
+00008330: 2e70 6976 6f74 5f70 6f69 6e74 0d0a 2020  .pivot_point..  
+00008340: 2020 2020 2020 796d 696e 203d 2079 6d61        ymin = yma
+00008350: 7820 2d20 7365 6c66 2e72 6f77 7320 2a20  x - self.rows * 
+00008360: 7365 6c66 2e63 656c 6c5f 7369 7a65 0d0a  self.cell_size..
+00008370: 2020 2020 2020 2020 786d 6178 203d 2078          xmax = x
+00008380: 6d69 6e20 2b20 7365 6c66 2e63 6f6c 756d  min + self.colum
+00008390: 6e73 202a 2073 656c 662e 6365 6c6c 5f73  ns * self.cell_s
+000083a0: 697a 650d 0a20 2020 2020 2020 2072 6574  ize..        ret
+000083b0: 7572 6e20 5b78 6d69 6e2c 2079 6d69 6e2c  urn [xmin, ymin,
+000083c0: 2078 6d61 782c 2079 6d61 785d 0d0a 0d0a   xmax, ymax]....
+000083d0: 2020 2020 6465 6620 5f63 616c 6375 6c61      def _calcula
+000083e0: 7465 5f62 6f75 6e64 7328 7365 6c66 2920  te_bounds(self) 
+000083f0: 2d3e 2047 656f 4461 7461 4672 616d 653a  -> GeoDataFrame:
+00008400: 0d0a 2020 2020 2020 2020 2222 2267 6574  ..        """get
+00008410: 2074 6865 2062 626f 7820 6173 2061 2067   the bbox as a g
+00008420: 656f 6461 7461 6672 616d 6520 7769 7468  eodataframe with
+00008430: 2061 2070 6f6c 7967 6f6e 2067 656f 6d65   a polygon geome
+00008440: 7472 7922 2222 0d0a 2020 2020 2020 2020  try"""..        
+00008450: 786d 696e 2c20 796d 696e 2c20 786d 6178  xmin, ymin, xmax
+00008460: 2c20 796d 6178 203d 2073 656c 662e 5f63  , ymax = self._c
+00008470: 616c 6375 6c61 7465 5f62 626f 7828 290d  alculate_bbox().
+00008480: 0a20 2020 2020 2020 2063 6f6f 7264 7320  .        coords 
+00008490: 3d20 5b28 786d 696e 2c20 796d 6178 292c  = [(xmin, ymax),
+000084a0: 2028 786d 696e 2c20 796d 696e 292c 2028   (xmin, ymin), (
+000084b0: 786d 6178 2c20 796d 696e 292c 2028 786d  xmax, ymin), (xm
+000084c0: 6178 2c20 796d 6178 295d 0d0a 2020 2020  ax, ymax)]..    
+000084d0: 2020 2020 706f 6c79 203d 2046 6561 7475      poly = Featu
+000084e0: 7265 436f 6c6c 6563 7469 6f6e 2e63 7265  reCollection.cre
+000084f0: 6174 655f 706f 6c79 676f 6e28 636f 6f72  ate_polygon(coor
+00008500: 6473 290d 0a20 2020 2020 2020 2067 6466  ds)..        gdf
+00008510: 203d 2067 7064 2e47 656f 4461 7461 4672   = gpd.GeoDataFr
+00008520: 616d 6528 6765 6f6d 6574 7279 3d5b 706f  ame(geometry=[po
+00008530: 6c79 5d29 0d0a 2020 2020 2020 2020 6764  ly])..        gd
+00008540: 662e 7365 745f 6372 7328 6570 7367 3d73  f.set_crs(epsg=s
+00008550: 656c 662e 6570 7367 2c20 696e 706c 6163  elf.epsg, inplac
+00008560: 653d 5472 7565 290d 0a20 2020 2020 2020  e=True)..       
+00008570: 2072 6574 7572 6e20 6764 660d 0a0d 0a20   return gdf.... 
+00008580: 2020 2064 6566 205f 7365 745f 6e6f 5f64     def _set_no_d
+00008590: 6174 615f 7661 6c75 655f 6261 636b 656e  ata_value_backen
+000085a0: 6428 7365 6c66 2c20 6261 6e64 5f69 3a20  d(self, band_i: 
+000085b0: 696e 742c 206e 6f5f 6461 7461 5f76 616c  int, no_data_val
+000085c0: 7565 3a20 416e 7929 3a0d 0a20 2020 2020  ue: Any):..     
+000085d0: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+000085e0: 2020 2020 2d20 6261 6e64 5f69 2073 7461      - band_i sta
+000085f0: 7274 7320 6672 6f6d 2030 2074 6f20 7468  rts from 0 to th
+00008600: 6520 6e75 6d62 6572 206f 6620 6261 6e64  e number of band
+00008610: 732d 312e 0d0a 0d0a 2020 2020 2020 2020  s-1.....        
+00008620: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
+00008630: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
+00008640: 2020 2020 2020 2020 6261 6e64 5f69 3a0d          band_i:.
+00008650: 0a20 2020 2020 2020 2020 2020 2062 616e  .            ban
+00008660: 6420 696e 6465 782c 2073 7461 7274 7320  d index, starts 
+00008670: 6672 6f6d 2030 2e0d 0a20 2020 2020 2020  from 0...       
+00008680: 206e 6f5f 6461 7461 5f76 616c 7565 3a0d   no_data_value:.
+00008690: 0a20 2020 2020 2020 2020 2020 204e 756d  .            Num
+000086a0: 6572 6963 616c 2076 616c 7565 2e0d 0a20  erical value... 
+000086b0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+000086c0: 2020 2020 2320 6368 6563 6b20 6966 2074      # check if t
+000086d0: 6865 2064 7479 7065 206f 6620 7468 6520  he dtype of the 
+000086e0: 6e6f 5f64 6174 615f 7661 6c75 6520 636f  no_data_value co
+000086f0: 6d70 6c79 2077 6974 6820 7468 6520 6474  mply with the dt
+00008700: 7970 6520 6f66 2074 6865 2072 6173 7465  ype of the raste
+00008710: 7220 6974 7365 6c66 2e0d 0a20 2020 2020  r itself...     
+00008720: 2020 206e 6f5f 6474 7970 6520 3d20 7374     no_dtype = st
+00008730: 7228 7479 7065 286e 6f5f 6461 7461 5f76  r(type(no_data_v
+00008740: 616c 7565 2929 2e73 706c 6974 2822 2722  alue)).split("'"
+00008750: 295b 315d 0d0a 2020 2020 2020 2020 706f  )[1]..        po
+00008760: 7465 6e74 6961 6c5f 6474 7970 6573 203d  tential_dtypes =
+00008770: 205b 0d0a 2020 2020 2020 2020 2020 2020   [..            
+00008780: 6920 666f 7220 6920 696e 206c 6973 7428  i for i in list(
+00008790: 4e55 4d50 595f 4744 414c 5f44 4154 415f  NUMPY_GDAL_DATA_
+000087a0: 5459 5045 532e 6b65 7973 2829 2920 6966  TYPES.keys()) if
+000087b0: 2069 2e5f 5f63 6f6e 7461 696e 735f 5f28   i.__contains__(
+000087c0: 6e6f 5f64 7479 7065 290d 0a20 2020 2020  no_dtype)..     
+000087d0: 2020 205d 0d0a 2020 2020 2020 2020 706f     ]..        po
+000087e0: 7465 6e74 6961 6c5f 6474 7970 6573 203d  tential_dtypes =
+000087f0: 205b 4e55 4d50 595f 4744 414c 5f44 4154   [NUMPY_GDAL_DAT
+00008800: 415f 5459 5045 532e 6765 7428 6929 2066  A_TYPES.get(i) f
+00008810: 6f72 2069 2069 6e20 706f 7465 6e74 6961  or i in potentia
+00008820: 6c5f 6474 7970 6573 5d0d 0a0d 0a20 2020  l_dtypes]....   
+00008830: 2020 2020 2069 6620 6e6f 5f64 6174 615f       if no_data_
+00008840: 7661 6c75 6520 6973 206e 6f74 204e 6f6e  value is not Non
+00008850: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00008860: 6966 206e 6f74 2073 656c 662e 6474 7970  if not self.dtyp
+00008870: 655b 6261 6e64 5f69 5d20 696e 2070 6f74  e[band_i] in pot
+00008880: 656e 7469 616c 5f64 7479 7065 733a 0d0a  ential_dtypes:..
+00008890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000088a0: 7261 6973 6520 4e6f 4461 7461 5661 6c75  raise NoDataValu
+000088b0: 6545 7272 6f72 280d 0a20 2020 2020 2020  eError(..       
+000088c0: 2020 2020 2020 2020 2020 2020 2066 2254               f"T
+000088d0: 6865 2064 7479 7065 206f 6620 7468 6520  he dtype of the 
+000088e0: 6769 7665 6e20 6e6f 5f64 6174 615f 7661  given no_data_va
+000088f0: 6c75 657b 6e6f 5f64 6174 615f 7661 6c75  lue{no_data_valu
+00008900: 657d 3a20 7b6e 6f5f 6474 7970 657d 2064  e}: {no_dtype} d
+00008910: 6966 6665 7273 2066 726f 6d20 7468 6520  iffers from the 
+00008920: 6474 7970 6520 6f66 2074 6865 2022 0d0a  dtype of the "..
+00008930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008940: 2020 2020 6622 6261 6e64 3a20 7b67 6461      f"band: {gda
+00008950: 6c5f 746f 5f6e 756d 7079 5f64 7479 7065  l_to_numpy_dtype
+00008960: 2873 656c 662e 6474 7970 655b 6261 6e64  (self.dtype[band
+00008970: 5f69 5d29 7d22 0d0a 2020 2020 2020 2020  _i])}"..        
+00008980: 2020 2020 2020 2020 290d 0a0d 0a20 2020          )....   
+00008990: 2020 2020 2073 656c 662e 6368 616e 6765       self.change
+000089a0: 5f6e 6f5f 6461 7461 5f76 616c 7565 5f61  _no_data_value_a
+000089b0: 7474 7228 6261 6e64 5f69 2c20 6e6f 5f64  ttr(band_i, no_d
+000089c0: 6174 615f 7661 6c75 6529 0d0a 2020 2020  ata_value)..    
+000089d0: 2020 2020 2320 696e 6974 6961 6c69 7a65      # initialize
+000089e0: 2074 6865 2062 616e 6420 7769 7468 2074   the band with t
+000089f0: 6865 206e 6f64 6174 6120 7661 6c75 6520  he nodata value 
+00008a00: 696e 7374 6561 6420 6f66 2030 0d0a 2020  instead of 0..  
+00008a10: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
+00008a20: 2020 2020 2020 2020 7365 6c66 2e72 6173          self.ras
+00008a30: 7465 722e 4765 7452 6173 7465 7242 616e  ter.GetRasterBan
+00008a40: 6428 6261 6e64 5f69 202b 2031 292e 4669  d(band_i + 1).Fi
+00008a50: 6c6c 286e 6f5f 6461 7461 5f76 616c 7565  ll(no_data_value
+00008a60: 290d 0a20 2020 2020 2020 2065 7863 6570  )..        excep
+00008a70: 7420 4578 6365 7074 696f 6e20 6173 2065  t Exception as e
+00008a80: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+00008a90: 6620 7374 7228 6529 2e5f 5f63 6f6e 7461  f str(e).__conta
+00008aa0: 696e 735f 5f28 2220 6172 6775 6d65 6e74  ins__(" argument
+00008ab0: 2032 206f 6620 7479 7065 2027 646f 7562   2 of type 'doub
+00008ac0: 6c65 2722 293a 0d0a 2020 2020 2020 2020  le'"):..        
+00008ad0: 2020 2020 2020 2020 7365 6c66 2e72 6173          self.ras
+00008ae0: 7465 722e 4765 7452 6173 7465 7242 616e  ter.GetRasterBan
+00008af0: 6428 6261 6e64 5f69 202b 2031 292e 4669  d(band_i + 1).Fi
+00008b00: 6c6c 286e 702e 666c 6f61 7436 3428 6e6f  ll(np.float64(no
+00008b10: 5f64 6174 615f 7661 6c75 6529 290d 0a20  _data_value)).. 
+00008b20: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00008b30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00008b40: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00008b50: 6f72 280d 0a20 2020 2020 2020 2020 2020  or(..           
+00008b60: 2020 2020 2020 2020 2066 2246 6169 6c65           f"Faile
+00008b70: 6420 746f 2066 696c 6c20 7468 6520 6261  d to fill the ba
+00008b80: 6e64 207b 6261 6e64 5f69 7d20 7769 7468  nd {band_i} with
+00008b90: 2076 616c 7565 3a20 7b6e 6f5f 6461 7461   value: {no_data
+00008ba0: 5f76 616c 7565 7d2c 2062 6563 6175 7365  _value}, because
+00008bb0: 206f 6620 7b65 7d22 0d0a 2020 2020 2020   of {e}"..      
+00008bc0: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
+00008bd0: 2020 2020 2023 2075 7064 6174 6520 7468       # update th
+00008be0: 6520 6e6f 5f64 6174 615f 7661 6c75 6520  e no_data_value 
+00008bf0: 696e 2074 6865 2044 6174 6173 6574 206f  in the Dataset o
+00008c00: 626a 6563 740d 0a20 2020 2020 2020 2073  bject..        s
+00008c10: 656c 662e 6e6f 5f64 6174 615f 7661 6c75  elf.no_data_valu
+00008c20: 655b 6261 6e64 5f69 5d20 3d20 6e6f 5f64  e[band_i] = no_d
+00008c30: 6174 615f 7661 6c75 650d 0a0d 0a20 2020  ata_value....   
+00008c40: 2064 6566 2063 6861 6e67 655f 6e6f 5f64   def change_no_d
+00008c50: 6174 615f 7661 6c75 655f 6174 7472 2873  ata_value_attr(s
+00008c60: 656c 662c 2062 616e 643a 2069 6e74 2c20  elf, band: int, 
+00008c70: 6e6f 5f64 6174 615f 7661 6c75 6529 3a0d  no_data_value):.
+00008c80: 0a20 2020 2020 2020 2022 2222 4368 616e  .        """Chan
+00008c90: 6765 2074 6865 206e 6f5f 6461 7461 5f76  ge the no_data_v
+00008ca0: 616c 7565 2061 7474 7269 6275 7465 2e0d  alue attribute..
+00008cb0: 0a0d 0a20 2020 2020 2020 2020 2020 202d  ...            -
+00008cc0: 2043 6861 6e67 6520 6f6e 6c79 2074 6865   Change only the
+00008cd0: 206e 6f5f 6461 7461 5f76 616c 7565 2061   no_data_value a
+00008ce0: 7474 7269 6275 7465 2069 6e20 7468 6520  ttribute in the 
+00008cf0: 6764 616c 2044 6174 6163 7562 6520 6f62  gdal Datacube ob
+00008d00: 6a65 6374 2e0d 0a20 2020 2020 2020 2020  ject...         
+00008d10: 2020 202d 2043 6861 6e67 6520 7468 6520     - Change the 
+00008d20: 6e6f 5f64 6174 615f 7661 6c75 6520 696e  no_data_value in
+00008d30: 2074 6865 2044 6174 6173 6574 206f 626a   the Dataset obj
+00008d40: 6563 7420 666f 7220 7468 6520 6769 7665  ect for the give
+00008d50: 6e20 6261 6e64 2069 6e64 6578 2e0d 0a20  n band index... 
+00008d60: 2020 2020 2020 2020 2020 202d 2054 6865             - The
+00008d70: 2063 6f72 7265 7370 6f6e 6469 6e67 2076   corresponding v
+00008d80: 616c 7565 2069 6e20 7468 6520 6172 7261  alue in the arra
+00008d90: 7920 7769 6c6c 206e 6f74 2062 6520 6368  y will not be ch
+00008da0: 616e 6765 642e 0d0a 2020 2020 2020 2020  anged...        
+00008db0: 2020 2020 2d20 4261 6e64 2069 6e64 6578      - Band index
+00008dc0: 2073 7461 7274 7320 6672 6f6d 2030 0d0a   starts from 0..
+00008dd0: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+00008de0: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
+00008df0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+00008e00: 2020 6261 6e64 3a20 5b69 6e74 5d0d 0a20    band: [int].. 
+00008e10: 2020 2020 2020 2020 2020 2062 616e 6420             band 
+00008e20: 696e 6465 7820 7374 6172 7473 2066 726f  index starts fro
+00008e30: 6d20 302e 0d0a 2020 2020 2020 2020 6e6f  m 0...        no
+00008e40: 5f64 6174 615f 7661 6c75 653a 205b 416e  _data_value: [An
+00008e50: 795d 0d0a 2020 2020 2020 2020 2020 2020  y]..            
+00008e60: 6e6f 2064 6174 6120 7661 6c75 652e 0d0a  no data value...
+00008e70: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+00008e80: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
+00008e90: 2020 2020 2020 2073 656c 662e 7261 7374         self.rast
+00008ea0: 6572 2e47 6574 5261 7374 6572 4261 6e64  er.GetRasterBand
+00008eb0: 2862 616e 6420 2b20 3129 2e53 6574 4e6f  (band + 1).SetNo
+00008ec0: 4461 7461 5661 6c75 6528 6e6f 5f64 6174  DataValue(no_dat
+00008ed0: 615f 7661 6c75 6529 0d0a 2020 2020 2020  a_value)..      
+00008ee0: 2020 6578 6365 7074 2045 7863 6570 7469    except Excepti
+00008ef0: 6f6e 2061 7320 653a 0d0a 2020 2020 2020  on as e:..      
+00008f00: 2020 2020 2020 6966 2073 7472 2865 292e        if str(e).
+00008f10: 5f5f 636f 6e74 6169 6e73 5f5f 280d 0a20  __contains__(.. 
+00008f20: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00008f30: 4174 7465 6d70 7420 746f 2077 7269 7465  Attempt to write
+00008f40: 2074 6f20 7265 6164 206f 6e6c 7920 6461   to read only da
+00008f50: 7461 7365 7420 696e 2047 4441 4c52 6173  taset in GDALRas
+00008f60: 7465 7242 616e 643a 3a46 696c 6c28 292e  terBand::Fill().
+00008f70: 220d 0a20 2020 2020 2020 2020 2020 2029  "..            )
+00008f80: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00008f90: 2020 2072 6169 7365 2052 6561 644f 6e6c     raise ReadOnl
+00008fa0: 7945 7272 6f72 280d 0a20 2020 2020 2020  yError(..       
+00008fb0: 2020 2020 2020 2020 2020 2020 2022 5468               "Th
+00008fc0: 6520 4461 7461 7365 7420 6973 206f 7065  e Dataset is ope
+00008fd0: 6e20 7769 7468 2061 2072 6561 6420 6f6e  n with a read on
+00008fe0: 6c79 2c20 706c 6561 7365 2072 6561 6420  ly, please read 
+00008ff0: 7468 6520 7261 7374 6572 2075 7369 6e67  the raster using
+00009000: 2075 7064 6174 6520 220d 0a20 2020 2020   update "..     
+00009010: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00009020: 6163 6365 7373 206d 6f64 6522 0d0a 2020  access mode"..  
+00009030: 2020 2020 2020 2020 2020 2020 2020 290d                ).
+00009040: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+00009050: 6620 7374 7228 6529 2e5f 5f63 6f6e 7461  f str(e).__conta
+00009060: 696e 735f 5f28 0d0a 2020 2020 2020 2020  ins__(..        
+00009070: 2020 2020 2020 2020 2269 6e20 6d65 7468          "in meth
+00009080: 6f64 2027 4261 6e64 5f53 6574 4e6f 4461  od 'Band_SetNoDa
+00009090: 7461 5661 6c75 6527 2c20 6172 6775 6d65  taValue', argume
+000090a0: 6e74 2032 206f 6620 7479 7065 2027 646f  nt 2 of type 'do
+000090b0: 7562 6c65 2722 0d0a 2020 2020 2020 2020  uble'"..        
+000090c0: 2020 2020 293a 0d0a 2020 2020 2020 2020      ):..        
+000090d0: 2020 2020 2020 2020 7365 6c66 2e72 6173          self.ras
+000090e0: 7465 722e 4765 7452 6173 7465 7242 616e  ter.GetRasterBan
+000090f0: 6428 6261 6e64 202b 2031 292e 5365 744e  d(band + 1).SetN
+00009100: 6f44 6174 6156 616c 7565 280d 0a20 2020  oDataValue(..   
+00009110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009120: 206e 702e 666c 6f61 7436 3428 6e6f 5f64   np.float64(no_d
+00009130: 6174 615f 7661 6c75 6529 0d0a 2020 2020  ata_value)..    
+00009140: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
+00009150: 2020 2020 2020 2073 656c 662e 6e6f 5f64         self.no_d
+00009160: 6174 615f 7661 6c75 655b 6261 6e64 5d20  ata_value[band] 
+00009170: 3d20 6e6f 5f64 6174 615f 7661 6c75 650d  = no_data_value.
+00009180: 0a0d 0a20 2020 2064 6566 2063 6861 6e67  ...    def chang
+00009190: 655f 6e6f 5f64 6174 615f 7661 6c75 6528  e_no_data_value(
+000091a0: 7365 6c66 2c20 6e65 775f 7661 6c75 653a  self, new_value:
+000091b0: 2041 6e79 2c20 6f6c 645f 7661 6c75 653a   Any, old_value:
+000091c0: 2041 6e79 203d 204e 6f6e 6529 3a0d 0a20   Any = None):.. 
+000091d0: 2020 2020 2020 2022 2222 6368 616e 6765         """change
+000091e0: 5f6e 6f5f 6461 7461 5f76 616c 7565 2e0d  _no_data_value..
+000091f0: 0a0d 0a20 2020 2020 2020 2020 2020 202d  ...            -
+00009200: 2053 6574 2074 6865 206e 6f20 6461 7461   Set the no data
+00009210: 2076 616c 7565 2069 6e20 6120 616c 6c20   value in a all 
+00009220: 7261 7374 6572 2062 616e 6473 2e0d 0a20  raster bands... 
+00009230: 2020 2020 2020 2020 2020 202d 2046 696c             - Fil
+00009240: 6c73 2074 6865 2077 686f 6c65 2072 6173  ls the whole ras
+00009250: 7465 7220 7769 7468 2074 6865 206e 6f5f  ter with the no_
+00009260: 6461 7461 5f76 616c 7565 2e0d 0a20 2020  data_value...   
+00009270: 2020 2020 2020 2020 202d 2043 6861 6e67           - Chang
+00009280: 6520 7468 6520 6e6f 5f64 6174 615f 7661  e the no_data_va
+00009290: 6c75 6520 696e 2074 6865 2061 7272 6179  lue in the array
+000092a0: 2069 6e20 616c 6c20 6261 6e64 732e 0d0a   in all bands...
+000092b0: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+000092c0: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
+000092d0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+000092e0: 2020 6e65 775f 7661 6c75 653a 205b 6e75    new_value: [nu
+000092f0: 6d65 7269 635d 0d0a 2020 2020 2020 2020  meric]..        
+00009300: 2020 2020 6e6f 2064 6174 6120 7661 6c75      no data valu
+00009310: 6520 746f 2073 6574 2069 6e20 7468 6520  e to set in the 
+00009320: 7261 7374 6572 2062 616e 6473 2e0d 0a0d  raster bands....
+00009330: 0a20 2020 2020 2020 206f 6c64 5f76 616c  .        old_val
+00009340: 7565 3a20 5b6e 756d 6572 6963 5d0d 0a20  ue: [numeric].. 
+00009350: 2020 2020 2020 2020 2020 206f 6c64 206e             old n
+00009360: 6f20 6461 7461 2076 616c 7565 2074 6861  o data value tha
+00009370: 7420 6172 6520 616c 7265 6164 7920 696e  t are already in
+00009380: 2074 6865 2072 6173 7465 7220 6261 6e64   the raster band
+00009390: 732e 0d0a 2020 2020 2020 2020 2222 220d  s...        """.
+000093a0: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+000093b0: 6973 696e 7374 616e 6365 286e 6577 5f76  isinstance(new_v
+000093c0: 616c 7565 2c20 6c69 7374 293a 0d0a 2020  alue, list):..  
+000093d0: 2020 2020 2020 2020 2020 6e65 775f 7661            new_va
+000093e0: 6c75 6520 3d20 5b6e 6577 5f76 616c 7565  lue = [new_value
+000093f0: 5d20 2a20 7365 6c66 2e62 616e 645f 636f  ] * self.band_co
+00009400: 756e 740d 0a0d 0a20 2020 2020 2020 2069  unt....        i
+00009410: 6620 6f6c 645f 7661 6c75 6520 6973 206e  f old_value is n
+00009420: 6f74 204e 6f6e 6520 616e 6420 6e6f 7420  ot None and not 
+00009430: 6973 696e 7374 616e 6365 286f 6c64 5f76  isinstance(old_v
+00009440: 616c 7565 2c20 6c69 7374 293a 0d0a 2020  alue, list):..  
+00009450: 2020 2020 2020 2020 2020 6f6c 645f 7661            old_va
+00009460: 6c75 6520 3d20 5b6f 6c64 5f76 616c 7565  lue = [old_value
+00009470: 5d20 2a20 7365 6c66 2e62 616e 645f 636f  ] * self.band_co
+00009480: 756e 740d 0a0d 0a20 2020 2020 2020 2064  unt....        d
+00009490: 7374 203d 2067 6461 6c2e 4765 7444 7269  st = gdal.GetDri
+000094a0: 7665 7242 794e 616d 6528 224d 454d 2229  verByName("MEM")
+000094b0: 2e43 7265 6174 6543 6f70 7928 2222 2c20  .CreateCopy("", 
+000094c0: 7365 6c66 2e72 6173 7465 722c 2030 290d  self.raster, 0).
+000094d0: 0a20 2020 2020 2020 2066 6f72 2062 616e  .        for ban
+000094e0: 6420 696e 2072 616e 6765 2873 656c 662e  d in range(self.
+000094f0: 6261 6e64 5f63 6f75 6e74 293a 0d0a 2020  band_count):..  
+00009500: 2020 2020 2020 2020 2020 6172 7220 3d20            arr = 
+00009510: 7365 6c66 2e72 6561 645f 6172 7261 7928  self.read_array(
+00009520: 6261 6e64 290d 0a20 2020 2020 2020 2020  band)..         
+00009530: 2020 2061 7272 5b6e 702e 6973 636c 6f73     arr[np.isclos
+00009540: 6528 6172 722c 206f 6c64 5f76 616c 7565  e(arr, old_value
+00009550: 2c20 7274 6f6c 3d30 2e30 3031 295d 203d  , rtol=0.001)] =
+00009560: 206e 6577 5f76 616c 7565 5b62 616e 645d   new_value[band]
+00009570: 0d0a 2020 2020 2020 2020 2020 2020 6473  ..            ds
+00009580: 742e 4765 7452 6173 7465 7242 616e 6428  t.GetRasterBand(
+00009590: 6261 6e64 202b 2031 292e 5772 6974 6541  band + 1).WriteA
+000095a0: 7272 6179 2861 7272 290d 0a0d 0a20 2020  rray(arr)....   
+000095b0: 2020 2020 2073 656c 662e 5f72 6173 7465       self._raste
+000095c0: 7220 3d20 6473 740d 0a0d 0a20 2020 2020  r = dst....     
+000095d0: 2020 2066 6f72 2062 616e 6420 696e 2072     for band in r
+000095e0: 616e 6765 2873 656c 662e 6261 6e64 5f63  ange(self.band_c
+000095f0: 6f75 6e74 293a 0d0a 2020 2020 2020 2020  ount):..        
+00009600: 2020 2020 7365 6c66 2e63 6861 6e67 655f      self.change_
+00009610: 6e6f 5f64 6174 615f 7661 6c75 655f 6174  no_data_value_at
+00009620: 7472 2862 616e 642c 206e 6577 5f76 616c  tr(band, new_val
+00009630: 7565 5b62 616e 645d 290d 0a0d 0a20 2020  ue[band])....   
+00009640: 2064 6566 2067 6574 5f63 656c 6c5f 636f   def get_cell_co
+00009650: 6f72 6473 280d 0a20 2020 2020 2020 2073  ords(..        s
+00009660: 656c 662c 206c 6f63 6174 696f 6e3a 2073  elf, location: s
+00009670: 7472 203d 2022 6365 6e74 6572 222c 206d  tr = "center", m
+00009680: 6173 6b3a 2062 6f6f 6c20 3d20 4661 6c73  ask: bool = Fals
+00009690: 650d 0a20 2020 2029 202d 3e20 6e70 2e6e  e..    ) -> np.n
+000096a0: 6461 7272 6179 3a0d 0a20 2020 2020 2020  darray:..       
+000096b0: 2022 2222 4765 7443 6f6f 7264 732e 0d0a   """GetCoords...
+000096c0: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+000096d0: 7320 7468 6520 636f 6f72 6469 6e61 7465  s the coordinate
+000096e0: 7320 6f66 2074 6865 2063 656c 6c20 6365  s of the cell ce
+000096f0: 6e74 7265 7320 696e 7369 6465 2074 6865  ntres inside the
+00009700: 2064 6f6d 6169 6e20 286f 6e6c 7920 7468   domain (only th
+00009710: 6520 6365 6c6c 7320 7468 6174 0d0a 2020  e cells that..  
+00009720: 2020 2020 2020 646f 6573 206e 6f74 2068        does not h
+00009730: 6176 6520 6e6f 6461 7461 2076 616c 7565  ave nodata value
+00009740: 290d 0a0d 0a20 2020 2020 2020 2050 6172  )....        Par
+00009750: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
+00009760: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
+00009770: 2020 2020 206c 6f63 6174 696f 6e3a 205b       location: [
+00009780: 7374 725d 0d0a 2020 2020 2020 2020 2020  str]..          
+00009790: 2020 6c6f 6361 7469 6f6e 206f 6620 7468    location of th
+000097a0: 6520 636f 6f72 6469 6e61 7465 7320 2263  e coordinates "c
+000097b0: 656e 7465 7222 2066 6f72 2074 6865 2063  enter" for the c
+000097c0: 656e 7465 7220 6f66 2061 2063 656c 6c2c  enter of a cell,
+000097d0: 2063 6f72 6e65 7220 666f 7220 7468 6520   corner for the 
+000097e0: 636f 726e 6572 206f 6620 7468 6520 6365  corner of the ce
+000097f0: 6c6c 2e0d 0a20 2020 2020 2020 2020 2020  ll...           
+00009800: 2074 6865 2063 6f72 6e65 7220 6973 2074   the corner is t
+00009810: 6865 2074 6f70 206c 6566 7420 636f 726e  he top left corn
+00009820: 6572 2e0d 0a20 2020 2020 2020 206d 6173  er...        mas
+00009830: 6b3a 205b 626f 6f6c 5d0d 0a20 2020 2020  k: [bool]..     
+00009840: 2020 2020 2020 2054 7275 6520 746f 2045         True to E
+00009850: 7865 636c 7564 6520 7468 6520 6365 6c6c  xeclude the cell
+00009860: 7320 6f75 7420 6f66 2074 6865 2064 6f61  s out of the doa
+00009870: 696e 2e20 4465 6661 756c 7420 6973 2046  in. Default is F
+00009880: 616c 7365 2e0d 0a0d 0a20 2020 2020 2020  alse.....       
+00009890: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
+000098a0: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
+000098b0: 2020 2063 6f6f 7264 7320 3a20 5b6e 702e     coords : [np.
+000098c0: 6e64 6172 7261 795d 0d0a 2020 2020 2020  ndarray]..      
+000098d0: 2020 2020 2020 4172 7261 7920 7769 7468        Array with
+000098e0: 2061 206c 6973 7420 6f66 2074 6865 2063   a list of the c
+000098f0: 6f6f 7264 696e 6174 6573 2074 6f20 6265  oordinates to be
+00009900: 2069 6e74 6572 706f 6c61 7465 642c 2077   interpolated, w
+00009910: 6974 686f 7574 2074 6865 204e 616e 0d0a  ithout the Nan..
+00009920: 2020 2020 2020 2020 6d61 745f 7261 6e67          mat_rang
+00009930: 6520 3a20 5b6e 702e 6e64 6172 7261 795d  e : [np.ndarray]
+00009940: 0d0a 2020 2020 2020 2020 2020 2020 4172  ..            Ar
+00009950: 7261 7920 7769 7468 2061 6c6c 2074 6865  ray with all the
+00009960: 2063 656e 7472 6573 206f 6620 6365 6c6c   centres of cell
+00009970: 7320 696e 2074 6865 2064 6f6d 6169 6e20  s in the domain 
+00009980: 6f66 2074 6865 2044 454d 0d0a 2020 2020  of the DEM..    
+00009990: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
+000099a0: 2023 2063 6865 636b 2074 6865 206c 6f63   # check the loc
+000099b0: 6174 696f 6e20 7061 7261 6d65 7465 720d  ation parameter.
+000099c0: 0a20 2020 2020 2020 206c 6f63 6174 696f  .        locatio
+000099d0: 6e20 3d20 6c6f 6361 7469 6f6e 2e6c 6f77  n = location.low
+000099e0: 6572 2829 0d0a 2020 2020 2020 2020 6966  er()..        if
+000099f0: 206c 6f63 6174 696f 6e20 6e6f 7420 696e   location not in
+00009a00: 205b 2263 656e 7465 7222 2c20 2263 6f72   ["center", "cor
+00009a10: 6e65 7222 5d3a 0d0a 2020 2020 2020 2020  ner"]:..        
+00009a20: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00009a30: 7272 6f72 280d 0a20 2020 2020 2020 2020  rror(..         
+00009a40: 2020 2020 2020 2022 5468 6520 6c6f 6361         "The loca
+00009a50: 7469 6f6e 2070 6172 616d 6574 6572 2063  tion parameter c
+00009a60: 616e 2068 6176 6520 6f6e 6520 6f66 2074  an have one of t
+00009a70: 6865 7365 2076 616c 7565 733a 2027 6365  hese values: 'ce
+00009a80: 6e74 6572 272c 2027 636f 726e 6572 272c  nter', 'corner',
+00009a90: 2022 0d0a 2020 2020 2020 2020 2020 2020   "..            
+00009aa0: 2020 2020 6622 6275 7420 7468 6520 7661      f"but the va
+00009ab0: 6c75 653a 207b 6c6f 6361 7469 6f6e 7d20  lue: {location} 
+00009ac0: 6973 2067 6976 656e 2e22 0d0a 2020 2020  is given."..    
+00009ad0: 2020 2020 2020 2020 290d 0a0d 0a20 2020          )....   
+00009ae0: 2020 2020 2069 6620 6c6f 6361 7469 6f6e       if location
+00009af0: 203d 3d20 2263 656e 7465 7222 3a0d 0a20   == "center":.. 
+00009b00: 2020 2020 2020 2020 2020 2023 2041 6464             # Add
+00009b10: 696e 6720 302e 352a 6365 6c6c 2073 697a  ing 0.5*cell siz
+00009b20: 6520 746f 2067 6574 2074 6865 2063 656e  e to get the cen
+00009b30: 7472 650d 0a20 2020 2020 2020 2020 2020  tre..           
+00009b40: 2061 6464 5f76 616c 7565 203d 2030 2e35   add_value = 0.5
+00009b50: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+00009b60: 0a20 2020 2020 2020 2020 2020 2061 6464  .            add
+00009b70: 5f76 616c 7565 203d 2030 0d0a 2020 2020  _value = 0..    
+00009b80: 2020 2020 2320 4765 7474 696e 6720 6461      # Getting da
+00009b90: 7461 2066 6f72 2074 6865 2077 686f 6c65  ta for the whole
+00009ba0: 2067 7269 640d 0a20 2020 2020 2020 2028   grid..        (
+00009bb0: 0d0a 2020 2020 2020 2020 2020 2020 785f  ..            x_
+00009bc0: 696e 6974 2c0d 0a20 2020 2020 2020 2020  init,..         
+00009bd0: 2020 2063 656c 6c5f 7369 7a65 5f78 2c0d     cell_size_x,.
+00009be0: 0a20 2020 2020 2020 2020 2020 2078 795f  .            xy_
+00009bf0: 7370 616e 2c0d 0a20 2020 2020 2020 2020  span,..         
+00009c00: 2020 2079 5f69 6e69 742c 0d0a 2020 2020     y_init,..    
+00009c10: 2020 2020 2020 2020 7979 5f73 7061 6e2c          yy_span,
+00009c20: 0d0a 2020 2020 2020 2020 2020 2020 6365  ..            ce
+00009c30: 6c6c 5f73 697a 655f 792c 0d0a 2020 2020  ll_size_y,..    
+00009c40: 2020 2020 2920 3d20 7365 6c66 2e67 656f      ) = self.geo
+00009c50: 7472 616e 7366 6f72 6d0d 0a20 2020 2020  transform..     
+00009c60: 2020 2069 6620 6365 6c6c 5f73 697a 655f     if cell_size_
+00009c70: 7820 213d 2063 656c 6c5f 7369 7a65 5f79  x != cell_size_y
+00009c80: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+00009c90: 6620 6e70 2e61 6273 2863 656c 6c5f 7369  f np.abs(cell_si
+00009ca0: 7a65 5f78 2920 213d 206e 702e 6162 7328  ze_x) != np.abs(
+00009cb0: 6365 6c6c 5f73 697a 655f 7929 3a0d 0a20  cell_size_y):.. 
+00009cc0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00009cd0: 6f67 6765 722e 7761 726e 696e 6728 0d0a  ogger.warning(..
+00009ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009cf0: 2020 2020 6622 5468 6520 6769 7665 6e20      f"The given 
+00009d00: 7261 7374 6572 2064 6f65 7320 6e6f 7420  raster does not 
+00009d10: 6861 7665 2061 2073 7175 6172 6520 6365  have a square ce
+00009d20: 6c6c 732c 2074 6865 2063 656c 6c20 7369  lls, the cell si
+00009d30: 7a65 2069 7320 7b63 656c 6c5f 7369 7a65  ze is {cell_size
+00009d40: 5f78 7d2a 7b63 656c 6c5f 7369 7a65 5f79  _x}*{cell_size_y
+00009d50: 7d20 220d 0a20 2020 2020 2020 2020 2020  } "..           
+00009d60: 2020 2020 2029 0d0a 0d0a 2020 2020 2020       )....      
+00009d70: 2020 2320 6461 7461 2069 6e20 7468 6520    # data in the 
+00009d80: 6172 7261 790d 0a20 2020 2020 2020 206e  array..        n
+00009d90: 6f5f 7661 6c20 3d20 7365 6c66 2e6e 6f5f  o_val = self.no_
+00009da0: 6461 7461 5f76 616c 7565 5b30 5d0d 0a20  data_value[0].. 
+00009db0: 2020 2020 2020 2061 7272 203d 2073 656c         arr = sel
+00009dc0: 662e 7265 6164 5f61 7272 6179 2862 616e  f.read_array(ban
+00009dd0: 643d 3029 0d0a 2020 2020 2020 2020 6966  d=0)..        if
+00009de0: 206d 6173 6b20 6973 206e 6f74 204e 6f6e   mask is not Non
+00009df0: 6520 616e 6420 6e6f 5f76 616c 206e 6f74  e and no_val not
+00009e00: 2069 6e20 6172 723a 0d0a 2020 2020 2020   in arr:..      
+00009e10: 2020 2020 2020 6c6f 6767 6572 2e77 6172        logger.war
+00009e20: 6e69 6e67 280d 0a20 2020 2020 2020 2020  ning(..         
+00009e30: 2020 2020 2020 2022 5468 6520 6e6f 2064         "The no d
+00009e40: 6174 6120 7661 6c75 6520 646f 6573 206e  ata value does n
+00009e50: 6f74 2065 7869 7374 2069 6e20 7468 6520  ot exist in the 
+00009e60: 6261 6e64 2c20 736f 2061 6c6c 2074 6865  band, so all the
+00009e70: 2063 656c 6c73 2077 696c 6c20 6265 2063   cells will be c
+00009e80: 6f73 6964 6572 6564 2061 6e64 2074 6865  osidered and the
+00009e90: 2022 0d0a 2020 2020 2020 2020 2020 2020   "..            
+00009ea0: 2020 2020 226d 6173 6b20 7769 6c6c 206e      "mask will n
+00009eb0: 6f74 2062 6520 636f 7369 6465 7265 642e  ot be cosidered.
+00009ec0: 220d 0a20 2020 2020 2020 2020 2020 2029  "..            )
+00009ed0: 0d0a 0d0a 2020 2020 2020 2020 6966 206d  ....        if m
+00009ee0: 6173 6b3a 0d0a 2020 2020 2020 2020 2020  ask:..          
+00009ef0: 2020 6d61 736b 203d 205b 6e6f 5f76 616c    mask = [no_val
+00009f00: 5d0d 0a20 2020 2020 2020 2065 6c73 653a  ]..        else:
+00009f10: 0d0a 2020 2020 2020 2020 2020 2020 6d61  ..            ma
+00009f20: 736b 203d 204e 6f6e 650d 0a20 2020 2020  sk = None..     
+00009f30: 2020 2069 6e64 6963 6573 203d 2067 6574     indices = get
+00009f40: 5f69 6e64 6963 6573 3228 6172 722c 206d  _indices2(arr, m
+00009f50: 6173 6b3d 6d61 736b 290d 0a0d 0a20 2020  ask=mask)....   
+00009f60: 2020 2020 2023 2065 7865 636c 7564 6520       # execlude 
+00009f70: 7468 6520 6e6f 5f64 6174 615f 7661 6c75  the no_data_valu
+00009f80: 6573 2063 656c 6c73 2e0d 0a20 2020 2020  es cells...     
+00009f90: 2020 2066 3120 3d20 5b69 5b30 5d20 666f     f1 = [i[0] fo
+00009fa0: 7220 6920 696e 2069 6e64 6963 6573 5d0d  r i in indices].
+00009fb0: 0a20 2020 2020 2020 2066 3220 3d20 5b69  .        f2 = [i
+00009fc0: 5b31 5d20 666f 7220 6920 696e 2069 6e64  [1] for i in ind
+00009fd0: 6963 6573 5d0d 0a20 2020 2020 2020 2078  ices]..        x
+00009fe0: 203d 205b 785f 696e 6974 202b 2063 656c   = [x_init + cel
+00009ff0: 6c5f 7369 7a65 5f78 202a 2028 6920 2b20  l_size_x * (i + 
+0000a000: 6164 645f 7661 6c75 6529 2066 6f72 2069  add_value) for i
+0000a010: 2069 6e20 6632 5d0d 0a20 2020 2020 2020   in f2]..       
+0000a020: 2079 203d 205b 795f 696e 6974 202b 2063   y = [y_init + c
+0000a030: 656c 6c5f 7369 7a65 5f79 202a 2028 6920  ell_size_y * (i 
+0000a040: 2b20 6164 645f 7661 6c75 6529 2066 6f72  + add_value) for
+0000a050: 2069 2069 6e20 6631 5d0d 0a20 2020 2020   i in f1]..     
+0000a060: 2020 2063 6f6f 7264 7320 3d20 6e70 2e61     coords = np.a
+0000a070: 7272 6179 286c 6973 7428 7a69 7028 782c  rray(list(zip(x,
+0000a080: 2079 2929 290d 0a0d 0a20 2020 2020 2020   y)))....       
+0000a090: 2072 6574 7572 6e20 636f 6f72 6473 0d0a   return coords..
+0000a0a0: 0d0a 2020 2020 6465 6620 6765 745f 6365  ..    def get_ce
+0000a0b0: 6c6c 5f70 6f6c 7967 6f6e 7328 7365 6c66  ll_polygons(self
+0000a0c0: 2c20 6d61 736b 3d46 616c 7365 2920 2d3e  , mask=False) ->
+0000a0d0: 2047 656f 4461 7461 4672 616d 653a 0d0a   GeoDataFrame:..
+0000a0e0: 2020 2020 2020 2020 2222 2247 6574 2061          """Get a
+0000a0f0: 2070 6f6c 7967 6f6e 2073 6861 7065 6c79   polygon shapely
+0000a100: 2067 656f 6d65 7472 7920 666f 7220 7468   geometry for th
+0000a110: 6520 7261 7374 6572 2063 656c 6c73 2e0d  e raster cells..
+0000a120: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+0000a130: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
+0000a140: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+0000a150: 2020 206d 6173 6b3a 205b 626f 6f6c 5d0d     mask: [bool].
+0000a160: 0a20 2020 2020 2020 2020 2020 2054 7275  .            Tru
+0000a170: 6520 746f 2067 6574 2074 6865 2070 6f6c  e to get the pol
+0000a180: 7967 6f6e 7320 6f66 2074 6865 2063 656c  ygons of the cel
+0000a190: 6c73 2069 6e73 6964 6520 7468 6520 646f  ls inside the do
+0000a1a0: 6d61 696e 2e0d 0a0d 0a20 2020 2020 2020  main.....       
+0000a1b0: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
+0000a1c0: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
+0000a1d0: 2020 2047 656f 4461 7461 4672 616d 653a     GeoDataFrame:
+0000a1e0: 0d0a 2020 2020 2020 2020 2020 2020 7769  ..            wi
+0000a1f0: 7468 2074 776f 2063 6f6c 756d 6e73 2c20  th two columns, 
+0000a200: 6765 6f6d 6574 7279 2c20 616e 6420 6964  geometry, and id
+0000a210: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+0000a220: 2020 2020 2020 2063 6f6f 7264 7320 3d20         coords = 
+0000a230: 7365 6c66 2e67 6574 5f63 656c 6c5f 636f  self.get_cell_co
+0000a240: 6f72 6473 286c 6f63 6174 696f 6e3d 2263  ords(location="c
+0000a250: 6f72 6e65 7222 2c20 6d61 736b 3d6d 6173  orner", mask=mas
+0000a260: 6b29 0d0a 2020 2020 2020 2020 6365 6c6c  k)..        cell
+0000a270: 5f73 697a 6520 3d20 7365 6c66 2e67 656f  _size = self.geo
+0000a280: 7472 616e 7366 6f72 6d5b 315d 0d0a 2020  transform[1]..  
+0000a290: 2020 2020 2020 6570 7367 203d 2073 656c        epsg = sel
+0000a2a0: 662e 5f67 6574 5f65 7073 6728 290d 0a20  f._get_epsg().. 
+0000a2b0: 2020 2020 2020 2078 203d 206e 702e 7a65         x = np.ze
+0000a2c0: 726f 7328 2863 6f6f 7264 732e 7368 6170  ros((coords.shap
+0000a2d0: 655b 305d 2c20 3429 290d 0a20 2020 2020  e[0], 4))..     
+0000a2e0: 2020 2079 203d 206e 702e 7a65 726f 7328     y = np.zeros(
+0000a2f0: 2863 6f6f 7264 732e 7368 6170 655b 305d  (coords.shape[0]
+0000a300: 2c20 3429 290d 0a20 2020 2020 2020 2023  , 4))..        #
+0000a310: 2066 696c 6c20 7468 6520 746f 7020 6c65   fill the top le
+0000a320: 6674 2063 6f72 6e65 7220 706f 696e 740d  ft corner point.
+0000a330: 0a20 2020 2020 2020 2078 5b3a 2c20 305d  .        x[:, 0]
+0000a340: 203d 2063 6f6f 7264 735b 3a2c 2030 5d0d   = coords[:, 0].
+0000a350: 0a20 2020 2020 2020 2079 5b3a 2c20 305d  .        y[:, 0]
+0000a360: 203d 2063 6f6f 7264 735b 3a2c 2031 5d0d   = coords[:, 1].
+0000a370: 0a20 2020 2020 2020 2023 2066 696c 6c20  .        # fill 
+0000a380: 7468 6520 746f 7020 7269 6768 740d 0a20  the top right.. 
+0000a390: 2020 2020 2020 2078 5b3a 2c20 315d 203d         x[:, 1] =
+0000a3a0: 2078 5b3a 2c20 305d 202b 2063 656c 6c5f   x[:, 0] + cell_
+0000a3b0: 7369 7a65 0d0a 2020 2020 2020 2020 795b  size..        y[
+0000a3c0: 3a2c 2031 5d20 3d20 795b 3a2c 2030 5d0d  :, 1] = y[:, 0].
+0000a3d0: 0a20 2020 2020 2020 2023 2066 696c 6c20  .        # fill 
+0000a3e0: 7468 6520 626f 7474 6f6d 2072 6967 6874  the bottom right
+0000a3f0: 0d0a 2020 2020 2020 2020 785b 3a2c 2032  ..        x[:, 2
+0000a400: 5d20 3d20 785b 3a2c 2030 5d20 2b20 6365  ] = x[:, 0] + ce
+0000a410: 6c6c 5f73 697a 650d 0a20 2020 2020 2020  ll_size..       
+0000a420: 2079 5b3a 2c20 325d 203d 2079 5b3a 2c20   y[:, 2] = y[:, 
+0000a430: 305d 202d 2063 656c 6c5f 7369 7a65 0d0a  0] - cell_size..
+0000a440: 0d0a 2020 2020 2020 2020 2320 6669 6c6c  ..        # fill
+0000a450: 2074 6865 2062 6f74 746f 6d20 6c65 6674   the bottom left
+0000a460: 0d0a 2020 2020 2020 2020 785b 3a2c 2033  ..        x[:, 3
+0000a470: 5d20 3d20 785b 3a2c 2030 5d0d 0a20 2020  ] = x[:, 0]..   
+0000a480: 2020 2020 2079 5b3a 2c20 335d 203d 2079       y[:, 3] = y
+0000a490: 5b3a 2c20 305d 202d 2063 656c 6c5f 7369  [:, 0] - cell_si
+0000a4a0: 7a65 0d0a 0d0a 2020 2020 2020 2020 636f  ze....        co
+0000a4b0: 6f72 6473 5f74 7570 6c65 7320 3d20 5b6c  ords_tuples = [l
+0000a4c0: 6973 7428 7a69 7028 785b 3a2c 2069 5d2c  ist(zip(x[:, i],
+0000a4d0: 2079 5b3a 2c20 695d 2929 2066 6f72 2069   y[:, i])) for i
+0000a4e0: 2069 6e20 7261 6e67 6528 3429 5d0d 0a20   in range(4)].. 
+0000a4f0: 2020 2020 2020 2070 6f6c 7973 5f63 6f6f         polys_coo
+0000a500: 7264 7320 3d20 5b0d 0a20 2020 2020 2020  rds = [..       
+0000a510: 2020 2020 2028 0d0a 2020 2020 2020 2020       (..        
+0000a520: 2020 2020 2020 2020 636f 6f72 6473 5f74          coords_t
+0000a530: 7570 6c65 735b 305d 5b69 5d2c 0d0a 2020  uples[0][i],..  
+0000a540: 2020 2020 2020 2020 2020 2020 2020 636f                co
+0000a550: 6f72 6473 5f74 7570 6c65 735b 315d 5b69  ords_tuples[1][i
+0000a560: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
+0000a570: 2020 2020 636f 6f72 6473 5f74 7570 6c65      coords_tuple
+0000a580: 735b 325d 5b69 5d2c 0d0a 2020 2020 2020  s[2][i],..      
+0000a590: 2020 2020 2020 2020 2020 636f 6f72 6473            coords
+0000a5a0: 5f74 7570 6c65 735b 335d 5b69 5d2c 0d0a  _tuples[3][i],..
+0000a5b0: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
+0000a5c0: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+0000a5d0: 2069 6e20 7261 6e67 6528 6c65 6e28 7829   in range(len(x)
+0000a5e0: 290d 0a20 2020 2020 2020 205d 0d0a 2020  )..        ]..  
+0000a5f0: 2020 2020 2020 706f 6c79 676f 6e73 203d        polygons =
+0000a600: 206c 6973 7428 6d61 7028 4665 6174 7572   list(map(Featur
+0000a610: 6543 6f6c 6c65 6374 696f 6e2e 6372 6561  eCollection.crea
+0000a620: 7465 5f70 6f6c 7967 6f6e 2c20 706f 6c79  te_polygon, poly
+0000a630: 735f 636f 6f72 6473 2929 0d0a 2020 2020  s_coords))..    
+0000a640: 2020 2020 6764 6620 3d20 6770 642e 4765      gdf = gpd.Ge
+0000a650: 6f44 6174 6146 7261 6d65 2867 656f 6d65  oDataFrame(geome
+0000a660: 7472 793d 706f 6c79 676f 6e73 290d 0a20  try=polygons).. 
+0000a670: 2020 2020 2020 2067 6466 2e73 6574 5f63         gdf.set_c
+0000a680: 7273 2865 7073 673d 6570 7367 2c20 696e  rs(epsg=epsg, in
+0000a690: 706c 6163 653d 5472 7565 290d 0a20 2020  place=True)..   
+0000a6a0: 2020 2020 2067 6466 5b22 6964 225d 203d       gdf["id"] =
+0000a6b0: 2067 6466 2e69 6e64 6578 0d0a 2020 2020   gdf.index..    
+0000a6c0: 2020 2020 7265 7475 726e 2067 6466 0d0a      return gdf..
+0000a6d0: 0d0a 2020 2020 6465 6620 6765 745f 6365  ..    def get_ce
+0000a6e0: 6c6c 5f70 6f69 6e74 7328 7365 6c66 2c20  ll_points(self, 
+0000a6f0: 6c6f 6361 7469 6f6e 3a20 7374 7220 3d20  location: str = 
+0000a700: 2263 656e 7465 7222 2c20 6d61 736b 3d46  "center", mask=F
+0000a710: 616c 7365 2920 2d3e 2047 656f 4461 7461  alse) -> GeoData
+0000a720: 4672 616d 653a 0d0a 2020 2020 2020 2020  Frame:..        
+0000a730: 2222 2247 6574 2061 2070 6f69 6e74 2073  """Get a point s
+0000a740: 6861 7065 6c79 2067 656f 6d65 7472 7920  hapely geometry 
+0000a750: 666f 7220 7468 6520 7261 7374 6572 2063  for the raster c
+0000a760: 656c 6c73 2063 656e 7465 7220 706f 696e  ells center poin
+0000a770: 742e 0d0a 0d0a 2020 2020 2020 2020 5061  t.....        Pa
+0000a780: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
+0000a790: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+0000a7a0: 2020 2020 2020 6c6f 6361 7469 6f6e 3a20        location: 
+0000a7b0: 5b73 7472 5d0d 0a20 2020 2020 2020 2020  [str]..         
+0000a7c0: 2020 206c 6f63 6174 696f 6e20 6f66 2074     location of t
+0000a7d0: 6865 2070 6f69 6e74 2c20 5b22 636f 726e  he point, ["corn
+0000a7e0: 6572 222c 2022 6365 6e74 6572 225d 2e20  er", "center"]. 
+0000a7f0: 4465 6661 756c 7420 6973 2022 6365 6e74  Default is "cent
+0000a800: 6572 222e 0d0a 2020 2020 2020 2020 6d61  er"...        ma
+0000a810: 736b 3a20 5b62 6f6f 6c5d 0d0a 2020 2020  sk: [bool]..    
+0000a820: 2020 2020 2020 2020 5472 7565 2074 6f20          True to 
+0000a830: 6765 7420 7468 6520 706f 6c79 676f 6e73  get the polygons
+0000a840: 206f 6620 7468 6520 6365 6c6c 7320 696e   of the cells in
+0000a850: 7369 6465 2074 6865 2064 6f6d 6169 6e2e  side the domain.
+0000a860: 0d0a 0d0a 2020 2020 2020 2020 5265 7475  ....        Retu
+0000a870: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
+0000a880: 2d2d 2d2d 0d0a 2020 2020 2020 2020 4765  ----..        Ge
+0000a890: 6f44 6174 6146 7261 6d65 3a0d 0a20 2020  oDataFrame:..   
+0000a8a0: 2020 2020 2020 2020 2077 6974 6820 7477           with tw
+0000a8b0: 6f20 636f 6c75 6d6e 732c 2067 656f 6d65  o columns, geome
+0000a8c0: 7472 792c 2061 6e64 2069 640d 0a20 2020  try, and id..   
+0000a8d0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+0000a8e0: 2020 636f 6f72 6473 203d 2073 656c 662e    coords = self.
+0000a8f0: 6765 745f 6365 6c6c 5f63 6f6f 7264 7328  get_cell_coords(
+0000a900: 6c6f 6361 7469 6f6e 3d6c 6f63 6174 696f  location=locatio
+0000a910: 6e2c 206d 6173 6b3d 6d61 736b 290d 0a20  n, mask=mask).. 
+0000a920: 2020 2020 2020 2065 7073 6720 3d20 7365         epsg = se
+0000a930: 6c66 2e5f 6765 745f 6570 7367 2829 0d0a  lf._get_epsg()..
+0000a940: 0d0a 2020 2020 2020 2020 636f 6f72 6473  ..        coords
+0000a950: 5f74 7570 6c65 7320 3d20 6c69 7374 287a  _tuples = list(z
+0000a960: 6970 2863 6f6f 7264 735b 3a2c 2030 5d2c  ip(coords[:, 0],
+0000a970: 2063 6f6f 7264 735b 3a2c 2031 5d29 290d   coords[:, 1])).
+0000a980: 0a20 2020 2020 2020 2070 6f69 6e74 7320  .        points 
+0000a990: 3d20 4665 6174 7572 6543 6f6c 6c65 6374  = FeatureCollect
+0000a9a0: 696f 6e2e 6372 6561 7465 5f70 6f69 6e74  ion.create_point
+0000a9b0: 2863 6f6f 7264 735f 7475 706c 6573 290d  (coords_tuples).
+0000a9c0: 0a20 2020 2020 2020 2067 6466 203d 2067  .        gdf = g
+0000a9d0: 7064 2e47 656f 4461 7461 4672 616d 6528  pd.GeoDataFrame(
+0000a9e0: 6765 6f6d 6574 7279 3d70 6f69 6e74 7329  geometry=points)
+0000a9f0: 0d0a 2020 2020 2020 2020 6764 662e 7365  ..        gdf.se
+0000aa00: 745f 6372 7328 6570 7367 3d65 7073 672c  t_crs(epsg=epsg,
+0000aa10: 2069 6e70 6c61 6365 3d54 7275 6529 0d0a   inplace=True)..
+0000aa20: 2020 2020 2020 2020 6764 665b 2269 6422          gdf["id"
+0000aa30: 5d20 3d20 6764 662e 696e 6465 780d 0a20  ] = gdf.index.. 
+0000aa40: 2020 2020 2020 2072 6574 7572 6e20 6764         return gd
+0000aa50: 660d 0a0d 0a20 2020 2064 6566 2074 6f5f  f....    def to_
+0000aa60: 6669 6c65 2873 656c 662c 2070 6174 683a  file(self, path:
+0000aa70: 2073 7472 2c20 6472 6976 6572 3a20 7374   str, driver: st
+0000aa80: 7220 3d20 2267 656f 7469 6666 222c 2062  r = "geotiff", b
+0000aa90: 616e 643a 2069 6e74 203d 2030 2920 2d3e  and: int = 0) ->
+0000aaa0: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+0000aab0: 2222 2253 6176 6520 746f 2067 656f 7469  """Save to geoti
+0000aac0: 6666 2066 6f72 6d61 742e 0d0a 0d0a 2020  ff format.....  
+0000aad0: 2020 2020 2020 2020 2020 7361 7665 5261            saveRa
+0000aae0: 7374 6572 2073 6176 6573 2061 2072 6173  ster saves a ras
+0000aaf0: 7465 7220 746f 2061 2070 6174 680d 0a0d  ter to a path...
+0000ab00: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+0000ab10: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
+0000ab20: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+0000ab30: 2070 6174 683a 205b 7374 7269 6e67 5d0d   path: [string].
+0000ab40: 0a20 2020 2020 2020 2020 2020 2061 2070  .            a p
+0000ab50: 6174 6820 696e 636c 7564 6e67 2074 6865  ath includng the
+0000ab60: 206e 616d 6520 6f66 2074 6865 2072 6173   name of the ras
+0000ab70: 7465 7220 616e 6420 6578 7465 6e74 696f  ter and extentio
+0000ab80: 6e2e 0d0a 2020 2020 2020 2020 2020 2020  n...            
+0000ab90: 3e3e 3e20 7061 7468 203d 2022 6461 7461  >>> path = "data
+0000aba0: 2f63 726f 7070 6564 2e74 6966 220d 0a20  /cropped.tif".. 
+0000abb0: 2020 2020 2020 2064 7269 7665 723a 205b         driver: [
+0000abc0: 7374 725d 0d0a 2020 2020 2020 2020 2020  str]..          
+0000abd0: 2020 6472 6976 6572 203d 2022 6765 6f74    driver = "geot
+0000abe0: 6966 6622 2e0d 0a20 2020 2020 2020 2062  iff"...        b
+0000abf0: 616e 643a 205b 696e 745d 0d0a 2020 2020  and: [int]..    
+0000ac00: 2020 2020 2020 2020 6261 6e64 2069 6e64          band ind
+0000ac10: 6578 2c20 6e65 6564 6564 206f 6e6c 7920  ex, needed only 
+0000ac20: 696e 2063 6173 6520 6f66 2061 7363 6969  in case of ascii
+0000ac30: 2064 7269 7665 7273 2e20 4465 6661 756c   drivers. Defaul
+0000ac40: 7420 6973 2031 2e0d 0a0d 0a20 2020 2020  t is 1.....     
+0000ac50: 2020 2045 7861 6d70 6c65 730d 0a20 2020     Examples..   
+0000ac60: 2020 2020 202d 2d2d 2d2d 2d2d 2d0d 0a20       --------.. 
+0000ac70: 2020 2020 2020 203e 3e3e 2072 6173 7465         >>> raste
+0000ac80: 725f 6f62 6a20 3d20 4461 7461 7365 742e  r_obj = Dataset.
+0000ac90: 7265 6164 5f66 696c 6528 2270 6174 682f  read_file("path/
+0000aca0: 746f 2f66 696c 652f 2a2a 2a2e 7469 6622  to/file/***.tif"
+0000acb0: 290d 0a20 2020 2020 2020 203e 3e3e 206f  )..        >>> o
+0000acc0: 7574 7075 745f 7061 7468 203d 2022 6578  utput_path = "ex
+0000acd0: 616d 706c 6573 2f47 4953 2f64 6174 612f  amples/GIS/data/
+0000ace0: 7361 7665 5f72 6173 7465 725f 7465 7374  save_raster_test
+0000acf0: 2e74 6966 220d 0a20 2020 2020 2020 203e  .tif"..        >
+0000ad00: 3e3e 2072 6173 7465 725f 6f62 6a2e 746f  >> raster_obj.to
+0000ad10: 5f66 696c 6528 6f75 7470 7574 5f70 6174  _file(output_pat
+0000ad20: 6829 0d0a 2020 2020 2020 2020 2222 220d  h)..        """.
+0000ad30: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+0000ad40: 6973 696e 7374 616e 6365 2870 6174 682c  isinstance(path,
+0000ad50: 2073 7472 293a 0d0a 2020 2020 2020 2020   str):..        
+0000ad60: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
+0000ad70: 726f 7228 2270 6174 6820 696e 7075 7420  ror("path input 
+0000ad80: 7368 6f75 6c64 2062 6520 7374 7269 6e67  should be string
+0000ad90: 2074 7970 6522 290d 0a0d 0a20 2020 2020   type")....     
+0000ada0: 2020 2069 6620 6e6f 7420 4341 5441 4c4f     if not CATALO
+0000adb0: 472e 6578 6973 7473 2864 7269 7665 7229  G.exists(driver)
+0000adc0: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
+0000add0: 6169 7365 2044 7269 7665 724e 6f74 4578  aise DriverNotEx
+0000ade0: 6973 7445 7272 6f72 2866 2254 6865 2067  istError(f"The g
+0000adf0: 6976 656e 2064 7269 7665 723a 207b 6472  iven driver: {dr
+0000ae00: 6976 6572 7d20 646f 6573 206e 6f74 2065  iver} does not e
+0000ae10: 7869 7374 2229 0d0a 0d0a 2020 2020 2020  xist")....      
+0000ae20: 2020 6472 6976 6572 5f6e 616d 6520 3d20    driver_name = 
+0000ae30: 4341 5441 4c4f 472e 6765 745f 6764 616c  CATALOG.get_gdal
+0000ae40: 5f6e 616d 6528 6472 6976 6572 290d 0a0d  _name(driver)...
+0000ae50: 0a20 2020 2020 2020 2069 6620 6472 6976  .        if driv
+0000ae60: 6572 203d 3d20 2261 7363 6969 223a 0d0a  er == "ascii":..
+0000ae70: 2020 2020 2020 2020 2020 2020 6172 7220              arr 
+0000ae80: 3d20 7365 6c66 2e72 6561 645f 6172 7261  = self.read_arra
+0000ae90: 7928 6261 6e64 3d62 616e 6429 0d0a 2020  y(band=band)..  
+0000aea0: 2020 2020 2020 2020 2020 6e6f 5f64 6174            no_dat
+0000aeb0: 615f 7661 6c75 6520 3d20 7365 6c66 2e6e  a_value = self.n
+0000aec0: 6f5f 6461 7461 5f76 616c 7565 5b62 616e  o_data_value[ban
+0000aed0: 645d 0d0a 2020 2020 2020 2020 2020 2020  d]..            
+0000aee0: 786d 696e 2c20 796d 696e 2c20 5f2c 205f  xmin, ymin, _, _
+0000aef0: 203d 2073 656c 662e 6262 6f78 0d0a 2020   = self.bbox..  
+0000af00: 2020 2020 2020 2020 2020 696f 2e74 6f5f            io.to_
+0000af10: 6173 6369 6928 6172 722c 2073 656c 662e  ascii(arr, self.
+0000af20: 6365 6c6c 5f73 697a 652c 2078 6d69 6e2c  cell_size, xmin,
+0000af30: 2079 6d69 6e2c 206e 6f5f 6461 7461 5f76   ymin, no_data_v
+0000af40: 616c 7565 2c20 7061 7468 290d 0a20 2020  alue, path)..   
+0000af50: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+0000af60: 2020 2020 2020 2020 6473 7420 3d20 6764          dst = gd
+0000af70: 616c 2e47 6574 4472 6976 6572 4279 4e61  al.GetDriverByNa
+0000af80: 6d65 2864 7269 7665 725f 6e61 6d65 292e  me(driver_name).
+0000af90: 4372 6561 7465 436f 7079 2870 6174 682c  CreateCopy(path,
+0000afa0: 2073 656c 662e 7261 7374 6572 2c20 3029   self.raster, 0)
+0000afb0: 0d0a 2020 2020 2020 2020 2020 2020 6473  ..            ds
+0000afc0: 7420 3d20 4e6f 6e65 2020 2320 466c 7573  t = None  # Flus
+0000afd0: 6820 7468 6520 6461 7461 7365 7420 746f  h the dataset to
+0000afe0: 2064 6973 6b0d 0a20 2020 2020 2020 2020   disk..         
+0000aff0: 2020 2023 2070 7269 6e74 2074 6f20 676f     # print to go
+0000b000: 2061 726f 756e 6420 7468 6520 6173 7369   around the assi
+0000b010: 676e 6564 2062 7574 206e 6576 6572 2075  gned but never u
+0000b020: 7365 6420 7072 652d 636f 6d6d 6974 2069  sed pre-commit i
+0000b030: 7373 7565 0d0a 2020 2020 2020 2020 2020  ssue..          
+0000b040: 2020 7072 696e 7428 6473 7429 0d0a 0d0a    print(dst)....
+0000b050: 2020 2020 6465 6620 746f 5f70 6f6c 7967      def to_polyg
+0000b060: 6f6e 280d 0a20 2020 2020 2020 2073 656c  on(..        sel
+0000b070: 662c 0d0a 2020 2020 2020 2020 6261 6e64  f,..        band
+0000b080: 3a20 696e 7420 3d20 302c 0d0a 2020 2020  : int = 0,..    
+0000b090: 2020 2020 636f 6c5f 6e61 6d65 3a20 416e      col_name: An
+0000b0a0: 7920 3d20 2269 6422 2c0d 0a20 2020 2020  y = "id",..     
+0000b0b0: 2020 2070 6174 683a 2073 7472 203d 204e     path: str = N
+0000b0c0: 6f6e 652c 0d0a 2020 2020 2020 2020 6472  one,..        dr
+0000b0d0: 6976 6572 3a20 7374 7220 3d20 226d 656d  iver: str = "mem
+0000b0e0: 6f72 7922 2c0d 0a20 2020 2029 202d 3e20  ory",..    ) -> 
+0000b0f0: 556e 696f 6e5b 4765 6f44 6174 6146 7261  Union[GeoDataFra
+0000b100: 6d65 2c20 4e6f 6e65 5d3a 0d0a 2020 2020  me, None]:..    
+0000b110: 2020 2020 2222 2270 6f6c 7967 6f6e 697a      """polygoniz
+0000b120: 652e 0d0a 0d0a 2020 2020 2020 2020 2020  e.....          
+0000b130: 2020 5261 7374 6572 546f 506f 6c79 676f    RasterToPolygo
+0000b140: 6e20 7461 6b65 7320 6120 6764 616c 2044  n takes a gdal D
+0000b150: 6174 6163 7562 6520 6f62 6a65 6374 2061  atacube object a
+0000b160: 6e64 2067 726f 7570 206e 6569 6768 626f  nd group neighbo
+0000b170: 7269 6e67 2063 656c 6c73 2077 6974 6820  ring cells with 
+0000b180: 7468 6520 7361 6d65 2076 616c 7565 2069  the same value i
+0000b190: 6e74 6f20 6f6e 650d 0a20 2020 2020 2020  nto one..       
+0000b1a0: 2020 2020 2070 6f6c 7967 6f6e 2c20 7468       polygon, th
+0000b1b0: 6520 7265 7375 6c74 6564 2076 6563 746f  e resulted vecto
+0000b1c0: 7220 7769 6c6c 2062 6520 7361 7665 6420  r will be saved 
+0000b1d0: 746f 2064 6973 6b20 6173 2061 2067 656f  to disk as a geo
+0000b1e0: 6a73 6f6e 2066 696c 650d 0a0d 0a20 2020  json file....   
+0000b1f0: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
+0000b200: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0000b210: 2d2d 2d0d 0a20 2020 2020 2020 2062 616e  ---..        ban
+0000b220: 643a 205b 696e 745d 0d0a 2020 2020 2020  d: [int]..      
+0000b230: 2020 2020 2020 7261 7374 6572 2062 616e        raster ban
+0000b240: 6420 696e 6465 7820 5b31 2c32 2c33 2c2e  d index [1,2,3,.
+0000b250: 2e5d 0d0a 2020 2020 2020 2020 7061 7468  .]..        path
+0000b260: 3a5b 7374 725d 0d0a 2020 2020 2020 2020  :[str]..        
+0000b270: 2020 2020 7061 7468 2077 6865 7265 2079      path where y
+0000b280: 6f75 2077 616e 7420 746f 2073 6176 6520  ou want to save 
+0000b290: 7468 6520 706f 6c79 676f 6e2c 2074 6865  the polygon, the
+0000b2a0: 2070 6174 6820 7368 6f75 6c64 2069 6e63   path should inc
+0000b2b0: 6c75 6465 2074 6865 2065 7874 656e 7369  lude the extensi
+0000b2c0: 6f6e 2061 7420 7468 6520 656e 640d 0a20  on at the end.. 
+0000b2d0: 2020 2020 2020 2020 2020 2028 692e 652e             (i.e.
+0000b2e0: 2070 6174 682f 7665 6374 6f72 5f6e 616d   path/vector_nam
+0000b2f0: 652e 6765 6f6a 736f 6e29 0d0a 2020 2020  e.geojson)..    
+0000b300: 2020 2020 636f 6c5f 6e61 6d65 3a0d 0a20      col_name:.. 
+0000b310: 2020 2020 2020 2020 2020 206e 616d 6520             name 
+0000b320: 6f66 2074 6865 2063 6f6c 756d 6e20 7768  of the column wh
+0000b330: 6572 6520 7468 6520 7261 7374 6572 2064  ere the raster d
+0000b340: 6174 6120 7769 6c6c 2062 6520 7374 6f72  ata will be stor
+0000b350: 6564 2e0d 0a20 2020 2020 2020 2064 7269  ed...        dri
+0000b360: 7665 723a 205b 7374 725d 0d0a 2020 2020  ver: [str]..    
+0000b370: 2020 2020 2020 2020 7665 6374 6f72 2064          vector d
+0000b380: 7269 7665 722c 2066 6f72 2061 6c6c 2070  river, for all p
+0000b390: 6f73 7369 626c 6520 6472 6976 6572 7320  ossible drivers 
+0000b3a0: 6368 6563 6b20 6874 7470 733a 2f2f 6764  check https://gd
+0000b3b0: 616c 2e6f 7267 2f64 7269 7665 7273 2f76  al.org/drivers/v
+0000b3c0: 6563 746f 722f 696e 6465 782e 6874 6d6c  ector/index.html
+0000b3d0: 202e 0d0a 2020 2020 2020 2020 2020 2020   ...            
+0000b3e0: 4465 6661 756c 7420 6973 2022 4765 6f4a  Default is "GeoJ
+0000b3f0: 534f 4e22 2e0d 0a0d 0a20 2020 2020 2020  SON".....       
+0000b400: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
+0000b410: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
+0000b420: 2020 204e 6f6e 650d 0a20 2020 2020 2020     None..       
+0000b430: 2022 2222 0d0a 2020 2020 2020 2020 6261   """..        ba
+0000b440: 6e64 203d 2073 656c 662e 7261 7374 6572  nd = self.raster
+0000b450: 2e47 6574 5261 7374 6572 4261 6e64 2862  .GetRasterBand(b
+0000b460: 616e 6420 2b20 3129 0d0a 2020 2020 2020  and + 1)..      
+0000b470: 2020 7372 7320 3d20 6f73 722e 5370 6174    srs = osr.Spat
+0000b480: 6961 6c52 6566 6572 656e 6365 2877 6b74  ialReference(wkt
+0000b490: 3d73 656c 662e 6372 7329 0d0a 2020 2020  =self.crs)..    
+0000b4a0: 2020 2020 6966 2070 6174 6820 6973 204e      if path is N
+0000b4b0: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
+0000b4c0: 2020 6473 745f 6c61 7965 726e 616d 6520    dst_layername 
+0000b4d0: 3d20 2269 6422 0d0a 2020 2020 2020 2020  = "id"..        
+0000b4e0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+0000b4f0: 2020 2064 7374 5f6c 6179 6572 6e61 6d65     dst_layername
+0000b500: 203d 2070 6174 682e 7370 6c69 7428 222e   = path.split(".
+0000b510: 2229 5b30 5d2e 7370 6c69 7428 222f 2229  ")[0].split("/")
+0000b520: 5b2d 315d 0d0a 0d0a 2020 2020 2020 2020  [-1]....        
+0000b530: 6473 745f 6473 203d 2046 6561 7475 7265  dst_ds = Feature
+0000b540: 436f 6c6c 6563 7469 6f6e 2e63 7265 6174  Collection.creat
+0000b550: 655f 6473 2864 7269 7665 722c 2070 6174  e_ds(driver, pat
+0000b560: 6829 0d0a 2020 2020 2020 2020 6473 745f  h)..        dst_
+0000b570: 6c61 7965 7220 3d20 6473 745f 6473 2e43  layer = dst_ds.C
+0000b580: 7265 6174 654c 6179 6572 2864 7374 5f6c  reateLayer(dst_l
+0000b590: 6179 6572 6e61 6d65 2c20 7372 733d 7372  ayername, srs=sr
+0000b5a0: 7329 0d0a 2020 2020 2020 2020 6474 7970  s)..        dtyp
+0000b5b0: 6520 3d20 6764 616c 5f74 6f5f 6f67 725f  e = gdal_to_ogr_
+0000b5c0: 6474 7970 6528 7365 6c66 2e72 6173 7465  dtype(self.raste
+0000b5d0: 7229 0d0a 2020 2020 2020 2020 6e65 7746  r)..        newF
+0000b5e0: 6965 6c64 203d 206f 6772 2e46 6965 6c64  ield = ogr.Field
+0000b5f0: 4465 666e 2863 6f6c 5f6e 616d 652c 2064  Defn(col_name, d
+0000b600: 7479 7065 290d 0a20 2020 2020 2020 2064  type)..        d
+0000b610: 7374 5f6c 6179 6572 2e43 7265 6174 6546  st_layer.CreateF
+0000b620: 6965 6c64 286e 6577 4669 656c 6429 0d0a  ield(newField)..
+0000b630: 2020 2020 2020 2020 6764 616c 2e50 6f6c          gdal.Pol
+0000b640: 7967 6f6e 697a 6528 6261 6e64 2c20 6261  ygonize(band, ba
+0000b650: 6e64 2c20 6473 745f 6c61 7965 722c 2030  nd, dst_layer, 0
+0000b660: 2c20 5b5d 2c20 6361 6c6c 6261 636b 3d4e  , [], callback=N
+0000b670: 6f6e 6529 0d0a 2020 2020 2020 2020 6966  one)..        if
+0000b680: 2070 6174 683a 0d0a 2020 2020 2020 2020   path:..        
+0000b690: 2020 2020 6473 745f 6c61 7965 7220 3d20      dst_layer = 
+0000b6a0: 4e6f 6e65 0d0a 2020 2020 2020 2020 2020  None..          
+0000b6b0: 2020 6473 745f 6473 203d 204e 6f6e 650d    dst_ds = None.
+0000b6c0: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+0000b6d0: 2020 2020 2020 2020 2020 2020 7665 6374              vect
+0000b6e0: 6f72 203d 2046 6561 7475 7265 436f 6c6c  or = FeatureColl
+0000b6f0: 6563 7469 6f6e 2864 7374 5f64 7329 0d0a  ection(dst_ds)..
+0000b700: 2020 2020 2020 2020 2020 2020 6764 6620              gdf 
+0000b710: 3d20 7665 6374 6f72 2e5f 6473 5f74 6f5f  = vector._ds_to_
+0000b720: 6764 6628 290d 0a20 2020 2020 2020 2020  gdf()..         
+0000b730: 2020 2072 6574 7572 6e20 6764 660d 0a0d     return gdf...
+0000b740: 0a20 2020 2064 6566 2074 6f5f 6765 6f64  .    def to_geod
+0000b750: 6174 6166 7261 6d65 280d 0a20 2020 2020  ataframe(..     
+0000b760: 2020 2073 656c 662c 0d0a 2020 2020 2020     self,..      
+0000b770: 2020 7665 6374 6f72 5f6d 6173 6b3a 2055    vector_mask: U
+0000b780: 6e69 6f6e 5b73 7472 2c20 4765 6f44 6174  nion[str, GeoDat
+0000b790: 6146 7261 6d65 5d20 3d20 4e6f 6e65 2c0d  aFrame] = None,.
+0000b7a0: 0a20 2020 2020 2020 2061 6464 5f67 656f  .        add_geo
+0000b7b0: 6d65 7472 793a 2073 7472 203d 204e 6f6e  metry: str = Non
+0000b7c0: 652c 0d0a 2020 2020 2020 2020 7469 6c65  e,..        tile
+0000b7d0: 3a20 626f 6f6c 203d 2046 616c 7365 2c0d  : bool = False,.
+0000b7e0: 0a20 2020 2020 2020 2074 696c 655f 7369  .        tile_si
+0000b7f0: 7a65 3a20 696e 7420 3d20 3135 3030 2c0d  ze: int = 1500,.
+0000b800: 0a20 2020 2029 202d 3e20 556e 696f 6e5b  .    ) -> Union[
+0000b810: 4461 7461 4672 616d 652c 2047 656f 4461  DataFrame, GeoDa
+0000b820: 7461 4672 616d 655d 3a0d 0a20 2020 2020  taFrame]:..     
+0000b830: 2020 2022 2222 436f 6e76 6572 7420 6120     """Convert a 
+0000b840: 7261 7374 6572 2074 6f20 6120 4765 6f44  raster to a GeoD
+0000b850: 6174 6146 7261 6d65 2e0d 0a0d 0a20 2020  ataFrame.....   
+0000b860: 2020 2020 2020 2020 2054 6865 2066 756e           The fun
+0000b870: 6374 696f 6e20 646f 2074 6865 2066 6f6c  ction do the fol
+0000b880: 6c6f 7769 6e67 0d0a 2020 2020 2020 2020  lowing..        
+0000b890: 2020 2020 2d20 466c 6174 7465 6e20 7468      - Flatten th
+0000b8a0: 6520 6172 7261 7920 696e 2065 6163 6820  e array in each 
+0000b8b0: 6261 6e64 2069 6e20 7468 6520 7261 7374  band in the rast
+0000b8c0: 6572 2074 6865 6e20 6d61 736b 2074 6865  er then mask the
+0000b8d0: 2076 616c 7565 7320 6966 2061 2076 6563   values if a vec
+0000b8e0: 746f 725f 6d61 736b 0d0a 2020 2020 2020  tor_mask..      
+0000b8f0: 2020 2020 2020 6669 6c65 2069 7320 6769        file is gi
+0000b900: 7665 6e20 6f74 6865 7277 6973 6520 6974  ven otherwise it
+0000b910: 2077 696c 6c20 666c 6174 7465 6e20 616c   will flatten al
+0000b920: 6c20 7661 6c75 6573 2e0d 0a20 2020 2020  l values...     
+0000b930: 2020 2020 2020 202d 2050 7574 2074 6865         - Put the
+0000b940: 2076 616c 7565 7320 666f 7220 6561 6368   values for each
+0000b950: 2062 616e 6420 696e 2061 2063 6f6c 756d   band in a colum
+0000b960: 6e20 696e 2061 2064 6174 6166 7261 6d65  n in a dataframe
+0000b970: 2075 6e64 6572 2074 6865 206e 616d 6520   under the name 
+0000b980: 6f66 2074 6865 2072 6173 7465 7220 6261  of the raster ba
+0000b990: 6e64 2c20 6275 7420 6966 206e 6f20 6d65  nd, but if no me
+0000b9a0: 7461 0d0a 2020 2020 2020 2020 2020 2020  ta..            
+0000b9b0: 6461 7461 2069 6e20 7468 6520 7261 7374  data in the rast
+0000b9c0: 6572 2062 616e 6420 6578 6973 7473 2c20  er band exists, 
+0000b9d0: 616e 2069 6e64 6578 206e 756d 6265 7220  an index number 
+0000b9e0: 7769 6c6c 2062 6520 7573 6564 205b 312c  will be used [1,
+0000b9f0: 2032 2c20 332c 202e 2e2e 5d0d 0a20 2020   2, 3, ...]..   
+0000ba00: 2020 2020 2020 2020 202d 2054 6865 2066           - The f
+0000ba10: 756e 6374 696f 6e20 6861 7320 6120 6164  unction has a ad
+0000ba20: 645f 6765 6f6d 6574 7279 2070 6172 616d  d_geometry param
+0000ba30: 6574 6572 2077 6974 6820 7477 6f20 706f  eter with two po
+0000ba40: 7373 6962 6c65 2076 616c 7565 7320 5b22  ssible values ["
+0000ba50: 706f 696e 7422 2c20 2270 6f6c 7967 6f6e  point", "polygon
+0000ba60: 225d 2c20 7768 6963 6820 796f 7520 6361  "], which you ca
+0000ba70: 6e0d 0a20 2020 2020 2020 2020 2020 2073  n..            s
+0000ba80: 7065 6369 6679 2074 6865 2074 7970 6520  pecify the type 
+0000ba90: 6f66 2073 6861 7065 6c79 2067 656f 6d65  of shapely geome
+0000baa0: 7472 7920 796f 7520 7761 6e74 2074 6f20  try you want to 
+0000bab0: 6372 6561 7465 2066 726f 6d20 6561 6368  create from each
+0000bac0: 2063 656c 6c2c 0d0a 2020 2020 2020 2020   cell,..        
+0000bad0: 2020 2020 2020 2020 2d20 4966 2070 6f69          - If poi
+0000bae0: 6e74 2069 7320 6368 6f73 656e 2c20 7468  nt is chosen, th
+0000baf0: 6520 6372 6561 7465 6420 706f 696e 7420  e created point 
+0000bb00: 7769 6c6c 2062 6520 6174 2074 6865 2063  will be at the c
+0000bb10: 656e 7465 7220 6f66 2065 6163 6820 6365  enter of each ce
+0000bb20: 6c6c 0d0a 2020 2020 2020 2020 2020 2020  ll..            
+0000bb30: 2020 2020 2d20 4966 2061 2070 6f6c 7967      - If a polyg
+0000bb40: 6f6e 2069 7320 6368 6f73 656e 2c20 6120  on is chosen, a 
+0000bb50: 7371 7561 7265 2070 6f6c 7967 6f6e 2077  square polygon w
+0000bb60: 696c 6c20 6265 2063 7265 6174 6564 2074  ill be created t
+0000bb70: 6861 7420 636f 7665 7273 2074 6865 2065  hat covers the e
+0000bb80: 6e74 6972 6520 6365 6c6c 2e0d 0a0d 0a20  ntire cell..... 
+0000bb90: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+0000bba0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+0000bbb0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2076  -----..        v
+0000bbc0: 6563 746f 725f 6d61 736b 203a 204f 7074  ector_mask : Opt
+0000bbd0: 696f 6e61 6c5b 4765 6f44 6174 6146 7261  ional[GeoDataFra
+0000bbe0: 6d65 2f73 7472 5d0d 0a20 2020 2020 2020  me/str]..       
+0000bbf0: 2020 2020 2047 656f 4461 7461 4672 616d       GeoDataFram
+0000bc00: 6520 666f 7220 7468 6520 7665 6374 6f72  e for the vector
+0000bc10: 5f6d 6173 6b20 6669 6c65 2070 6174 6820  _mask file path 
+0000bc20: 746f 2076 6563 746f 725f 6d61 736b 2066  to vector_mask f
+0000bc30: 696c 652e 2049 6620 6769 7665 6e2c 2069  ile. If given, i
+0000bc40: 7420 7769 6c6c 2062 6520 7573 6564 2074  t will be used t
+0000bc50: 6f20 636c 6970 2074 6865 2072 6173 7465  o clip the raste
+0000bc60: 720d 0a20 2020 2020 2020 2061 6464 5f67  r..        add_g
+0000bc70: 656f 6d65 7472 793a 205b 7374 725d 0d0a  eometry: [str]..
+0000bc80: 2020 2020 2020 2020 2020 2020 2250 6f6c              "Pol
+0000bc90: 7967 6f6e 222c 206f 7220 2250 6f69 6e74  ygon", or "Point
+0000bca0: 2220 6966 2079 6f75 2077 616e 7420 746f  " if you want to
+0000bcb0: 2061 6464 2061 2070 6f6c 7967 6f6e 2067   add a polygon g
+0000bcc0: 656f 6d65 7472 7920 6f66 2074 6865 2063  eometry of the c
+0000bcd0: 656c 6c73 2061 7320 2063 6f6c 756d 6e20  ells as  column 
+0000bce0: 696e 2064 6174 6166 7261 6d65 2e0d 0a20  in dataframe... 
+0000bcf0: 2020 2020 2020 2020 2020 2044 6566 6175             Defau
+0000bd00: 6c74 2069 7320 4e6f 6e65 2e0d 0a20 2020  lt is None...   
+0000bd10: 2020 2020 2074 696c 653a 205b 626f 6f6c       tile: [bool
+0000bd20: 5d0d 0a20 2020 2020 2020 2020 2020 2054  ]..            T
+0000bd30: 7275 6520 746f 2075 7365 2074 696c 6573  rue to use tiles
+0000bd40: 2069 6e20 6578 7472 6163 7469 6e67 2074   in extracting t
+0000bd50: 6865 2076 616c 7565 7320 6672 6f6d 2074  he values from t
+0000bd60: 6865 2072 6173 7465 722e 2044 6566 6175  he raster. Defau
+0000bd70: 6c74 2069 7320 4661 6c73 652e 0d0a 2020  lt is False...  
+0000bd80: 2020 2020 2020 7469 6c65 5f73 697a 653a        tile_size:
+0000bd90: 205b 696e 745d 0d0a 2020 2020 2020 2020   [int]..        
+0000bda0: 2020 2020 7469 6c65 2073 697a 652e 2044      tile size. D
+0000bdb0: 6566 6175 6c74 2069 7320 3135 3030 2e0d  efault is 1500..
+0000bdc0: 0a0d 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
+0000bdd0: 6e73 0d0a 2020 2020 2020 2020 2d2d 2d2d  ns..        ----
+0000bde0: 2d2d 2d0d 0a20 2020 2020 2020 2044 6174  ---..        Dat
+0000bdf0: 6146 7261 6d65 2f47 656f 4461 7461 4672  aFrame/GeoDataFr
+0000be00: 616d 650d 0a20 2020 2020 2020 2020 2020  ame..           
+0000be10: 2063 6f6c 756d 6e64 4c3a 0d0a 2020 2020   columndL:..    
+0000be20: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+0000be30: 7072 696e 7428 6764 662e 636f 6c75 6d6e  print(gdf.column
+0000be40: 7329 0d0a 2020 2020 2020 2020 2020 2020  s)..            
+0000be50: 2020 2020 3e3e 3e20 496e 6465 7828 5b27      >>> Index(['
+0000be60: 4261 6e64 5f31 272c 2027 6765 6f6d 6574  Band_1', 'geomet
+0000be70: 7279 275d 2c20 6474 7970 653d 276f 626a  ry'], dtype='obj
+0000be80: 6563 7427 290d 0a0d 0a20 2020 2020 2020  ect')....       
+0000be90: 2074 6865 2072 6573 756c 7465 6420 6765   the resulted ge
+0000bea0: 6f64 6174 6166 7261 6d65 2077 696c 6c20  odataframe will 
+0000beb0: 6861 7665 2074 6865 2062 616e 6420 7661  have the band va
+0000bec0: 6c75 6520 756e 6465 7220 7468 6520 6e61  lue under the na
+0000bed0: 6d65 206f 6620 7468 6520 6261 6e64 2028  me of the band (
+0000bee0: 6966 2074 6865 2072 6173 7465 7220 6669  if the raster fi
+0000bef0: 6c65 2068 6173 2061 206d 6574 6164 6174  le has a metadat
+0000bf00: 612c 0d0a 2020 2020 2020 2020 6966 206e  a,..        if n
+0000bf10: 6f74 2c20 7468 6520 6261 6e64 7320 7769  ot, the bands wi
+0000bf20: 6c6c 2062 6520 696e 6465 7865 6420 6672  ll be indexed fr
+0000bf30: 6f6d 2031 2074 6f20 7468 6520 6e75 6d62  om 1 to the numb
+0000bf40: 6572 206f 6620 6261 6e64 7329 0d0a 2020  er of bands)..  
+0000bf50: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+0000bf60: 2020 2074 656d 705f 6469 7220 3d20 4e6f     temp_dir = No
+0000bf70: 6e65 0d0a 0d0a 2020 2020 2020 2020 2320  ne....        # 
+0000bf80: 4765 7420 7261 7374 6572 2062 616e 6420  Get raster band 
+0000bf90: 6e61 6d65 732e 206f 7065 6e20 7468 6520  names. open the 
+0000bfa0: 6461 7461 7365 7420 7573 696e 6720 6764  dataset using gd
+0000bfb0: 616c 2e4f 7065 6e0d 0a20 2020 2020 2020  al.Open..       
+0000bfc0: 2062 616e 645f 6e61 6d65 7320 3d20 7365   band_names = se
+0000bfd0: 6c66 2e67 6574 5f62 616e 645f 6e61 6d65  lf.get_band_name
+0000bfe0: 7328 290d 0a0d 0a20 2020 2020 2020 2023  s()....        #
+0000bff0: 2043 7265 6174 6520 6120 6d61 736b 2066   Create a mask f
+0000c000: 726f 6d20 7468 6520 7069 7865 6c73 2074  rom the pixels t
+0000c010: 6f75 6368 6564 2062 7920 7468 6520 7665  ouched by the ve
+0000c020: 6374 6f72 5f6d 6173 6b2e 0d0a 2020 2020  ctor_mask...    
+0000c030: 2020 2020 6966 2076 6563 746f 725f 6d61      if vector_ma
+0000c040: 736b 2069 7320 6e6f 7420 4e6f 6e65 3a0d  sk is not None:.
+0000c050: 0a20 2020 2020 2020 2020 2020 2023 2043  .            # C
+0000c060: 7265 6174 6520 6120 7465 6d70 6f72 6172  reate a temporar
+0000c070: 7920 6469 7265 6374 6f72 7920 666f 7220  y directory for 
+0000c080: 6669 6c65 732e 0d0a 2020 2020 2020 2020  files...        
+0000c090: 2020 2020 7465 6d70 5f64 6972 203d 2074      temp_dir = t
+0000c0a0: 656d 7066 696c 652e 6d6b 6474 656d 7028  empfile.mkdtemp(
+0000c0b0: 290d 0a20 2020 2020 2020 2020 2020 206e  )..            n
+0000c0c0: 6577 5f76 6563 746f 725f 7061 7468 203d  ew_vector_path =
+0000c0d0: 206f 732e 7061 7468 2e6a 6f69 6e28 7465   os.path.join(te
+0000c0e0: 6d70 5f64 6972 2c20 6622 7b75 7569 642e  mp_dir, f"{uuid.
+0000c0f0: 7575 6964 3128 297d 2229 0d0a 0d0a 2020  uuid1()}")....  
+0000c100: 2020 2020 2020 2020 2020 2320 7265 6164            # read
+0000c110: 2074 6865 2076 6563 746f 7220 7769 7468   the vector with
+0000c120: 2067 656f 7061 6e64 6173 0d0a 2020 2020   geopandas..    
+0000c130: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+0000c140: 7461 6e63 6528 7665 6374 6f72 5f6d 6173  tance(vector_mas
+0000c150: 6b2c 2047 656f 4461 7461 4672 616d 6529  k, GeoDataFrame)
+0000c160: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0000c170: 2020 2076 6563 746f 7220 3d20 4665 6174     vector = Feat
+0000c180: 7572 6543 6f6c 6c65 6374 696f 6e28 7665  ureCollection(ve
+0000c190: 6374 6f72 5f6d 6173 6b29 0d0a 2020 2020  ctor_mask)..    
+0000c1a0: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
+0000c1b0: 6e73 7461 6e63 6528 7665 6374 6f72 5f6d  nstance(vector_m
+0000c1c0: 6173 6b2c 2046 6561 7475 7265 436f 6c6c  ask, FeatureColl
+0000c1d0: 6563 7469 6f6e 293a 0d0a 2020 2020 2020  ection):..      
+0000c1e0: 2020 2020 2020 2020 2020 7665 6374 6f72            vector
+0000c1f0: 203d 2076 6563 746f 725f 6d61 736b 0d0a   = vector_mask..
+0000c200: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0000c210: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0000c220: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+0000c230: 6f72 280d 0a20 2020 2020 2020 2020 2020  or(..           
+0000c240: 2020 2020 2020 2020 2066 2254 6865 2076           f"The v
+0000c250: 6563 746f 725f 6d61 736b 2073 686f 756c  ector_mask shoul
+0000c260: 6420 6265 206f 6620 7479 7065 3a20 5b47  d be of type: [G
+0000c270: 656f 4461 7461 4672 616d 652f 4665 6174  eoDataFrame/Feat
+0000c280: 7572 6543 6f6c 6c65 6374 696f 6e5d 2c20  ureCollection], 
+0000c290: 6769 7665 6e3a 2022 0d0a 2020 2020 2020  given: "..      
+0000c2a0: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+0000c2b0: 7b74 7970 6528 7665 6374 6f72 5f6d 6173  {type(vector_mas
+0000c2c0: 6b29 7d22 0d0a 2020 2020 2020 2020 2020  k)}"..          
+0000c2d0: 2020 2020 2020 290d 0a0d 0a20 2020 2020        )....     
+0000c2e0: 2020 2020 2020 2023 2061 6464 2061 2075         # add a u
+0000c2f0: 6e69 7175 6520 7661 6c75 6520 666f 7220  nique value for 
+0000c300: 6561 6368 2072 6f77 7320 746f 2075 7365  each rows to use
+0000c310: 2069 7420 746f 2072 6173 7465 7269 7a65   it to rasterize
+0000c320: 2074 6865 2076 6563 746f 720d 0a20 2020   the vector..   
+0000c330: 2020 2020 2020 2020 2076 6563 746f 722e           vector.
+0000c340: 6665 6174 7572 655b 2262 7572 6e5f 7661  feature["burn_va
+0000c350: 6c75 6522 5d20 3d20 6c69 7374 2872 616e  lue"] = list(ran
+0000c360: 6765 2831 2c20 6c65 6e28 7665 6374 6f72  ge(1, len(vector
+0000c370: 2e66 6561 7475 7265 2920 2b20 3129 290d  .feature) + 1)).
+0000c380: 0a20 2020 2020 2020 2020 2020 2023 2073  .            # s
+0000c390: 6176 6520 7468 6520 6e65 7720 7665 6374  ave the new vect
+0000c3a0: 6f72 2074 6f20 6469 736b 2074 6f20 7265  or to disk to re
+0000c3b0: 6164 2069 7420 7769 7468 206f 6772 206c  ad it with ogr l
+0000c3c0: 6174 6572 0d0a 2020 2020 2020 2020 2020  ater..          
+0000c3d0: 2020 7665 6374 6f72 2e66 6561 7475 7265    vector.feature
+0000c3e0: 2e74 6f5f 6669 6c65 286e 6577 5f76 6563  .to_file(new_vec
+0000c3f0: 746f 725f 7061 7468 2c20 6472 6976 6572  tor_path, driver
+0000c400: 3d22 4765 6f4a 534f 4e22 290d 0a0d 0a20  ="GeoJSON").... 
+0000c410: 2020 2020 2020 2020 2020 2023 2072 6173             # ras
+0000c420: 7465 7269 7a65 2074 6865 2076 6563 746f  terize the vecto
+0000c430: 7220 6279 2062 7572 6e69 6e67 2074 6865  r by burning the
+0000c440: 2075 6e69 7175 6520 7661 6c75 6573 2061   unique values a
+0000c450: 7320 6365 6c6c 2076 616c 7565 732e 0d0a  s cell values...
+0000c460: 2020 2020 2020 2020 2020 2020 2320 7261              # ra
+0000c470: 7374 6572 697a 6564 5f76 6563 746f 725f  sterized_vector_
+0000c480: 7061 7468 203d 206f 732e 7061 7468 2e6a  path = os.path.j
+0000c490: 6f69 6e28 7465 6d70 5f64 6972 2c20 6622  oin(temp_dir, f"
+0000c4a0: 7b75 7569 642e 7575 6964 3128 297d 2e74  {uuid.uuid1()}.t
+0000c4b0: 6966 2229 0d0a 2020 2020 2020 2020 2020  if")..          
+0000c4c0: 2020 7261 7374 6572 697a 6564 5f76 6563    rasterized_vec
+0000c4d0: 746f 7220 3d20 7665 6374 6f72 2e74 6f5f  tor = vector.to_
+0000c4e0: 6461 7461 7365 7428 0d0a 2020 2020 2020  dataset(..      
+0000c4f0: 2020 2020 2020 2020 2020 6461 7461 7365            datase
+0000c500: 743d 7365 6c66 2c20 636f 6c75 6d6e 5f6e  t=self, column_n
+0000c510: 616d 653d 2262 7572 6e5f 7661 6c75 6522  ame="burn_value"
+0000c520: 0d0a 2020 2020 2020 2020 2020 2020 2920  ..            ) 
+0000c530: 2023 2072 6173 7465 7269 7a65 645f 7665   # rasterized_ve
+0000c540: 6374 6f72 5f70 6174 682c 0d0a 2020 2020  ctor_path,..    
+0000c550: 2020 2020 2020 2020 6966 2061 6464 5f67          if add_g
+0000c560: 656f 6d65 7472 793a 0d0a 2020 2020 2020  eometry:..      
+0000c570: 2020 2020 2020 2020 2020 6966 2061 6464            if add
+0000c580: 5f67 656f 6d65 7472 792e 6c6f 7765 7228  _geometry.lower(
+0000c590: 2920 3d3d 2022 706f 696e 7422 3a0d 0a20  ) == "point":.. 
+0000c5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c5b0: 2020 2063 6f6f 7264 7320 3d20 7261 7374     coords = rast
+0000c5c0: 6572 697a 6564 5f76 6563 746f 722e 6765  erized_vector.ge
+0000c5d0: 745f 6365 6c6c 5f70 6f69 6e74 7328 6d61  t_cell_points(ma
+0000c5e0: 736b 3d54 7275 6529 0d0a 2020 2020 2020  sk=True)..      
+0000c5f0: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+0000c600: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c610: 2020 2020 2063 6f6f 7264 7320 3d20 7261       coords = ra
+0000c620: 7374 6572 697a 6564 5f76 6563 746f 722e  sterized_vector.
+0000c630: 6765 745f 6365 6c6c 5f70 6f6c 7967 6f6e  get_cell_polygon
+0000c640: 7328 6d61 736b 3d54 7275 6529 0d0a 0d0a  s(mask=True)....
+0000c650: 2020 2020 2020 2020 2020 2020 2320 4c6f              # Lo
+0000c660: 6f70 206f 7665 7220 6d61 736b 2076 616c  op over mask val
+0000c670: 7565 7320 746f 2065 7874 7261 6374 2070  ues to extract p
+0000c680: 6978 656c 732e 0d0a 2020 2020 2020 2020  ixels...        
+0000c690: 2020 2020 2320 4461 7461 4672 616d 6573      # DataFrames
+0000c6a0: 206f 6620 6561 6368 2074 696c 652e 0d0a   of each tile...
+0000c6b0: 2020 2020 2020 2020 2020 2020 6466 5f6c              df_l
+0000c6c0: 6973 7420 3d20 5b5d 0d0a 2020 2020 2020  ist = []..      
+0000c6d0: 2020 2020 2020 6d61 736b 5f61 7272 203d        mask_arr =
+0000c6e0: 2072 6173 7465 7269 7a65 645f 7665 6374   rasterized_vect
+0000c6f0: 6f72 2e72 6173 7465 722e 4765 7452 6173  or.raster.GetRas
+0000c700: 7465 7242 616e 6428 3129 2e52 6561 6441  terBand(1).ReadA
+0000c710: 7341 7272 6179 2829 0d0a 0d0a 2020 2020  sArray()....    
+0000c720: 2020 2020 2020 2020 666f 7220 6172 7220          for arr 
+0000c730: 696e 2073 656c 662e 6765 745f 7469 6c65  in self.get_tile
+0000c740: 2874 696c 655f 7369 7a65 293a 0d0a 0d0a  (tile_size):....
+0000c750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c760: 6d61 736b 5f64 6673 203d 205b 5d0d 0a20  mask_dfs = [].. 
+0000c770: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000c780: 6f72 206d 6173 6b5f 7661 6c20 696e 2076  or mask_val in v
+0000c790: 6563 746f 722e 6665 6174 7572 655b 2262  ector.feature["b
+0000c7a0: 7572 6e5f 7661 6c75 6522 5d2e 7661 6c75  urn_value"].valu
+0000c7b0: 6573 3a0d 0a20 2020 2020 2020 2020 2020  es:..           
+0000c7c0: 2020 2020 2020 2020 2023 2045 7874 7261           # Extra
+0000c7d0: 6374 206f 6e6c 7920 6d61 736b 6564 2070  ct only masked p
+0000c7e0: 6978 656c 732e 0d0a 2020 2020 2020 2020  ixels...        
+0000c7f0: 2020 2020 2020 2020 2020 2020 666c 6174              flat
+0000c800: 7465 6e5f 6d61 736b 6564 5f76 616c 7565  ten_masked_value
+0000c810: 7320 3d20 6765 745f 7069 7865 6c73 280d  s = get_pixels(.
+0000c820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c830: 2020 2020 2020 2020 2061 7272 2c20 6d61           arr, ma
+0000c840: 736b 5f61 7272 2c20 6d61 736b 5f76 616c  sk_arr, mask_val
+0000c850: 3d6d 6173 6b5f 7661 6c0d 0a20 2020 2020  =mask_val..     
+0000c860: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0000c870: 2e74 7261 6e73 706f 7365 2829 0d0a 2020  .transpose()..  
+0000c880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c890: 2020 6669 645f 7078 203d 206e 702e 6f6e    fid_px = np.on
+0000c8a0: 6573 2866 6c61 7474 656e 5f6d 6173 6b65  es(flatten_maske
+0000c8b0: 645f 7661 6c75 6573 2e73 6861 7065 5b30  d_values.shape[0
+0000c8c0: 5d29 202a 206d 6173 6b5f 7661 6c0d 0a0d  ]) * mask_val...
+0000c8d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c8e0: 2020 2020 2023 2043 7265 6174 6520 6120       # Create a 
+0000c8f0: 4461 7461 4672 616d 6520 6f66 206d 6173  DataFrame of mas
+0000c900: 6b65 6420 666c 6174 7465 6e5f 6d61 736b  ked flatten_mask
+0000c910: 6564 5f76 616c 7565 7320 616e 6420 7468  ed_values and th
+0000c920: 6569 7220 4649 442e 0d0a 2020 2020 2020  eir FID...      
+0000c930: 2020 2020 2020 2020 2020 2020 2020 6d61                ma
+0000c940: 736b 5f64 6620 3d20 7064 2e44 6174 6146  sk_df = pd.DataF
+0000c950: 7261 6d65 2866 6c61 7474 656e 5f6d 6173  rame(flatten_mas
+0000c960: 6b65 645f 7661 6c75 6573 2c20 636f 6c75  ked_values, colu
+0000c970: 6d6e 733d 6261 6e64 5f6e 616d 6573 290d  mns=band_names).
+0000c980: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c990: 2020 2020 206d 6173 6b5f 6466 5b22 6275       mask_df["bu
+0000c9a0: 726e 5f76 616c 7565 225d 203d 2066 6964  rn_value"] = fid
+0000c9b0: 5f70 780d 0a20 2020 2020 2020 2020 2020  _px..           
+0000c9c0: 2020 2020 2020 2020 206d 6173 6b5f 6466           mask_df
+0000c9d0: 732e 6170 7065 6e64 286d 6173 6b5f 6466  s.append(mask_df
+0000c9e0: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+0000c9f0: 2020 2020 2023 2043 6f6e 6361 7420 7468       # Concat th
+0000ca00: 6520 6d61 736b 2044 6174 6146 7261 6d65  e mask DataFrame
+0000ca10: 732e 0d0a 2020 2020 2020 2020 2020 2020  s...            
+0000ca20: 2020 2020 6d61 736b 5f64 6620 3d20 7064      mask_df = pd
+0000ca30: 2e63 6f6e 6361 7428 6d61 736b 5f64 6673  .concat(mask_dfs
+0000ca40: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+0000ca50: 2020 2020 2023 204a 6f69 6e20 7769 7468       # Join with
+0000ca60: 2070 6978 656c 7320 7769 7468 2076 6563   pixels with vec
+0000ca70: 746f 7220 6174 7472 6962 7574 6573 2075  tor attributes u
+0000ca80: 7369 6e67 2074 6865 2046 4944 2e0d 0a20  sing the FID... 
+0000ca90: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0000caa0: 665f 6c69 7374 2e61 7070 656e 6428 0d0a  f_list.append(..
+0000cab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cac0: 2020 2020 6d61 736b 5f64 662e 6d65 7267      mask_df.merg
+0000cad0: 6528 7665 6374 6f72 2e66 6561 7475 7265  e(vector.feature
+0000cae0: 2c20 686f 773d 226c 6566 7422 2c20 6f6e  , how="left", on
+0000caf0: 3d22 6275 726e 5f76 616c 7565 2229 0d0a  ="burn_value")..
+0000cb00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cb10: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+0000cb20: 2023 204d 6572 6765 2061 6c6c 2074 6865   # Merge all the
+0000cb30: 2074 696c 6573 2e0d 0a20 2020 2020 2020   tiles...       
+0000cb40: 2020 2020 206f 7574 5f64 6620 3d20 7064       out_df = pd
+0000cb50: 2e63 6f6e 6361 7428 6466 5f6c 6973 7429  .concat(df_list)
+0000cb60: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+0000cb70: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0000cb80: 7469 6c65 3a0d 0a20 2020 2020 2020 2020  tile:..         
+0000cb90: 2020 2020 2020 2064 665f 6c69 7374 203d         df_list =
+0000cba0: 205b 5d20 2023 2044 6174 6146 7261 6d65   []  # DataFrame
+0000cbb0: 7320 6f66 2065 6163 6820 7469 6c65 2e0d  s of each tile..
+0000cbc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000cbd0: 2066 6f72 2061 7272 2069 6e20 4461 7461   for arr in Data
+0000cbe0: 7365 742e 6765 745f 7469 6c65 2873 656c  set.get_tile(sel
+0000cbf0: 662e 7261 7374 6572 293a 0d0a 2020 2020  f.raster):..    
+0000cc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cc10: 2320 4173 7375 6d65 206d 756c 7469 6261  # Assume multiba
+0000cc20: 6e64 0d0a 2020 2020 2020 2020 2020 2020  nd..            
+0000cc30: 2020 2020 2020 2020 6964 7820 3d20 2831          idx = (1
+0000cc40: 2c20 3229 0d0a 2020 2020 2020 2020 2020  , 2)..          
+0000cc50: 2020 2020 2020 2020 2020 6966 2061 7272            if arr
+0000cc60: 2e6e 6469 6d20 3d3d 2032 3a0d 0a20 2020  .ndim == 2:..   
 0000cc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cc80: 2020 2273 6f75 7263 6520 7261 7374 6572    "source raster
-0000cc90: 2079 6f75 2068 6176 6520 7072 6f76 6964   you have provid
-0000cca0: 6564 2064 6f65 7320 6e6f 7420 6578 6973  ed does not exis
-0000ccb0: 7422 0d0a 2020 2020 2020 2020 2020 2020  t"..            
-0000ccc0: 2020 2020 290d 0a0d 0a20 2020 2020 2020      )....       
-0000ccd0: 2020 2020 2065 7874 203d 206d 6173 6b5b       ext = mask[
-0000cce0: 2d34 3a5d 0d0a 2020 2020 2020 2020 2020  -4:]..          
-0000ccf0: 2020 6966 206e 6f74 2065 7874 203d 3d20    if not ext == 
-0000cd00: 222e 7469 6622 3a0d 0a20 2020 2020 2020  ".tif":..       
-0000cd10: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-0000cd20: 7970 6545 7272 6f72 280d 0a20 2020 2020  ypeError(..     
-0000cd30: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0000cd40: 506c 6561 7365 2061 6464 2074 6865 2065  Please add the e
-0000cd50: 7874 656e 7369 6f6e 2027 2e74 6966 2720  xtension '.tif' 
-0000cd60: 6174 2074 6865 2065 6e64 206f 6620 7468  at the end of th
-0000cd70: 6520 6d61 736b 2069 6e70 7574 220d 0a20  e mask input".. 
-0000cd80: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0000cd90: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-0000cda0: 6d61 736b 203d 2067 6461 6c2e 4f70 656e  mask = gdal.Open
-0000cdb0: 286d 6173 6b29 0d0a 2020 2020 2020 2020  (mask)..        
-0000cdc0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-0000cdd0: 2020 206d 6173 6b20 3d20 6d61 736b 0d0a     mask = mask..
-0000cde0: 0d0a 2020 2020 2020 2020 2320 6173 7365  ..        # asse
-0000cdf0: 7274 2069 7369 6e73 7461 6e63 6528 4d61  rt isinstance(Ma
-0000ce00: 736b 5f70 6174 682c 2073 7472 292c 2022  sk_path, str), "
-0000ce10: 4d61 736b 5f70 6174 6820 696e 7075 7420  Mask_path input 
-0000ce20: 7368 6f75 6c64 2062 6520 7374 7269 6e67  should be string
-0000ce30: 2074 7970 6522 0d0a 2020 2020 2020 2020   type"..        
-0000ce40: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
-0000ce50: 6528 7372 635f 6469 722c 2073 7472 293a  e(src_dir, str):
-0000ce60: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
-0000ce70: 6973 6520 5479 7065 4572 726f 7228 2273  ise TypeError("s
-0000ce80: 7263 5f64 6972 2069 6e70 7574 2073 686f  rc_dir input sho
-0000ce90: 756c 6420 6265 2073 7472 696e 6720 7479  uld be string ty
-0000cea0: 7065 2229 0d0a 0d0a 2020 2020 2020 2020  pe")....        
-0000ceb0: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
-0000cec0: 6528 7361 7665 746f 2c20 7374 7229 3a0d  e(saveto, str):.
-0000ced0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0000cee0: 7365 2054 7970 6545 7272 6f72 2822 7361  se TypeError("sa
-0000cef0: 7665 746f 2069 6e70 7574 2073 686f 756c  veto input shoul
-0000cf00: 6420 6265 2073 7472 696e 6720 7479 7065  d be string type
-0000cf10: 2229 0d0a 0d0a 2020 2020 2020 2020 2320  ")....        # 
-0000cf20: 6368 6563 6b20 7765 7468 6572 2074 6865  check wether the
-0000cf30: 2070 6174 6820 6578 6973 7473 206f 7220   path exists or 
-0000cf40: 6e6f 740d 0a20 2020 2020 2020 2069 6620  not..        if 
-0000cf50: 6e6f 7420 6f73 2e70 6174 682e 6578 6973  not os.path.exis
-0000cf60: 7473 2873 7263 5f64 6972 293a 0d0a 2020  ts(src_dir):..  
-0000cf70: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0000cf80: 4669 6c65 4e6f 7446 6f75 6e64 4572 726f  FileNotFoundErro
-0000cf90: 7228 0d0a 2020 2020 2020 2020 2020 2020  r(..            
-0000cfa0: 2020 2020 6622 7468 6520 7b73 7263 5f64      f"the {src_d
-0000cfb0: 6972 7d20 7061 7468 2079 6f75 2068 6176  ir} path you hav
-0000cfc0: 6520 7072 6f76 6964 6564 2064 6f65 7320  e provided does 
-0000cfd0: 6e6f 7420 6578 6973 7422 0d0a 2020 2020  not exist"..    
-0000cfe0: 2020 2020 2020 2020 290d 0a0d 0a20 2020          )....   
-0000cff0: 2020 2020 2069 6620 6e6f 7420 6f73 2e70       if not os.p
-0000d000: 6174 682e 6578 6973 7473 2873 6176 6574  ath.exists(savet
-0000d010: 6f29 3a0d 0a20 2020 2020 2020 2020 2020  o):..           
-0000d020: 2072 6169 7365 2046 696c 654e 6f74 466f   raise FileNotFo
-0000d030: 756e 6445 7272 6f72 280d 0a20 2020 2020  undError(..     
-0000d040: 2020 2020 2020 2020 2020 2066 2274 6865             f"the
-0000d050: 207b 7361 7665 746f 7d20 7061 7468 2079   {saveto} path y
-0000d060: 6f75 2068 6176 6520 7072 6f76 6964 6564  ou have provided
-0000d070: 2064 6f65 7320 6e6f 7420 6578 6973 7422   does not exist"
-0000d080: 0d0a 2020 2020 2020 2020 2020 2020 290d  ..            ).
-0000d090: 0a20 2020 2020 2020 2023 2063 6865 636b  .        # check
-0000d0a0: 2077 6574 6865 7220 7468 6520 666f 6c64   wether the fold
-0000d0b0: 6572 2068 6173 2074 6865 2072 6173 7465  er has the raste
-0000d0c0: 7273 206f 7220 6e6f 740d 0a20 2020 2020  rs or not..     
-0000d0d0: 2020 2069 6620 6e6f 7420 6c65 6e28 6f73     if not len(os
-0000d0e0: 2e6c 6973 7464 6972 2873 7263 5f64 6972  .listdir(src_dir
-0000d0f0: 2929 203e 2030 3a0d 0a20 2020 2020 2020  )) > 0:..       
-0000d100: 2020 2020 2072 6169 7365 2046 696c 654e       raise FileN
-0000d110: 6f74 466f 756e 6445 7272 6f72 2866 227b  otFoundError(f"{
-0000d120: 7372 635f 6469 727d 2066 6f6c 6465 7220  src_dir} folder 
-0000d130: 796f 7520 6861 7665 2070 726f 7669 6465  you have provide
-0000d140: 6420 6973 2065 6d70 7479 2229 0d0a 0d0a  d is empty")....
-0000d150: 2020 2020 2020 2020 6669 6c65 735f 6c69          files_li
-0000d160: 7374 203d 206f 732e 6c69 7374 6469 7228  st = os.listdir(
-0000d170: 7372 635f 6469 7229 0d0a 2020 2020 2020  src_dir)..      
-0000d180: 2020 6966 2022 6465 736b 746f 702e 696e    if "desktop.in
-0000d190: 6922 2069 6e20 6669 6c65 735f 6c69 7374  i" in files_list
-0000d1a0: 3a0d 0a20 2020 2020 2020 2020 2020 2066  :..            f
-0000d1b0: 696c 6573 5f6c 6973 742e 7265 6d6f 7665  iles_list.remove
-0000d1c0: 2822 6465 736b 746f 702e 696e 6922 290d  ("desktop.ini").
-0000d1d0: 0a0d 0a20 2020 2020 2020 2070 7269 6e74  ...        print
-0000d1e0: 2822 4e65 7720 5061 7468 2d20 2220 2b20  ("New Path- " + 
-0000d1f0: 7361 7665 746f 290d 0a20 2020 2020 2020  saveto)..       
-0000d200: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-0000d210: 6c65 6e28 6669 6c65 735f 6c69 7374 2929  len(files_list))
-0000d220: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-0000d230: 6620 6669 6c65 735f 6c69 7374 5b69 5d5b  f files_list[i][
-0000d240: 2d34 3a5d 203d 3d20 222e 7469 6622 3a0d  -4:] == ".tif":.
-0000d250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d260: 2070 7269 6e74 2866 227b 6920 2b20 317d   print(f"{i + 1}
-0000d270: 2f7b 6c65 6e28 6669 6c65 735f 6c69 7374  /{len(files_list
-0000d280: 297d 202d 207b 7361 7665 746f 7d7b 6669  )} - {saveto}{fi
-0000d290: 6c65 735f 6c69 7374 5b69 5d7d 2229 0d0a  les_list[i]}")..
-0000d2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d2b0: 4220 3d20 6764 616c 2e4f 7065 6e28 7372  B = gdal.Open(sr
-0000d2c0: 635f 6469 7220 2b20 6669 6c65 735f 6c69  c_dir + files_li
-0000d2d0: 7374 5b69 5d29 0d0a 2020 2020 2020 2020  st[i])..        
-0000d2e0: 2020 2020 2020 2020 6e65 775f 4220 3d20          new_B = 
-0000d2f0: 5261 7374 6572 2e63 726f 7041 6c6c 6967  Raster.cropAllig
-0000d300: 6e65 6428 422c 206d 6173 6b29 0d0a 2020  ned(B, mask)..  
-0000d310: 2020 2020 2020 2020 2020 2020 2020 5261                Ra
-0000d320: 7374 6572 2e73 6176 6552 6173 7465 7228  ster.saveRaster(
-0000d330: 6e65 775f 422c 2073 6176 6574 6f20 2b20  new_B, saveto + 
-0000d340: 6669 6c65 735f 6c69 7374 5b69 5d29 0d0a  files_list[i])..
-0000d350: 0d0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
-0000d360: 686f 640d 0a20 2020 2064 6566 2063 726f  hod..    def cro
-0000d370: 7028 0d0a 2020 2020 2020 2020 7372 633a  p(..        src:
-0000d380: 2055 6e69 6f6e 5b44 6174 6173 6574 2c20   Union[Dataset, 
-0000d390: 7374 725d 2c0d 0a20 2020 2020 2020 206d  str],..        m
-0000d3a0: 6173 6b3a 2055 6e69 6f6e 5b44 6174 6173  ask: Union[Datas
-0000d3b0: 6574 2c20 7374 725d 2c0d 0a20 2020 2020  et, str],..     
-0000d3c0: 2020 206f 7574 7075 745f 7061 7468 3a20     output_path: 
-0000d3d0: 7374 7220 3d20 2222 2c0d 0a20 2020 2020  str = "",..     
-0000d3e0: 2020 2073 6176 653a 2062 6f6f 6c20 3d20     save: bool = 
-0000d3f0: 4661 6c73 652c 0d0a 2020 2020 2020 2020  False,..        
-0000d400: 2320 5265 7361 6d70 6c65 3a20 626f 6f6c  # Resample: bool
-0000d410: 3d54 7275 650d 0a20 2020 2029 202d 3e20  =True..    ) -> 
-0000d420: 4461 7461 7365 743a 0d0a 2020 2020 2020  Dataset:..      
-0000d430: 2020 2222 2263 726f 702e 0d0a 0d0a 2020    """crop.....  
-0000d440: 2020 2020 2020 2020 2020 6372 6f70 206d            crop m
-0000d450: 6574 686f 6420 6372 6f70 7320 6120 7261  ethod crops a ra
-0000d460: 7374 6572 2075 7369 6e67 2061 6e6f 7468  ster using anoth
-0000d470: 6572 2072 6173 7465 7220 2862 6f74 6820  er raster (both 
-0000d480: 7261 7374 6572 7320 646f 6573 206e 6f74  rasters does not
-0000d490: 2068 6176 6520 746f 2062 6520 616c 6967   have to be alig
-0000d4a0: 6e65 6429 2e0d 0a0d 0a20 2020 2020 2020  ned).....       
-0000d4b0: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-0000d4c0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-0000d4d0: 0d0a 2020 2020 2020 2020 7372 633a 205b  ..        src: [
-0000d4e0: 7374 7269 6e67 2f67 6461 6c2e 4461 7461  string/gdal.Data
-0000d4f0: 7365 745d 0d0a 2020 2020 2020 2020 2020  set]..          
-0000d500: 2020 7468 6520 7261 7374 6572 2079 6f75    the raster you
-0000d510: 2077 616e 7420 746f 2063 726f 7020 6173   want to crop as
-0000d520: 2061 2070 6174 6820 6f72 2061 2067 6461   a path or a gda
-0000d530: 6c20 6f62 6a65 6374 0d0a 2020 2020 2020  l object..      
-0000d540: 2020 6d61 736b 203a 205b 7374 7269 6e67    mask : [string
-0000d550: 2f67 6461 6c2e 4461 7461 7365 745d 0d0a  /gdal.Dataset]..
-0000d560: 2020 2020 2020 2020 2020 2020 7468 6520              the 
-0000d570: 7261 7374 6572 2079 6f75 2077 616e 7420  raster you want 
-0000d580: 746f 2075 7365 2061 7320 6120 6d61 736b  to use as a mask
-0000d590: 2074 6f20 6372 6f70 206f 7468 6572 2072   to crop other r
-0000d5a0: 6173 7465 722c 0d0a 2020 2020 2020 2020  aster,..        
-0000d5b0: 2020 2020 7468 6520 6d61 736b 2063 616e      the mask can
-0000d5c0: 2062 6520 616c 736f 2061 2070 6174 6820   be also a path 
-0000d5d0: 6f72 2061 2067 6461 6c20 6f62 6a65 6374  or a gdal object
-0000d5e0: 2e0d 0a20 2020 2020 2020 206f 7574 7075  ...        outpu
-0000d5f0: 745f 7061 7468 203a 205b 7374 7269 6e67  t_path : [string
-0000d600: 5d0d 0a20 2020 2020 2020 2020 2020 2069  ]..            i
-0000d610: 6620 796f 7520 7761 6e74 2074 6f20 7361  f you want to sa
-0000d620: 7665 2074 6865 2063 726f 7070 6564 2072  ve the cropped r
-0000d630: 6173 7465 7220 6469 7265 6374 6c79 2074  aster directly t
-0000d640: 6f20 6469 736b 0d0a 2020 2020 2020 2020  o disk..        
-0000d650: 2020 2020 656e 7465 7220 7468 6520 7661      enter the va
-0000d660: 6c75 6520 6f66 2074 6865 204f 7574 7075  lue of the Outpu
-0000d670: 7450 6174 6820 6173 2074 6865 2070 6174  tPath as the pat
-0000d680: 682e 0d0a 2020 2020 2020 2020 7361 7665  h...        save
-0000d690: 203a 205b 626f 6f6c 656e 5d0d 0a20 2020   : [boolen]..   
-0000d6a0: 2020 2020 2020 2020 2054 7275 6520 6966           True if
-0000d6b0: 2079 6f75 2077 616e 7420 746f 2073 6176   you want to sav
-0000d6c0: 6520 7468 6520 6372 6f70 7065 6420 7261  e the cropped ra
-0000d6d0: 7374 6572 2064 6972 6563 746c 7920 746f  ster directly to
-0000d6e0: 2064 6973 6b2e 0d0a 0d0a 2020 2020 2020   disk.....      
-0000d6f0: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
-0000d700: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
-0000d710: 2020 2020 6473 7420 3a20 5b67 6461 6c2e      dst : [gdal.
-0000d720: 4461 7461 7365 745d 0d0a 2020 2020 2020  Dataset]..      
-0000d730: 2020 2020 2020 7468 6520 6372 6f70 7065        the croppe
-0000d740: 6420 7261 7374 6572 2077 696c 6c20 6265  d raster will be
-0000d750: 2072 6574 7572 6e65 642c 2069 6620 7468   returned, if th
-0000d760: 6520 7361 7665 2070 6172 616d 6574 6572  e save parameter
-0000d770: 2077 6173 2054 7275 652c 0d0a 2020 2020   was True,..    
-0000d780: 2020 2020 2020 2020 7468 6520 6372 6f70          the crop
-0000d790: 7065 6420 7261 7374 6572 2077 696c 6c20  ped raster will 
-0000d7a0: 616c 736f 2062 6520 7361 7665 6420 746f  also be saved to
-0000d7b0: 2064 6973 6b20 696e 2074 6865 204f 7574   disk in the Out
-0000d7c0: 7075 7450 6174 680d 0a20 2020 2020 2020  putPath..       
-0000d7d0: 2020 2020 2064 6972 6563 746f 7279 2e0d       directory..
-0000d7e0: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-0000d7f0: 2020 2020 2020 2320 6765 7420 696e 666f        # get info
-0000d800: 726d 6174 696f 6e20 6672 6f6d 2074 6865  rmation from the
-0000d810: 206d 6173 6b20 7261 7374 6572 0d0a 2020   mask raster..  
-0000d820: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-0000d830: 6e63 6528 6d61 736b 2c20 7374 7229 3a0d  nce(mask, str):.
-0000d840: 0a20 2020 2020 2020 2020 2020 206d 6173  .            mas
-0000d850: 6b20 3d20 6764 616c 2e4f 7065 6e28 6d61  k = gdal.Open(ma
-0000d860: 736b 290d 0a20 2020 2020 2020 2065 6c69  sk)..        eli
-0000d870: 6620 6973 696e 7374 616e 6365 286d 6173  f isinstance(mas
-0000d880: 6b2c 2067 6461 6c2e 4461 7461 7365 7429  k, gdal.Dataset)
-0000d890: 3a0d 0a20 2020 2020 2020 2020 2020 206d  :..            m
-0000d8a0: 6173 6b20 3d20 6d61 736b 0d0a 2020 2020  ask = mask..    
-0000d8b0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-0000d8c0: 2020 2020 2020 2070 7269 6e74 280d 0a20         print(.. 
-0000d8d0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0000d8e0: 5365 636f 6e64 2070 6172 616d 6574 6572  Second parameter
-0000d8f0: 2068 6173 2074 6f20 6265 2065 6974 6865   has to be eithe
-0000d900: 7220 7061 7468 2074 6f20 7468 6520 6d61  r path to the ma
-0000d910: 736b 2072 6173 7465 7220 6f72 2061 2067  sk raster or a g
-0000d920: 6461 6c2e 4461 7461 7365 7420 6f62 6a65  dal.Dataset obje
-0000d930: 6374 220d 0a20 2020 2020 2020 2020 2020  ct"..           
-0000d940: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
-0000d950: 7265 7475 726e 0d0a 0d0a 2020 2020 2020  return....      
-0000d960: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-0000d970: 7372 632c 2073 7472 293a 0d0a 2020 2020  src, str):..    
-0000d980: 2020 2020 2020 2020 7372 6320 3d20 6764          src = gd
-0000d990: 616c 2e4f 7065 6e28 7372 6329 0d0a 2020  al.Open(src)..  
-0000d9a0: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
-0000d9b0: 7461 6e63 6528 7372 632c 2067 6461 6c2e  tance(src, gdal.
-0000d9c0: 4461 7461 7365 7429 3a0d 0a20 2020 2020  Dataset):..     
-0000d9d0: 2020 2020 2020 2073 7263 203d 2073 7263         src = src
-0000d9e0: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-0000d9f0: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
-0000da00: 6e74 280d 0a20 2020 2020 2020 2020 2020  nt(..           
-0000da10: 2020 2020 2022 6669 7273 7420 7061 7261       "first para
-0000da20: 6d65 7465 7220 6861 7320 746f 2062 6520  meter has to be 
-0000da30: 6569 7468 6572 2070 6174 6820 746f 2074  either path to t
-0000da40: 6865 2072 6173 7465 7220 746f 2062 6520  he raster to be 
-0000da50: 6372 6f70 7065 6420 6f72 2061 2067 6461  cropped or a gda
-0000da60: 6c2e 4461 7461 7365 7420 6f62 6a65 6374  l.Dataset object
-0000da70: 220d 0a20 2020 2020 2020 2020 2020 2029  "..            )
-0000da80: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-0000da90: 7475 726e 0d0a 0d0a 2020 2020 2020 2020  turn....        
-0000daa0: 2320 6669 7273 7420 616c 6967 6e20 7468  # first align th
-0000dab0: 6520 6d61 736b 2077 6974 6820 7468 6520  e mask with the 
-0000dac0: 7372 6320 7261 7374 6572 0d0a 2020 2020  src raster..    
-0000dad0: 2020 2020 6d61 736b 5f61 6c69 676e 6564      mask_aligned
-0000dae0: 203d 2052 6173 7465 722e 6d61 7463 6852   = Raster.matchR
-0000daf0: 6173 7465 7241 6c69 676e 6d65 6e74 2873  asterAlignment(s
-0000db00: 7263 2c20 6d61 736b 290d 0a20 2020 2020  rc, mask)..     
-0000db10: 2020 2023 2063 726f 7020 7468 6520 7372     # crop the sr
-0000db20: 6320 7261 7374 6572 2077 6974 6820 7468  c raster with th
-0000db30: 6520 616c 6967 6e65 6420 6d61 736b 0d0a  e aligned mask..
-0000db40: 2020 2020 2020 2020 6473 7420 3d20 5261          dst = Ra
-0000db50: 7374 6572 2e63 726f 7041 6c6c 6967 6e65  ster.cropAlligne
-0000db60: 6428 7372 632c 206d 6173 6b5f 616c 6967  d(src, mask_alig
-0000db70: 6e65 6429 0d0a 0d0a 2020 2020 2020 2020  ned)....        
-0000db80: 2320 6d61 736b 5f70 726f 6a20 3d20 6d61  # mask_proj = ma
-0000db90: 736b 2e47 6574 5072 6f6a 6563 7469 6f6e  sk.GetProjection
-0000dba0: 2829 0d0a 2020 2020 2020 2020 2320 2320  ()..        # # 
-0000dbb0: 4745 5420 5448 4520 4745 4f54 5241 4e53  GET THE GEOTRANS
-0000dbc0: 464f 524d 0d0a 2020 2020 2020 2020 2320  FORM..        # 
-0000dbd0: 6d61 736b 5f67 7420 3d20 6d61 736b 2e47  mask_gt = mask.G
-0000dbe0: 6574 4765 6f54 7261 6e73 666f 726d 2829  etGeoTransform()
-0000dbf0: 0d0a 2020 2020 2020 2020 2320 2320 4745  ..        # # GE
-0000dc00: 5420 4e55 4d42 4552 204f 4620 636f 6c75  T NUMBER OF colu
-0000dc10: 6d6e 730d 0a20 2020 2020 2020 2023 206d  mns..        # m
-0000dc20: 6173 6b5f 7820 3d20 6d61 736b 2e52 6173  ask_x = mask.Ras
-0000dc30: 7465 7258 5369 7a65 0d0a 2020 2020 2020  terXSize..      
-0000dc40: 2020 2320 2320 6765 7420 6e75 6d62 6572    # # get number
-0000dc50: 206f 6620 726f 7773 0d0a 2020 2020 2020   of rows..      
-0000dc60: 2020 2320 6d61 736b 5f79 203d 206d 6173    # mask_y = mas
-0000dc70: 6b2e 5261 7374 6572 5953 697a 650d 0a20  k.RasterYSize.. 
-0000dc80: 2020 2020 2020 2023 0d0a 2020 2020 2020         #..      
-0000dc90: 2020 2320 6d61 736b 5f65 7073 6720 3d20    # mask_epsg = 
-0000dca0: 6f73 722e 5370 6174 6961 6c52 6566 6572  osr.SpatialRefer
-0000dcb0: 656e 6365 2877 6b74 3d6d 6173 6b5f 7072  ence(wkt=mask_pr
-0000dcc0: 6f6a 290d 0a20 2020 2020 2020 2023 0d0a  oj)..        #..
-0000dcd0: 2020 2020 2020 2020 2320 6d65 6d5f 6472          # mem_dr
-0000dce0: 7620 3d20 6764 616c 2e47 6574 4472 6976  v = gdal.GetDriv
-0000dcf0: 6572 4279 4e61 6d65 2822 4d45 4d22 290d  erByName("MEM").
-0000dd00: 0a20 2020 2020 2020 2023 2064 7374 203d  .        # dst =
-0000dd10: 206d 656d 5f64 7276 2e43 7265 6174 6528   mem_drv.Create(
-0000dd20: 2222 2c20 6d61 736b 5f78 2c20 6d61 736b  "", mask_x, mask
-0000dd30: 5f79 2c20 312c 0d0a 2020 2020 2020 2020  _y, 1,..        
-0000dd40: 2320 2020 2020 2020 2020 2020 2020 2020  #               
-0000dd50: 2020 2020 2020 2067 6461 6c63 6f6e 7374         gdalconst
-0000dd60: 2e47 4454 5f46 6c6f 6174 3332 290d 0a20  .GDT_Float32).. 
-0000dd70: 2020 2020 2020 2023 2023 202c 5b27 434f         # # ,['CO
-0000dd80: 4d50 5245 5353 3d4c 5a57 275d 204c 5a57  MPRESS=LZW'] LZW
-0000dd90: 2069 7320 6120 6c6f 7373 6c65 7373 2063   is a lossless c
-0000dda0: 6f6d 7072 6573 7369 6f6e 206d 6574 686f  ompression metho
-0000ddb0: 6420 6163 6869 6576 6520 7468 6520 6869  d achieve the hi
-0000ddc0: 6768 7374 2063 6f6d 7072 6573 7369 6f6e  ghst compression
-0000ddd0: 2062 7574 2077 6974 6820 6c6f 7420 6f66   but with lot of
-0000dde0: 2063 6f6d 7075 7461 7469 6f6e 0d0a 2020   computation..  
-0000ddf0: 2020 2020 2020 2320 2320 7365 7420 7468        # # set th
-0000de00: 6520 6765 6f74 7261 6e73 666f 726d 0d0a  e geotransform..
-0000de10: 2020 2020 2020 2020 2320 6473 742e 5365          # dst.Se
-0000de20: 7447 656f 5472 616e 7366 6f72 6d28 6d61  tGeoTransform(ma
-0000de30: 736b 5f67 7429 0d0a 2020 2020 2020 2020  sk_gt)..        
-0000de40: 2320 2320 7365 7420 7468 6520 7072 6f6a  # # set the proj
-0000de50: 6563 7469 6f6e 0d0a 2020 2020 2020 2020  ection..        
-0000de60: 2320 6473 742e 5365 7450 726f 6a65 6374  # dst.SetProject
-0000de70: 696f 6e28 6d61 736b 5f65 7073 672e 4578  ion(mask_epsg.Ex
-0000de80: 706f 7274 546f 576b 7428 2929 0d0a 2020  portToWkt())..  
-0000de90: 2020 2020 2020 2320 2320 7365 7420 7468        # # set th
-0000dea0: 6520 6e6f 2064 6174 6120 7661 6c75 650d  e no data value.
-0000deb0: 0a20 2020 2020 2020 2023 2064 7374 2e47  .        # dst.G
-0000dec0: 6574 5261 7374 6572 4261 6e64 2831 292e  etRasterBand(1).
-0000ded0: 5365 744e 6f44 6174 6156 616c 7565 286d  SetNoDataValue(m
-0000dee0: 6173 6b2e 4765 7452 6173 7465 7242 616e  ask.GetRasterBan
-0000def0: 6428 3129 2e47 6574 4e6f 4461 7461 5661  d(1).GetNoDataVa
-0000df00: 6c75 6528 2929 0d0a 2020 2020 2020 2020  lue())..        
-0000df10: 2320 2320 696e 6974 6961 6c69 7a65 2074  # # initialize t
-0000df20: 6865 2062 616e 6420 7769 7468 2074 6865  he band with the
-0000df30: 206e 6f64 6174 6120 7661 6c75 6520 696e   nodata value in
-0000df40: 7374 6561 6420 6f66 2030 0d0a 2020 2020  stead of 0..    
-0000df50: 2020 2020 2320 6473 742e 4765 7452 6173      # dst.GetRas
-0000df60: 7465 7242 616e 6428 3129 2e46 696c 6c28  terBand(1).Fill(
-0000df70: 6d61 736b 2e47 6574 5261 7374 6572 4261  mask.GetRasterBa
-0000df80: 6e64 2831 292e 4765 744e 6f44 6174 6156  nd(1).GetNoDataV
-0000df90: 616c 7565 2829 290d 0a20 2020 2020 2020  alue())..       
-0000dfa0: 2023 2023 2070 6572 666f 726d 2074 6865   # # perform the
-0000dfb0: 2070 726f 6a65 6374 696f 6e20 2620 7265   projection & re
-0000dfc0: 7361 6d70 6c69 6e67 0d0a 2020 2020 2020  sampling..      
-0000dfd0: 2020 2320 7265 7361 6d70 6c65 5f74 6563    # resample_tec
-0000dfe0: 686e 6971 7565 203d 2067 6461 6c2e 4752  hnique = gdal.GR
-0000dff0: 415f 4e65 6172 6573 744e 6569 6768 626f  A_NearestNeighbo
-0000e000: 7572 2020 2320 6764 616c 2e47 5241 5f4e  ur  # gdal.GRA_N
-0000e010: 6561 7265 7374 4e65 6967 6862 6f75 720d  earestNeighbour.
-0000e020: 0a20 2020 2020 2020 2023 0d0a 2020 2020  .        #..    
-0000e030: 2020 2020 2320 2320 7265 7072 6f6a 6563      # # reprojec
-0000e040: 7420 7468 6520 7372 6320 7261 7374 6572  t the src raster
-0000e050: 2074 6f20 7468 6520 6d61 736b 2070 726f   to the mask pro
-0000e060: 6a65 6374 696f 6e0d 0a20 2020 2020 2020  jection..       
-0000e070: 2023 2052 6570 726f 6a65 6374 6564 5f73   # Reprojected_s
-0000e080: 7263 203d 2067 6461 6c2e 5761 7270 2827  rc = gdal.Warp('
-0000e090: 272c 2073 7263 2c0d 0a20 2020 2020 2020  ', src,..       
-0000e0a0: 2023 2020 2020 2020 2020 2020 2020 2020   #              
-0000e0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e0c0: 2064 7374 5352 533d 2745 5053 473a 2720   dstSRS='EPSG:' 
-0000e0d0: 2b20 6d61 736b 5f65 7073 672e 4765 7441  + mask_epsg.GetA
-0000e0e0: 7474 7256 616c 7565 2827 4155 5448 4f52  ttrValue('AUTHOR
-0000e0f0: 4954 5927 2c20 3129 2c20 666f 726d 6174  ITY', 1), format
-0000e100: 3d27 5652 5427 290d 0a20 2020 2020 2020  ='VRT')..       
-0000e110: 2023 2069 6620 5265 7361 6d70 6c65 3a0d   # if Resample:.
-0000e120: 0a20 2020 2020 2020 2023 2020 2020 2023  .        #     #
-0000e130: 2072 6573 616d 706c 650d 0a20 2020 2020   resample..     
-0000e140: 2020 2023 2020 2020 2067 6461 6c2e 5265     #     gdal.Re
-0000e150: 7072 6f6a 6563 7449 6d61 6765 2852 6570  projectImage(Rep
-0000e160: 726f 6a65 6374 6564 5f73 7263 2c20 6473  rojected_src, ds
-0000e170: 742c 206d 6173 6b5f 6570 7367 2e45 7870  t, mask_epsg.Exp
-0000e180: 6f72 7454 6f57 6b74 2829 2c20 6d61 736b  ortToWkt(), mask
-0000e190: 5f65 7073 672e 4578 706f 7274 546f 576b  _epsg.ExportToWk
-0000e1a0: 7428 292c 0d0a 2020 2020 2020 2020 2320  t(),..        # 
-0000e1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e1c0: 2020 2020 2020 2020 7265 7361 6d70 6c65          resample
-0000e1d0: 5f74 6563 686e 6971 7565 290d 0a0d 0a20  _technique).... 
-0000e1e0: 2020 2020 2020 2069 6620 7361 7665 3a0d         if save:.
-0000e1f0: 0a20 2020 2020 2020 2020 2020 2052 6173  .            Ras
-0000e200: 7465 722e 7361 7665 5261 7374 6572 2864  ter.saveRaster(d
-0000e210: 7374 2c20 6f75 7470 7574 5f70 6174 6829  st, output_path)
-0000e220: 0d0a 0d0a 2020 2020 2020 2020 7265 7475  ....        retu
-0000e230: 726e 2064 7374 0d0a 0d0a 2020 2020 4073  rn dst....    @s
-0000e240: 7461 7469 636d 6574 686f 640d 0a20 2020  taticmethod..   
-0000e250: 2064 6566 2063 6c69 7052 6173 7465 7257   def clipRasterW
-0000e260: 6974 6850 6f6c 7967 6f6e 280d 0a20 2020  ithPolygon(..   
-0000e270: 2020 2020 2072 6173 7465 725f 7061 7468       raster_path
-0000e280: 3a20 7374 722c 0d0a 2020 2020 2020 2020  : str,..        
-0000e290: 7368 6170 6566 696c 655f 7061 7468 3a20  shapefile_path: 
-0000e2a0: 7374 722c 0d0a 2020 2020 2020 2020 7361  str,..        sa
-0000e2b0: 7665 3a20 626f 6f6c 203d 2046 616c 7365  ve: bool = False
-0000e2c0: 2c0d 0a20 2020 2020 2020 206f 7574 7075  ,..        outpu
-0000e2d0: 745f 7061 7468 3a20 7374 7220 3d20 4e6f  t_path: str = No
-0000e2e0: 6e65 2c0d 0a20 2020 2029 202d 3e20 4461  ne,..    ) -> Da
-0000e2f0: 7461 7365 743a 0d0a 2020 2020 2020 2020  taset:..        
-0000e300: 2222 2243 6c69 7052 6173 7465 7257 6974  """ClipRasterWit
-0000e310: 6850 6f6c 7967 6f6e 2e0d 0a0d 0a20 2020  hPolygon.....   
-0000e320: 2020 2020 2020 2020 2043 6c69 7052 6173           ClipRas
-0000e330: 7465 7257 6974 6850 6f6c 7967 6f6e 206d  terWithPolygon m
-0000e340: 6574 686f 6420 636c 6970 2061 2072 6173  ethod clip a ras
-0000e350: 7465 7220 7573 696e 6720 706f 6c79 676f  ter using polygo
-0000e360: 6e20 7368 6170 6566 696c 650d 0a0d 0a20  n shapefile.... 
-0000e370: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-0000e380: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-0000e390: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2072  -----..        r
-0000e3a0: 6173 7465 725f 7061 7468 203a 205b 5374  aster_path : [St
-0000e3b0: 7269 6e67 5d0d 0a20 2020 2020 2020 2020  ring]..         
-0000e3c0: 2020 2070 6174 6820 746f 2074 6865 2069     path to the i
-0000e3d0: 6e70 7574 2072 6173 7465 7220 696e 636c  nput raster incl
-0000e3e0: 7564 696e 6720 7468 6520 7261 7374 6572  uding the raster
-0000e3f0: 2065 7874 656e 7369 6f6e 2028 2e74 6966   extension (.tif
-0000e400: 290d 0a20 2020 2020 2020 2073 6861 7065  )..        shape
-0000e410: 6669 6c65 5f70 6174 6820 3a20 5b53 7472  file_path : [Str
-0000e420: 696e 675d 0d0a 2020 2020 2020 2020 2020  ing]..          
-0000e430: 2020 7061 7468 2074 6f20 7468 6520 696e    path to the in
-0000e440: 7075 7420 7368 6170 6566 696c 6520 696e  put shapefile in
-0000e450: 636c 7564 696e 6720 7468 6520 7368 6170  cluding the shap
-0000e460: 6566 696c 6520 6578 7465 6e73 696f 6e20  efile extension 
-0000e470: 282e 7368 7029 0d0a 2020 2020 2020 2020  (.shp)..        
-0000e480: 7361 7665 203a 205b 426f 6f6c 656e 5d0d  save : [Boolen].
-0000e490: 0a20 2020 2020 2020 2020 2020 2054 7275  .            Tru
-0000e4a0: 6520 6f72 2046 616c 7365 2074 6f20 6465  e or False to de
-0000e4b0: 6369 6465 2077 6865 7468 6572 2074 6f20  cide whether to 
-0000e4c0: 7361 7665 2074 6865 2063 6c69 7070 6564  save the clipped
-0000e4d0: 2072 6173 7465 7220 6f72 206e 6f74 0d0a   raster or not..
-0000e4e0: 2020 2020 2020 2020 2020 2020 6465 6661              defa
-0000e4f0: 756c 7420 6973 2046 616c 7365 0d0a 2020  ult is False..  
-0000e500: 2020 2020 2020 6f75 7470 7574 5f70 6174        output_pat
-0000e510: 6820 3a20 5b53 7472 696e 675d 0d0a 2020  h : [String]..  
-0000e520: 2020 2020 2020 2020 2020 7061 7468 2074            path t
-0000e530: 6f20 7468 6520 706c 6163 6520 696e 2079  o the place in y
-0000e540: 6f75 7220 6472 6976 6520 796f 7520 7761  our drive you wa
-0000e550: 6e74 2074 6f20 7361 7665 2074 6865 2063  nt to save the c
-0000e560: 6c69 7070 6564 2072 6173 7465 720d 0a20  lipped raster.. 
-0000e570: 2020 2020 2020 2020 2020 2069 6e63 6c75             inclu
-0000e580: 6469 6e67 2074 6865 2072 6173 7465 7220  ding the raster 
-0000e590: 6e61 6d65 2026 2065 7874 656e 7369 6f6e  name & extension
-0000e5a0: 2028 2e74 6966 292c 2064 6566 6175 6c74   (.tif), default
-0000e5b0: 2069 7320 4e6f 6e65 0d0a 0d0a 2020 2020   is None....    
-0000e5c0: 2020 2020 5265 7475 726e 730d 0a20 2020      Returns..   
-0000e5d0: 2020 2020 202d 2d2d 2d2d 2d2d 0d0a 2020       -------..  
-0000e5e0: 2020 2020 2020 7072 6f6a 6563 7465 645f        projected_
-0000e5f0: 7261 7374 6572 3a0d 0a20 2020 2020 2020  raster:..       
-0000e600: 2020 2020 205b 6764 616c 206f 626a 6563       [gdal objec
-0000e610: 745d 2063 6c69 7070 6564 2072 6173 7465  t] clipped raste
-0000e620: 720d 0a20 2020 2020 2020 2069 6620 7361  r..        if sa
-0000e630: 7665 2069 7320 5472 7565 2066 756e 6374  ve is True funct
-0000e640: 696f 6e20 6973 2067 6f69 6e67 2074 6f20  ion is going to 
-0000e650: 7361 7665 2074 6865 2063 6c69 7070 6564  save the clipped
-0000e660: 2072 6173 7465 7220 746f 2074 6865 206f   raster to the o
-0000e670: 7574 7075 745f 7061 7468 0d0a 0d0a 2020  utput_path....  
-0000e680: 2020 2020 2020 4578 616d 706c 6573 0d0a        Examples..
-0000e690: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0000e6a0: 0d0a 2020 2020 2020 2020 3e3e 3e20 7372  ..        >>> sr
-0000e6b0: 635f 7061 7468 203d 2072 2264 6174 612f  c_path = r"data/
-0000e6c0: 4576 6170 6f72 6174 696f 6e5f 4552 412d  Evaporation_ERA-
-0000e6d0: 496e 7465 7269 6d5f 3230 3039 2e30 312e  Interim_2009.01.
-0000e6e0: 3031 2e74 6966 220d 0a20 2020 2020 2020  01.tif"..       
-0000e6f0: 203e 3e3e 2073 6870 5f70 6174 6820 3d20   >>> shp_path = 
-0000e700: 2264 6174 612f 222b 224f 7574 6c69 6e65  "data/"+"Outline
-0000e710: 2e73 6870 220d 0a20 2020 2020 2020 203e  .shp"..        >
-0000e720: 3e3e 2063 6c69 7070 6564 5f72 6173 7465  >> clipped_raste
-0000e730: 7220 3d20 5261 7374 6572 2e63 6c69 7052  r = Raster.clipR
-0000e740: 6173 7465 7257 6974 6850 6f6c 7967 6f6e  asterWithPolygon
-0000e750: 2872 6173 7465 725f 7061 7468 2c73 6861  (raster_path,sha
-0000e760: 7065 6669 6c65 5f70 6174 6829 0d0a 2020  pefile_path)..  
-0000e770: 2020 2020 2020 6f72 0d0a 2020 2020 2020        or..      
-0000e780: 2020 3e3e 3e20 6473 745f 7061 7468 203d    >>> dst_path =
-0000e790: 2072 2264 6174 612f 6372 6f70 7065 642e   r"data/cropped.
-0000e7a0: 7469 6622 0d0a 2020 2020 2020 2020 3e3e  tif"..        >>
-0000e7b0: 3e20 636c 6970 7065 645f 7261 7374 6572  > clipped_raster
-0000e7c0: 203d 2052 6173 7465 722e 636c 6970 5261   = Raster.clipRa
-0000e7d0: 7374 6572 5769 7468 506f 6c79 676f 6e28  sterWithPolygon(
-0000e7e0: 7372 635f 7061 7468 2c20 7368 705f 7061  src_path, shp_pa
-0000e7f0: 7468 2c20 5472 7565 2c20 6473 745f 7061  th, True, dst_pa
-0000e800: 7468 290d 0a20 2020 2020 2020 2022 2222  th)..        """
-0000e810: 0d0a 2020 2020 2020 2020 6966 2069 7369  ..        if isi
-0000e820: 6e73 7461 6e63 6528 7261 7374 6572 5f70  nstance(raster_p
-0000e830: 6174 682c 2073 7472 293a 0d0a 2020 2020  ath, str):..    
-0000e840: 2020 2020 2020 2020 7372 6320 3d20 6764          src = gd
-0000e850: 616c 2e4f 7065 6e28 7261 7374 6572 5f70  al.Open(raster_p
-0000e860: 6174 6829 0d0a 2020 2020 2020 2020 656c  ath)..        el
-0000e870: 6966 2069 7369 6e73 7461 6e63 6528 7261  if isinstance(ra
-0000e880: 7374 6572 5f70 6174 682c 2067 6461 6c2e  ster_path, gdal.
-0000e890: 4461 7461 7365 7429 3a0d 0a20 2020 2020  Dataset):..     
-0000e8a0: 2020 2020 2020 2073 7263 203d 2072 6173         src = ras
-0000e8b0: 7465 725f 7061 7468 0d0a 2020 2020 2020  ter_path..      
-0000e8c0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0000e8d0: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-0000e8e0: 7272 6f72 2822 5261 7374 6572 5f70 6174  rror("Raster_pat
-0000e8f0: 6820 696e 7075 7420 7368 6f75 6c64 2062  h input should b
-0000e900: 6520 7374 7269 6e67 2074 7970 6522 290d  e string type").
-0000e910: 0a0d 0a20 2020 2020 2020 2069 6620 6973  ...        if is
-0000e920: 696e 7374 616e 6365 2873 6861 7065 6669  instance(shapefi
-0000e930: 6c65 5f70 6174 682c 2073 7472 293a 0d0a  le_path, str):..
-0000e940: 2020 2020 2020 2020 2020 2020 706f 6c79              poly
-0000e950: 203d 2067 7064 2e72 6561 645f 6669 6c65   = gpd.read_file
-0000e960: 2873 6861 7065 6669 6c65 5f70 6174 6829  (shapefile_path)
-0000e970: 0d0a 2020 2020 2020 2020 656c 6966 2069  ..        elif i
-0000e980: 7369 6e73 7461 6e63 6528 7368 6170 6566  sinstance(shapef
-0000e990: 696c 655f 7061 7468 2c20 6770 642e 6765  ile_path, gpd.ge
-0000e9a0: 6f64 6174 6166 7261 6d65 2e47 656f 4461  odataframe.GeoDa
-0000e9b0: 7461 4672 616d 6529 3a0d 0a20 2020 2020  taFrame):..     
-0000e9c0: 2020 2020 2020 2070 6f6c 7920 3d20 7368         poly = sh
-0000e9d0: 6170 6566 696c 655f 7061 7468 0d0a 2020  apefile_path..  
-0000e9e0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-0000e9f0: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-0000ea00: 7970 6545 7272 6f72 2822 7368 6170 6566  ypeError("shapef
-0000ea10: 696c 655f 7061 7468 2069 6e70 7574 2073  ile_path input s
-0000ea20: 686f 756c 6420 6265 2073 7472 696e 6720  hould be string 
-0000ea30: 7479 7065 2229 0d0a 0d0a 2020 2020 2020  type")....      
-0000ea40: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
-0000ea50: 6e63 6528 7361 7665 2c20 626f 6f6c 293a  nce(save, bool):
-0000ea60: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
-0000ea70: 6973 6520 5479 7065 4572 726f 7228 2273  ise TypeError("s
-0000ea80: 6176 6520 696e 7075 7420 7368 6f75 6c64  ave input should
-0000ea90: 2062 6520 626f 6f6c 2074 7970 6520 2854   be bool type (T
-0000eaa0: 7275 6520 6f72 2046 616c 7365 2922 290d  rue or False)").
-0000eab0: 0a0d 0a20 2020 2020 2020 2069 6620 7361  ...        if sa
-0000eac0: 7665 3a0d 0a20 2020 2020 2020 2020 2020  ve:..           
-0000ead0: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
-0000eae0: 6365 286f 7574 7075 745f 7061 7468 2c20  ce(output_path, 
-0000eaf0: 7374 7229 3a0d 0a20 2020 2020 2020 2020  str):..         
-0000eb00: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-0000eb10: 7565 4572 726f 7228 2250 6c65 6161 7365  ueError("Pleaase
-0000eb20: 2065 6e74 6572 2061 2070 6174 6820 746f   enter a path to
-0000eb30: 2073 6176 6520 7468 6520 636c 6970 7065   save the clippe
-0000eb40: 6420 7261 7374 6572 2229 0d0a 2020 2020  d raster")..    
-0000eb50: 2020 2020 2320 696e 7075 7473 2076 616c      # inputs val
-0000eb60: 7565 0d0a 2020 2020 2020 2020 6966 2073  ue..        if s
-0000eb70: 6176 653a 0d0a 2020 2020 2020 2020 2020  ave:..          
-0000eb80: 2020 6578 7420 3d20 6f75 7470 7574 5f70    ext = output_p
-0000eb90: 6174 685b 2d34 3a5d 0d0a 2020 2020 2020  ath[-4:]..      
-0000eba0: 2020 2020 2020 6966 206e 6f74 2065 7874        if not ext
-0000ebb0: 203d 3d20 222e 7469 6622 3a0d 0a20 2020   == ".tif":..   
-0000ebc0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-0000ebd0: 7365 2054 7970 6545 7272 6f72 280d 0a20  se TypeError(.. 
-0000ebe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ebf0: 2020 2022 706c 6561 7365 2061 6464 2074     "please add t
-0000ec00: 6865 2065 7874 656e 7469 6f6e 2061 7420  he extention at 
-0000ec10: 7468 6520 656e 6420 6f66 2074 6865 206f  the end of the o
-0000ec20: 7574 7075 745f 7061 7468 2069 6e70 7574  utput_path input
-0000ec30: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
-0000ec40: 2020 2029 0d0a 0d0a 2020 2020 2020 2020     )....        
-0000ec50: 7072 6f6a 203d 2073 7263 2e47 6574 5072  proj = src.GetPr
-0000ec60: 6f6a 6563 7469 6f6e 2829 0d0a 2020 2020  ojection()..    
-0000ec70: 2020 2020 7372 635f 6570 7367 203d 206f      src_epsg = o
-0000ec80: 7372 2e53 7061 7469 616c 5265 6665 7265  sr.SpatialRefere
-0000ec90: 6e63 6528 776b 743d 7072 6f6a 290d 0a20  nce(wkt=proj).. 
-0000eca0: 2020 2020 2020 2067 7420 3d20 7372 632e         gt = src.
-0000ecb0: 4765 7447 656f 5472 616e 7366 6f72 6d28  GetGeoTransform(
-0000ecc0: 290d 0a0d 0a20 2020 2020 2020 2023 2066  )....        # f
-0000ecd0: 6972 7374 2063 6865 636b 2069 6620 7468  irst check if th
-0000ece0: 6520 6372 7320 6973 2047 4353 2069 6620  e crs is GCS if 
-0000ecf0: 7965 7320 6368 6563 6b20 7768 6574 6865  yes check whethe
-0000ed00: 7220 7468 6520 6c6f 6e67 2069 7320 6772  r the long is gr
-0000ed10: 6561 7465 7220 7468 616e 2031 3830 0d0a  eater than 180..
-0000ed20: 2020 2020 2020 2020 2320 6765 6f70 616e          # geopan
-0000ed30: 6461 7320 7265 6164 202d 7665 206c 6f6e  das read -ve lon
-0000ed40: 6769 7475 6465 2076 616c 7565 7320 6966  gitude values if
-0000ed50: 206c 6f63 6174 696f 6e20 6973 2077 6573   location is wes
-0000ed60: 7420 6f66 2074 6865 2070 7269 6d65 206d  t of the prime m
-0000ed70: 6572 6964 6961 6e0d 0a20 2020 2020 2020  eridian..       
-0000ed80: 2023 2077 6869 6c65 2072 6173 7465 7269   # while rasteri
-0000ed90: 6f20 616e 6420 6764 616c 206e 6f74 0d0a  o and gdal not..
-0000eda0: 2020 2020 2020 2020 6966 2073 7263 5f65          if src_e
-0000edb0: 7073 672e 4765 7441 7474 7256 616c 7565  psg.GetAttrValue
-0000edc0: 2822 4155 5448 4f52 4954 5922 2c20 3129  ("AUTHORITY", 1)
-0000edd0: 203d 3d20 2234 3332 3622 2061 6e64 2067   == "4326" and g
-0000ede0: 745b 305d 203e 2031 3830 3a0d 0a20 2020  t[0] > 180:..   
-0000edf0: 2020 2020 2020 2020 2023 2072 6570 726f           # repro
-0000ee00: 6a65 6374 2074 6865 2072 6173 7465 7220  ject the raster 
-0000ee10: 746f 2077 6562 206d 6572 6361 746f 7220  to web mercator 
-0000ee20: 6372 730d 0a20 2020 2020 2020 2020 2020  crs..           
-0000ee30: 2072 6173 7465 7220 3d20 5261 7374 6572   raster = Raster
-0000ee40: 2e72 6570 726f 6a65 6374 4461 7461 7365  .reprojectDatase
-0000ee50: 7428 7372 6329 0d0a 2020 2020 2020 2020  t(src)..        
-0000ee60: 2020 2020 6f75 745f 7472 616e 7366 6f72      out_transfor
-0000ee70: 6d65 6420 3d20 6f73 2e65 6e76 6972 6f6e  med = os.environ
-0000ee80: 5b22 5465 6d70 225d 202b 2022 2f74 7261  ["Temp"] + "/tra
-0000ee90: 6e73 666f 726d 6564 2e74 6966 220d 0a20  nsformed.tif".. 
-0000eea0: 2020 2020 2020 2020 2020 2023 2073 6176             # sav
-0000eeb0: 6520 7468 6520 7261 7374 6572 2077 6974  e the raster wit
-0000eec0: 6820 7468 6520 6e65 7720 6372 730d 0a20  h the new crs.. 
-0000eed0: 2020 2020 2020 2020 2020 2052 6173 7465             Raste
-0000eee0: 722e 7361 7665 5261 7374 6572 2872 6173  r.saveRaster(ras
-0000eef0: 7465 722c 206f 7574 5f74 7261 6e73 666f  ter, out_transfo
-0000ef00: 726d 6564 290d 0a20 2020 2020 2020 2020  rmed)..         
-0000ef10: 2020 2072 6173 7465 7220 3d20 7261 7374     raster = rast
-0000ef20: 6572 696f 2e6f 7065 6e28 6f75 745f 7472  erio.open(out_tr
-0000ef30: 616e 7366 6f72 6d65 6429 0d0a 2020 2020  ansformed)..    
-0000ef40: 2020 2020 2020 2020 2320 6465 6c65 7465          # delete
-0000ef50: 2074 6865 2074 7261 6e73 666f 726d 6564   the transformed
-0000ef60: 2072 6173 7465 720d 0a20 2020 2020 2020   raster..       
-0000ef70: 2020 2020 206f 732e 7265 6d6f 7665 286f       os.remove(o
-0000ef80: 7574 5f74 7261 6e73 666f 726d 6564 290d  ut_transformed).
-0000ef90: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-0000efa0: 2020 2020 2020 2020 2020 2020 2320 6372              # cr
-0000efb0: 7320 6f66 2074 6865 2072 6173 7465 7220  s of the raster 
-0000efc0: 7761 7320 6e6f 7420 4743 5320 6f72 206c  was not GCS or l
-0000efd0: 6f6e 6769 7475 6465 7320 6c65 7373 2074  ongitudes less t
-0000efe0: 6861 6e20 3138 300d 0a20 2020 2020 2020  han 180..       
-0000eff0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-0000f000: 6365 2872 6173 7465 725f 7061 7468 2c20  ce(raster_path, 
-0000f010: 7374 7229 3a0d 0a20 2020 2020 2020 2020  str):..         
-0000f020: 2020 2020 2020 2072 6173 7465 7220 3d20         raster = 
-0000f030: 7261 7374 6572 696f 2e6f 7065 6e28 7261  rasterio.open(ra
-0000f040: 7374 6572 5f70 6174 6829 0d0a 2020 2020  ster_path)..    
-0000f050: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-0000f060: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000f070: 6173 7465 7220 3d20 7261 7374 6572 696f  aster = rasterio
-0000f080: 2e6f 7065 6e28 7261 7374 6572 5f70 6174  .open(raster_pat
-0000f090: 682e 4765 7444 6573 6372 6970 7469 6f6e  h.GetDescription
-0000f0a0: 2829 290d 0a0d 0a20 2020 2020 2020 2023  ())....        #
-0000f0b0: 2323 2043 726f 7070 696e 6720 7468 6520  ## Cropping the 
-0000f0c0: 7261 7374 6572 2077 6974 6820 7468 6520  raster with the 
-0000f0d0: 7368 6170 6566 696c 650d 0a20 2020 2020  shapefile..     
-0000f0e0: 2020 2023 2052 652d 7072 6f6a 6563 7420     # Re-project 
-0000f0f0: 696e 746f 2074 6865 2073 616d 6520 636f  into the same co
-0000f100: 6f72 6469 6e61 7465 2073 7973 7465 6d20  ordinate system 
-0000f110: 6173 2074 6865 2072 6173 7465 7220 6461  as the raster da
-0000f120: 7461 0d0a 2020 2020 2020 2020 7368 7066  ta..        shpf
-0000f130: 696c 6520 3d20 706f 6c79 2e74 6f5f 6372  ile = poly.to_cr
-0000f140: 7328 6372 733d 7261 7374 6572 2e63 7273  s(crs=raster.crs
-0000f150: 2e64 6174 6129 0d0a 0d0a 2020 2020 2020  .data)....      
-0000f160: 2020 2320 4765 7420 7468 6520 6765 6f6d    # Get the geom
-0000f170: 6574 7279 2063 6f6f 7264 696e 6174 6573  etry coordinates
-0000f180: 2062 7920 7573 696e 6720 7468 6520 6675   by using the fu
-0000f190: 6e63 7469 6f6e 2e0d 0a20 2020 2020 2020  nction...       
-0000f1a0: 2063 6f6f 7264 7320 3d20 5665 6374 6f72   coords = Vector
-0000f1b0: 2e67 6574 4665 6174 7572 6573 2873 6870  .getFeatures(shp
-0000f1c0: 6669 6c65 290d 0a0d 0a20 2020 2020 2020  file)....       
-0000f1d0: 206f 7574 5f69 6d67 2c20 6f75 745f 7472   out_img, out_tr
-0000f1e0: 616e 7366 6f72 6d20 3d20 7269 6f5f 6d61  ansform = rio_ma
-0000f1f0: 736b 2864 6174 6173 6574 3d72 6173 7465  sk(dataset=raste
-0000f200: 722c 2073 6861 7065 733d 636f 6f72 6473  r, shapes=coords
-0000f210: 2c20 6372 6f70 3d54 7275 6529 0d0a 0d0a  , crop=True)....
-0000f220: 2020 2020 2020 2020 2320 636f 7079 2074          # copy t
-0000f230: 6865 206d 6574 6164 6174 6120 6672 6f6d  he metadata from
-0000f240: 2074 6865 206f 7269 6769 6e61 6c20 6461   the original da
-0000f250: 7461 2066 696c 652e 0d0a 2020 2020 2020  ta file...      
-0000f260: 2020 6f75 745f 6d65 7461 203d 2072 6173    out_meta = ras
-0000f270: 7465 722e 6d65 7461 2e63 6f70 7928 290d  ter.meta.copy().
-0000f280: 0a0d 0a20 2020 2020 2020 2023 204e 6578  ...        # Nex
-0000f290: 7420 7765 206e 6565 6420 746f 2070 6172  t we need to par
-0000f2a0: 7365 2074 6865 2045 5053 4720 7661 6c75  se the EPSG valu
-0000f2b0: 6520 6672 6f6d 2074 6865 2043 5253 2073  e from the CRS s
-0000f2c0: 6f20 7468 6174 2077 6520 6361 6e20 6372  o that we can cr
-0000f2d0: 6561 7465 0d0a 2020 2020 2020 2020 2320  eate..        # 
-0000f2e0: 6120 5072 6f6a 3420 7374 7269 6e67 2075  a Proj4 string u
-0000f2f0: 7369 6e67 2050 7943 5253 206c 6962 7261  sing PyCRS libra
-0000f300: 7279 2028 746f 2065 6e73 7572 6520 7468  ry (to ensure th
-0000f310: 6174 2074 6865 2070 726f 6a65 6374 696f  at the projectio
-0000f320: 6e20 696e 666f 726d 6174 696f 6e20 6973  n information is
-0000f330: 2073 6176 6564 2063 6f72 7265 6374 6c79   saved correctly
-0000f340: 292e 0d0a 2020 2020 2020 2020 6570 7367  )...        epsg
-0000f350: 5f63 6f64 6520 3d20 696e 7428 7261 7374  _code = int(rast
-0000f360: 6572 2e63 7273 2e64 6174 615b 2269 6e69  er.crs.data["ini
-0000f370: 7422 5d5b 353a 5d29 0d0a 0d0a 2020 2020  t"][5:])....    
-0000f380: 2020 2020 2320 636c 6f73 6520 7468 6520      # close the 
-0000f390: 7472 616e 7366 6f72 6d65 6420 7261 7374  transformed rast
-0000f3a0: 6572 0d0a 2020 2020 2020 2020 7261 7374  er..        rast
-0000f3b0: 6572 2e63 6c6f 7365 2829 0d0a 0d0a 2020  er.close()....  
-0000f3c0: 2020 2020 2020 2320 4e6f 7720 7765 206e        # Now we n
-0000f3d0: 6565 6420 746f 2075 7064 6174 6520 7468  eed to update th
-0000f3e0: 6520 6d65 7461 6461 7461 2077 6974 6820  e metadata with 
-0000f3f0: 6e65 7720 6469 6d65 6e73 696f 6e73 2c20  new dimensions, 
-0000f400: 7472 616e 7366 6f72 6d20 2861 6666 696e  transform (affin
-0000f410: 6529 2061 6e64 2043 5253 2028 6173 2050  e) and CRS (as P
-0000f420: 726f 6a34 2074 6578 7429 0d0a 2020 2020  roj4 text)..    
-0000f430: 2020 2020 6f75 745f 6d65 7461 2e75 7064      out_meta.upd
-0000f440: 6174 6528 0d0a 2020 2020 2020 2020 2020  ate(..          
-0000f450: 2020 7b0d 0a20 2020 2020 2020 2020 2020    {..           
-0000f460: 2020 2020 2022 6472 6976 6572 223a 2022       "driver": "
-0000f470: 4754 6966 6622 2c0d 0a20 2020 2020 2020  GTiff",..       
-0000f480: 2020 2020 2020 2020 2022 6865 6967 6874           "height
-0000f490: 223a 206f 7574 5f69 6d67 2e73 6861 7065  ": out_img.shape
-0000f4a0: 5b31 5d2c 0d0a 2020 2020 2020 2020 2020  [1],..          
-0000f4b0: 2020 2020 2020 2277 6964 7468 223a 206f        "width": o
-0000f4c0: 7574 5f69 6d67 2e73 6861 7065 5b32 5d2c  ut_img.shape[2],
-0000f4d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000f4e0: 2020 2274 7261 6e73 666f 726d 223a 206f    "transform": o
-0000f4f0: 7574 5f74 7261 6e73 666f 726d 2c0d 0a20  ut_transform,.. 
-0000f500: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0000f510: 6372 7322 3a20 7079 7072 6f6a 2e43 5253  crs": pyproj.CRS
-0000f520: 2e66 726f 6d5f 6570 7367 2865 7073 675f  .from_epsg(epsg_
-0000f530: 636f 6465 292e 746f 5f77 6b74 2829 2c0d  code).to_wkt(),.
-0000f540: 0a20 2020 2020 2020 2020 2020 207d 0d0a  .            }..
-0000f550: 2020 2020 2020 2020 290d 0a0d 0a20 2020          )....   
-0000f560: 2020 2020 2023 2073 6176 6520 7468 6520       # save the 
-0000f570: 636c 6970 7065 6420 7261 7374 6572 2e0d  clipped raster..
-0000f580: 0a20 2020 2020 2020 2074 656d 705f 7061  .        temp_pa
-0000f590: 7468 203d 206f 732e 656e 7669 726f 6e5b  th = os.environ[
-0000f5a0: 2254 656d 7022 5d20 2b20 222f 6372 6f70  "Temp"] + "/crop
-0000f5b0: 7065 642e 7469 6622 0d0a 2020 2020 2020  ped.tif"..      
-0000f5c0: 2020 7769 7468 2072 6173 7465 7269 6f2e    with rasterio.
-0000f5d0: 6f70 656e 2874 656d 705f 7061 7468 2c20  open(temp_path, 
-0000f5e0: 2277 222c 202a 2a6f 7574 5f6d 6574 6129  "w", **out_meta)
-0000f5f0: 2061 7320 6465 7374 3a0d 0a20 2020 2020   as dest:..     
-0000f600: 2020 2020 2020 2064 6573 742e 7772 6974         dest.writ
-0000f610: 6528 6f75 745f 696d 6729 0d0a 2020 2020  e(out_img)..    
-0000f620: 2020 2020 2020 2020 6465 7374 2e63 6c6f          dest.clo
-0000f630: 7365 2829 0d0a 2020 2020 2020 2020 2020  se()..          
-0000f640: 2020 6465 7374 203d 204e 6f6e 650d 0a0d    dest = None...
-0000f650: 0a20 2020 2020 2020 2023 2072 6561 6420  .        # read 
-0000f660: 7468 6520 636c 6970 7065 6420 7261 7374  the clipped rast
-0000f670: 6572 0d0a 2020 2020 2020 2020 7261 7374  er..        rast
-0000f680: 6572 203d 2067 6461 6c2e 4f70 656e 2874  er = gdal.Open(t
-0000f690: 656d 705f 7061 7468 2c20 6764 616c 2e47  emp_path, gdal.G
-0000f6a0: 415f 5265 6164 4f6e 6c79 290d 0a20 2020  A_ReadOnly)..   
-0000f6b0: 2020 2020 2023 2072 6570 726f 6a65 6374       # reproject
-0000f6c0: 2074 6865 2063 6c69 7070 6564 2072 6173   the clipped ras
-0000f6d0: 7465 7220 6261 636b 2074 6f20 6974 7320  ter back to its 
-0000f6e0: 6f72 6967 696e 616c 2063 7273 0d0a 2020  original crs..  
-0000f6f0: 2020 2020 2020 7072 6f6a 6563 7465 645f        projected_
-0000f700: 7261 7374 6572 203d 2052 6173 7465 722e  raster = Raster.
-0000f710: 7072 6f6a 6563 7452 6173 7465 7228 0d0a  projectRaster(..
-0000f720: 2020 2020 2020 2020 2020 2020 7261 7374              rast
-0000f730: 6572 2c20 696e 7428 7372 635f 6570 7367  er, int(src_epsg
-0000f740: 2e47 6574 4174 7472 5661 6c75 6528 2241  .GetAttrValue("A
-0000f750: 5554 484f 5249 5459 222c 2031 2929 0d0a  UTHORITY", 1))..
-0000f760: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
-0000f770: 2020 2072 6173 7465 7220 3d20 4e6f 6e65     raster = None
-0000f780: 0d0a 2020 2020 2020 2020 2320 6465 6c65  ..        # dele
-0000f790: 7465 2074 6865 2063 6c69 7070 6564 2072  te the clipped r
-0000f7a0: 6173 7465 720d 0a20 2020 2020 2020 2023  aster..        #
-0000f7b0: 2074 7279 3a0d 0a20 2020 2020 2020 2023   try:..        #
-0000f7c0: 2054 4f44 4f3a 2066 6978 2043 6c69 7052   TODO: fix ClipR
-0000f7d0: 6173 7465 7257 6974 6850 6f6c 7967 6f6e  asterWithPolygon
-0000f7e0: 2061 7320 6974 2064 6f65 7320 6e6f 7420   as it does not 
-0000f7f0: 6465 6c65 7465 2074 6865 2074 6865 2063  delete the the c
-0000f800: 726f 7070 6564 2e74 6966 2072 6173 7465  ropped.tif raste
-0000f810: 7220 6672 6f6d 2074 6865 2074 656d 705f  r from the temp_
-0000f820: 7061 7468 0d0a 2020 2020 2020 2020 2320  path..        # 
-0000f830: 7468 6520 666f 6c6c 6f77 696e 6720 6c69  the following li
-0000f840: 6e65 2074 6872 6f75 6768 2061 6e20 6572  ne through an er
-0000f850: 726f 720d 0a20 2020 2020 2020 206f 732e  ror..        os.
-0000f860: 7265 6d6f 7665 2874 656d 705f 7061 7468  remove(temp_path
-0000f870: 290d 0a20 2020 2020 2020 2023 2065 7863  )..        # exc
-0000f880: 6570 743a 0d0a 2020 2020 2020 2020 2320  ept:..        # 
-0000f890: 2020 2020 7072 696e 7428 7465 6d70 5f70      print(temp_p
-0000f8a0: 6174 6820 2b20 2220 2d20 636f 756c 6420  ath + " - could 
-0000f8b0: 6e6f 7420 6265 2064 656c 6574 6564 2229  not be deleted")
-0000f8c0: 0d0a 0d0a 2020 2020 2020 2020 2320 7772  ....        # wr
-0000f8d0: 6974 6520 7468 6520 7261 7374 6572 2074  ite the raster t
-0000f8e0: 6f20 7468 6520 6669 6c65 0d0a 2020 2020  o the file..    
-0000f8f0: 2020 2020 6966 2073 6176 653a 0d0a 2020      if save:..  
-0000f900: 2020 2020 2020 2020 2020 5261 7374 6572            Raster
-0000f910: 2e73 6176 6552 6173 7465 7228 7072 6f6a  .saveRaster(proj
-0000f920: 6563 7465 645f 7261 7374 6572 2c20 6f75  ected_raster, ou
-0000f930: 7470 7574 5f70 6174 6829 0d0a 0d0a 2020  tput_path)....  
-0000f940: 2020 2020 2020 7265 7475 726e 2070 726f        return pro
-0000f950: 6a65 6374 6564 5f72 6173 7465 720d 0a0d  jected_raster...
-0000f960: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
-0000f970: 6f64 0d0a 2020 2020 6465 6620 636c 6970  od..    def clip
-0000f980: 3228 0d0a 2020 2020 2020 2020 7372 633a  2(..        src:
-0000f990: 2055 6e69 6f6e 5b72 6173 7465 7269 6f2e   Union[rasterio.
-0000f9a0: 696f 2e44 6174 6173 6574 5265 6164 6572  io.DatasetReader
-0000f9b0: 2c20 7374 725d 2c0d 0a20 2020 2020 2020  , str],..       
-0000f9c0: 2070 6f6c 793a 2055 6e69 6f6e 5b47 656f   poly: Union[Geo
-0000f9d0: 4461 7461 4672 616d 652c 2073 7472 5d2c  DataFrame, str],
-0000f9e0: 0d0a 2020 2020 2020 2020 7361 7665 3a20  ..        save: 
-0000f9f0: 626f 6f6c 203d 2046 616c 7365 2c0d 0a20  bool = False,.. 
-0000fa00: 2020 2020 2020 206f 7574 7075 745f 7061         output_pa
-0000fa10: 7468 3a20 7374 7220 3d20 226d 6173 6b65  th: str = "maske
-0000fa20: 642e 7469 6622 2c0d 0a20 2020 2029 202d  d.tif",..    ) -
-0000fa30: 3e20 4461 7461 7365 743a 0d0a 2020 2020  > Dataset:..    
-0000fa40: 2020 2020 2222 2243 6c69 7032 2e0d 0a0d      """Clip2....
-0000fa50: 0a20 2020 2020 2020 2020 2020 2043 6c69  .            Cli
-0000fa60: 7020 6675 6e63 7469 6f6e 2074 616b 6573  p function takes
-0000fa70: 2061 2072 6173 7465 7269 6f20 6f62 6a65   a rasterio obje
-0000fa80: 6374 2061 6e64 2063 6c69 7020 6974 2077  ct and clip it w
-0000fa90: 6974 6820 6120 6769 7665 6e20 6765 6f64  ith a given geod
-0000faa0: 6174 6166 7261 6d65 0d0a 2020 2020 2020  ataframe..      
-0000fab0: 2020 2020 2020 636f 6e74 6169 6e69 6e67        containing
-0000fac0: 2061 2070 6f6c 7967 6f6e 2073 6861 7065   a polygon shape
-0000fad0: 6c79 206f 626a 6563 740d 0a0d 0a20 2020  ly object....   
-0000fae0: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
-0000faf0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0000fb00: 2d2d 2d0d 0a20 2020 2020 2020 2073 7263  ---..        src
-0000fb10: 203a 205b 7261 7374 6572 696f 2e69 6f2e   : [rasterio.io.
-0000fb20: 4461 7461 7365 7452 6561 6465 725d 0d0a  DatasetReader]..
-0000fb30: 2020 2020 2020 2020 2020 2020 7468 6520              the 
-0000fb40: 7261 7374 6572 2072 6561 6420 6279 2072  raster read by r
-0000fb50: 6173 7465 7269 6f20 2e0d 0a20 2020 2020  asterio ...     
-0000fb60: 2020 2070 6f6c 7920 3a20 5b67 656f 6461     poly : [geoda
-0000fb70: 7461 6672 616d 655d 0d0a 2020 2020 2020  taframe]..      
-0000fb80: 2020 2020 2020 6765 6f64 6174 6166 7261        geodatafra
-0000fb90: 6d65 2063 6f6e 7461 696e 696e 6720 7468  me containing th
-0000fba0: 6520 706f 6c79 676f 6e20 796f 7520 7761  e polygon you wa
-0000fbb0: 6e74 2063 6c69 7020 7468 6520 7261 7374  nt clip the rast
-0000fbc0: 6572 2062 6173 6564 206f 6e2e 0d0a 2020  er based on...  
-0000fbd0: 2020 2020 2020 7361 7665 203a 205b 426f        save : [Bo
-0000fbe0: 6f6c 5d2c 206f 7074 696f 6e61 6c0d 0a20  ol], optional.. 
-0000fbf0: 2020 2020 2020 2020 2020 2074 6f20 7361             to sa
-0000fc00: 7665 2074 6865 2063 6c69 7070 6564 2072  ve the clipped r
-0000fc10: 6173 7465 7220 746f 2079 6f75 7220 6472  aster to your dr
-0000fc20: 6976 652e 2054 6865 2064 6566 6175 6c74  ive. The default
-0000fc30: 2069 7320 4661 6c73 652e 0d0a 2020 2020   is False...    
-0000fc40: 2020 2020 6f75 7470 7574 5f70 6174 6820      output_path 
-0000fc50: 3a20 5b53 7472 696e 675d 2c20 6f70 7469  : [String], opti
-0000fc60: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
-0000fc70: 2020 7061 7468 2069 696e 636c 7564 696e    path iincludin
-0000fc80: 6720 7468 6520 6578 7465 6e74 696f 6e20  g the extention 
-0000fc90: 282e 7469 6629 2e20 5468 6520 6465 6661  (.tif). The defa
-0000fca0: 756c 7420 6973 2027 6d61 736b 6564 2e74  ult is 'masked.t
-0000fcb0: 6966 272e 0d0a 0d0a 2020 2020 2020 2020  if'.....        
-0000fcc0: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
-0000fcd0: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020   -------..      
-0000fce0: 2020 6f75 745f 696d 6720 3a20 5b72 6173    out_img : [ras
-0000fcf0: 7465 7269 6f20 6f62 6a65 6374 5d0d 0a20  terio object].. 
-0000fd00: 2020 2020 2020 2020 2020 2074 6865 2063             the c
-0000fd10: 6c69 7070 6564 2072 6173 7465 722e 0d0a  lipped raster...
-0000fd20: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
-0000fd30: 203a 205b 6469 6374 696f 6e61 795d 0d0a   : [dictionay]..
-0000fd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fd50: 6469 6374 696f 6e61 7279 2063 6f6e 7461  dictionary conta
-0000fd60: 696e 696e 6720 6e75 6d62 6572 206f 6620  ining number of 
-0000fd70: 6261 6e64 732c 2063 6f6f 7264 696e 6174  bands, coordinat
-0000fd80: 6520 7265 6665 7265 6e63 6520 7379 7374  e reference syst
-0000fd90: 656d 2063 7273 0d0a 2020 2020 2020 2020  em crs..        
-0000fda0: 2020 2020 2020 2020 6474 7970 652c 2067          dtype, g
-0000fdb0: 656f 7472 616e 7366 6f72 6d2c 2068 6569  eotransform, hei
-0000fdc0: 6768 7420 616e 6420 7769 6474 6820 6f66  ght and width of
-0000fdd0: 2074 6865 2072 6173 7465 720d 0a20 2020   the raster..   
-0000fde0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-0000fdf0: 2020 2323 2320 312d 2052 652d 7072 6f6a    ### 1- Re-proj
-0000fe00: 6563 7420 7468 6520 706f 6c79 676f 6e20  ect the polygon 
-0000fe10: 696e 746f 2074 6865 2073 616d 6520 636f  into the same co
-0000fe20: 6f72 6469 6e61 7465 2073 7973 7465 6d20  ordinate system 
-0000fe30: 6173 2074 6865 2072 6173 7465 7220 6461  as the raster da
-0000fe40: 7461 2e0d 0a20 2020 2020 2020 2023 2057  ta...        # W
-0000fe50: 6520 6361 6e20 6163 6365 7373 2074 6865  e can access the
-0000fe60: 2063 7273 206f 6620 7468 6520 7261 7374   crs of the rast
-0000fe70: 6572 2075 7369 6e67 2061 7474 7269 6275  er using attribu
-0000fe80: 7465 202e 6372 732e 6461 7461 3a0d 0a20  te .crs.data:.. 
-0000fe90: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0000fea0: 616e 6365 2870 6f6c 792c 2073 7472 293a  ance(poly, str):
-0000feb0: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-0000fec0: 7265 6164 2074 6865 2073 6861 7065 6669  read the shapefi
-0000fed0: 6c65 0d0a 2020 2020 2020 2020 2020 2020  le..            
-0000fee0: 706f 6c79 203d 2067 7064 2e72 6561 645f  poly = gpd.read_
-0000fef0: 6669 6c65 2870 6f6c 7929 0d0a 2020 2020  file(poly)..    
-0000ff00: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
-0000ff10: 6e63 6528 706f 6c79 2c20 6770 642e 6765  nce(poly, gpd.ge
-0000ff20: 6f64 6174 6166 7261 6d65 2e47 656f 4461  odataframe.GeoDa
-0000ff30: 7461 4672 616d 6529 3a0d 0a20 2020 2020  taFrame):..     
-0000ff40: 2020 2020 2020 2070 6f6c 7920 3d20 706f         poly = po
-0000ff50: 6c79 0d0a 2020 2020 2020 2020 656c 7365  ly..        else
-0000ff60: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
-0000ff70: 6169 7365 2054 7970 6545 7272 6f72 2822  aise TypeError("
-0000ff80: 506f 6c79 676f 6e67 6466 2069 6e70 7574  Polygongdf input
-0000ff90: 2073 686f 756c 6420 6265 2073 7472 696e   should be strin
-0000ffa0: 6720 7479 7065 2229 0d0a 0d0a 2020 2020  g type")....    
-0000ffb0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-0000ffc0: 6528 7372 632c 2073 7472 293a 0d0a 2020  e(src, str):..  
-0000ffd0: 2020 2020 2020 2020 2020 7372 6320 3d20            src = 
-0000ffe0: 7261 7374 6572 696f 2e6f 7065 6e28 7372  rasterio.open(sr
-0000fff0: 6329 0d0a 2020 2020 2020 2020 656c 6966  c)..        elif
-00010000: 2069 7369 6e73 7461 6e63 6528 7372 632c   isinstance(src,
-00010010: 2072 6173 7465 7269 6f2e 696f 2e44 6174   rasterio.io.Dat
-00010020: 6173 6574 5265 6164 6572 293a 0d0a 2020  asetReader):..  
-00010030: 2020 2020 2020 2020 2020 7372 6320 3d20            src = 
-00010040: 7372 630d 0a20 2020 2020 2020 2065 6c73  src..        els
-00010050: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00010060: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
-00010070: 2252 6173 7465 726f 626a 2069 6e70 7574  "Rasterobj input
-00010080: 2073 686f 756c 6420 6265 2073 7472 696e   should be strin
-00010090: 6720 7479 7065 2229 0d0a 0d0a 2020 2020  g type")....    
-000100a0: 2020 2020 2320 5072 6f6a 6563 7420 7468      # Project th
-000100b0: 6520 506f 6c79 676f 6e20 696e 746f 2073  e Polygon into s
-000100c0: 616d 6520 4352 5320 6173 2074 6865 2067  ame CRS as the g
-000100d0: 7269 640d 0a20 2020 2020 2020 2070 6f6c  rid..        pol
-000100e0: 7920 3d20 706f 6c79 2e74 6f5f 6372 7328  y = poly.to_crs(
-000100f0: 6372 733d 7372 632e 6372 732e 6461 7461  crs=src.crs.data
-00010100: 290d 0a0d 0a20 2020 2020 2020 2023 2050  )....        # P
-00010110: 7269 6e74 2063 7273 0d0a 2020 2020 2020  rint crs..      
-00010120: 2020 2320 6765 6f2e 6372 730d 0a20 2020    # geo.crs..   
-00010130: 2020 2020 2023 2323 2032 2d20 436f 6e76       ### 2- Conv
-00010140: 6572 7420 7468 6520 706f 6c79 676f 6e20  ert the polygon 
-00010150: 696e 746f 2047 656f 4a53 4f4e 2066 6f72  into GeoJSON for
-00010160: 6d61 7420 666f 7220 7261 7374 6572 696f  mat for rasterio
-00010170: 2e0d 0a0d 0a20 2020 2020 2020 2023 2047  .....        # G
-00010180: 6574 2074 6865 2067 656f 6d65 7472 7920  et the geometry 
-00010190: 636f 6f72 6469 6e61 7465 7320 6279 2075  coordinates by u
-000101a0: 7369 6e67 2074 6865 2066 756e 6374 696f  sing the functio
-000101b0: 6e2e 0d0a 2020 2020 2020 2020 636f 6f72  n...        coor
-000101c0: 6473 203d 205b 6a73 6f6e 2e6c 6f61 6473  ds = [json.loads
-000101d0: 2870 6f6c 792e 746f 5f6a 736f 6e28 2929  (poly.to_json())
-000101e0: 5b22 6665 6174 7572 6573 225d 5b30 5d5b  ["features"][0][
-000101f0: 2267 656f 6d65 7472 7922 5d5d 0d0a 0d0a  "geometry"]]....
-00010200: 2020 2020 2020 2020 2320 7072 696e 7428          # print(
-00010210: 636f 6f72 6473 290d 0a0d 0a20 2020 2020  coords)....     
-00010220: 2020 2023 2323 2033 2d43 6c69 7020 7468     ### 3-Clip th
-00010230: 6520 7261 7374 6572 2077 6974 6820 506f  e raster with Po
-00010240: 6c79 676f 6e0d 0a20 2020 2020 2020 206f  lygon..        o
-00010250: 7574 5f69 6d67 2c20 6f75 745f 7472 616e  ut_img, out_tran
-00010260: 7366 6f72 6d20 3d20 7261 7374 6572 696f  sform = rasterio
-00010270: 2e6d 6173 6b2e 6d61 736b 280d 0a20 2020  .mask.mask(..   
-00010280: 2020 2020 2020 2020 2064 6174 6173 6574           dataset
-00010290: 3d73 7263 2c20 7368 6170 6573 3d63 6f6f  =src, shapes=coo
-000102a0: 7264 732c 2063 726f 703d 5472 7565 0d0a  rds, crop=True..
-000102b0: 2020 2020 2020 2020 290d 0a0d 0a20 2020          )....   
-000102c0: 2020 2020 2023 2323 2034 2d20 7570 6461       ### 4- upda
-000102d0: 7465 2074 6865 206d 6574 6164 6174 610d  te the metadata.
-000102e0: 0a20 2020 2020 2020 2023 2043 6f70 7920  .        # Copy 
-000102f0: 7468 6520 6f6c 6420 6d65 7461 6461 7461  the old metadata
-00010300: 0d0a 2020 2020 2020 2020 6f75 745f 6d65  ..        out_me
-00010310: 7461 203d 2073 7263 2e6d 6574 612e 636f  ta = src.meta.co
-00010320: 7079 2829 0d0a 2020 2020 2020 2020 2320  py()..        # 
-00010330: 7072 696e 7428 6f75 745f 6d65 7461 290d  print(out_meta).
-00010340: 0a0d 0a20 2020 2020 2020 2023 204e 6578  ...        # Nex
-00010350: 7420 7765 206e 6565 6420 746f 2070 6172  t we need to par
-00010360: 7365 2074 6865 2045 5053 4720 7661 6c75  se the EPSG valu
-00010370: 6520 6672 6f6d 2074 6865 2043 5253 2073  e from the CRS s
-00010380: 6f20 7468 6174 2077 6520 6361 6e20 6372  o that we can cr
-00010390: 6561 7465 0d0a 2020 2020 2020 2020 2320  eate..        # 
-000103a0: 6120 5072 6f6a 3420 2d73 7472 696e 6720  a Proj4 -string 
-000103b0: 7573 696e 6720 5079 4352 5320 6c69 6272  using PyCRS libr
-000103c0: 6172 7920 2874 6f20 656e 7375 7265 2074  ary (to ensure t
-000103d0: 6861 7420 7468 6520 7072 6f6a 6563 7469  hat the projecti
-000103e0: 6f6e 0d0a 2020 2020 2020 2020 2320 696e  on..        # in
-000103f0: 666f 726d 6174 696f 6e20 6973 2073 6176  formation is sav
-00010400: 6564 2063 6f72 7265 6374 6c79 292e 0d0a  ed correctly)...
-00010410: 0d0a 2020 2020 2020 2020 2320 5061 7273  ..        # Pars
-00010420: 6520 4550 5347 2063 6f64 650d 0a20 2020  e EPSG code..   
-00010430: 2020 2020 2065 7073 675f 636f 6465 203d       epsg_code =
-00010440: 2069 6e74 2873 7263 2e63 7273 2e64 6174   int(src.crs.dat
-00010450: 615b 2269 6e69 7422 5d5b 353a 5d29 0d0a  a["init"][5:])..
-00010460: 2020 2020 2020 2020 2320 7072 696e 7428          # print(
-00010470: 6570 7367 5f63 6f64 6529 0d0a 0d0a 2020  epsg_code)....  
-00010480: 2020 2020 2020 6f75 745f 6d65 7461 2e75        out_meta.u
-00010490: 7064 6174 6528 0d0a 2020 2020 2020 2020  pdate(..        
-000104a0: 2020 2020 7b0d 0a20 2020 2020 2020 2020      {..         
-000104b0: 2020 2020 2020 2022 6472 6976 6572 223a         "driver":
-000104c0: 2022 4754 6966 6622 2c0d 0a20 2020 2020   "GTiff",..     
-000104d0: 2020 2020 2020 2020 2020 2022 6865 6967             "heig
-000104e0: 6874 223a 206f 7574 5f69 6d67 2e73 6861  ht": out_img.sha
-000104f0: 7065 5b31 5d2c 0d0a 2020 2020 2020 2020  pe[1],..        
-00010500: 2020 2020 2020 2020 2277 6964 7468 223a          "width":
-00010510: 206f 7574 5f69 6d67 2e73 6861 7065 5b32   out_img.shape[2
-00010520: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
-00010530: 2020 2020 2274 7261 6e73 666f 726d 223a      "transform":
-00010540: 206f 7574 5f74 7261 6e73 666f 726d 2c0d   out_transform,.
-00010550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010560: 2022 6372 7322 3a20 7079 7072 6f6a 2e43   "crs": pyproj.C
-00010570: 5253 2e66 726f 6d5f 6570 7367 2865 7073  RS.from_epsg(eps
-00010580: 675f 636f 6465 292e 746f 5f77 6b74 2829  g_code).to_wkt()
-00010590: 2c0d 0a20 2020 2020 2020 2020 2020 207d  ,..            }
-000105a0: 0d0a 2020 2020 2020 2020 290d 0a20 2020  ..        )..   
-000105b0: 2020 2020 2069 6620 7361 7665 3a0d 0a20       if save:.. 
-000105c0: 2020 2020 2020 2020 2020 2077 6974 6820             with 
-000105d0: 7261 7374 6572 696f 2e6f 7065 6e28 6f75  rasterio.open(ou
-000105e0: 7470 7574 5f70 6174 682c 2022 7722 2c20  tput_path, "w", 
-000105f0: 2a2a 6f75 745f 6d65 7461 2920 6173 2064  **out_meta) as d
-00010600: 6573 743a 0d0a 2020 2020 2020 2020 2020  est:..          
-00010610: 2020 2020 2020 6465 7374 2e77 7269 7465        dest.write
-00010620: 286f 7574 5f69 6d67 290d 0a0d 0a20 2020  (out_img)....   
-00010630: 2020 2020 2072 6574 7572 6e20 6f75 745f       return out_
-00010640: 696d 672c 206f 7574 5f6d 6574 610d 0a0d  img, out_meta...
-00010650: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
-00010660: 6f64 0d0a 2020 2020 6465 6620 6368 616e  od..    def chan
-00010670: 6765 4e6f 4461 7461 5661 6c75 6528 7372  geNoDataValue(sr
-00010680: 633a 2044 6174 6173 6574 2c20 6473 743a  c: Dataset, dst:
-00010690: 2044 6174 6173 6574 2920 2d3e 2044 6174   Dataset) -> Dat
-000106a0: 6173 6574 3a0d 0a20 2020 2020 2020 2022  aset:..        "
-000106b0: 2222 4368 616e 6765 4e6f 4461 7461 5661  ""ChangeNoDataVa
-000106c0: 6c75 652e 0d0a 0d0a 2020 2020 2020 2020  lue.....        
-000106d0: 4368 616e 6765 4e6f 4461 7461 5661 6c75  ChangeNoDataValu
-000106e0: 6520 6368 616e 6765 7320 7468 6520 6365  e changes the ce
-000106f0: 6c6c 7320 6f66 206e 6f64 6174 6120 7661  lls of nodata va
-00010700: 6c75 6520 696e 2061 2064 7374 2072 6173  lue in a dst ras
-00010710: 7465 7220 746f 206d 6174 6368 0d0a 2020  ter to match..  
-00010720: 2020 2020 2020 6120 7372 6320 7261 7374        a src rast
-00010730: 6572 2e0d 0a0d 0a20 2020 2020 2020 2050  er.....        P
-00010740: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
-00010750: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-00010760: 2020 2020 2020 2073 7263 3a20 5b67 6461         src: [gda
-00010770: 6c2e 6461 7461 7365 745d 0d0a 2020 2020  l.dataset]..    
-00010780: 2020 2020 2020 2020 736f 7572 6365 2072          source r
-00010790: 6173 7465 7220 746f 2067 6574 2074 6865  aster to get the
-000107a0: 206c 6f63 6174 696f 6e20 6f66 2074 6865   location of the
-000107b0: 204e 6f44 6174 6156 616c 7565 2061 6e64   NoDataValue and
-000107c0: 0d0a 2020 2020 2020 2020 2020 2020 7768  ..            wh
-000107d0: 6572 6520 6974 2069 7320 696e 2074 6865  ere it is in the
-000107e0: 2061 7272 6179 0d0a 2020 2020 2020 2020   array..        
-000107f0: 6473 743a 205b 6764 616c 2e64 6174 6173  dst: [gdal.datas
-00010800: 6574 5d0d 0a20 2020 2020 2020 2020 2020  et]..           
-00010810: 2072 6173 7465 7220 796f 7520 7761 6e74   raster you want
-00010820: 2074 6f20 7374 6f72 6520 4e6f 4461 7461   to store NoData
-00010830: 5661 6c75 6520 696e 2069 7473 2063 656c  Value in its cel
-00010840: 6c73 0d0a 2020 2020 2020 2020 2020 2020  ls..            
-00010850: 6578 6163 746c 7920 7468 6520 7361 6d65  exactly the same
-00010860: 206c 696b 6520 7372 6320 7261 7374 6572   like src raster
-00010870: 0d0a 0d0a 2020 2020 2020 2020 5265 7475  ....        Retu
-00010880: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
-00010890: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6473  ----..        ds
-000108a0: 743a 205b 6764 616c 2e64 6174 6173 6574  t: [gdal.dataset
-000108b0: 5d0d 0a20 2020 2020 2020 2020 2020 2074  ]..            t
-000108c0: 6865 2073 6563 6f6e 6420 7261 7374 6572  he second raster
-000108d0: 2077 6974 6820 4e6f 4461 7461 5661 6c75   with NoDataValu
-000108e0: 6520 7374 6f72 6564 2069 6e20 6974 7320  e stored in its 
-000108f0: 6365 6c6c 730d 0a20 2020 2020 2020 2020  cells..         
-00010900: 2020 2065 7861 6374 6c79 2074 6865 2073     exactly the s
-00010910: 616d 6520 6c69 6b65 2073 7263 2072 6173  ame like src ras
-00010920: 7465 720d 0a20 2020 2020 2020 2022 2222  ter..        """
-00010930: 0d0a 2020 2020 2020 2020 2320 696e 7075  ..        # inpu
-00010940: 7420 6461 7461 2076 616c 6964 6174 696f  t data validatio
-00010950: 6e0d 0a20 2020 2020 2020 2023 2064 6174  n..        # dat
-00010960: 6120 7479 7065 0d0a 2020 2020 2020 2020  a type..        
-00010970: 6173 7365 7274 2028 0d0a 2020 2020 2020  assert (..      
-00010980: 2020 2020 2020 7479 7065 2873 7263 2920        type(src) 
-00010990: 3d3d 2067 6461 6c2e 4461 7461 7365 740d  == gdal.Dataset.
-000109a0: 0a20 2020 2020 2020 2029 2c20 2273 7263  .        ), "src
-000109b0: 2073 686f 756c 6420 6265 2072 6561 6420   should be read 
-000109c0: 7573 696e 6720 6764 616c 2028 6764 616c  using gdal (gdal
-000109d0: 2064 6174 6173 6574 2070 6c65 6173 6520   dataset please 
-000109e0: 7265 6164 2069 7420 7573 696e 6720 6764  read it using gd
-000109f0: 616c 206c 6962 7261 7279 2920 220d 0a20  al library) ".. 
-00010a00: 2020 2020 2020 2061 7373 6572 7420 280d         assert (.
-00010a10: 0a20 2020 2020 2020 2020 2020 2074 7970  .            typ
-00010a20: 6528 6473 7429 203d 3d20 6764 616c 2e44  e(dst) == gdal.D
-00010a30: 6174 6173 6574 0d0a 2020 2020 2020 2020  ataset..        
-00010a40: 292c 2022 6473 7420 7368 6f75 6c64 2062  ), "dst should b
-00010a50: 6520 7265 6164 2075 7369 6e67 2067 6461  e read using gda
-00010a60: 6c20 2867 6461 6c20 6461 7461 7365 7420  l (gdal dataset 
-00010a70: 706c 6561 7365 2072 6561 6420 6974 2075  please read it u
-00010a80: 7369 6e67 2067 6461 6c20 6c69 6272 6172  sing gdal librar
-00010a90: 7929 2022 0d0a 0d0a 2020 2020 2020 2020  y) "....        
-00010aa0: 7372 635f 6e6f 7661 6c20 3d20 6e70 2e66  src_noval = np.f
-00010ab0: 6c6f 6174 3332 2873 7263 2e47 6574 5261  loat32(src.GetRa
-00010ac0: 7374 6572 4261 6e64 2831 292e 4765 744e  sterBand(1).GetN
-00010ad0: 6f44 6174 6156 616c 7565 2829 290d 0a0d  oDataValue())...
-00010ae0: 0a20 2020 2020 2020 2064 7374 5f67 7420  .        dst_gt 
-00010af0: 3d20 6473 742e 4765 7447 656f 5472 616e  = dst.GetGeoTran
-00010b00: 7366 6f72 6d28 290d 0a20 2020 2020 2020  sform()..       
-00010b10: 2064 7374 5f70 726f 6a20 3d20 6473 742e   dst_proj = dst.
-00010b20: 4765 7450 726f 6a65 6374 696f 6e28 290d  GetProjection().
-00010b30: 0a20 2020 2020 2020 2064 7374 5f72 6f77  .        dst_row
-00010b40: 203d 2064 7374 2e52 6173 7465 7259 5369   = dst.RasterYSi
-00010b50: 7a65 0d0a 2020 2020 2020 2020 6473 745f  ze..        dst_
-00010b60: 636f 6c20 3d20 6473 742e 5261 7374 6572  col = dst.Raster
-00010b70: 5853 697a 650d 0a20 2020 2020 2020 2064  XSize..        d
-00010b80: 7479 7065 203d 2064 7374 2e47 6574 5261  type = dst.GetRa
-00010b90: 7374 6572 4261 6e64 2831 292e 4461 7461  sterBand(1).Data
-00010ba0: 5479 7065 0d0a 2020 2020 2020 2020 6473  Type..        ds
-00010bb0: 745f 6e6f 7661 6c20 3d20 6e70 2e66 6c6f  t_noval = np.flo
-00010bc0: 6174 3332 2864 7374 2e47 6574 5261 7374  at32(dst.GetRast
-00010bd0: 6572 4261 6e64 2831 292e 4765 744e 6f44  erBand(1).GetNoD
-00010be0: 6174 6156 616c 7565 2829 290d 0a20 2020  ataValue())..   
-00010bf0: 2020 2020 2064 7374 5f73 7265 6620 3d20       dst_sref = 
-00010c00: 6f73 722e 5370 6174 6961 6c52 6566 6572  osr.SpatialRefer
-00010c10: 656e 6365 2877 6b74 3d64 7374 5f70 726f  ence(wkt=dst_pro
-00010c20: 6a29 0d0a 2020 2020 2020 2020 2320 2020  j)..        #   
-00010c30: 2064 7374 5f65 7073 6720 3d20 696e 7428   dst_epsg = int(
-00010c40: 6473 745f 7372 6566 2e47 6574 4174 7472  dst_sref.GetAttr
-00010c50: 5661 6c75 6528 2741 5554 484f 5249 5459  Value('AUTHORITY
-00010c60: 272c 3129 290d 0a0d 0a20 2020 2020 2020  ',1))....       
-00010c70: 2064 7374 5f61 7272 6179 203d 2064 7374   dst_array = dst
-00010c80: 2e52 6561 6441 7341 7272 6179 2829 0d0a  .ReadAsArray()..
-00010c90: 0d0a 2020 2020 2020 2020 666f 7220 6920  ..        for i 
-00010ca0: 696e 2072 616e 6765 2864 7374 5f61 7272  in range(dst_arr
-00010cb0: 6179 2e73 6861 7065 5b30 5d29 3a0d 0a20  ay.shape[0]):.. 
-00010cc0: 2020 2020 2020 2020 2020 2066 6f72 206a             for j
-00010cd0: 2069 6e20 7261 6e67 6528 6473 745f 6172   in range(dst_ar
-00010ce0: 7261 792e 7368 6170 655b 315d 293a 0d0a  ray.shape[1]):..
-00010cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010d00: 6966 206e 702e 6973 636c 6f73 6528 6473  if np.isclose(ds
-00010d10: 745f 6172 7261 795b 692c 206a 5d2c 2064  t_array[i, j], d
-00010d20: 7374 5f6e 6f76 616c 2c20 7274 6f6c 3d30  st_noval, rtol=0
-00010d30: 2e30 3031 293a 0d0a 2020 2020 2020 2020  .001):..        
-00010d40: 2020 2020 2020 2020 2020 2020 6473 745f              dst_
-00010d50: 6172 7261 795b 692c 206a 5d20 3d20 7372  array[i, j] = sr
-00010d60: 635f 6e6f 7661 6c0d 0a0d 0a20 2020 2020  c_noval....     
-00010d70: 2020 2023 2064 7374 5f61 7272 6179 5b64     # dst_array[d
-00010d80: 7374 5f61 7272 6179 3d3d 6473 745f 6e6f  st_array==dst_no
-00010d90: 7661 6c5d 3d73 7263 5f6e 6f76 616c 0d0a  val]=src_noval..
-00010da0: 2020 2020 2020 2020 6473 7420 3d20 5261          dst = Ra
-00010db0: 7374 6572 2e5f 6372 6561 7465 4461 7461  ster._createData
-00010dc0: 7365 7428 6473 745f 636f 6c2c 2064 7374  set(dst_col, dst
-00010dd0: 5f72 6f77 2c20 312c 2064 7479 7065 2c20  _row, 1, dtype, 
-00010de0: 6472 6976 6572 3d22 4d45 4d22 290d 0a0d  driver="MEM")...
-00010df0: 0a20 2020 2020 2020 2023 2073 6574 2074  .        # set t
-00010e00: 6865 2067 656f 7472 616e 7366 6f72 6d0d  he geotransform.
-00010e10: 0a20 2020 2020 2020 2064 7374 2e53 6574  .        dst.Set
-00010e20: 4765 6f54 7261 6e73 666f 726d 2864 7374  GeoTransform(dst
-00010e30: 5f67 7429 0d0a 2020 2020 2020 2020 2320  _gt)..        # 
-00010e40: 7365 7420 7468 6520 7072 6f6a 6563 7469  set the projecti
-00010e50: 6f6e 0d0a 2020 2020 2020 2020 6473 742e  on..        dst.
-00010e60: 5365 7450 726f 6a65 6374 696f 6e28 6473  SetProjection(ds
-00010e70: 745f 7372 6566 2e45 7870 6f72 7454 6f57  t_sref.ExportToW
-00010e80: 6b74 2829 290d 0a20 2020 2020 2020 2023  kt())..        #
-00010e90: 2073 6574 2074 6865 206e 6f20 6461 7461   set the no data
-00010ea0: 2076 616c 7565 0d0a 2020 2020 2020 2020   value..        
-00010eb0: 6e6f 5f64 6174 615f 7661 6c75 6520 3d20  no_data_value = 
-00010ec0: 7372 632e 4765 7452 6173 7465 7242 616e  src.GetRasterBan
-00010ed0: 6428 3129 2e47 6574 4e6f 4461 7461 5661  d(1).GetNoDataVa
-00010ee0: 6c75 6528 290d 0a20 2020 2020 2020 2064  lue()..        d
-00010ef0: 7374 203d 2052 6173 7465 722e 7365 744e  st = Raster.setN
-00010f00: 6f44 6174 6156 616c 7565 2864 7374 2c20  oDataValue(dst, 
-00010f10: 6e6f 5f64 6174 615f 7661 6c75 6529 0d0a  no_data_value)..
-00010f20: 2020 2020 2020 2020 6473 742e 4765 7452          dst.GetR
-00010f30: 6173 7465 7242 616e 6428 3129 2e57 7269  asterBand(1).Wri
-00010f40: 7465 4172 7261 7928 6473 745f 6172 7261  teArray(dst_arra
-00010f50: 7929 0d0a 0d0a 2020 2020 2020 2020 7265  y)....        re
-00010f60: 7475 726e 2064 7374 0d0a 0d0a 2020 2020  turn dst....    
-00010f70: 4073 7461 7469 636d 6574 686f 640d 0a20  @staticmethod.. 
-00010f80: 2020 2064 6566 206d 6174 6368 5261 7374     def matchRast
-00010f90: 6572 416c 6967 6e6d 656e 7428 0d0a 2020  erAlignment(..  
-00010fa0: 2020 2020 2020 616c 6967 6e6d 656e 745f        alignment_
-00010fb0: 7372 633a 2055 6e69 6f6e 5b44 6174 6173  src: Union[Datas
-00010fc0: 6574 2c20 7374 725d 2c20 6461 7461 5f73  et, str], data_s
-00010fd0: 7263 3a20 556e 696f 6e5b 4461 7461 7365  rc: Union[Datase
-00010fe0: 742c 2073 7472 5d0d 0a20 2020 2029 202d  t, str]..    ) -
-00010ff0: 3e20 4461 7461 7365 743a 0d0a 2020 2020  > Dataset:..    
-00011000: 2020 2020 2222 226d 6174 6368 5261 7374      """matchRast
-00011010: 6572 416c 6967 6e6d 656e 742e 0d0a 0d0a  erAlignment.....
-00011020: 2020 2020 2020 2020 6d61 7463 6852 6173          matchRas
-00011030: 7465 7241 6c69 676e 6d65 6e74 206d 6574  terAlignment met
-00011040: 686f 6420 6d61 7463 6865 7320 7468 6520  hod matches the 
-00011050: 636f 6f72 6469 6e61 7465 2073 7973 7465  coordinate syste
-00011060: 6d20 616e 6420 7468 6520 6e75 6d62 6572  m and the number
-00011070: 206f 6620 6f66 2072 6f77 7320 2620 636f   of of rows & co
-00011080: 6c75 6d6e 730d 0a20 2020 2020 2020 2062  lumns..        b
-00011090: 6574 7765 656e 2074 776f 2072 6173 7465  etween two raste
-000110a0: 7273 0d0a 2020 2020 2020 2020 616c 6967  rs..        alig
-000110b0: 6e6d 656e 745f 7372 6320 6973 2074 6865  nment_src is the
-000110c0: 2073 6f75 7263 6520 6f66 2074 6865 2063   source of the c
-000110d0: 6f6f 7264 696e 6174 6520 7379 7374 656d  oordinate system
-000110e0: 2c20 6e75 6d62 6572 206f 6620 726f 7773  , number of rows
-000110f0: 2c20 6e75 6d62 6572 206f 6620 636f 6c75  , number of colu
-00011100: 6d6e 7320 2620 6365 6c6c 2073 697a 650d  mns & cell size.
-00011110: 0a20 2020 2020 2020 2064 6174 615f 7372  .        data_sr
-00011120: 6320 6973 2074 6865 2073 6f75 7263 6520  c is the source 
-00011130: 6f66 2064 6174 6120 7661 6c75 6573 2069  of data values i
-00011140: 6e20 6365 6c6c 730d 0a20 2020 2020 2020  n cells..       
-00011150: 2074 6865 2072 6573 756c 7420 7769 6c6c   the result will
-00011160: 2062 6520 6120 7261 7374 6572 2077 6974   be a raster wit
-00011170: 6820 7468 6520 7361 6d65 2073 7472 7563  h the same struc
-00011180: 7475 7265 206c 696b 6520 616c 6967 6e6d  ture like alignm
-00011190: 656e 745f 7372 6320 6275 7420 7769 7468  ent_src but with
-000111a0: 0d0a 2020 2020 2020 2020 7661 6c75 6573  ..        values
-000111b0: 2066 726f 6d20 6461 7461 5f73 7263 2075   from data_src u
-000111c0: 7369 6e67 204e 6561 7265 7374 204e 6569  sing Nearest Nei
-000111d0: 6768 626f 7572 2069 6e74 6572 706f 6c61  ghbour interpola
-000111e0: 7469 6f6e 2061 6c67 6f72 6974 686d 0d0a  tion algorithm..
-000111f0: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-00011200: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
-00011210: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-00011220: 2020 616c 6967 6e6d 656e 745f 7372 6320    alignment_src 
-00011230: 3a20 5b67 6461 6c2e 6461 7461 7365 742f  : [gdal.dataset/
-00011240: 7374 7269 6e67 5d0d 0a20 2020 2020 2020  string]..       
-00011250: 2020 2020 2073 7061 7469 616c 2069 6e66       spatial inf
-00011260: 6f72 6d61 7469 6f6e 2073 6f75 7263 6520  ormation source 
-00011270: 7261 7374 6572 2074 6f20 6765 7420 7468  raster to get th
-00011280: 6520 7370 6174 6961 6c20 696e 666f 726d  e spatial inform
-00011290: 6174 696f 6e0d 0a20 2020 2020 2020 2020  ation..         
-000112a0: 2020 2028 636f 6f72 6469 6e61 7465 2073     (coordinate s
-000112b0: 7973 7465 6d2c 206e 6f20 6f66 2072 6f77  ystem, no of row
-000112c0: 7320 2620 636f 6c75 6d6e 7329 0d0a 2020  s & columns)..  
-000112d0: 2020 2020 2020 6461 7461 5f73 7263 203a        data_src :
-000112e0: 205b 6764 616c 2e64 6174 6173 6574 2f73   [gdal.dataset/s
-000112f0: 7472 696e 675d 0d0a 2020 2020 2020 2020  tring]..        
-00011300: 2020 2020 6461 7461 2076 616c 7565 7320      data values 
-00011310: 736f 7572 6365 2072 6173 7465 7220 746f  source raster to
-00011320: 2067 6574 2074 6865 2064 6174 6120 2876   get the data (v
-00011330: 616c 7565 7320 6f66 2065 6163 6820 6365  alues of each ce
-00011340: 6c6c 290d 0a0d 0a20 2020 2020 2020 2052  ll)....        R
-00011350: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
-00011360: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00011370: 2064 7374 203a 205b 6764 616c 2e64 6174   dst : [gdal.dat
-00011380: 6173 6574 5d0d 0a20 2020 2020 2020 2020  aset]..         
-00011390: 2020 2072 6573 756c 7420 7261 7374 6572     result raster
-000113a0: 2069 6e20 6d65 6d6f 7279 0d0a 0d0a 2020   in memory....  
-000113b0: 2020 2020 2020 4578 616d 706c 6573 0d0a        Examples..
-000113c0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-000113d0: 0d0a 2020 2020 2020 2020 3e3e 3e20 4120  ..        >>> A 
-000113e0: 3d20 6764 616c 2e4f 7065 6e28 2265 7861  = gdal.Open("exa
-000113f0: 6d70 6c65 732f 4749 532f 6461 7461 2f61  mples/GIS/data/a
-00011400: 6363 3430 3030 2e74 6966 2229 0d0a 2020  cc4000.tif")..  
-00011410: 2020 2020 2020 3e3e 3e20 4220 3d20 6764        >>> B = gd
-00011420: 616c 2e4f 7065 6e28 2265 7861 6d70 6c65  al.Open("example
-00011430: 732f 4749 532f 6461 7461 2f73 6f69 6c5f  s/GIS/data/soil_
-00011440: 7261 7374 6572 2e74 6966 2229 0d0a 2020  raster.tif")..  
-00011450: 2020 2020 2020 3e3e 3e20 5261 7374 6572        >>> Raster
-00011460: 424d 6174 6368 6564 203d 2052 6173 7465  BMatched = Raste
-00011470: 722e 6d61 7463 6852 6173 7465 7241 6c69  r.matchRasterAli
-00011480: 676e 6d65 6e74 2841 2c42 290d 0a20 2020  gnment(A,B)..   
-00011490: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-000114a0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-000114b0: 616c 6967 6e6d 656e 745f 7372 632c 2067  alignment_src, g
-000114c0: 6461 6c2e 4461 7461 7365 7429 3a0d 0a20  dal.Dataset):.. 
-000114d0: 2020 2020 2020 2020 2020 2073 7263 203d             src =
-000114e0: 2061 6c69 676e 6d65 6e74 5f73 7263 0d0a   alignment_src..
-000114f0: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
-00011500: 6e73 7461 6e63 6528 616c 6967 6e6d 656e  nstance(alignmen
-00011510: 745f 7372 632c 2073 7472 293a 0d0a 2020  t_src, str):..  
-00011520: 2020 2020 2020 2020 2020 7372 6320 3d20            src = 
-00011530: 6764 616c 2e4f 7065 6e28 616c 6967 6e6d  gdal.Open(alignm
-00011540: 656e 745f 7372 6329 0d0a 2020 2020 2020  ent_src)..      
-00011550: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-00011560: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-00011570: 7272 6f72 280d 0a20 2020 2020 2020 2020  rror(..         
-00011580: 2020 2020 2020 2022 4669 7273 7420 7061         "First pa
-00011590: 7261 6d65 7465 7220 7368 6f75 6c64 2062  rameter should b
-000115a0: 6520 6120 7261 7374 6572 2072 6561 6420  e a raster read 
-000115b0: 7573 696e 6720 6764 616c 2028 6764 616c  using gdal (gdal
-000115c0: 2064 6174 6173 6574 2070 6c65 6173 6520   dataset please 
-000115d0: 7265 6164 2069 7420 220d 0a20 2020 2020  read it "..     
-000115e0: 2020 2020 2020 2020 2020 2066 2275 7369             f"usi
-000115f0: 6e67 2067 6461 6c20 6c69 6272 6172 7929  ng gdal library)
-00011600: 206f 7220 6120 7061 7468 2074 6f20 7468   or a path to th
-00011610: 6520 7261 7374 6572 2c20 6769 7665 6e20  e raster, given 
-00011620: 7b74 7970 6528 616c 6967 6e6d 656e 745f  {type(alignment_
-00011630: 7372 6329 7d22 0d0a 2020 2020 2020 2020  src)}"..        
-00011640: 2020 2020 290d 0a0d 0a20 2020 2020 2020      )....       
-00011650: 2069 6620 6973 696e 7374 616e 6365 2864   if isinstance(d
-00011660: 6174 615f 7372 632c 2067 6461 6c2e 4461  ata_src, gdal.Da
-00011670: 7461 7365 7429 3a0d 0a20 2020 2020 2020  taset):..       
-00011680: 2020 2020 2052 6173 7465 7242 203d 2064       RasterB = d
-00011690: 6174 615f 7372 630d 0a20 2020 2020 2020  ata_src..       
-000116a0: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
-000116b0: 2864 6174 615f 7372 632c 2073 7472 293a  (data_src, str):
-000116c0: 0d0a 2020 2020 2020 2020 2020 2020 5261  ..            Ra
-000116d0: 7374 6572 4220 3d20 6764 616c 2e4f 7065  sterB = gdal.Ope
-000116e0: 6e28 6461 7461 5f73 7263 290d 0a20 2020  n(data_src)..   
-000116f0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-00011700: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
-00011710: 7065 4572 726f 7228 0d0a 2020 2020 2020  peError(..      
-00011720: 2020 2020 2020 2020 2020 2253 6563 6f6e            "Secon
-00011730: 6420 7061 7261 6d65 7465 7220 7368 6f75  d parameter shou
-00011740: 6c64 2062 6520 6120 7261 7374 6572 2072  ld be a raster r
-00011750: 6561 6420 7573 696e 6720 6764 616c 2028  ead using gdal (
-00011760: 6764 616c 2064 6174 6173 6574 2070 6c65  gdal dataset ple
-00011770: 6173 6520 7265 6164 2069 7420 220d 0a20  ase read it ".. 
-00011780: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00011790: 2275 7369 6e67 2067 6461 6c20 6c69 6272  "using gdal libr
-000117a0: 6172 7929 206f 7220 6120 7061 7468 2074  ary) or a path t
-000117b0: 6f20 7468 6520 7261 7374 6572 2c20 6769  o the raster, gi
-000117c0: 7665 6e20 7b74 7970 6528 6461 7461 5f73  ven {type(data_s
-000117d0: 7263 297d 220d 0a20 2020 2020 2020 2020  rc)}"..         
-000117e0: 2020 2029 0d0a 0d0a 2020 2020 2020 2020     )....        
-000117f0: 2320 7765 206e 6565 6420 6e75 6d62 6572  # we need number
-00011800: 206f 6620 726f 7773 2061 6e64 2063 6f6c   of rows and col
-00011810: 7320 6672 6f6d 2073 7263 2041 2061 6e64  s from src A and
-00011820: 2064 6174 6120 6672 6f6d 2073 7263 2042   data from src B
-00011830: 2074 6f20 7374 6f72 6520 626f 7468 2069   to store both i
-00011840: 6e20 6473 740d 0a20 2020 2020 2020 2063  n dst..        c
-00011850: 6f6c 732c 2072 6f77 732c 2070 726a 2c20  ols, rows, prj, 
-00011860: 6261 6e64 732c 2067 742c 206e 6f5f 6461  bands, gt, no_da
-00011870: 7461 5f76 616c 7565 2c20 6474 7970 6573  ta_value, dtypes
-00011880: 203d 2052 6173 7465 722e 6765 7452 6173   = Raster.getRas
-00011890: 7465 7244 6574 6169 6c73 2873 7263 290d  terDetails(src).
-000118a0: 0a0d 0a20 2020 2020 2020 2073 7263 5f73  ...        src_s
-000118b0: 7220 3d20 6f73 722e 5370 6174 6961 6c52  r = osr.SpatialR
-000118c0: 6566 6572 656e 6365 2877 6b74 3d70 726a  eference(wkt=prj
-000118d0: 290d 0a20 2020 2020 2020 2073 7263 5f65  )..        src_e
-000118e0: 7073 6720 3d20 696e 7428 7372 635f 7372  psg = int(src_sr
-000118f0: 2e47 6574 4174 7472 5661 6c75 6528 2241  .GetAttrValue("A
-00011900: 5554 484f 5249 5459 222c 2031 2929 0d0a  UTHORITY", 1))..
-00011910: 0d0a 2020 2020 2020 2020 2320 7265 7072  ..        # repr
-00011920: 6f6a 6563 7420 7468 6520 5261 7374 6572  oject the Raster
-00011930: 4220 746f 206d 6174 6368 2074 6865 2070  B to match the p
-00011940: 726f 6a65 6374 696f 6e20 6f66 2061 6c69  rojection of ali
-00011950: 676e 6d65 6e74 5f73 7263 0d0a 2020 2020  gnment_src..    
-00011960: 2020 2020 7265 7072 6f6a 6563 7465 645f      reprojected_
-00011970: 5261 7374 6572 4220 3d20 5261 7374 6572  RasterB = Raster
-00011980: 2e70 726f 6a65 6374 5261 7374 6572 2852  .projectRaster(R
-00011990: 6173 7465 7242 2c20 7372 635f 6570 7367  asterB, src_epsg
-000119a0: 290d 0a0d 0a20 2020 2020 2020 2023 2063  )....        # c
-000119b0: 7265 6174 6520 6120 6e65 7720 7261 7374  reate a new rast
-000119c0: 6572 0d0a 2020 2020 2020 2020 6473 7420  er..        dst 
-000119d0: 3d20 5261 7374 6572 2e5f 6372 6561 7465  = Raster._create
-000119e0: 4461 7461 7365 7428 636f 6c73 2c20 726f  Dataset(cols, ro
-000119f0: 7773 2c20 312c 2064 7479 7065 735b 305d  ws, 1, dtypes[0]
-00011a00: 2c20 6472 6976 6572 3d22 4d45 4d22 290d  , driver="MEM").
-00011a10: 0a20 2020 2020 2020 2023 2073 6574 2074  .        # set t
-00011a20: 6865 2067 656f 7472 616e 7366 6f72 6d0d  he geotransform.
-00011a30: 0a20 2020 2020 2020 2064 7374 2e53 6574  .        dst.Set
-00011a40: 4765 6f54 7261 6e73 666f 726d 2867 7429  GeoTransform(gt)
-00011a50: 0d0a 2020 2020 2020 2020 2320 7365 7420  ..        # set 
-00011a60: 7468 6520 7072 6f6a 6563 7469 6f6e 0d0a  the projection..
-00011a70: 2020 2020 2020 2020 6473 742e 5365 7450          dst.SetP
-00011a80: 726f 6a65 6374 696f 6e28 7372 635f 7372  rojection(src_sr
-00011a90: 2e45 7870 6f72 7454 6f57 6b74 2829 290d  .ExportToWkt()).
-00011aa0: 0a20 2020 2020 2020 2023 2073 6574 2074  .        # set t
-00011ab0: 6865 206e 6f20 6461 7461 2076 616c 7565  he no data value
-00011ac0: 0d0a 2020 2020 2020 2020 6e6f 5f64 6174  ..        no_dat
-00011ad0: 615f 7661 6c75 6520 3d20 7372 632e 4765  a_value = src.Ge
-00011ae0: 7452 6173 7465 7242 616e 6428 3129 2e47  tRasterBand(1).G
-00011af0: 6574 4e6f 4461 7461 5661 6c75 6528 290d  etNoDataValue().
-00011b00: 0a20 2020 2020 2020 2064 7374 203d 2052  .        dst = R
-00011b10: 6173 7465 722e 7365 744e 6f44 6174 6156  aster.setNoDataV
-00011b20: 616c 7565 2864 7374 2c20 6e6f 5f64 6174  alue(dst, no_dat
-00011b30: 615f 7661 6c75 6529 0d0a 2020 2020 2020  a_value)..      
-00011b40: 2020 2320 7065 7266 6f72 6d20 7468 6520    # perform the 
-00011b50: 7072 6f6a 6563 7469 6f6e 2026 2072 6573  projection & res
-00011b60: 616d 706c 696e 670d 0a20 2020 2020 2020  ampling..       
-00011b70: 2072 6573 616d 706c 655f 7465 6368 6e69   resample_techni
-00011b80: 7175 6520 3d20 6764 616c 2e47 5241 5f4e  que = gdal.GRA_N
-00011b90: 6561 7265 7374 4e65 6967 6862 6f75 720d  earestNeighbour.
-00011ba0: 0a20 2020 2020 2020 2023 2072 6573 616d  .        # resam
-00011bb0: 706c 6520 7468 6520 7265 7072 6f6a 6563  ple the reprojec
-00011bc0: 7465 645f 5261 7374 6572 420d 0a20 2020  ted_RasterB..   
-00011bd0: 2020 2020 2067 6461 6c2e 5265 7072 6f6a       gdal.Reproj
-00011be0: 6563 7449 6d61 6765 280d 0a20 2020 2020  ectImage(..     
-00011bf0: 2020 2020 2020 2072 6570 726f 6a65 6374         reproject
-00011c00: 6564 5f52 6173 7465 7242 2c0d 0a20 2020  ed_RasterB,..   
-00011c10: 2020 2020 2020 2020 2064 7374 2c0d 0a20           dst,.. 
-00011c20: 2020 2020 2020 2020 2020 2073 7263 5f73             src_s
-00011c30: 722e 4578 706f 7274 546f 576b 7428 292c  r.ExportToWkt(),
-00011c40: 0d0a 2020 2020 2020 2020 2020 2020 7372  ..            sr
-00011c50: 635f 7372 2e45 7870 6f72 7454 6f57 6b74  c_sr.ExportToWkt
-00011c60: 2829 2c0d 0a20 2020 2020 2020 2020 2020  (),..           
-00011c70: 2072 6573 616d 706c 655f 7465 6368 6e69   resample_techni
-00011c80: 7175 652c 0d0a 2020 2020 2020 2020 290d  que,..        ).
-00011c90: 0a0d 0a20 2020 2020 2020 2072 6574 7572  ...        retur
-00011ca0: 6e20 6473 740d 0a0d 0a20 2020 2040 7374  n dst....    @st
-00011cb0: 6174 6963 6d65 7468 6f64 0d0a 2020 2020  aticmethod..    
-00011cc0: 6465 6620 6e65 6172 6573 744e 6569 6768  def nearestNeigh
-00011cd0: 626f 7572 280d 0a20 2020 2020 2020 2061  bour(..        a
-00011ce0: 7272 6179 3a20 6e70 2e6e 6461 7272 6179  rray: np.ndarray
-00011cf0: 2c20 6e6f 6461 7461 7661 6c75 653a 2055  , nodatavalue: U
-00011d00: 6e69 6f6e 5b66 6c6f 6174 2c20 696e 745d  nion[float, int]
-00011d10: 2c20 726f 7773 3a20 6c69 7374 2c20 636f  , rows: list, co
-00011d20: 6c73 3a20 6c69 7374 0d0a 2020 2020 2920  ls: list..    ) 
-00011d30: 2d3e 206e 702e 6e64 6172 7261 793a 0d0a  -> np.ndarray:..
-00011d40: 2020 2020 2020 2020 2222 226e 6561 7265          """neare
-00011d50: 7374 4e65 6967 6862 6f75 722e 0d0a 0d0a  stNeighbour.....
-00011d60: 2020 2020 2020 2020 2020 2020 2d20 6e65              - ne
-00011d70: 6172 6573 744e 6569 6768 626f 7572 2066  arestNeighbour f
-00011d80: 696c 6c73 2074 6865 2063 656c 6c73 206f  ills the cells o
-00011d90: 6620 6120 6769 7665 6e20 696e 6469 6365  f a given indice
-00011da0: 7320 696e 2072 6f77 7320 616e 6420 636f  s in rows and co
-00011db0: 6c73 2077 6974 6820 7468 6520 7661 6c75  ls with the valu
-00011dc0: 6520 6f66 2074 6865 206e 6561 7265 7374  e of the nearest
-00011dd0: 0d0a 2020 2020 2020 2020 2020 2020 6e65  ..            ne
-00011de0: 6967 6862 6f75 722e 0d0a 2020 2020 2020  ighbour...      
-00011df0: 2020 2020 2020 2d20 5373 2074 6865 2072        - Ss the r
-00011e00: 6173 7465 7220 6772 6964 2069 7320 7371  aster grid is sq
-00011e10: 7561 7265 2073 6f20 7468 6520 3420 7065  uare so the 4 pe
-00011e20: 7270 656e 6469 6375 6c61 7220 6469 7265  rpendicular dire
-00011e30: 6374 696f 6e20 6172 6520 6f66 2074 6865  ction are of the
-00011e40: 2073 616d 6520 636c 6f73 6520 736f 2074   same close so t
-00011e50: 6865 2066 756e 6374 696f 6e0d 0a20 2020  he function..   
-00011e60: 2020 2020 2020 2020 2067 6976 6573 2070           gives p
-00011e70: 7269 6f72 6974 7920 746f 2074 6865 2072  riority to the r
-00011e80: 6967 6874 2074 6865 6e20 6c65 6674 2074  ight then left t
-00011e90: 6865 6e20 626f 7474 6f6d 2074 6865 6e20  hen bottom then 
-00011ea0: 746f 7020 616e 6420 7468 6520 7361 6d65  top and the same
-00011eb0: 2066 6f72 2034 3520 6465 6772 6565 2069   for 45 degree i
-00011ec0: 6e63 6c69 6e65 6420 6469 7265 6374 696f  nclined directio
-00011ed0: 6e0d 0a20 2020 2020 2020 2020 2020 2072  n..            r
-00011ee0: 6967 6874 2062 6f74 746f 6d20 7468 656e  ight bottom then
-00011ef0: 206c 6566 7420 626f 7474 6f6d 2074 6865   left bottom the
-00011f00: 6e20 6c65 6674 2054 6f70 2074 6865 6e20  n left Top then 
-00011f10: 7269 6768 7420 546f 702e 0d0a 0d0a 2020  right Top.....  
-00011f20: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-00011f30: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00011f40: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6172  ----..        ar
-00011f50: 7261 793a 205b 6e75 6d70 792e 6172 7261  ray: [numpy.arra
-00011f60: 795d 0d0a 2020 2020 2020 2020 2020 2020  y]..            
-00011f70: 4172 7261 7920 746f 2066 696c 6c20 736f  Array to fill so
-00011f80: 6d65 206f 6620 6974 7320 6365 6c6c 7320  me of its cells 
-00011f90: 7769 7468 204e 6561 7265 7374 2076 616c  with Nearest val
-00011fa0: 7565 2e0d 0a20 2020 2020 2020 206e 6f64  ue...        nod
-00011fb0: 6174 6176 616c 7565 3a20 5b66 6c6f 6174  atavalue: [float
-00011fc0: 3332 5d0d 0a20 2020 2020 2020 2020 2020  32]..           
-00011fd0: 2076 616c 7565 2073 746f 7265 6420 696e   value stored in
-00011fe0: 2063 656c 6c73 2074 6861 7420 6973 206f   cells that is o
-00011ff0: 7574 206f 6620 7468 6520 646f 6d61 696e  ut of the domain
-00012000: 0d0a 2020 2020 2020 2020 726f 7773 3a20  ..        rows: 
-00012010: 5b4c 6973 745d 0d0a 2020 2020 2020 2020  [List]..        
-00012020: 2020 2020 6c69 7374 206f 6620 7468 6520      list of the 
-00012030: 726f 7720 696e 6465 7820 6f66 2074 6865  row index of the
-00012040: 2063 656c 6c73 2079 6f75 2077 616e 7420   cells you want 
-00012050: 746f 2066 696c 6c20 6974 2077 6974 680d  to fill it with.
-00012060: 0a20 2020 2020 2020 2020 2020 206e 6561  .            nea
-00012070: 7265 7374 206e 6569 6768 626f 7572 2e0d  rest neighbour..
-00012080: 0a20 2020 2020 2020 2063 6f6c 733a 205b  .        cols: [
-00012090: 4c69 7374 5d0d 0a20 2020 2020 2020 2020  List]..         
-000120a0: 2020 206c 6973 7420 6f66 2074 6865 2063     list of the c
-000120b0: 6f6c 756d 6e20 696e 6465 7820 6f66 2074  olumn index of t
-000120c0: 6865 2063 656c 6c73 2079 6f75 2077 616e  he cells you wan
-000120d0: 7420 746f 2066 696c 6c20 6974 2077 6974  t to fill it wit
-000120e0: 680d 0a20 2020 2020 2020 2020 2020 206e  h..            n
-000120f0: 6561 7265 7374 206e 6569 6768 626f 7572  earest neighbour
-00012100: 2e0d 0a0d 0a20 2020 2020 2020 2052 6574  .....        Ret
-00012110: 7572 6e73 0d0a 2020 2020 2020 2020 2d2d  urns..        --
-00012120: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2061  -----..        a
-00012130: 7272 6179 3a20 5b6e 756d 7079 2061 7272  rray: [numpy arr
-00012140: 6179 5d0d 0a20 2020 2020 2020 2020 2020  ay]..           
-00012150: 2043 656c 6c73 206f 6620 6769 7665 6e20   Cells of given 
-00012160: 696e 6469 6365 7320 7769 6c6c 2062 6520  indices will be 
-00012170: 6669 6c6c 6564 2077 6974 6820 7661 6c75  filled with valu
-00012180: 6520 6f66 2074 6865 204e 6561 7265 7374  e of the Nearest
-00012190: 206e 6569 6768 626f 7572 0d0a 0d0a 2020   neighbour....  
-000121a0: 2020 2020 2020 4578 616d 706c 6573 0d0a        Examples..
-000121b0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-000121c0: 0d0a 2020 2020 2020 2020 3e3e 3e20 7261  ..        >>> ra
-000121d0: 7374 6572 203d 2067 6461 6c2e 4f70 656e  ster = gdal.Open
-000121e0: 2822 6465 6d2e 7469 6622 290d 0a20 2020  ("dem.tif")..   
-000121f0: 2020 2020 203e 3e3e 2072 6571 5f72 6f77       >>> req_row
-00012200: 7320 3d20 5b33 2c31 325d 0d0a 2020 2020  s = [3,12]..    
-00012210: 2020 2020 3e3e 3e20 7265 715f 636f 6c73      >>> req_cols
-00012220: 203d 205b 392c 325d 0d0a 2020 2020 2020   = [9,2]..      
-00012230: 2020 3e3e 3e20 6e65 775f 6172 7261 7920    >>> new_array 
-00012240: 3d20 5261 7374 6572 2e6e 6561 7265 7374  = Raster.nearest
-00012250: 4e65 6967 6862 6f75 7228 7261 7374 6572  Neighbour(raster
-00012260: 2c20 7265 715f 726f 7773 2c20 7265 715f  , req_rows, req_
-00012270: 636f 6c73 290d 0a20 2020 2020 2020 2022  cols)..        "
-00012280: 2222 0d0a 2020 2020 2020 2020 6966 206e  ""..        if n
-00012290: 6f74 2069 7369 6e73 7461 6e63 6528 6172  ot isinstance(ar
-000122a0: 7261 792c 206e 702e 6e64 6172 7261 7929  ray, np.ndarray)
-000122b0: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
-000122c0: 6169 7365 2054 7970 6545 7272 6f72 280d  aise TypeError(.
-000122d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000122e0: 2022 7372 6320 7368 6f75 6c64 2062 6520   "src should be 
-000122f0: 7265 6164 2075 7369 6e67 2067 6461 6c20  read using gdal 
-00012300: 2867 6461 6c20 6461 7461 7365 7420 706c  (gdal dataset pl
-00012310: 6561 7365 2072 6561 6420 6974 2075 7369  ease read it usi
-00012320: 6e67 2067 6461 6c20 6c69 6272 6172 7929  ng gdal library)
-00012330: 2022 0d0a 2020 2020 2020 2020 2020 2020   "..            
-00012340: 290d 0a20 2020 2020 2020 2069 6620 6e6f  )..        if no
-00012350: 7420 6973 696e 7374 616e 6365 2872 6f77  t isinstance(row
-00012360: 732c 206c 6973 7429 3a0d 0a20 2020 2020  s, list):..     
-00012370: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
-00012380: 6545 7272 6f72 2822 726f 7773 2069 6e70  eError("rows inp
-00012390: 7574 2068 6173 2074 6f20 6265 206f 6620  ut has to be of 
-000123a0: 7479 7065 206c 6973 7422 290d 0a20 2020  type list")..   
-000123b0: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
-000123c0: 7374 616e 6365 2863 6f6c 732c 206c 6973  stance(cols, lis
-000123d0: 7429 3a0d 0a20 2020 2020 2020 2020 2020  t):..           
-000123e0: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
-000123f0: 2822 636f 6c73 2069 6e70 7574 2068 6173  ("cols input has
-00012400: 2074 6f20 6265 206f 6620 7479 7065 206c   to be of type l
-00012410: 6973 7422 290d 0a0d 0a20 2020 2020 2020  ist")....       
-00012420: 2023 2020 2020 6172 7261 793d 7261 7374   #    array=rast
-00012430: 6572 2e52 6561 6441 7341 7272 6179 2829  er.ReadAsArray()
-00012440: 0d0a 2020 2020 2020 2020 2320 2020 206e  ..        #    n
-00012450: 6f64 6174 6176 616c 7565 3d6e 702e 666c  odatavalue=np.fl
-00012460: 6f61 7433 3228 7261 7374 6572 2e47 6574  oat32(raster.Get
-00012470: 5261 7374 6572 4261 6e64 2831 292e 4765  RasterBand(1).Ge
-00012480: 744e 6f44 6174 6156 616c 7565 2829 290d  tNoDataValue()).
-00012490: 0a0d 0a20 2020 2020 2020 206e 6f5f 726f  ...        no_ro
-000124a0: 7773 203d 206e 702e 7368 6170 6528 6172  ws = np.shape(ar
-000124b0: 7261 7929 5b30 5d0d 0a0d 0a20 2020 2020  ray)[0]....     
-000124c0: 2020 206e 6f5f 636f 6c73 203d 206e 702e     no_cols = np.
-000124d0: 7368 6170 6528 6172 7261 7929 5b31 5d0d  shape(array)[1].
-000124e0: 0a0d 0a20 2020 2020 2020 2066 6f72 2069  ...        for i
-000124f0: 2069 6e20 7261 6e67 6528 6c65 6e28 726f   in range(len(ro
-00012500: 7773 2929 3a0d 0a20 2020 2020 2020 2020  ws)):..         
-00012510: 2020 2023 2067 6976 6520 7468 6520 6365     # give the ce
-00012520: 6c6c 2074 6865 2076 616c 7565 206f 6620  ll the value of 
-00012530: 7468 6520 6365 6c6c 2074 6861 7420 6973  the cell that is
-00012540: 2061 7420 7468 6520 7269 6768 740d 0a20   at the right.. 
-00012550: 2020 2020 2020 2020 2020 2069 6620 6172             if ar
-00012560: 7261 795b 726f 7773 5b69 5d2c 2063 6f6c  ray[rows[i], col
-00012570: 735b 695d 202b 2031 5d20 213d 206e 6f64  s[i] + 1] != nod
-00012580: 6174 6176 616c 7565 2061 6e64 2063 6f6c  atavalue and col
-00012590: 735b 695d 202b 2031 203c 3d20 6e6f 5f63  s[i] + 1 <= no_c
-000125a0: 6f6c 733a 0d0a 2020 2020 2020 2020 2020  ols:..          
-000125b0: 2020 2020 2020 6172 7261 795b 726f 7773        array[rows
-000125c0: 5b69 5d2c 2063 6f6c 735b 695d 5d20 3d20  [i], cols[i]] = 
-000125d0: 6172 7261 795b 726f 7773 5b69 5d2c 2063  array[rows[i], c
-000125e0: 6f6c 735b 695d 202b 2031 5d0d 0a0d 0a20  ols[i] + 1].... 
-000125f0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-00012600: 6172 7261 795b 726f 7773 5b69 5d2c 2063  array[rows[i], c
-00012610: 6f6c 735b 695d 202d 2031 5d20 213d 206e  ols[i] - 1] != n
-00012620: 6f64 6174 6176 616c 7565 2061 6e64 2063  odatavalue and c
-00012630: 6f6c 735b 695d 202d 2031 203e 2030 3a0d  ols[i] - 1 > 0:.
-00012640: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012650: 2023 2067 6976 6520 7468 6520 6365 6c6c   # give the cell
-00012660: 2074 6865 2076 616c 7565 206f 6620 7468   the value of th
-00012670: 6520 6365 6c6c 2074 6861 7420 6973 2061  e cell that is a
-00012680: 7420 7468 6520 6c65 6674 0d0a 2020 2020  t the left..    
-00012690: 2020 2020 2020 2020 2020 2020 6172 7261              arra
-000126a0: 795b 726f 7773 5b69 5d2c 2063 6f6c 735b  y[rows[i], cols[
-000126b0: 695d 5d20 3d20 6172 7261 795b 726f 7773  i]] = array[rows
-000126c0: 5b69 5d2c 2063 6f6c 735b 695d 202d 2031  [i], cols[i] - 1
-000126d0: 5d0d 0a0d 0a20 2020 2020 2020 2020 2020  ]....           
-000126e0: 2065 6c69 6620 6172 7261 795b 726f 7773   elif array[rows
-000126f0: 5b69 5d20 2d20 312c 2063 6f6c 735b 695d  [i] - 1, cols[i]
-00012700: 5d20 213d 206e 6f64 6174 6176 616c 7565  ] != nodatavalue
-00012710: 2061 6e64 2072 6f77 735b 695d 202d 2031   and rows[i] - 1
-00012720: 203e 2030 3a0d 0a20 2020 2020 2020 2020   > 0:..         
-00012730: 2020 2020 2020 2023 2067 6976 6520 7468         # give th
-00012740: 6520 6365 6c6c 2074 6865 2076 616c 7565  e cell the value
-00012750: 206f 6620 7468 6520 6365 6c6c 2074 6861   of the cell tha
-00012760: 7420 6973 2061 7420 7468 6520 626f 7474  t is at the bott
-00012770: 6f6d 0d0a 2020 2020 2020 2020 2020 2020  om..            
-00012780: 2020 2020 6172 7261 795b 726f 7773 5b69      array[rows[i
-00012790: 5d2c 2063 6f6c 735b 695d 5d20 3d20 6172  ], cols[i]] = ar
-000127a0: 7261 795b 726f 7773 5b69 5d20 2d20 312c  ray[rows[i] - 1,
-000127b0: 2063 6f6c 735b 695d 5d0d 0a0d 0a20 2020   cols[i]]....   
-000127c0: 2020 2020 2020 2020 2065 6c69 6620 6172           elif ar
-000127d0: 7261 795b 726f 7773 5b69 5d20 2b20 312c  ray[rows[i] + 1,
-000127e0: 2063 6f6c 735b 695d 5d20 213d 206e 6f64   cols[i]] != nod
-000127f0: 6174 6176 616c 7565 2061 6e64 2072 6f77  atavalue and row
-00012800: 735b 695d 202b 2031 203c 3d20 6e6f 5f72  s[i] + 1 <= no_r
-00012810: 6f77 733a 0d0a 2020 2020 2020 2020 2020  ows:..          
-00012820: 2020 2020 2020 2320 6769 7665 2074 6865        # give the
-00012830: 2063 656c 6c20 7468 6520 7661 6c75 6520   cell the value 
-00012840: 6f66 2074 6865 2063 656c 6c20 7468 6174  of the cell that
-00012850: 2069 7320 6174 2074 6865 2054 6f70 0d0a   is at the Top..
-00012860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012870: 6172 7261 795b 726f 7773 5b69 5d2c 2063  array[rows[i], c
-00012880: 6f6c 735b 695d 5d20 3d20 6172 7261 795b  ols[i]] = array[
-00012890: 726f 7773 5b69 5d20 2b20 312c 2063 6f6c  rows[i] + 1, col
-000128a0: 735b 695d 5d0d 0a0d 0a20 2020 2020 2020  s[i]]....       
-000128b0: 2020 2020 2065 6c69 6620 280d 0a20 2020       elif (..   
-000128c0: 2020 2020 2020 2020 2020 2020 2061 7272               arr
-000128d0: 6179 5b72 6f77 735b 695d 202d 2031 2c20  ay[rows[i] - 1, 
-000128e0: 636f 6c73 5b69 5d20 2b20 315d 2021 3d20  cols[i] + 1] != 
-000128f0: 6e6f 6461 7461 7661 6c75 650d 0a20 2020  nodatavalue..   
-00012900: 2020 2020 2020 2020 2020 2020 2061 6e64               and
-00012910: 2072 6f77 735b 695d 202d 2031 203e 2030   rows[i] - 1 > 0
-00012920: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00012930: 2020 616e 6420 636f 6c73 5b69 5d20 2b20    and cols[i] + 
-00012940: 3120 3c3d 206e 6f5f 636f 6c73 0d0a 2020  1 <= no_cols..  
-00012950: 2020 2020 2020 2020 2020 293a 0d0a 2020            ):..  
-00012960: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00012970: 6769 7665 2074 6865 2063 656c 6c20 7468  give the cell th
-00012980: 6520 7661 6c75 6520 6f66 2074 6865 2063  e value of the c
-00012990: 656c 6c20 7468 6174 2069 7320 6174 2074  ell that is at t
-000129a0: 6865 2072 6967 6874 2062 6f74 746f 6d0d  he right bottom.
-000129b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000129c0: 2061 7272 6179 5b72 6f77 735b 695d 2c20   array[rows[i], 
-000129d0: 636f 6c73 5b69 5d5d 203d 2061 7272 6179  cols[i]] = array
-000129e0: 5b72 6f77 735b 695d 202d 2031 2c20 636f  [rows[i] - 1, co
-000129f0: 6c73 5b69 5d20 2b20 315d 0d0a 0d0a 2020  ls[i] + 1]....  
-00012a00: 2020 2020 2020 2020 2020 656c 6966 2028            elif (
-00012a10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00012a20: 2020 6172 7261 795b 726f 7773 5b69 5d20    array[rows[i] 
-00012a30: 2d20 312c 2063 6f6c 735b 695d 202d 2031  - 1, cols[i] - 1
-00012a40: 5d20 213d 206e 6f64 6174 6176 616c 7565  ] != nodatavalue
-00012a50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00012a60: 2020 616e 6420 726f 7773 5b69 5d20 2d20    and rows[i] - 
-00012a70: 3120 3e20 300d 0a20 2020 2020 2020 2020  1 > 0..         
-00012a80: 2020 2020 2020 2061 6e64 2063 6f6c 735b         and cols[
-00012a90: 695d 202d 2031 203e 2030 0d0a 2020 2020  i] - 1 > 0..    
-00012aa0: 2020 2020 2020 2020 293a 0d0a 2020 2020          ):..    
-00012ab0: 2020 2020 2020 2020 2020 2020 2320 6769              # gi
-00012ac0: 7665 2074 6865 2063 656c 6c20 7468 6520  ve the cell the 
-00012ad0: 7661 6c75 6520 6f66 2074 6865 2063 656c  value of the cel
-00012ae0: 6c20 7468 6174 2069 7320 6174 2074 6865  l that is at the
-00012af0: 206c 6566 7420 626f 7474 6f6d 0d0a 2020   left bottom..  
-00012b00: 2020 2020 2020 2020 2020 2020 2020 6172                ar
-00012b10: 7261 795b 726f 7773 5b69 5d2c 2063 6f6c  ray[rows[i], col
-00012b20: 735b 695d 5d20 3d20 6172 7261 795b 726f  s[i]] = array[ro
-00012b30: 7773 5b69 5d20 2d20 312c 2063 6f6c 735b  ws[i] - 1, cols[
-00012b40: 695d 202d 2031 5d0d 0a0d 0a20 2020 2020  i] - 1]....     
-00012b50: 2020 2020 2020 2065 6c69 6620 280d 0a20         elif (.. 
-00012b60: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00012b70: 7272 6179 5b72 6f77 735b 695d 202b 2031  rray[rows[i] + 1
-00012b80: 2c20 636f 6c73 5b69 5d20 2d20 315d 2021  , cols[i] - 1] !
-00012b90: 3d20 6e6f 6461 7461 7661 6c75 650d 0a20  = nodatavalue.. 
-00012ba0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00012bb0: 6e64 2072 6f77 735b 695d 202b 2031 203c  nd rows[i] + 1 <
-00012bc0: 3d20 6e6f 5f72 6f77 730d 0a20 2020 2020  = no_rows..     
-00012bd0: 2020 2020 2020 2020 2020 2061 6e64 2063             and c
-00012be0: 6f6c 735b 695d 202d 2031 203e 2030 0d0a  ols[i] - 1 > 0..
-00012bf0: 2020 2020 2020 2020 2020 2020 293a 0d0a              ):..
-00012c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012c10: 2320 6769 7665 2074 6865 2063 656c 6c20  # give the cell 
-00012c20: 7468 6520 7661 6c75 6520 6f66 2074 6865  the value of the
-00012c30: 2063 656c 6c20 7468 6174 2069 7320 6174   cell that is at
-00012c40: 2074 6865 206c 6566 7420 546f 700d 0a20   the left Top.. 
-00012c50: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00012c60: 7272 6179 5b72 6f77 735b 695d 2c20 636f  rray[rows[i], co
-00012c70: 6c73 5b69 5d5d 203d 2061 7272 6179 5b72  ls[i]] = array[r
-00012c80: 6f77 735b 695d 202b 2031 2c20 636f 6c73  ows[i] + 1, cols
-00012c90: 5b69 5d20 2d20 315d 0d0a 0d0a 2020 2020  [i] - 1]....    
-00012ca0: 2020 2020 2020 2020 656c 6966 2028 0d0a          elif (..
-00012cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012cc0: 6172 7261 795b 726f 7773 5b69 5d20 2b20  array[rows[i] + 
-00012cd0: 312c 2063 6f6c 735b 695d 202b 2031 5d20  1, cols[i] + 1] 
-00012ce0: 213d 206e 6f64 6174 6176 616c 7565 0d0a  != nodatavalue..
-00012cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012d00: 616e 6420 726f 7773 5b69 5d20 2b20 3120  and rows[i] + 1 
-00012d10: 3c3d 206e 6f5f 726f 7773 0d0a 2020 2020  <= no_rows..    
-00012d20: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-00012d30: 636f 6c73 5b69 5d20 2b20 3120 3c3d 206e  cols[i] + 1 <= n
-00012d40: 6f5f 636f 6c73 0d0a 2020 2020 2020 2020  o_cols..        
-00012d50: 2020 2020 293a 0d0a 2020 2020 2020 2020      ):..        
-00012d60: 2020 2020 2020 2020 2320 6769 7665 2074          # give t
-00012d70: 6865 2063 656c 6c20 7468 6520 7661 6c75  he cell the valu
-00012d80: 6520 6f66 2074 6865 2063 656c 6c20 7468  e of the cell th
-00012d90: 6174 2069 7320 6174 2074 6865 2072 6967  at is at the rig
-00012da0: 6874 2054 6f70 0d0a 2020 2020 2020 2020  ht Top..        
-00012db0: 2020 2020 2020 2020 6172 7261 795b 726f          array[ro
-00012dc0: 7773 5b69 5d2c 2063 6f6c 735b 695d 5d20  ws[i], cols[i]] 
-00012dd0: 3d20 6172 7261 795b 726f 7773 5b69 5d20  = array[rows[i] 
-00012de0: 2b20 312c 2063 6f6c 735b 695d 202b 2031  + 1, cols[i] + 1
-00012df0: 5d0d 0a20 2020 2020 2020 2020 2020 2065  ]..            e
-00012e00: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00012e10: 2020 2020 2020 7072 696e 7428 2274 6865        print("the
-00012e20: 2063 656c 6c20 6973 2069 736f 6c61 7465   cell is isolate
-00012e30: 6420 284e 6f20 7375 7272 6f75 6e64 696e  d (No surroundin
-00012e40: 6720 6365 6c6c 7320 6578 6973 7429 2229  g cells exist)")
-00012e50: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00012e60: 2061 7272 6179 0d0a 0d0a 2020 2020 4073   array....    @s
-00012e70: 7461 7469 636d 6574 686f 640d 0a20 2020  taticmethod..   
-00012e80: 2064 6566 2072 6561 6441 5343 4949 2861   def readASCII(a
-00012e90: 7363 6969 5f66 696c 653a 2073 7472 2c20  scii_file: str, 
-00012ea0: 7069 7865 6c5f 7479 7065 3a20 696e 7420  pixel_type: int 
-00012eb0: 3d20 3129 202d 3e20 5475 706c 655b 6e70  = 1) -> Tuple[np
-00012ec0: 2e6e 6461 7272 6179 2c20 7475 706c 655d  .ndarray, tuple]
-00012ed0: 3a0d 0a20 2020 2020 2020 2022 2222 7265  :..        """re
-00012ee0: 6164 4153 4349 492e 0d0a 0d0a 2020 2020  adASCII.....    
-00012ef0: 2020 2020 2020 2020 7265 6164 4153 4349          readASCI
-00012f00: 4920 7265 6164 7320 616e 2041 5343 4949  I reads an ASCII
-00012f10: 2066 696c 650d 0a0d 0a20 2020 2020 2020   file....       
-00012f20: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-00012f30: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-00012f40: 0a20 2020 2020 2020 2061 7363 6969 5f66  .        ascii_f
-00012f50: 696c 653a 205b 7374 725d 0d0a 2020 2020  ile: [str]..    
-00012f60: 2020 2020 2020 2020 6e61 6d65 206f 6620          name of 
-00012f70: 7468 6520 4153 4349 4920 6669 6c65 2079  the ASCII file y
-00012f80: 6f75 2077 616e 7420 746f 2063 6f6e 7665  ou want to conve
-00012f90: 7274 2061 6e64 2074 6865 206e 616d 650d  rt and the name.
-00012fa0: 0a20 2020 2020 2020 2020 2020 2073 686f  .            sho
-00012fb0: 756c 6420 696e 636c 7564 6520 7468 6520  uld include the 
-00012fc0: 6578 7465 6e73 696f 6e20 222e 6173 6322  extension ".asc"
-00012fd0: 0d0a 2020 2020 2020 2020 7069 7865 6c5f  ..        pixel_
-00012fe0: 7479 7065 3a20 5b49 6e74 6567 6572 5d0d  type: [Integer].
-00012ff0: 0a20 2020 2020 2020 2020 2020 2074 7970  .            typ
-00013000: 6520 6f66 2074 6865 2064 6174 6120 746f  e of the data to
-00013010: 2062 6520 7374 6f72 6564 2069 6e20 7468   be stored in th
-00013020: 6520 7069 7865 6c73 2c64 6566 6175 6c74  e pixels,default
-00013030: 2069 7320 3120 2866 6c6f 6174 3332 290d   is 1 (float32).
-00013040: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-00013050: 2065 7861 6d70 6c65 2070 6978 656c 2074   example pixel t
-00013060: 7970 6520 6f66 2066 6c6f 7720 6469 7265  ype of flow dire
-00013070: 6374 696f 6e20 7261 7374 6572 2069 7320  ction raster is 
-00013080: 756e 7369 676e 6564 2069 6e74 6567 6572  unsigned integer
-00013090: 0d0a 2020 2020 2020 2020 2020 2020 3120  ..            1 
-000130a0: 666f 7220 666c 6f61 7433 320d 0a20 2020  for float32..   
-000130b0: 2020 2020 2020 2020 2032 2066 6f72 2066           2 for f
-000130c0: 6c6f 6174 3634 0d0a 2020 2020 2020 2020  loat64..        
-000130d0: 2020 2020 3320 666f 7220 556e 7369 676e      3 for Unsign
-000130e0: 6564 2069 6e74 6567 6572 2031 360d 0a20  ed integer 16.. 
-000130f0: 2020 2020 2020 2020 2020 2034 2066 6f72             4 for
-00013100: 2055 6e73 6967 6e65 6420 696e 7465 6765   Unsigned intege
-00013110: 7220 3332 0d0a 2020 2020 2020 2020 2020  r 32..          
-00013120: 2020 3520 666f 7220 696e 7465 6765 7220    5 for integer 
-00013130: 3136 0d0a 2020 2020 2020 2020 2020 2020  16..            
-00013140: 3620 666f 7220 696e 7465 6765 7220 3332  6 for integer 32
-00013150: 0d0a 0d0a 2020 2020 2020 2020 5265 7475  ....        Retu
-00013160: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
-00013170: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6173  ----..        as
-00013180: 6369 695f 7661 6c75 6573 3a20 5b6e 756d  cii_values: [num
-00013190: 7079 2061 7272 6179 5d0d 0a20 2020 2020  py array]..     
-000131a0: 2020 2020 2020 2032 4420 6172 7261 7973         2D arrays
-000131b0: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
-000131c0: 7661 6c75 6573 2073 746f 7265 6420 696e  values stored in
-000131d0: 2074 6865 2041 5343 4949 2066 696c 650d   the ASCII file.
-000131e0: 0a20 2020 2020 2020 2061 7363 6969 5f64  .        ascii_d
-000131f0: 6574 6169 6c73 3a20 5b4c 6973 745d 0d0a  etails: [List]..
-00013200: 2020 2020 2020 2020 2020 2020 6c69 7374              list
-00013210: 206f 6620 7468 6520 7369 7820 7370 6174   of the six spat
-00013220: 6961 6c20 696e 666f 726d 6174 696f 6e20  ial information 
-00013230: 6f66 2074 6865 2041 5343 4949 2066 696c  of the ASCII fil
-00013240: 650d 0a20 2020 2020 2020 2020 2020 205b  e..            [
-00013250: 4153 4349 4952 6f77 732c 2041 5343 4949  ASCIIRows, ASCII
-00013260: 436f 6c75 6d6e 732c 2058 4c6f 774c 6566  Columns, XLowLef
-00013270: 7443 6f72 6e65 722c 2059 4c6f 774c 6566  tCorner, YLowLef
-00013280: 7443 6f72 6e65 722c 0d0a 2020 2020 2020  tCorner,..      
-00013290: 2020 2020 2020 4365 6c6c 5369 7a65 2c20        CellSize, 
-000132a0: 4e6f 5661 6c75 655d 0d0a 0d0a 2020 2020  NoValue]....    
-000132b0: 2020 2020 4578 616d 706c 6573 0d0a 2020      Examples..  
-000132c0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0d0a        --------..
-000132d0: 2020 2020 2020 2020 3e3e 3e20 456c 6576          >>> Elev
-000132e0: 6174 696f 6e5f 7661 6c75 6573 2c20 4445  ation_values, DE
-000132f0: 4d53 7061 7469 616c 4465 7461 696c 7320  MSpatialDetails 
-00013300: 3d20 5261 7374 6572 2e72 6561 6441 5343  = Raster.readASC
-00013310: 4949 2822 6465 6d2e 6173 6322 2c31 290d  II("dem.asc",1).
-00013320: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-00013330: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
-00013340: 6e73 7461 6e63 6528 6173 6369 695f 6669  nstance(ascii_fi
-00013350: 6c65 2c20 7374 7229 3a0d 0a20 2020 2020  le, str):..     
-00013360: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
-00013370: 6545 7272 6f72 2822 6173 6369 695f 6669  eError("ascii_fi
-00013380: 6c65 2069 6e70 7574 2073 686f 756c 6420  le input should 
-00013390: 6265 2073 7472 696e 6720 7479 7065 2229  be string type")
-000133a0: 0d0a 0d0a 2020 2020 2020 2020 6966 206e  ....        if n
-000133b0: 6f74 2069 7369 6e73 7461 6e63 6528 7069  ot isinstance(pi
-000133c0: 7865 6c5f 7479 7065 2c20 696e 7429 3a0d  xel_type, int):.
-000133d0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-000133e0: 7365 2054 7970 6545 7272 6f72 280d 0a20  se TypeError(.. 
-000133f0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00013400: 7069 7865 6c20 7479 7065 2069 6e70 7574  pixel type input
-00013410: 2073 686f 756c 6420 6265 2069 6e74 6567   should be integ
-00013420: 6572 2074 7970 6520 706c 6561 7365 2063  er type please c
-00013430: 6865 636b 2064 6f63 756d 656e 7461 7469  heck documentati
-00013440: 6f6e 7322 0d0a 2020 2020 2020 2020 2020  ons"..          
-00013450: 2020 290d 0a0d 0a20 2020 2020 2020 2023    )....        #
-00013460: 2069 6e70 7574 2076 616c 7565 730d 0a20   input values.. 
-00013470: 2020 2020 2020 2066 696c 655f 6578 7465         file_exte
-00013480: 6e73 696f 6e20 3d20 6173 6369 695f 6669  nsion = ascii_fi
-00013490: 6c65 5b2d 343a 5d0d 0a20 2020 2020 2020  le[-4:]..       
-000134a0: 2069 6620 6e6f 7420 6669 6c65 5f65 7874   if not file_ext
-000134b0: 656e 7369 6f6e 203d 3d20 222e 6173 6322  ension == ".asc"
-000134c0: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
-000134d0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-000134e0: 2270 6c65 6173 6520 6164 6420 7468 6520  "please add the 
-000134f0: 6578 7465 6e73 696f 6e20 6174 2074 6865  extension at the
-00013500: 2065 6e64 206f 6620 7468 6520 7061 7468   end of the path
-00013510: 2069 6e70 7574 2229 0d0a 0d0a 2020 2020   input")....    
-00013520: 2020 2020 6966 206e 6f74 206f 732e 7061      if not os.pa
-00013530: 7468 2e65 7869 7374 7328 6173 6369 695f  th.exists(ascii_
-00013540: 6669 6c65 293a 0d0a 2020 2020 2020 2020  file):..        
-00013550: 2020 2020 7261 6973 6520 4669 6c65 4e6f      raise FileNo
-00013560: 7446 6f75 6e64 4572 726f 7228 2241 5343  tFoundError("ASC
-00013570: 4949 2066 696c 6520 7061 7468 2079 6f75  II file path you
-00013580: 2068 6176 6520 7072 6f76 6964 6564 2064   have provided d
-00013590: 6f65 7320 6e6f 7420 6578 6973 7422 290d  oes not exist").
-000135a0: 0a0d 0a20 2020 2020 2020 2023 2323 2072  ...        ### r
-000135b0: 6561 6420 7468 6520 4153 4349 4920 6669  ead the ASCII fi
-000135c0: 6c65 0d0a 2020 2020 2020 2020 4669 6c65  le..        File
-000135d0: 203d 206f 7065 6e28 6173 6369 695f 6669   = open(ascii_fi
-000135e0: 6c65 290d 0a20 2020 2020 2020 2077 686f  le)..        who
-000135f0: 6c65 5f66 696c 6520 3d20 4669 6c65 2e72  le_file = File.r
-00013600: 6561 646c 696e 6573 2829 0d0a 2020 2020  eadlines()..    
-00013610: 2020 2020 4669 6c65 2e63 6c6f 7365 2829      File.close()
-00013620: 0d0a 0d0a 2020 2020 2020 2020 636f 6c73  ....        cols
-00013630: 203d 2069 6e74 2877 686f 6c65 5f66 696c   = int(whole_fil
-00013640: 655b 305d 2e73 706c 6974 2829 5b31 5d29  e[0].split()[1])
-00013650: 0d0a 2020 2020 2020 2020 726f 7773 203d  ..        rows =
-00013660: 2069 6e74 2877 686f 6c65 5f66 696c 655b   int(whole_file[
-00013670: 315d 2e73 706c 6974 2829 5b31 5d29 0d0a  1].split()[1])..
-00013680: 0d0a 2020 2020 2020 2020 785f 6c65 6674  ..        x_left
-00013690: 5f73 6964 6520 3d20 666c 6f61 7428 7768  _side = float(wh
-000136a0: 6f6c 655f 6669 6c65 5b32 5d2e 7370 6c69  ole_file[2].spli
-000136b0: 7428 295b 315d 290d 0a20 2020 2020 2020  t()[1])..       
-000136c0: 2079 5f6c 6f77 6572 5f73 6964 6520 3d20   y_lower_side = 
-000136d0: 666c 6f61 7428 7768 6f6c 655f 6669 6c65  float(whole_file
-000136e0: 5b33 5d2e 7370 6c69 7428 295b 315d 290d  [3].split()[1]).
-000136f0: 0a20 2020 2020 2020 2063 616c 6c5f 7369  .        call_si
-00013700: 7a65 203d 2066 6c6f 6174 2877 686f 6c65  ze = float(whole
-00013710: 5f66 696c 655b 345d 2e73 706c 6974 2829  _file[4].split()
-00013720: 5b31 5d29 0d0a 2020 2020 2020 2020 6e6f  [1])..        no
-00013730: 5f64 6174 615f 7661 6c75 6520 3d20 666c  _data_value = fl
-00013740: 6f61 7428 7768 6f6c 655f 6669 6c65 5b35  oat(whole_file[5
-00013750: 5d2e 7370 6c69 7428 295b 315d 290d 0a0d  ].split()[1])...
-00013760: 0a20 2020 2020 2020 2061 7272 203d 206e  .        arr = n
-00013770: 702e 6f6e 6573 2828 726f 7773 2c20 636f  p.ones((rows, co
-00013780: 6c73 292c 2064 7479 7065 3d6e 702e 666c  ls), dtype=np.fl
-00013790: 6f61 7433 3229 0d0a 2020 2020 2020 2020  oat32)..        
-000137a0: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
-000137b0: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
-000137c0: 2872 6f77 7329 3a0d 0a20 2020 2020 2020  (rows):..       
-000137d0: 2020 2020 2020 2020 2078 203d 2077 686f           x = who
-000137e0: 6c65 5f66 696c 655b 3620 2b20 695d 2e73  le_file[6 + i].s
-000137f0: 706c 6974 2829 0d0a 2020 2020 2020 2020  plit()..        
-00013800: 2020 2020 2020 2020 6172 725b 692c 203a          arr[i, :
-00013810: 5d20 3d20 6c69 7374 286d 6170 2866 6c6f  ] = list(map(flo
-00013820: 6174 2c20 7829 290d 0a20 2020 2020 2020  at, x))..       
-00013830: 2065 7863 6570 743a 0d0a 2020 2020 2020   except:..      
-00013840: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
-00013850: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00013860: 6a20 696e 2072 616e 6765 286c 656e 2878  j in range(len(x
-00013870: 2929 3a0d 0a20 2020 2020 2020 2020 2020  )):..           
-00013880: 2020 2020 2020 2020 2066 6c6f 6174 2878           float(x
-00013890: 5b6a 5d29 0d0a 2020 2020 2020 2020 2020  [j])..          
-000138a0: 2020 6578 6365 7074 3a0d 0a20 2020 2020    except:..     
-000138b0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-000138c0: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-000138d0: 2020 2020 2020 2066 2245 7272 6f72 2072         f"Error r
-000138e0: 6561 6469 6e67 2074 6865 2041 5243 4949  eading the ARCII
-000138f0: 2066 696c 6520 706c 6561 7365 2063 6865   file please che
-00013900: 636b 2072 6f77 207b 6920 2b20 3620 2b20  ck row {i + 6 + 
-00013910: 317d 2c20 636f 6c75 6d6e 207b 6a7d 220d  1}, column {j}".
-00013920: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013930: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
-00013940: 2020 2020 7072 696e 7428 6622 4120 7661      print(f"A va
-00013950: 6c75 6520 6f66 207b 785b 6a5d 7d20 2c20  lue of {x[j]} , 
-00013960: 6973 2073 746f 7265 6420 696e 2074 6865  is stored in the
-00013970: 2041 5343 4949 2066 696c 6520 2229 0d0a   ASCII file ")..
-00013980: 0d0a 2020 2020 2020 2020 6765 6f74 7261  ..        geotra
-00013990: 6e73 666f 726d 203d 2028 726f 7773 2c20  nsform = (rows, 
-000139a0: 636f 6c73 2c20 785f 6c65 6674 5f73 6964  cols, x_left_sid
-000139b0: 652c 2079 5f6c 6f77 6572 5f73 6964 652c  e, y_lower_side,
-000139c0: 2063 616c 6c5f 7369 7a65 2c20 6e6f 5f64   call_size, no_d
-000139d0: 6174 615f 7661 6c75 6529 0d0a 0d0a 2020  ata_value)....  
-000139e0: 2020 2020 2020 7265 7475 726e 2061 7272        return arr
-000139f0: 2c20 6765 6f74 7261 6e73 666f 726d 0d0a  , geotransform..
-00013a00: 0d0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
-00013a10: 686f 640d 0a20 2020 2064 6566 2073 7472  hod..    def str
-00013a20: 696e 6753 7061 6365 2869 6e70 293a 0d0a  ingSpace(inp):..
-00013a30: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00013a40: 7472 2869 6e70 2920 2b20 2220 2022 0d0a  tr(inp) + "  "..
-00013a50: 0d0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
-00013a60: 686f 640d 0a20 2020 2064 6566 2077 7269  hod..    def wri
-00013a70: 7465 4153 4349 4928 6173 6369 695f 6669  teASCII(ascii_fi
-00013a80: 6c65 3a20 7374 722c 2067 656f 7472 616e  le: str, geotran
-00013a90: 7366 6f72 6d3a 2074 7570 6c65 2c20 6172  sform: tuple, ar
-00013aa0: 723a 206e 702e 6e64 6172 7261 7929 202d  r: np.ndarray) -
-00013ab0: 3e20 4e6f 6e65 3a0d 0a20 2020 2020 2020  > None:..       
-00013ac0: 2022 2222 7772 6974 6541 5343 4949 2e0d   """writeASCII..
-00013ad0: 0a0d 0a20 2020 2020 2020 2020 2020 2077  ...            w
-00013ae0: 7269 7465 4153 4349 4920 7265 6164 7320  riteASCII reads 
-00013af0: 616e 2041 5343 4949 2066 696c 6520 7468  an ASCII file th
-00013b00: 6520 7370 6174 6961 6c20 696e 666f 726d  e spatial inform
-00013b10: 6174 696f 6e0d 0a0d 0a20 2020 2020 2020  ation....       
-00013b20: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-00013b30: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-00013b40: 0a20 2020 2020 2020 2061 7363 6969 5f66  .        ascii_f
-00013b50: 696c 653a 205b 7374 725d 0d0a 2020 2020  ile: [str]..    
-00013b60: 2020 2020 2020 2020 6e61 6d65 206f 6620          name of 
-00013b70: 7468 6520 4153 4349 4920 6669 6c65 2079  the ASCII file y
-00013b80: 6f75 2077 616e 7420 746f 2063 6f6e 7665  ou want to conve
-00013b90: 7274 2061 6e64 2074 6865 206e 616d 650d  rt and the name.
-00013ba0: 0a20 2020 2020 2020 2020 2020 2073 686f  .            sho
-00013bb0: 756c 6420 696e 636c 7564 6520 7468 6520  uld include the 
-00013bc0: 6578 7465 6e73 696f 6e20 222e 6173 6322  extension ".asc"
-00013bd0: 0d0a 2020 2020 2020 2020 6765 6f74 7261  ..        geotra
-00013be0: 6e73 666f 726d 3a20 5b74 7570 6c65 5d0d  nsform: [tuple].
-00013bf0: 0a20 2020 2020 2020 2020 2020 206c 6973  .            lis
-00013c00: 7420 6f66 2074 6865 2073 6978 2073 7061  t of the six spa
-00013c10: 7469 616c 2069 6e66 6f72 6d61 7469 6f6e  tial information
-00013c20: 206f 6620 7468 6520 4153 4349 4920 6669   of the ASCII fi
-00013c30: 6c65 0d0a 2020 2020 2020 2020 2020 2020  le..            
-00013c40: 5b41 5343 4949 526f 7773 2c20 4153 4349  [ASCIIRows, ASCI
-00013c50: 4943 6f6c 756d 6e73 2c20 584c 6f77 4c65  IColumns, XLowLe
-00013c60: 6674 436f 726e 6572 2c20 594c 6f77 4c65  ftCorner, YLowLe
-00013c70: 6674 436f 726e 6572 2c0d 0a20 2020 2020  ftCorner,..     
-00013c80: 2020 2020 2020 2043 656c 6c53 697a 652c         CellSize,
-00013c90: 204e 6f56 616c 7565 5d0d 0a20 2020 2020   NoValue]..     
-00013ca0: 2020 2061 7272 3a20 5b6e 702e 6e64 6172     arr: [np.ndar
-00013cb0: 7261 795d 0d0a 2020 2020 2020 2020 2020  ray]..          
-00013cc0: 2020 5b6e 756d 7079 2061 7272 6179 5d20    [numpy array] 
-00013cd0: 3244 2061 7272 6179 7320 636f 6e74 6169  2D arrays contai
-00013ce0: 6e69 6e67 2074 6865 2076 616c 7565 7320  ning the values 
-00013cf0: 7374 6f72 6564 2069 6e20 7468 6520 4153  stored in the AS
-00013d00: 4349 490d 0a20 2020 2020 2020 2020 2020  CII..           
-00013d10: 2066 696c 650d 0a0d 0a20 2020 2020 2020   file....       
-00013d20: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
-00013d30: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
-00013d40: 2020 204e 6f6e 650d 0a0d 0a20 2020 2020     None....     
-00013d50: 2020 2045 7861 6d70 6c65 730d 0a20 2020     Examples..   
-00013d60: 2020 2020 202d 2d2d 2d2d 2d2d 2d0d 0a20       --------.. 
-00013d70: 2020 2020 2020 203e 3e3e 2045 6c65 7661         >>> Eleva
-00013d80: 7469 6f6e 5f76 616c 7565 732c 2044 454d  tion_values, DEM
-00013d90: 5370 6174 6961 6c44 6574 6169 6c73 203d  SpatialDetails =
-00013da0: 2052 6173 7465 722e 7265 6164 4153 4349   Raster.readASCI
-00013db0: 4928 2264 656d 2e61 7363 222c 3129 0d0a  I("dem.asc",1)..
-00013dc0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-00013dd0: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
-00013de0: 7374 616e 6365 2861 7363 6969 5f66 696c  stance(ascii_fil
-00013df0: 652c 2073 7472 293a 0d0a 2020 2020 2020  e, str):..      
-00013e00: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-00013e10: 4572 726f 7228 2261 7363 6969 5f66 696c  Error("ascii_fil
-00013e20: 6520 696e 7075 7420 7368 6f75 6c64 2062  e input should b
-00013e30: 6520 7374 7269 6e67 2074 7970 6522 290d  e string type").
-00013e40: 0a0d 0a20 2020 2020 2020 2023 2069 6e70  ...        # inp
-00013e50: 7574 2076 616c 7565 730d 0a20 2020 2020  ut values..     
-00013e60: 2020 2041 5343 4949 4578 7420 3d20 6173     ASCIIExt = as
-00013e70: 6369 695f 6669 6c65 5b2d 343a 5d0d 0a20  cii_file[-4:].. 
-00013e80: 2020 2020 2020 2069 6620 6e6f 7420 4153         if not AS
-00013e90: 4349 4945 7874 203d 3d20 222e 6173 6322  CIIExt == ".asc"
-00013ea0: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
-00013eb0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00013ec0: 2270 6c65 6173 6520 6164 6420 7468 6520  "please add the 
-00013ed0: 6578 7465 6e73 696f 6e20 6174 2074 6865  extension at the
-00013ee0: 2065 6e64 206f 6620 7468 6520 7061 7468   end of the path
-00013ef0: 2069 6e70 7574 2229 0d0a 0d0a 2020 2020   input")....    
-00013f00: 2020 2020 7472 793a 0d0a 2020 2020 2020      try:..      
-00013f10: 2020 2020 2020 4669 6c65 203d 206f 7065        File = ope
-00013f20: 6e28 6173 6369 695f 6669 6c65 2c20 2277  n(ascii_file, "w
-00013f30: 2229 0d0a 2020 2020 2020 2020 6578 6365  ")..        exce
-00013f40: 7074 2046 696c 6545 7869 7374 7345 7272  pt FileExistsErr
-00013f50: 6f72 3a0d 0a20 2020 2020 2020 2020 2020  or:..           
-00013f60: 2072 6169 7365 2046 696c 6545 7869 7374   raise FileExist
-00013f70: 7345 7272 6f72 280d 0a20 2020 2020 2020  sError(..       
-00013f80: 2020 2020 2020 2020 2066 2270 6174 6820           f"path 
-00013f90: 796f 7520 6861 7665 2070 726f 7669 6465  you have provide
-00013fa0: 6420 646f 6573 206e 6f74 2065 7869 7374  d does not exist
-00013fb0: 2070 6c65 6173 6520 6368 6563 6b20 7b61   please check {a
-00013fc0: 7363 6969 5f66 696c 657d 220d 0a20 2020  scii_file}"..   
-00013fd0: 2020 2020 2020 2020 2029 0d0a 0d0a 2020           )....  
-00013fe0: 2020 2020 2020 2320 7772 6974 6520 7468        # write th
-00013ff0: 6520 7468 6520 4153 4349 4920 6669 6c65  e the ASCII file
-00014000: 2064 6574 6169 6c73 0d0a 2020 2020 2020   details..      
-00014010: 2020 4669 6c65 2e77 7269 7465 2822 6e63    File.write("nc
-00014020: 6f6c 7320 2020 2020 2020 2020 2220 2b20  ols         " + 
-00014030: 7374 7228 6765 6f74 7261 6e73 666f 726d  str(geotransform
-00014040: 5b31 5d29 202b 2022 5c6e 2229 0d0a 2020  [1]) + "\n")..  
-00014050: 2020 2020 2020 4669 6c65 2e77 7269 7465        File.write
-00014060: 2822 6e72 6f77 7320 2020 2020 2020 2020  ("nrows         
-00014070: 2220 2b20 7374 7228 6765 6f74 7261 6e73  " + str(geotrans
-00014080: 666f 726d 5b30 5d29 202b 2022 5c6e 2229  form[0]) + "\n")
-00014090: 0d0a 2020 2020 2020 2020 4669 6c65 2e77  ..        File.w
-000140a0: 7269 7465 2822 786c 6c63 6f72 6e65 7220  rite("xllcorner 
-000140b0: 2020 2020 2220 2b20 7374 7228 6765 6f74      " + str(geot
-000140c0: 7261 6e73 666f 726d 5b32 5d29 202b 2022  ransform[2]) + "
-000140d0: 5c6e 2229 0d0a 2020 2020 2020 2020 4669  \n")..        Fi
-000140e0: 6c65 2e77 7269 7465 2822 796c 6c63 6f72  le.write("yllcor
-000140f0: 6e65 7220 2020 2020 2220 2b20 7374 7228  ner     " + str(
-00014100: 6765 6f74 7261 6e73 666f 726d 5b33 5d29  geotransform[3])
-00014110: 202b 2022 5c6e 2229 0d0a 2020 2020 2020   + "\n")..      
-00014120: 2020 4669 6c65 2e77 7269 7465 2822 6365    File.write("ce
-00014130: 6c6c 7369 7a65 2020 2020 2020 2220 2b20  llsize      " + 
-00014140: 7374 7228 6765 6f74 7261 6e73 666f 726d  str(geotransform
-00014150: 5b34 5d29 202b 2022 5c6e 2229 0d0a 2020  [4]) + "\n")..  
-00014160: 2020 2020 2020 4669 6c65 2e77 7269 7465        File.write
-00014170: 2822 4e4f 4441 5441 5f76 616c 7565 2020  ("NODATA_value  
-00014180: 2220 2b20 7374 7228 6765 6f74 7261 6e73  " + str(geotrans
-00014190: 666f 726d 5b35 5d29 202b 2022 5c6e 2229  form[5]) + "\n")
-000141a0: 0d0a 0d0a 2020 2020 2020 2020 2320 7772  ....        # wr
-000141b0: 6974 6520 7468 6520 6172 7261 790d 0a20  ite the array.. 
-000141c0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-000141d0: 7261 6e67 6528 6e70 2e73 6861 7065 2861  range(np.shape(a
-000141e0: 7272 295b 305d 293a 0d0a 2020 2020 2020  rr)[0]):..      
-000141f0: 2020 2020 2020 4669 6c65 2e77 7269 7465        File.write
-00014200: 6c69 6e65 7328 6c69 7374 286d 6170 2852  lines(list(map(R
-00014210: 6173 7465 722e 7374 7269 6e67 5370 6163  aster.stringSpac
-00014220: 652c 2061 7272 5b69 2c20 3a5d 2929 290d  e, arr[i, :]))).
-00014230: 0a20 2020 2020 2020 2020 2020 2046 696c  .            Fil
-00014240: 652e 7772 6974 6528 225c 6e22 290d 0a0d  e.write("\n")...
-00014250: 0a20 2020 2020 2020 2046 696c 652e 636c  .        File.cl
-00014260: 6f73 6528 290d 0a0d 0a20 2020 2040 7374  ose()....    @st
-00014270: 6174 6963 6d65 7468 6f64 0d0a 2020 2020  aticmethod..    
-00014280: 6465 6620 6764 616c 5f6d 6572 6765 280d  def gdal_merge(.
-00014290: 0a20 2020 2020 2020 2073 7263 3a20 4c69  .        src: Li
-000142a0: 7374 5b73 7472 5d2c 0d0a 2020 2020 2020  st[str],..      
-000142b0: 2020 6473 743a 2073 7472 2c0d 0a20 2020    dst: str,..   
-000142c0: 2020 2020 206e 6f5f 6461 7461 5f76 616c       no_data_val
-000142d0: 7565 3a20 556e 696f 6e5b 666c 6f61 742c  ue: Union[float,
-000142e0: 2069 6e74 2c20 7374 725d 203d 2022 3022   int, str] = "0"
-000142f0: 2c0d 0a20 2020 2020 2020 2069 6e69 743a  ,..        init:
-00014300: 2055 6e69 6f6e 5b66 6c6f 6174 2c20 696e   Union[float, in
-00014310: 742c 2073 7472 5d20 3d20 226e 616e 222c  t, str] = "nan",
-00014320: 0d0a 2020 2020 2020 2020 6e3a 2055 6e69  ..        n: Uni
-00014330: 6f6e 5b66 6c6f 6174 2c20 696e 742c 2073  on[float, int, s
-00014340: 7472 5d20 3d20 226e 616e 222c 0d0a 2020  tr] = "nan",..  
-00014350: 2020 293a 0d0a 2020 2020 2020 2020 2222    ):..        ""
-00014360: 226d 6572 6765 2e0d 0a0d 0a20 2020 2020  "merge.....     
-00014370: 2020 2020 2020 206d 6572 6765 7320 6772         merges gr
-00014380: 6f75 7020 6f66 2072 6173 7465 7273 2069  oup of rasters i
-00014390: 6e74 6f20 6f6e 6520 7261 7374 6572 0d0a  nto one raster..
-000143a0: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-000143b0: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
-000143c0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-000143d0: 2020 7372 633a 204c 6973 745b 7374 725d    src: List[str]
-000143e0: 0d0a 2020 2020 2020 2020 2020 2020 6c69  ..            li
-000143f0: 7374 206f 6620 7468 6520 7061 7468 2074  st of the path t
-00014400: 6f20 616c 6c20 696e 7075 7420 7261 7374  o all input rast
-00014410: 6572 0d0a 2020 2020 2020 2020 6473 743a  er..        dst:
-00014420: 205b 7374 725d 0d0a 2020 2020 2020 2020   [str]..        
-00014430: 2020 2020 7061 7468 2074 6f20 7468 6520      path to the 
-00014440: 6f75 7470 7574 2072 6173 7465 720d 0a20  output raster.. 
-00014450: 2020 2020 2020 206e 6f5f 6461 7461 5f76         no_data_v
-00014460: 616c 7565 3a20 5b66 6c6f 6174 2f69 6e74  alue: [float/int
-00014470: 5d0d 0a20 2020 2020 2020 2020 2020 2041  ]..            A
-00014480: 7373 6967 6e20 6120 7370 6563 6966 6965  ssign a specifie
-00014490: 6420 6e6f 6461 7461 2076 616c 7565 2074  d nodata value t
-000144a0: 6f20 6f75 7470 7574 2062 616e 6473 2e0d  o output bands..
-000144b0: 0a20 2020 2020 2020 2069 6e69 743a 205b  .        init: [
-000144c0: 666c 6f61 742f 696e 745d 0d0a 2020 2020  float/int]..    
-000144d0: 2020 2020 2020 2020 5072 652d 696e 6974          Pre-init
-000144e0: 6961 6c69 7a65 2074 6865 206f 7574 7075  ialize the outpu
-000144f0: 7420 696d 6167 6520 6261 6e64 7320 7769  t image bands wi
-00014500: 7468 2074 6865 7365 2076 616c 7565 732e  th these values.
-00014510: 2048 6f77 6576 6572 2c20 6974 2069 7320   However, it is 
-00014520: 6e6f 7420 6d61 726b 6564 2061 7320 7468  not marked as th
-00014530: 6520 6e6f 6461 7461 2076 616c 7565 0d0a  e nodata value..
-00014540: 2020 2020 2020 2020 2020 2020 696e 2074              in t
-00014550: 6865 206f 7574 7075 7420 6669 6c65 2e20  he output file. 
-00014560: 4966 206f 6e6c 7920 6f6e 6520 7661 6c75  If only one valu
-00014570: 6520 6973 2067 6976 656e 2c20 7468 6520  e is given, the 
-00014580: 7361 6d65 2076 616c 7565 2069 7320 7573  same value is us
-00014590: 6564 2069 6e20 616c 6c20 7468 6520 6261  ed in all the ba
-000145a0: 6e64 732e 0d0a 2020 2020 2020 2020 6e3a  nds...        n:
-000145b0: 205b 666c 6f61 742f 696e 745d 0d0a 2020   [float/int]..  
-000145c0: 2020 2020 2020 2020 2020 4967 6e6f 7265            Ignore
-000145d0: 2070 6978 656c 7320 6672 6f6d 2066 696c   pixels from fil
-000145e0: 6573 2062 6569 6e67 206d 6572 6765 6420  es being merged 
-000145f0: 696e 2077 6974 6820 7468 6973 2070 6978  in with this pix
-00014600: 656c 2076 616c 7565 2e0d 0a0d 0a20 2020  el value.....   
-00014610: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
-00014620: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
-00014630: 2020 2020 2020 204e 6f6e 650d 0a20 2020         None..   
-00014640: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-00014650: 2020 2320 7275 6e20 7468 6520 636f 6d6d    # run the comm
-00014660: 616e 640d 0a20 2020 2020 2020 2023 2063  and..        # c
-00014670: 6d64 203d 2022 6764 616c 5f6d 6572 6765  md = "gdal_merge
-00014680: 2e70 7920 2d6f 206d 6572 6765 645f 696d  .py -o merged_im
-00014690: 6167 655f 312e 7469 6622 0d0a 2020 2020  age_1.tif"..    
-000146a0: 2020 2020 2320 7375 6270 726f 6365 7373      # subprocess
-000146b0: 2e63 616c 6c28 636d 642e 7370 6c69 7428  .call(cmd.split(
-000146c0: 2920 2b20 6669 6c65 5f6c 6973 7429 0d0a  ) + file_list)..
-000146d0: 2020 2020 2020 2020 2320 7672 7420 3d20          # vrt = 
-000146e0: 6764 616c 2e42 7569 6c64 5652 5428 226d  gdal.BuildVRT("m
-000146f0: 6572 6765 642e 7672 7422 2c66 696c 655f  erged.vrt",file_
-00014700: 6c69 7374 290d 0a20 2020 2020 2020 2023  list)..        #
-00014710: 2073 7263 203d 2067 6461 6c2e 5472 616e   src = gdal.Tran
-00014720: 736c 6174 6528 226d 6572 6765 645f 696d  slate("merged_im
-00014730: 6167 652e 7469 6622 2c76 7274 290d 0a0d  age.tif",vrt)...
-00014740: 0a20 2020 2020 2020 2070 6172 616d 6574  .        paramet
-00014750: 6572 7320 3d20 280d 0a20 2020 2020 2020  ers = (..       
-00014760: 2020 2020 205b 2222 2c20 222d 6f22 2c20       ["", "-o", 
-00014770: 6473 745d 0d0a 2020 2020 2020 2020 2020  dst]..          
-00014780: 2020 2b20 7372 630d 0a20 2020 2020 2020    + src..       
-00014790: 2020 2020 202b 205b 0d0a 2020 2020 2020       + [..      
-000147a0: 2020 2020 2020 2020 2020 222d 636f 222c            "-co",
-000147b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000147c0: 2020 2243 4f4d 5052 4553 533d 4c5a 5722    "COMPRESS=LZW"
-000147d0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-000147e0: 2020 2022 2d69 6e69 7422 2c0d 0a20 2020     "-init",..   
-000147f0: 2020 2020 2020 2020 2020 2020 2073 7472               str
-00014800: 2869 6e69 7429 2c0d 0a20 2020 2020 2020  (init),..       
-00014810: 2020 2020 2020 2020 2022 2d61 5f6e 6f64           "-a_nod
-00014820: 6174 6122 2c0d 0a20 2020 2020 2020 2020  ata",..         
-00014830: 2020 2020 2020 2073 7472 286e 6f5f 6461         str(no_da
-00014840: 7461 5f76 616c 7565 292c 0d0a 2020 2020  ta_value),..    
-00014850: 2020 2020 2020 2020 2020 2020 222d 6e22              "-n"
-00014860: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00014870: 2020 2073 7472 286e 292c 0d0a 2020 2020     str(n),..    
-00014880: 2020 2020 2020 2020 5d0d 0a20 2020 2020          ]..     
-00014890: 2020 2029 2020 2320 272d 7365 7061 7261     )  # '-separa
-000148a0: 7465 270d 0a20 2020 2020 2020 2067 6461  te'..        gda
-000148b0: 6c5f 6d65 7267 652e 6d61 696e 2870 6172  l_merge.main(par
-000148c0: 616d 6574 6572 7329 0d0a 0d0a 2020 2020  ameters)....    
-000148d0: 4073 7461 7469 636d 6574 686f 640d 0a20  @staticmethod.. 
-000148e0: 2020 2064 6566 2072 6173 7465 7269 6f5f     def rasterio_
-000148f0: 6d65 7267 6528 0d0a 2020 2020 2020 2020  merge(..        
-00014900: 7261 7374 6572 5f6c 6973 743a 206c 6973  raster_list: lis
-00014910: 742c 2073 6176 653a 2062 6f6f 6c20 3d20  t, save: bool = 
-00014920: 4661 6c73 652c 2070 6174 683a 2073 7472  False, path: str
-00014930: 203d 2022 4d6f 7361 6963 6564 5261 7374   = "MosaicedRast
-00014940: 6572 2e74 6966 220d 0a20 2020 2029 3a0d  er.tif"..    ):.
-00014950: 0a20 2020 2020 2020 2022 2222 6d6f 7361  .        """mosa
-00014960: 6963 2e0d 0a0d 0a20 2020 2020 2020 2050  ic.....        P
-00014970: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
-00014980: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-00014990: 2020 2020 2020 2072 6173 7465 725f 6c69         raster_li
-000149a0: 7374 203a 205b 6c69 7374 5d0d 0a20 2020  st : [list]..   
-000149b0: 2020 2020 2020 2020 206c 6973 7420 6f66           list of
-000149c0: 2074 6865 2072 6173 7465 7220 6669 6c65   the raster file
-000149d0: 7320 746f 206d 6f73 6169 632e 0d0a 2020  s to mosaic...  
-000149e0: 2020 2020 2020 7361 7665 203a 205b 426f        save : [Bo
-000149f0: 6f6c 5d2c 206f 7074 696f 6e61 6c0d 0a20  ol], optional.. 
-00014a00: 2020 2020 2020 2020 2020 2074 6f20 7361             to sa
-00014a10: 7665 2074 6865 2063 6c69 7070 6564 2072  ve the clipped r
-00014a20: 6173 7465 7220 746f 2079 6f75 7220 6472  aster to your dr
-00014a30: 6976 652e 2054 6865 2064 6566 6175 6c74  ive. The default
-00014a40: 2069 7320 4661 6c73 652e 0d0a 2020 2020   is False...    
-00014a50: 2020 2020 7061 7468 203a 205b 5374 7269      path : [Stri
-00014a60: 6e67 5d2c 206f 7074 696f 6e61 6c0d 0a20  ng], optional.. 
-00014a70: 2020 2020 2020 2020 2020 2050 6174 6820             Path 
-00014a80: 6969 6e63 6c75 6469 6e67 2074 6865 2065  iincluding the e
-00014a90: 7874 656e 7469 6f6e 2028 2e74 6966 292e  xtention (.tif).
-00014aa0: 2054 6865 2064 6566 6175 6c74 2069 7320   The default is 
-00014ab0: 274d 6f73 6169 6365 6452 6173 7465 722e  'MosaicedRaster.
-00014ac0: 7469 6627 2e0d 0a0d 0a20 2020 2020 2020  tif'.....       
-00014ad0: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
-00014ae0: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
-00014af0: 2020 204d 6f73 6169 6365 6420 7261 7374     Mosaiced rast
-00014b00: 6572 3a20 5b52 6173 7465 7269 6f20 6f62  er: [Rasterio ob
-00014b10: 6a65 6374 5d0d 0a20 2020 2020 2020 2020  ject]..         
-00014b20: 2020 2074 6865 2077 686f 6c65 206d 6f73     the whole mos
-00014b30: 6169 6365 6420 7261 7374 6572 0d0a 2020  aiced raster..  
-00014b40: 2020 2020 2020 6d65 7461 6461 7461 203a        metadata :
-00014b50: 205b 6469 6374 696f 6e61 795d 0d0a 2020   [dictionay]..  
-00014b60: 2020 2020 2020 2020 2020 6469 6374 696f            dictio
-00014b70: 6e61 7279 2063 6f6e 7461 696e 696e 6720  nary containing 
-00014b80: 6e75 6d62 6572 206f 6620 6261 6e64 732c  number of bands,
-00014b90: 2063 6f6f 7264 696e 6174 6520 7265 6665   coordinate refe
-00014ba0: 7265 6e63 6520 7379 7374 656d 2063 7273  rence system crs
-00014bb0: 0d0a 2020 2020 2020 2020 2020 2020 6474  ..            dt
-00014bc0: 7970 652c 2067 656f 7472 616e 7366 6f72  ype, geotransfor
-00014bd0: 6d2c 2068 6569 6768 7420 616e 6420 7769  m, height and wi
-00014be0: 6474 6820 6f66 2074 6865 2072 6173 7465  dth of the raste
-00014bf0: 720d 0a20 2020 2020 2020 2022 2222 0d0a  r..        """..
-00014c00: 2020 2020 2020 2020 2320 4c69 7374 2066          # List f
-00014c10: 6f72 2074 6865 2073 6f75 7263 6520 6669  or the source fi
-00014c20: 6c65 730d 0a20 2020 2020 2020 2052 6173  les..        Ras
-00014c30: 7465 7269 6f4f 626a 6563 7473 203d 205b  terioObjects = [
-00014c40: 5d0d 0a0d 0a20 2020 2020 2020 2023 2049  ]....        # I
-00014c50: 7465 7261 7465 206f 7665 7220 7261 7374  terate over rast
-00014c60: 6572 2066 696c 6573 2061 6e64 2061 6464  er files and add
-00014c70: 2074 6865 6d20 746f 2073 6f75 7263 6520   them to source 
-00014c80: 2d6c 6973 7420 696e 2027 7265 6164 206d  -list in 'read m
-00014c90: 6f64 6527 0d0a 2020 2020 2020 2020 666f  ode'..        fo
-00014ca0: 7220 6669 6c65 2069 6e20 7261 7374 6572  r file in raster
-00014cb0: 5f6c 6973 743a 0d0a 2020 2020 2020 2020  _list:..        
-00014cc0: 2020 2020 7372 6320 3d20 7261 7374 6572      src = raster
-00014cd0: 696f 2e6f 7065 6e28 6669 6c65 290d 0a20  io.open(file).. 
-00014ce0: 2020 2020 2020 2020 2020 2052 6173 7465             Raste
-00014cf0: 7269 6f4f 626a 6563 7473 2e61 7070 656e  rioObjects.appen
-00014d00: 6428 7372 6329 0d0a 0d0a 2020 2020 2020  d(src)....      
-00014d10: 2020 2320 4d65 7267 6520 6675 6e63 7469    # Merge functi
-00014d20: 6f6e 2072 6574 7572 6e73 2061 2073 696e  on returns a sin
-00014d30: 676c 6520 6d6f 7361 6963 2061 7272 6179  gle mosaic array
-00014d40: 2061 6e64 2074 6865 2074 7261 6e73 666f   and the transfo
-00014d50: 726d 6174 696f 6e20 696e 666f 0d0a 2020  rmation info..  
-00014d60: 2020 2020 2020 6473 742c 2064 7374 5f74        dst, dst_t
-00014d70: 7261 6e73 203d 2072 6173 7465 7269 6f2e  rans = rasterio.
-00014d80: 6d65 7267 652e 6d65 7267 6528 5261 7374  merge.merge(Rast
-00014d90: 6572 696f 4f62 6a65 6374 7329 0d0a 0d0a  erioObjects)....
-00014da0: 2020 2020 2020 2020 2320 436f 7079 2074          # Copy t
-00014db0: 6865 206d 6574 6164 6174 610d 0a20 2020  he metadata..   
-00014dc0: 2020 2020 2064 7374 5f6d 6574 6120 3d20       dst_meta = 
-00014dd0: 7372 632e 6d65 7461 2e63 6f70 7928 290d  src.meta.copy().
-00014de0: 0a20 2020 2020 2020 2065 7073 675f 636f  .        epsg_co
-00014df0: 6465 203d 2069 6e74 2873 7263 2e63 7273  de = int(src.crs
-00014e00: 2e64 6174 615b 2269 6e69 7422 5d5b 353a  .data["init"][5:
-00014e10: 5d29 0d0a 2020 2020 2020 2020 2320 5570  ])..        # Up
-00014e20: 6461 7465 2074 6865 206d 6574 6164 6174  date the metadat
-00014e30: 610d 0a20 2020 2020 2020 2064 7374 5f6d  a..        dst_m
-00014e40: 6574 612e 7570 6461 7465 280d 0a20 2020  eta.update(..   
-00014e50: 2020 2020 2020 2020 207b 0d0a 2020 2020           {..    
-00014e60: 2020 2020 2020 2020 2020 2020 2264 7269              "dri
-00014e70: 7665 7222 3a20 2247 5469 6666 222c 0d0a  ver": "GTiff",..
-00014e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014e90: 2268 6569 6768 7422 3a20 6473 742e 7368  "height": dst.sh
-00014ea0: 6170 655b 315d 2c0d 0a20 2020 2020 2020  ape[1],..       
-00014eb0: 2020 2020 2020 2020 2022 7769 6474 6822           "width"
-00014ec0: 3a20 6473 742e 7368 6170 655b 325d 2c0d  : dst.shape[2],.
-00014ed0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014ee0: 2022 7472 616e 7366 6f72 6d22 3a20 6473   "transform": ds
-00014ef0: 745f 7472 616e 732c 0d0a 2020 2020 2020  t_trans,..      
-00014f00: 2020 2020 2020 2020 2020 2263 7273 223a            "crs":
-00014f10: 2070 7970 726f 6a2e 4352 532e 6672 6f6d   pyproj.CRS.from
-00014f20: 5f65 7073 6728 6570 7367 5f63 6f64 6529  _epsg(epsg_code)
-00014f30: 2e74 6f5f 776b 7428 292c 0d0a 2020 2020  .to_wkt(),..    
-00014f40: 2020 2020 2020 2020 7d0d 0a20 2020 2020          }..     
-00014f50: 2020 2029 0d0a 0d0a 2020 2020 2020 2020     )....        
-00014f60: 6966 2073 6176 653a 0d0a 2020 2020 2020  if save:..      
-00014f70: 2020 2020 2020 2320 5772 6974 6520 7468        # Write th
-00014f80: 6520 6d6f 7361 6963 2072 6173 7465 7220  e mosaic raster 
-00014f90: 746f 2064 6973 6b0d 0a20 2020 2020 2020  to disk..       
-00014fa0: 2020 2020 2077 6974 6820 7261 7374 6572       with raster
-00014fb0: 696f 2e6f 7065 6e28 7061 7468 2c20 2277  io.open(path, "w
-00014fc0: 222c 202a 2a64 7374 5f6d 6574 6129 2061  ", **dst_meta) a
-00014fd0: 7320 6465 7374 3a0d 0a20 2020 2020 2020  s dest:..       
-00014fe0: 2020 2020 2020 2020 2064 6573 742e 7772           dest.wr
-00014ff0: 6974 6528 6473 7429 0d0a 0d0a 2020 2020  ite(dst)....    
-00015000: 2020 2020 7265 7475 726e 2064 7374 2c20      return dst, 
-00015010: 6473 745f 6d65 7461 0d0a 0d0a 2020 2020  dst_meta....    
-00015020: 4073 7461 7469 636d 6574 686f 640d 0a20  @staticmethod.. 
-00015030: 2020 2064 6566 2072 6561 6441 5343 4949     def readASCII
-00015040: 7346 6f6c 6465 7228 7061 7468 3a20 7374  sFolder(path: st
-00015050: 722c 2070 6978 656c 5f74 7970 653a 2069  r, pixel_type: i
-00015060: 6e74 293a 0d0a 2020 2020 2020 2020 2222  nt):..        ""
-00015070: 2272 6561 6441 5343 4949 7346 6f6c 6465  "readASCIIsFolde
-00015080: 722e 0d0a 0d0a 2020 2020 2020 2020 7468  r.....        th
-00015090: 6973 2066 756e 6374 696f 6e20 7265 6164  is function read
-000150a0: 7320 7261 7374 6572 7320 6672 6f6d 2061  s rasters from a
-000150b0: 2066 6f6c 6465 7220 616e 6420 6372 6561   folder and crea
-000150c0: 7465 7320 6120 3364 2061 7272 6179 7769  tes a 3d arraywi
-000150d0: 7468 2074 6865 2073 616d 650d 0a20 2020  th the same..   
-000150e0: 2020 2020 2032 6420 6469 6d65 6e73 696f       2d dimensio
-000150f0: 6e73 206f 6620 7468 6520 6669 7273 7420  ns of the first 
-00015100: 7261 7374 6572 2069 6e20 7468 6520 666f  raster in the fo
-00015110: 6c64 6572 2061 6e64 206c 656e 2061 7320  lder and len as 
-00015120: 7468 6520 6e75 6d62 6572 206f 6620 6669  the number of fi
-00015130: 6c65 730d 0a20 2020 2020 2020 2069 6e73  les..        ins
-00015140: 6964 6520 7468 6520 666f 6c64 6572 2e0d  ide the folder..
-00015150: 0a20 2020 2020 2020 202d 2061 6c6c 2072  .        - all r
-00015160: 6173 7465 7273 2073 686f 756c 6420 6861  asters should ha
-00015170: 7665 2074 6865 2073 616d 6520 6469 6d65  ve the same dime
-00015180: 6e73 696f 6e73 0d0a 2020 2020 2020 2020  nsions..        
-00015190: 2d20 666f 6c64 6572 2073 686f 756c 6420  - folder should 
-000151a0: 6f6e 6c79 2063 6f6e 7461 696e 2072 6173  only contain ras
-000151b0: 7465 7220 6669 6c65 730d 0a0d 0a20 2020  ter files....   
-000151c0: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
-000151d0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-000151e0: 2d2d 2d0d 0a20 2020 2020 2020 2070 6174  ---..        pat
-000151f0: 683a 205b 5374 7269 6e67 5d0d 0a20 2020  h: [String]..   
-00015200: 2020 2020 2020 2020 2070 6174 6820 6f66           path of
-00015210: 2074 6865 2066 6f6c 6465 7220 7468 6174   the folder that
-00015220: 2063 6f6e 7461 696e 7320 616c 6c20 7468   contains all th
-00015230: 6520 7261 7374 6572 732e 0d0a 2020 2020  e rasters...    
-00015240: 2020 2020 7069 7865 6c5f 7479 7065 3a20      pixel_type: 
-00015250: 5b69 6e74 5d0d 0a0d 0a20 2020 2020 2020  [int]....       
-00015260: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
-00015270: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
-00015280: 2020 2061 7272 5f33 643a 205b 6e75 6d70     arr_3d: [nump
-00015290: 792e 6e64 6172 7261 795d 0d0a 2020 2020  y.ndarray]..    
-000152a0: 2020 2020 2020 2020 3364 2061 7272 6179          3d array
-000152b0: 2063 6f6e 7461 696e 7320 6172 7261 7973   contains arrays
-000152c0: 2072 6561 6420 6672 6f6d 2061 6c6c 2072   read from all r
-000152d0: 6173 7465 7273 2069 6e20 7468 6520 666f  asters in the fo
-000152e0: 6c64 6572 2e0d 0a0d 0a20 2020 2020 2020  lder.....       
-000152f0: 2041 5343 4949 4465 7461 696c 733a 205b   ASCIIDetails: [
-00015300: 4c69 7374 5d0d 0a20 2020 2020 2020 2020  List]..         
-00015310: 2020 206c 6973 7420 6f66 2074 6865 2073     list of the s
-00015320: 6978 2073 7061 7469 616c 2069 6e66 6f72  ix spatial infor
-00015330: 6d61 7469 6f6e 206f 6620 7468 6520 4153  mation of the AS
-00015340: 4349 4920 6669 6c65 0d0a 2020 2020 2020  CII file..      
-00015350: 2020 2020 2020 5b41 5343 4949 526f 7773        [ASCIIRows
-00015360: 2c20 4153 4349 4943 6f6c 756d 6e73 2c20  , ASCIIColumns, 
-00015370: 584c 6f77 4c65 6674 436f 726e 6572 2c20  XLowLeftCorner, 
-00015380: 594c 6f77 4c65 6674 436f 726e 6572 2c0d  YLowLeftCorner,.
-00015390: 0a20 2020 2020 2020 2020 2020 2043 656c  .            Cel
-000153a0: 6c53 697a 652c 204e 6f56 616c 7565 5d0d  lSize, NoValue].
-000153b0: 0a20 2020 2020 2020 2066 696c 6573 3a20  .        files: 
-000153c0: 5b6c 6973 745d 0d0a 2020 2020 2020 2020  [list]..        
-000153d0: 2020 2020 6c69 7374 206f 6620 6e61 6d65      list of name
-000153e0: 7320 6f66 2061 6c6c 2066 696c 6573 2069  s of all files i
-000153f0: 6e73 6964 6520 7468 6520 666f 6c64 6572  nside the folder
-00015400: 0d0a 0d0a 2020 2020 2020 2020 4578 616d  ....        Exam
-00015410: 706c 6573 0d0a 2020 2020 2020 2020 2d2d  ples..        --
-00015420: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-00015430: 3e3e 3e20 7261 7374 6572 5f64 6972 203d  >>> raster_dir =
-00015440: 2022 4153 4349 4920 666f 6c64 6572 2f22   "ASCII folder/"
-00015450: 0d0a 2020 2020 2020 2020 3e3e 3e20 7069  ..        >>> pi
-00015460: 7865 6c5f 7479 7065 203d 2031 0d0a 2020  xel_type = 1..  
-00015470: 2020 2020 2020 3e3e 3e20 4153 4349 4941        >>> ASCIIA
-00015480: 7272 6179 2c20 4153 4349 4944 6574 6169  rray, ASCIIDetai
-00015490: 6c73 2c20 4e61 6d65 4c69 7374 203d 2052  ls, NameList = R
-000154a0: 6173 7465 722e 7265 6164 4153 4349 4973  aster.readASCIIs
-000154b0: 466f 6c64 6572 2872 6173 7465 725f 6469  Folder(raster_di
-000154c0: 722c 2070 6978 656c 5f74 7970 6529 0d0a  r, pixel_type)..
-000154d0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-000154e0: 2020 2020 2023 2069 6e70 7574 2064 6174       # input dat
-000154f0: 6120 7661 6c69 6461 7469 6f6e 0d0a 2020  a validation..  
-00015500: 2020 2020 2020 2320 6461 7461 2074 7970        # data typ
-00015510: 650d 0a20 2020 2020 2020 2061 7373 6572  e..        asser
-00015520: 7420 7479 7065 2870 6174 6829 203d 3d20  t type(path) == 
-00015530: 7374 722c 2022 415f 7061 7468 2069 6e70  str, "A_path inp
-00015540: 7574 2073 686f 756c 6420 6265 2073 7472  ut should be str
-00015550: 696e 6720 7479 7065 220d 0a20 2020 2020  ing type"..     
-00015560: 2020 2023 2069 6e70 7574 2076 616c 7565     # input value
-00015570: 730d 0a20 2020 2020 2020 2023 2063 6865  s..        # che
-00015580: 636b 2077 6574 6865 7220 7468 6520 7061  ck wether the pa
-00015590: 7468 2065 7869 7374 206f 7220 6e6f 740d  th exist or not.
-000155a0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-000155b0: 6f73 2e70 6174 682e 6578 6973 7473 2870  os.path.exists(p
-000155c0: 6174 6829 2c20 2274 6865 2070 6174 6820  ath), "the path 
-000155d0: 796f 7520 6861 7665 2070 726f 7669 6465  you have provide
-000155e0: 6420 646f 6573 206e 6f74 2065 7869 7374  d does not exist
-000155f0: 220d 0a20 2020 2020 2020 2023 2063 6865  "..        # che
-00015600: 636b 2077 6865 7468 6572 2074 6865 7265  ck whether there
-00015610: 2061 7265 2066 696c 6573 206f 7220 6e6f   are files or no
-00015620: 7420 696e 7369 6465 2074 6865 2066 6f6c  t inside the fol
-00015630: 6465 720d 0a20 2020 2020 2020 2061 7373  der..        ass
-00015640: 6572 7420 6f73 2e6c 6973 7464 6972 2870  ert os.listdir(p
-00015650: 6174 6829 2021 3d20 2222 2c20 2274 6865  ath) != "", "the
-00015660: 2070 6174 6820 796f 7520 6861 7665 2070   path you have p
-00015670: 726f 7669 6465 6420 6973 2065 6d70 7479  rovided is empty
-00015680: 220d 0a20 2020 2020 2020 2023 2067 6574  "..        # get
-00015690: 206c 6973 7420 6f66 2061 6c6c 2066 696c   list of all fil
-000156a0: 6573 0d0a 2020 2020 2020 2020 6669 6c65  es..        file
-000156b0: 7320 3d20 6f73 2e6c 6973 7464 6972 2870  s = os.listdir(p
-000156c0: 6174 6829 0d0a 2020 2020 2020 2020 6966  ath)..        if
-000156d0: 2022 6465 736b 746f 702e 696e 6922 2069   "desktop.ini" i
-000156e0: 6e20 6669 6c65 733a 0d0a 2020 2020 2020  n files:..      
-000156f0: 2020 2020 2020 6669 6c65 732e 7265 6d6f        files.remo
-00015700: 7665 2822 6465 736b 746f 702e 696e 6922  ve("desktop.ini"
-00015710: 290d 0a20 2020 2020 2020 2023 2063 6865  )..        # che
-00015720: 636b 2074 6861 7420 666f 6c64 6572 206f  ck that folder o
-00015730: 6e6c 7920 636f 6e74 6169 6e73 2072 6173  nly contains ras
-00015740: 7465 7273 0d0a 2020 2020 2020 2020 6173  ters..        as
-00015750: 7365 7274 2061 6c6c 280d 0a20 2020 2020  sert all(..     
-00015760: 2020 2020 2020 2066 2e65 6e64 7377 6974         f.endswit
-00015770: 6828 222e 6173 6322 2920 666f 7220 6620  h(".asc") for f 
-00015780: 696e 2066 696c 6573 0d0a 2020 2020 2020  in files..      
-00015790: 2020 292c 2022 616c 6c20 6669 6c65 7320    ), "all files 
-000157a0: 696e 2074 6865 2067 6976 656e 2066 6f6c  in the given fol
-000157b0: 6465 7220 7368 6f75 6c64 2068 6176 6520  der should have 
-000157c0: 2e74 6966 2065 7874 656e 7369 6f6e 220d  .tif extension".
-000157d0: 0a20 2020 2020 2020 2023 2063 7265 6174  .        # creat
-000157e0: 6520 6120 3364 2061 7272 6179 2077 6974  e a 3d array wit
-000157f0: 6820 7468 6520 3264 2064 696d 656e 7369  h the 2d dimensi
-00015800: 6f6e 206f 6620 7468 6520 6669 7273 7420  on of the first 
-00015810: 7261 7374 6572 2061 6e64 2074 6865 206c  raster and the l
-00015820: 656e 0d0a 2020 2020 2020 2020 2320 6f66  en..        # of
-00015830: 2074 6865 206e 756d 6265 7220 6f66 2072   the number of r
-00015840: 6173 7465 7273 2069 6e20 7468 6520 666f  asters in the fo
-00015850: 6c64 6572 0d0a 2020 2020 2020 2020 4153  lder..        AS
-00015860: 4349 4956 616c 7565 732c 2041 5343 4949  CIIValues, ASCII
-00015870: 4465 7461 696c 7320 3d20 5261 7374 6572  Details = Raster
-00015880: 2e72 6561 6441 5343 4949 2870 6174 6820  .readASCII(path 
-00015890: 2b20 222f 2220 2b20 6669 6c65 735b 305d  + "/" + files[0]
-000158a0: 2c20 7069 7865 6c5f 7479 7065 290d 0a20  , pixel_type).. 
-000158b0: 2020 2020 2020 206e 6f76 616c 203d 2041         noval = A
-000158c0: 5343 4949 4465 7461 696c 735b 355d 0d0a  SCIIDetails[5]..
-000158d0: 2020 2020 2020 2020 2320 6669 6c6c 2074          # fill t
-000158e0: 6865 2061 7272 6179 2077 6974 6820 6e6f  he array with no
-000158f0: 7661 6c20 6461 7461 0d0a 2020 2020 2020  val data..      
-00015900: 2020 6172 725f 3364 203d 206e 702e 6f6e    arr_3d = np.on
-00015910: 6573 2828 4153 4349 4944 6574 6169 6c73  es((ASCIIDetails
-00015920: 5b30 5d2c 2041 5343 4949 4465 7461 696c  [0], ASCIIDetail
-00015930: 735b 315d 2c20 6c65 6e28 6669 6c65 7329  s[1], len(files)
-00015940: 2929 202a 206e 6f76 616c 0d0a 0d0a 2020  )) * noval....  
-00015950: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
-00015960: 616e 6765 286c 656e 2866 696c 6573 2929  ange(len(files))
-00015970: 3a0d 0a20 2020 2020 2020 2020 2020 2023  :..            #
-00015980: 2072 6561 6420 7468 6520 7469 6620 6669   read the tif fi
-00015990: 6c65 0d0a 2020 2020 2020 2020 2020 2020  le..            
-000159a0: 662c 205f 203d 2052 6173 7465 722e 7265  f, _ = Raster.re
-000159b0: 6164 4153 4349 4928 7061 7468 202b 2022  adASCII(path + "
-000159c0: 2f22 202b 2066 696c 6573 5b30 5d2c 2070  /" + files[0], p
-000159d0: 6978 656c 5f74 7970 6529 0d0a 2020 2020  ixel_type)..    
-000159e0: 2020 2020 2020 2020 6172 725f 3364 5b3a          arr_3d[:
-000159f0: 2c20 3a2c 2069 5d20 3d20 660d 0a0d 0a20  , :, i] = f.... 
-00015a00: 2020 2020 2020 2072 6574 7572 6e20 6172         return ar
-00015a10: 725f 3364 2c20 4153 4349 4944 6574 6169  r_3d, ASCIIDetai
-00015a20: 6c73 2c20 6669 6c65 730d 0a0d 0a20 2020  ls, files....   
-00015a30: 2040 7374 6174 6963 6d65 7468 6f64 0d0a   @staticmethod..
-00015a40: 2020 2020 6465 6620 7261 7374 6572 734c      def rastersL
-00015a50: 696b 6528 7372 633a 2044 6174 6173 6574  ike(src: Dataset
-00015a60: 2c20 6172 7261 793a 206e 702e 6e64 6172  , array: np.ndar
-00015a70: 7261 792c 2070 6174 683a 204c 6973 745b  ray, path: List[
-00015a80: 7374 725d 203d 204e 6f6e 6529 3a0d 0a20  str] = None):.. 
-00015a90: 2020 2020 2020 2022 2222 4372 6561 7465         """Create
-00015aa0: 2052 6173 7465 7220 6c69 6b65 206f 7468   Raster like oth
-00015ab0: 6572 2073 6f75 7263 6520 7261 7374 6572  er source raster
-00015ac0: 2077 6974 6820 6120 6769 7665 6e20 6172   with a given ar
-00015ad0: 7261 792e 0d0a 0d0a 2020 2020 2020 2020  ray.....        
-00015ae0: 2020 2020 2d20 5468 6973 2066 756e 6374      - This funct
-00015af0: 696f 6e20 6372 6561 7465 7320 6120 4765  ion creates a Ge
-00015b00: 6f74 6966 6620 7261 7374 6572 206c 696b  otiff raster lik
-00015b10: 6520 616e 6f74 6865 7220 696e 7075 7420  e another input 
-00015b20: 7261 7374 6572 2c20 6e65 7720 7261 7374  raster, new rast
-00015b30: 6572 2077 696c 6c20 6861 7665 2074 6865  er will have the
-00015b40: 2073 616d 650d 0a20 2020 2020 2020 2020   same..         
-00015b50: 2020 2070 726f 6a65 6374 696f 6e2c 2063     projection, c
-00015b60: 6f6f 7264 696e 6174 6573 206f 7220 7468  oordinates or th
-00015b70: 6520 746f 7020 6c65 6674 2063 6f72 6e65  e top left corne
-00015b80: 7220 6f66 2074 6865 206f 7269 6769 6e61  r of the origina
-00015b90: 6c20 7261 7374 6572 2c20 6365 6c6c 2073  l raster, cell s
-00015ba0: 697a 652c 206e 6f64 6174 6120 7665 6c75  ize, nodata velu
-00015bb0: 652c 2061 6e64 206e 756d 6265 720d 0a20  e, and number.. 
-00015bc0: 2020 2020 2020 2020 2020 206f 6620 726f             of ro
-00015bd0: 7773 2061 6e64 2063 6f6c 756d 6e73 0d0a  ws and columns..
-00015be0: 2020 2020 2020 2020 2020 2020 2d20 7468              - th
-00015bf0: 6520 7261 7374 6572 2061 6e64 2074 6865  e raster and the
-00015c00: 2067 6976 656e 2061 7272 6179 2073 686f   given array sho
-00015c10: 756c 6420 6861 7665 2074 6865 2073 616d  uld have the sam
-00015c20: 6520 6e75 6d62 6572 206f 6620 636f 6c75  e number of colu
-00015c30: 6d6e 7320 616e 6420 726f 7773 2e0d 0a0d  mns and rows....
-00015c40: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00015c50: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
-00015c60: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00015c70: 2073 7263 3a20 5b67 6461 6c2e 6461 7461   src: [gdal.data
-00015c80: 7365 745d 0d0a 2020 2020 2020 2020 2020  set]..          
-00015c90: 2020 736f 7572 6365 2072 6173 7465 7220    source raster 
-00015ca0: 746f 2067 6574 2074 6865 2073 7061 7469  to get the spati
-00015cb0: 616c 2069 6e66 6f72 6d61 7469 6f6e 0d0a  al information..
-00015cc0: 2020 2020 2020 2020 6172 7261 793a 205b          array: [
-00015cd0: 6e75 6d70 7920 6172 7261 795d 0d0a 2020  numpy array]..  
-00015ce0: 2020 2020 2020 2020 2020 3344 2061 7272            3D arr
-00015cf0: 6179 2074 6f20 6265 2073 746f 7265 7320  ay to be stores 
-00015d00: 6173 2061 2072 6173 7465 7273 2c20 7468  as a rasters, th
-00015d10: 6520 6469 6d65 6e73 696f 6e73 2073 686f  e dimensions sho
-00015d20: 756c 6420 6265 0d0a 2020 2020 2020 2020  uld be..        
-00015d30: 2020 2020 5b72 6f77 732c 2063 6f6c 756d      [rows, colum
-00015d40: 6e73 2c20 7469 6d65 7365 7269 6573 206c  ns, timeseries l
-00015d50: 656e 6774 685d 0d0a 2020 2020 2020 2020  ength]..        
-00015d60: 7061 7468 3a20 5b53 7472 696e 675d 0d0a  path: [String]..
-00015d70: 2020 2020 2020 2020 2020 2020 6c69 7374              list
-00015d80: 206f 6620 6e61 6d65 7320 746f 2073 6176   of names to sav
-00015d90: 6520 7468 6520 6e65 7720 7261 7374 6572  e the new raster
-00015da0: 730d 0a20 2020 2020 2020 2020 2020 206c  s..            l
-00015db0: 696b 6520 5b22 7265 7375 6c74 732f 7375  ike ["results/su
-00015dc0: 7266 6163 6544 6973 6368 6172 6765 5f32  rfaceDischarge_2
-00015dd0: 3031 325f 3038 5f31 335f 3233 2e74 6966  012_08_13_23.tif
-00015de0: 222c 2272 6573 756c 7473 2f73 7572 6661  ","results/surfa
-00015df0: 6365 4469 7363 6861 7267 655f 3230 3132  ceDischarge_2012
-00015e00: 5f30 385f 3134 5f30 302e 7469 6622 5d0d  _08_14_00.tif"].
-00015e10: 0a20 2020 2020 2020 2020 2020 2044 6566  .            Def
-00015e20: 6175 6c74 2076 616c 7565 2069 7320 4e6f  ault value is No
-00015e30: 6e65 0d0a 0d0a 2020 2020 2020 2020 5265  ne....        Re
-00015e40: 7475 726e 730d 0a20 2020 2020 2020 202d  turns..        -
-00015e50: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-00015e60: 7361 7665 2074 6865 206e 6577 2072 6173  save the new ras
-00015e70: 7465 7220 746f 2074 6865 2067 6976 656e  ter to the given
-00015e80: 2070 6174 680d 0a0d 0a20 2020 2020 2020   path....       
-00015e90: 2045 7861 6d70 6c65 730d 0a20 2020 2020   Examples..     
-00015ea0: 2020 202d 2d2d 2d2d 2d2d 2d0d 0a20 2020     --------..   
-00015eb0: 2020 2020 203e 3e3e 2073 7263 5f72 6173       >>> src_ras
-00015ec0: 7465 7220 3d20 6764 616c 2e4f 7065 6e28  ter = gdal.Open(
-00015ed0: 2244 454d 2e74 6966 2229 0d0a 2020 2020  "DEM.tif")..    
-00015ee0: 2020 2020 3e3e 3e20 6e61 6d65 203d 205b      >>> name = [
-00015ef0: 2251 5f32 3031 325f 3031 5f30 315f 3031  "Q_2012_01_01_01
-00015f00: 2e74 6966 222c 2251 5f32 3031 325f 3031  .tif","Q_2012_01
-00015f10: 5f30 315f 3032 2e74 6966 222c 2251 5f32  _01_02.tif","Q_2
-00015f20: 3031 325f 3031 5f30 315f 3033 2e74 6966  012_01_01_03.tif
-00015f30: 222c 2251 5f32 3031 325f 3031 5f30 315f  ","Q_2012_01_01_
-00015f40: 3034 2e74 6966 225d 0d0a 2020 2020 2020  04.tif"]..      
-00015f50: 2020 3e3e 3e20 5261 7374 6572 2e72 6173    >>> Raster.ras
-00015f60: 7465 7273 4c69 6b65 2873 7263 5f72 6173  tersLike(src_ras
-00015f70: 7465 722c 2064 6174 612c 206e 616d 6529  ter, data, name)
-00015f80: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-00015f90: 2020 2020 2020 2023 206c 656e 6774 6820         # length 
-00015fa0: 6f66 2074 6865 2033 7264 2064 696d 656e  of the 3rd dimen
-00015fb0: 7369 6f6e 206f 6620 7468 6520 6172 7261  sion of the arra
-00015fc0: 790d 0a20 2020 2020 2020 2074 7279 3a0d  y..        try:.
-00015fd0: 0a20 2020 2020 2020 2020 2020 206c 203d  .            l =
-00015fe0: 206e 702e 7368 6170 6528 6172 7261 7929   np.shape(array)
-00015ff0: 5b32 5d0d 0a20 2020 2020 2020 2065 7863  [2]..        exc
-00016000: 6570 7420 496e 6465 7845 7272 6f72 3a0d  ept IndexError:.
-00016010: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00016020: 7365 2049 6e64 6578 4572 726f 7228 0d0a  se IndexError(..
-00016030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016040: 2274 6865 2061 7272 6179 2079 6f75 2068  "the array you h
-00016050: 6176 6520 656e 7465 7265 6420 6973 2032  ave entered is 2
-00016060: 4420 796f 7520 6861 7665 2074 6f20 7573  D you have to us
-00016070: 6520 5261 7374 6572 4c69 6b65 2066 756e  e RasterLike fun
-00016080: 6374 696f 6e20 6e6f 7420 5261 7374 6572  ction not Raster
-00016090: 734c 696b 6522 0d0a 2020 2020 2020 2020  sLike"..        
-000160a0: 2020 2020 290d 0a0d 0a20 2020 2020 2020      )....       
-000160b0: 2023 2063 6865 636b 206c 656e 6774 6820   # check length 
-000160c0: 6f66 2074 6865 206c 6973 7420 6f66 206e  of the list of n
-000160d0: 616d 6573 2074 6f20 6265 2065 7175 616c  ames to be equal
-000160e0: 2074 6f20 3372 6420 6469 6d65 6e73 696f   to 3rd dimensio
-000160f0: 6e20 6f66 2074 6865 2061 7272 6179 0d0a  n of the array..
-00016100: 2020 2020 2020 2020 6966 2070 6174 6820          if path 
-00016110: 6973 206e 6f74 204e 6f6e 653a 2020 2320  is not None:  # 
-00016120: 7061 7468 7320 6172 6520 6769 7665 6e0d  paths are given.
-00016130: 0a20 2020 2020 2020 2020 2020 2061 7373  .            ass
-00016140: 6572 7420 6c65 6e28 7061 7468 2920 3d3d  ert len(path) ==
-00016150: 206e 702e 7368 6170 6528 6172 7261 7929   np.shape(array)
-00016160: 5b32 5d2c 2028 0d0a 2020 2020 2020 2020  [2], (..        
-00016170: 2020 2020 2020 2020 6622 6c65 6e67 7468          f"length
-00016180: 206f 6620 6c69 7374 206f 6620 6e61 6d65   of list of name
-00016190: 7320 7b6c 656e 2870 6174 6829 7d20 7368  s {len(path)} sh
-000161a0: 6f75 6c64 2065 7175 616c 2074 6865 2033  ould equal the 3
-000161b0: 6420 220d 0a20 2020 2020 2020 2020 2020  d "..           
-000161c0: 2020 2020 2066 2264 696d 656e 7369 6f6e       f"dimension
-000161d0: 206f 6620 7468 6520 6172 7261 792d 7b6e   of the array-{n
-000161e0: 702e 7368 6170 6528 6172 7261 7929 5b32  p.shape(array)[2
-000161f0: 5d7d 220d 0a20 2020 2020 2020 2020 2020  ]}"..           
-00016200: 2029 0d0a 2020 2020 2020 2020 656c 7365   )..        else
-00016210: 3a20 2023 2070 6174 6873 2061 7265 206e  :  # paths are n
-00016220: 6f74 2067 6976 656e 0d0a 2020 2020 2020  ot given..      
-00016230: 2020 2020 2020 2320 7472 7920 746f 2063        # try to c
-00016240: 7265 6174 6520 6120 666f 6c64 6572 2063  reate a folder c
-00016250: 616c 6c65 6420 7265 7375 6c74 7320 6174  alled results at
-00016260: 2074 6865 2063 7572 7265 6e74 2077 6f72   the current wor
-00016270: 6b69 6e67 2064 6972 6563 746f 7279 2074  king directory t
-00016280: 6f20 7374 6f72 6520 7265 7375 6c74 6564  o store resulted
-00016290: 2072 6173 7465 7273 0d0a 2020 2020 2020   rasters..      
-000162a0: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
-000162b0: 2020 2020 2020 2020 2020 2020 6f73 2e6d              os.m
-000162c0: 616b 6564 6972 7328 6f73 2e70 6174 682e  akedirs(os.path.
-000162d0: 6a6f 696e 286f 732e 6765 7463 7764 2829  join(os.getcwd()
-000162e0: 2c20 2272 6573 756c 745f 7261 7374 6572  , "result_raster
-000162f0: 7322 2929 0d0a 2020 2020 2020 2020 2020  s"))..          
-00016300: 2020 6578 6365 7074 2057 696e 646f 7773    except Windows
-00016310: 4572 726f 723a 0d0a 2020 2020 2020 2020  Error:..        
-00016320: 2020 2020 2020 2020 6173 7365 7274 2028          assert (
-00016330: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00016340: 2020 2020 2020 4661 6c73 650d 0a20 2020        False..   
-00016350: 2020 2020 2020 2020 2020 2020 2029 2c20               ), 
-00016360: 2270 6c65 6173 6520 6569 7468 6572 2074  "please either t
-00016370: 6f20 7072 6f76 6964 6520 796f 7572 206f  o provide your o
-00016380: 776e 2070 6174 6873 2069 6e63 6c75 6469  wn paths includi
-00016390: 6e67 2066 6f6c 6465 7220 6e61 6d65 2061  ng folder name a
-000163a0: 6e64 2072 6173 7465 726e 616d 6573 2e74  nd rasternames.t
-000163b0: 6966 2069 6e20 6120 6c69 7374 206f 7220  if in a list or 
-000163c0: 7265 6e61 6d65 2074 6865 2066 6f6c 6465  rename the folde
-000163d0: 7220 6361 6c6c 6564 2072 6573 756c 745f  r called result_
-000163e0: 7261 7374 6572 7322 0d0a 2020 2020 2020  rasters"..      
-000163f0: 2020 2020 2020 2320 6361 7265 6174 6520        # careate 
-00016400: 6c69 7374 206f 6620 6e61 6d65 730d 0a20  list of names.. 
-00016410: 2020 2020 2020 2020 2020 2070 6174 6820             path 
-00016420: 3d20 5b22 7265 7375 6c74 5f72 6173 7465  = ["result_raste
-00016430: 7273 2f22 202b 2073 7472 2869 2920 2b20  rs/" + str(i) + 
-00016440: 222e 7469 6622 2066 6f72 2069 2069 6e20  ".tif" for i in 
-00016450: 7261 6e67 6528 6c29 5d0d 0a0d 0a20 2020  range(l)]....   
-00016460: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
-00016470: 6e67 6528 6c29 3a0d 0a20 2020 2020 2020  nge(l):..       
-00016480: 2020 2020 2052 6173 7465 722e 7261 7374       Raster.rast
-00016490: 6572 4c69 6b65 2873 7263 2c20 6172 7261  erLike(src, arra
-000164a0: 795b 3a2c 203a 2c20 695d 2c20 7061 7468  y[:, :, i], path
-000164b0: 5b69 5d29 0d0a 0d0a 2020 2020 4073 7461  [i])....    @sta
-000164c0: 7469 636d 6574 686f 640d 0a20 2020 2064  ticmethod..    d
-000164d0: 6566 206d 6174 6368 4461 7461 416c 6967  ef matchDataAlig
-000164e0: 6e6d 656e 7428 7372 635f 616c 6967 6e6d  nment(src_alignm
-000164f0: 656e 743a 2073 7472 2c20 7261 7374 6572  ent: str, raster
-00016500: 735f 6469 723a 2073 7472 2c20 7361 7665  s_dir: str, save
-00016510: 5f74 6f3a 2073 7472 293a 0d0a 2020 2020  _to: str):..    
-00016520: 2020 2020 2222 226d 6174 6368 4461 7461      """matchData
-00016530: 416c 6967 6e6d 656e 742e 0d0a 0d0a 2020  Alignment.....  
-00016540: 2020 2020 2020 7468 6973 2066 756e 6374        this funct
-00016550: 696f 6e20 6d61 7463 6865 7320 7468 6520  ion matches the 
-00016560: 636f 6f72 6469 6e61 7465 2073 7973 7465  coordinate syste
-00016570: 6d20 616e 6420 7468 6520 6e75 6d62 6572  m and the number
-00016580: 206f 6620 6f66 2072 6f77 7320 2620 636f   of of rows & co
-00016590: 6c75 6d6e 730d 0a20 2020 2020 2020 2062  lumns..        b
-000165a0: 6574 7765 656e 2074 776f 2072 6173 7465  etween two raste
-000165b0: 7273 0d0a 2020 2020 2020 2020 5261 7374  rs..        Rast
-000165c0: 6572 2041 2069 7320 7468 6520 736f 7572  er A is the sour
-000165d0: 6365 206f 6620 7468 6520 636f 6f72 6469  ce of the coordi
-000165e0: 6e61 7465 2073 7973 7465 6d2c 206e 6f20  nate system, no 
-000165f0: 6f66 2072 6f77 7320 616e 6420 6e6f 206f  of rows and no o
-00016600: 6620 636f 6c75 6d6e 7320 2620 6365 6c6c  f columns & cell
-00016610: 2073 697a 650d 0a20 2020 2020 2020 2072   size..        r
-00016620: 6173 7465 7273 5f64 6972 2069 7320 7061  asters_dir is pa
-00016630: 7468 2074 6f20 7468 6520 666f 6c64 6572  th to the folder
-00016640: 2077 6865 7265 2052 6173 7465 7220 4220   where Raster B 
-00016650: 6578 6973 7420 7768 6572 6520 2052 6173  exist where  Ras
-00016660: 7465 7220 4220 6973 0d0a 2020 2020 2020  ter B is..      
-00016670: 2020 7468 6520 736f 7572 6365 206f 6620    the source of 
-00016680: 6461 7461 2076 616c 7565 7320 696e 2063  data values in c
-00016690: 656c 6c73 0d0a 2020 2020 2020 2020 7468  ells..        th
-000166a0: 6520 7265 7375 6c74 2077 696c 6c20 6265  e result will be
-000166b0: 2061 2072 6173 7465 7220 7769 7468 2074   a raster with t
-000166c0: 6865 2073 616d 6520 7374 7275 6374 7572  he same structur
-000166d0: 6520 6c69 6b65 2052 6173 7465 7241 2062  e like RasterA b
-000166e0: 7574 2077 6974 680d 0a20 2020 2020 2020  ut with..       
-000166f0: 2076 616c 7565 7320 6672 6f6d 2052 6173   values from Ras
-00016700: 7465 7242 2075 7369 6e67 204e 6561 7265  terB using Neare
-00016710: 7374 204e 6569 6768 626f 7572 2069 6e74  st Neighbour int
-00016720: 6572 706f 6c61 7469 6f6e 2061 6c67 6f72  erpolation algor
-00016730: 6974 686d 0d0a 0d0a 2020 2020 2020 2020  ithm....        
-00016740: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
-00016750: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
-00016760: 2020 2020 2020 2020 7372 635f 616c 6967          src_alig
-00016770: 6e6d 656e 743a 205b 5374 7269 6e67 5d0d  nment: [String].
-00016780: 0a20 2020 2020 2020 2020 2020 2070 6174  .            pat
-00016790: 6820 746f 2074 6865 2073 7061 7469 616c  h to the spatial
-000167a0: 2069 6e66 6f72 6d61 7469 6f6e 2073 6f75   information sou
-000167b0: 7263 6520 7261 7374 6572 2074 6f20 6765  rce raster to ge
-000167c0: 7420 7468 6520 7370 6174 6961 6c20 696e  t the spatial in
-000167d0: 666f 726d 6174 696f 6e0d 0a20 2020 2020  formation..     
-000167e0: 2020 2020 2020 2028 636f 6f72 6469 6e61         (coordina
-000167f0: 7465 2073 7973 7465 6d2c 206e 6f20 6f66  te system, no of
-00016800: 2072 6f77 7320 2620 636f 6c75 6d6e 7329   rows & columns)
-00016810: 2073 7263 5f61 6c69 676e 6d65 6e74 2073   src_alignment s
-00016820: 686f 756c 6420 696e 636c 7564 6520 7468  hould include th
-00016830: 6520 6e61 6d65 206f 6620 7468 6520 7261  e name of the ra
-00016840: 7374 6572 0d0a 2020 2020 2020 2020 2020  ster..          
-00016850: 2020 616e 6420 7468 6520 6578 7465 6e73    and the extens
-00016860: 696f 6e20 6c69 6b65 2022 6461 7461 2f64  ion like "data/d
-00016870: 656d 2e74 6966 220d 0a20 2020 2020 2020  em.tif"..       
-00016880: 2072 6173 7465 7273 5f64 6972 3a20 5b53   rasters_dir: [S
-00016890: 7472 696e 675d 0d0a 2020 2020 2020 2020  tring]..        
-000168a0: 2020 2020 7061 7468 206f 6620 7468 6520      path of the 
-000168b0: 666f 6c64 6572 206f 6620 7468 6520 7261  folder of the ra
-000168c0: 7374 6572 7320 2852 6173 7465 7220 4229  sters (Raster B)
-000168d0: 2079 6f75 2077 616e 7420 746f 2061 646a   you want to adj
-000168e0: 7573 7420 7468 6569 720d 0a20 2020 2020  ust their..     
-000168f0: 2020 2020 2020 206e 6f20 6f66 2072 6f77         no of row
-00016900: 732c 2063 6f6c 756d 6e73 2061 6e64 2072  s, columns and r
-00016910: 6573 6f6c 7574 696f 6e20 2861 6c69 676e  esolution (align
-00016920: 6d65 6e74 2920 6c69 6b65 2072 6173 7465  ment) like raste
-00016930: 7220 410d 0a20 2020 2020 2020 2020 2020  r A..           
-00016940: 2074 6865 2066 6f6c 6465 7220 7368 6f75   the folder shou
-00016950: 6c64 206e 6f74 2068 6176 6520 616e 7920  ld not have any 
-00016960: 6f74 6865 7220 6669 6c65 7320 6578 6365  other files exce
-00016970: 7074 2074 6865 2072 6173 7465 7273 0d0a  pt the rasters..
-00016980: 2020 2020 2020 2020 7361 7665 5f74 6f3a          save_to:
-00016990: 205b 5374 7269 6e67 5d0d 0a20 2020 2020   [String]..     
-000169a0: 2020 2020 2020 2070 6174 6820 7768 6572         path wher
-000169b0: 6520 6e65 7720 7261 7374 6572 7320 6172  e new rasters ar
-000169c0: 6520 676f 696e 6720 746f 2062 6520 7361  e going to be sa
-000169d0: 7665 6420 7769 7468 2065 7861 6374 0d0a  ved with exact..
-000169e0: 2020 2020 2020 2020 2020 2020 7361 6d65              same
-000169f0: 206f 6c64 206e 616d 6573 0d0a 0d0a 2020   old names....  
-00016a00: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
-00016a10: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
-00016a20: 2020 2020 2020 2020 6e65 7720 7261 7374          new rast
-00016a30: 6572 733a 0d0a 2020 2020 2020 2020 2020  ers:..          
-00016a40: 2020 d98c 5261 7374 6572 7320 6861 7665    ..Rasters have
-00016a50: 2074 6865 2076 616c 7565 7320 6672 6f6d   the values from
-00016a60: 2072 6173 7465 7273 2069 6e20 7261 7374   rasters in rast
-00016a70: 6572 735f 6469 7220 7769 7468 2074 6865  ers_dir with the
-00016a80: 2073 616d 650d 0a20 2020 2020 2020 2020   same..         
-00016a90: 2020 2063 656c 6c20 7369 7a65 2c20 6e6f     cell size, no
-00016aa0: 206f 6620 726f 7773 2026 2063 6f6c 756d   of rows & colum
-00016ab0: 6e73 2c20 636f 6f72 6469 6e61 7465 2073  ns, coordinate s
-00016ac0: 7973 7465 6d20 616e 6420 616c 6967 6e6d  ystem and alignm
-00016ad0: 656e 7420 6c69 6b65 2072 6173 7465 7220  ent like raster 
-00016ae0: 410d 0a0d 0a20 2020 2020 2020 2045 7861  A....        Exa
-00016af0: 6d70 6c65 730d 0a20 2020 2020 2020 202d  mples..        -
-00016b00: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00016b10: 203e 3e3e 2064 656d 5f70 6174 6820 3d20   >>> dem_path = 
-00016b20: 2230 3147 4953 2f69 6e70 7574 732f 3430  "01GIS/inputs/40
-00016b30: 3030 2f61 6363 3430 3030 2e74 6966 220d  00/acc4000.tif".
-00016b40: 0a20 2020 2020 2020 203e 3e3e 2070 7265  .        >>> pre
-00016b50: 635f 696e 5f70 6174 6820 3d20 2230 3250  c_in_path = "02P
-00016b60: 7265 6369 7069 7461 7469 6f6e 2f43 4849  recipitation/CHI
-00016b70: 5250 532f 4461 696c 792f 220d 0a20 2020  RPS/Daily/"..   
-00016b80: 2020 2020 203e 3e3e 2070 7265 635f 6f75       >>> prec_ou
-00016b90: 745f 7061 7468 203d 2022 3032 5072 6563  t_path = "02Prec
-00016ba0: 6970 6974 6174 696f 6e2f 346b 6d2f 220d  ipitation/4km/".
-00016bb0: 0a20 2020 2020 2020 203e 3e3e 2052 6173  .        >>> Ras
-00016bc0: 7465 722e 6d61 7463 6844 6174 6141 6c69  ter.matchDataAli
-00016bd0: 676e 6d65 6e74 2864 656d 5f70 6174 682c  gnment(dem_path,
-00016be0: 7072 6563 5f69 6e5f 7061 7468 2c70 7265  prec_in_path,pre
-00016bf0: 635f 6f75 745f 7061 7468 290d 0a20 2020  c_out_path)..   
-00016c00: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-00016c10: 2020 2320 696e 7075 7420 6461 7461 2076    # input data v
-00016c20: 616c 6964 6174 696f 6e0d 0a20 2020 2020  alidation..     
-00016c30: 2020 2023 2064 6174 6120 7479 7065 0d0a     # data type..
-00016c40: 2020 2020 2020 2020 6173 7365 7274 2074          assert t
-00016c50: 7970 6528 7372 635f 616c 6967 6e6d 656e  ype(src_alignmen
-00016c60: 7429 203d 3d20 7374 722c 2022 7372 635f  t) == str, "src_
-00016c70: 616c 6967 6e6d 656e 7420 696e 7075 7420  alignment input 
-00016c80: 7368 6f75 6c64 2062 6520 7374 7269 6e67  should be string
-00016c90: 2074 7970 6522 0d0a 2020 2020 2020 2020   type"..        
-00016ca0: 6173 7365 7274 2074 7970 6528 7261 7374  assert type(rast
-00016cb0: 6572 735f 6469 7229 203d 3d20 7374 722c  ers_dir) == str,
-00016cc0: 2022 7261 7374 6572 735f 6469 7220 696e   "rasters_dir in
-00016cd0: 7075 7420 7368 6f75 6c64 2062 6520 7374  put should be st
-00016ce0: 7269 6e67 2074 7970 6522 0d0a 2020 2020  ring type"..    
-00016cf0: 2020 2020 6173 7365 7274 2074 7970 6528      assert type(
-00016d00: 7361 7665 5f74 6f29 203d 3d20 7374 722c  save_to) == str,
-00016d10: 2022 7361 7665 5f74 6f20 696e 7075 7420   "save_to input 
-00016d20: 7368 6f75 6c64 2062 6520 7374 7269 6e67  should be string
-00016d30: 2074 7970 6522 0d0a 2020 2020 2020 2020   type"..        
-00016d40: 2320 696e 7075 7420 7661 6c75 6573 0d0a  # input values..
-00016d50: 2020 2020 2020 2020 6578 7420 3d20 7372          ext = sr
-00016d60: 635f 616c 6967 6e6d 656e 745b 2d34 3a5d  c_alignment[-4:]
-00016d70: 0d0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
-00016d80: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
-00016d90: 6578 7420 3d3d 2022 2e74 6966 220d 0a20  ext == ".tif".. 
-00016da0: 2020 2020 2020 2029 2c20 2270 6c65 6173         ), "pleas
-00016db0: 6520 6164 6420 7468 6520 6578 7465 6e73  e add the extens
-00016dc0: 696f 6e28 2e74 6966 2920 6174 2074 6865  ion(.tif) at the
-00016dd0: 2065 6e64 206f 6620 7468 6520 7061 7468   end of the path
-00016de0: 2069 6e70 7574 220d 0a0d 0a20 2020 2020   input"....     
-00016df0: 2020 2041 203d 2067 6461 6c2e 4f70 656e     A = gdal.Open
-00016e00: 2873 7263 5f61 6c69 676e 6d65 6e74 290d  (src_alignment).
-00016e10: 0a20 2020 2020 2020 2066 696c 6573 5f6c  .        files_l
-00016e20: 6973 7420 3d20 6f73 2e6c 6973 7464 6972  ist = os.listdir
-00016e30: 2872 6173 7465 7273 5f64 6972 290d 0a20  (rasters_dir).. 
-00016e40: 2020 2020 2020 2069 6620 2264 6573 6b74         if "deskt
-00016e50: 6f70 2e69 6e69 2220 696e 2066 696c 6573  op.ini" in files
-00016e60: 5f6c 6973 743a 0d0a 2020 2020 2020 2020  _list:..        
-00016e70: 2020 2020 6669 6c65 735f 6c69 7374 2e72      files_list.r
-00016e80: 656d 6f76 6528 2264 6573 6b74 6f70 2e69  emove("desktop.i
-00016e90: 6e69 2229 0d0a 0d0a 2020 2020 2020 2020  ni")....        
-00016ea0: 7072 696e 7428 6622 4e65 7720 5061 7468  print(f"New Path
-00016eb0: 2d20 7b73 6176 655f 746f 7d22 290d 0a20  - {save_to}").. 
-00016ec0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-00016ed0: 7261 6e67 6528 6c65 6e28 6669 6c65 735f  range(len(files_
-00016ee0: 6c69 7374 2929 3a0d 0a20 2020 2020 2020  list)):..       
-00016ef0: 2020 2020 2069 6620 6669 6c65 735f 6c69       if files_li
-00016f00: 7374 5b69 5d5b 2d34 3a5d 203d 3d20 222e  st[i][-4:] == ".
-00016f10: 7469 6622 3a0d 0a20 2020 2020 2020 2020  tif":..         
-00016f20: 2020 2020 2020 2070 7269 6e74 2866 227b         print(f"{
-00016f30: 6920 2b20 317d 2f7b 6c65 6e28 6669 6c65  i + 1}/{len(file
-00016f40: 735f 6c69 7374 297d 202d 207b 7361 7665  s_list)} - {save
-00016f50: 5f74 6f7d 2066 696c 6573 5f6c 6973 745b  _to} files_list[
-00016f60: 695d 2229 0d0a 2020 2020 2020 2020 2020  i]")..          
-00016f70: 2020 2020 2020 4220 3d20 6764 616c 2e4f        B = gdal.O
-00016f80: 7065 6e28 7261 7374 6572 735f 6469 7220  pen(rasters_dir 
-00016f90: 2b20 6669 6c65 735f 6c69 7374 5b69 5d29  + files_list[i])
-00016fa0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00016fb0: 2020 6e65 775f 4220 3d20 5261 7374 6572    new_B = Raster
-00016fc0: 2e6d 6174 6368 5261 7374 6572 416c 6967  .matchRasterAlig
-00016fd0: 6e6d 656e 7428 412c 2042 290d 0a20 2020  nment(A, B)..   
-00016fe0: 2020 2020 2020 2020 2020 2020 2052 6173               Ras
-00016ff0: 7465 722e 7361 7665 5261 7374 6572 286e  ter.saveRaster(n
-00017000: 6577 5f42 2c20 7361 7665 5f74 6f20 2b20  ew_B, save_to + 
-00017010: 6669 6c65 735f 6c69 7374 5b69 5d29 0d0a  files_list[i])..
-00017020: 0d0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
-00017030: 686f 640d 0a20 2020 2064 6566 2066 6f6c  hod..    def fol
-00017040: 6465 7243 616c 6375 6c61 746f 7228 7261  derCalculator(ra
-00017050: 7374 6572 735f 6469 723a 2073 7472 2c20  sters_dir: str, 
-00017060: 7361 7665 5f74 6f3a 2073 7472 2c20 6675  save_to: str, fu
-00017070: 6e63 7469 6f6e 293a 0d0a 2020 2020 2020  nction):..      
-00017080: 2020 2222 2266 6f6c 6465 7243 616c 6375    """folderCalcu
-00017090: 6c61 746f 722e 0d0a 0d0a 2020 2020 2020  lator.....      
-000170a0: 2020 7468 6973 2066 756e 6374 696f 6e20    this function 
-000170b0: 6d61 7463 6865 7320 7468 6520 6c6f 6361  matches the loca
-000170c0: 7469 6f6e 206f 6620 6e6f 6461 7461 2076  tion of nodata v
-000170d0: 616c 7565 2066 726f 6d20 7372 6320 7261  alue from src ra
-000170e0: 7374 6572 2074 6f20 6473 740d 0a20 2020  ster to dst..   
-000170f0: 2020 2020 2072 6173 7465 720d 0a20 2020       raster..   
-00017100: 2020 2020 2052 6173 7465 7220 4120 6973       Raster A is
-00017110: 2077 6865 7265 2074 6865 204e 6f44 6174   where the NoDat
-00017120: 6176 616c 7565 2077 696c 6c20 6265 2074  avalue will be t
-00017130: 616b 656e 2061 6e64 2074 6865 206c 6f63  aken and the loc
-00017140: 6174 696f 6e20 6f66 2074 6869 7320 7661  ation of this va
-00017150: 6c75 650d 0a20 2020 2020 2020 2042 5f69  lue..        B_i
-00017160: 6e70 7574 5f70 6174 6820 6973 2070 6174  nput_path is pat
-00017170: 6820 746f 2074 6865 2066 6f6c 6465 7220  h to the folder 
-00017180: 7768 6572 6520 5261 7374 6572 2042 2065  where Raster B e
-00017190: 7869 7374 2077 6865 7265 2020 7765 206e  xist where  we n
-000171a0: 6565 6420 746f 2070 7574 0d0a 2020 2020  eed to put..    
-000171b0: 2020 2020 7468 6520 4e6f 4461 7461 5661      the NoDataVa
-000171c0: 6c75 6520 6f66 2052 6173 7465 7241 2069  lue of RasterA i
-000171d0: 6e20 5261 7374 6572 4220 6174 2074 6865  n RasterB at the
-000171e0: 2073 616d 6520 6c6f 6361 7469 6f6e 730d   same locations.
-000171f0: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-00017200: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
-00017210: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
-00017220: 2020 2072 6173 7465 7273 5f64 6972 3a20     rasters_dir: 
-00017230: 5b53 7472 696e 675d 0d0a 2020 2020 2020  [String]..      
-00017240: 2020 2020 2020 7061 7468 206f 6620 7468        path of th
-00017250: 6520 666f 6c64 6572 206f 6620 7261 7374  e folder of rast
-00017260: 6572 7320 796f 7520 7761 6e74 2074 6f20  ers you want to 
-00017270: 6578 6563 7574 6520 6120 6365 7274 6169  execute a certai
-00017280: 6e20 6675 6e63 7469 6f6e 206f 6e20 616c  n function on al
-00017290: 6c0d 0a20 2020 2020 2020 2020 2020 206f  l..            o
-000172a0: 6620 7468 656d 0d0a 2020 2020 2020 2020  f them..        
-000172b0: 7361 7665 5f74 6f3a 205b 5374 7269 6e67  save_to: [String
-000172c0: 5d0d 0a20 2020 2020 2020 2020 2020 2070  ]..            p
-000172d0: 6174 6820 6f66 2074 6865 2066 6f6c 6465  ath of the folde
-000172e0: 7220 7768 6572 6520 7265 7375 6c74 6564  r where resulted
-000172f0: 2072 6173 7465 7220 7769 6c6c 2062 6520   raster will be 
-00017300: 7361 7665 640d 0a20 2020 2020 2020 2066  saved..        f
-00017310: 756e 6374 696f 6e3a 205b 6675 6e63 7469  unction: [functi
-00017320: 6f6e 5d0d 0a20 2020 2020 2020 2020 2020  on]..           
-00017330: 2063 616c 6c61 626c 6520 6675 6e63 7469   callable functi
-00017340: 6f6e 2028 6275 696c 7469 6e20 6f72 2075  on (builtin or u
-00017350: 7365 7220 6465 6669 6e65 6429 0d0a 0d0a  ser defined)....
-00017360: 2020 2020 2020 2020 5265 7475 726e 730d          Returns.
-00017370: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00017380: 0d0a 2020 2020 2020 2020 6e65 7720 7261  ..        new ra
-00017390: 7374 6572 7320 7769 6c6c 2062 6520 7361  sters will be sa
-000173a0: 7665 6420 746f 2074 6865 2073 6176 655f  ved to the save_
-000173b0: 746f 0d0a 0d0a 2020 2020 2020 2020 4578  to....        Ex
-000173c0: 616d 706c 6573 0d0a 2020 2020 2020 2020  amples..        
-000173d0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-000173e0: 2020 3e3e 3e20 6465 6620 6675 6e63 2861    >>> def func(a
-000173f0: 7267 7329 3a0d 0a20 2020 2020 2020 202e  rgs):..        .
-00017400: 2e2e 2020 2020 4120 3d20 6172 6773 5b30  ..    A = args[0
-00017410: 5d0d 0a20 2020 2020 2020 202e 2e2e 2020  ]..        ...  
-00017420: 2020 6675 6e63 696f 6e20 3d20 6e70 2e61    funcion = np.a
-00017430: 6273 0d0a 2020 2020 2020 2020 2e2e 2e20  bs..        ... 
-00017440: 2020 2070 6174 6820 3d20 6172 6773 5b31     path = args[1
-00017450: 5d0d 0a20 2020 2020 2020 202e 2e2e 2020  ]..        ...  
-00017460: 2020 4220 3d20 5261 7374 6572 2e6d 6170    B = Raster.map
-00017470: 416c 6765 6272 6128 412c 2066 756e 6369  Algebra(A, funci
-00017480: 6f6e 290d 0a20 2020 2020 2020 202e 2e2e  on)..        ...
-00017490: 2020 2020 5261 7374 6572 2e73 6176 6552      Raster.saveR
-000174a0: 6173 7465 7228 422c 2070 6174 6829 0d0a  aster(B, path)..
-000174b0: 0d0a 2020 2020 2020 2020 3e3e 3e20 7261  ..        >>> ra
-000174c0: 7374 6572 735f 6469 7220 3d20 2230 3357  sters_dir = "03W
-000174d0: 6561 7468 6572 5f44 6174 612f 6e65 772f  eather_Data/new/
-000174e0: 346b 6d5f 662f 6576 6170 2f22 0d0a 2020  4km_f/evap/"..  
-000174f0: 2020 2020 2020 3e3e 3e20 7361 7665 5f74        >>> save_t
-00017500: 6f20 3d20 2230 3357 6561 7468 6572 5f44  o = "03Weather_D
-00017510: 6174 612f 6e65 772f 346b 6d5f 662f 6e65  ata/new/4km_f/ne
-00017520: 775f 6576 6170 2f22 0d0a 2020 2020 2020  w_evap/"..      
-00017530: 2020 3e3e 3e20 5261 7374 6572 2e66 6f6c    >>> Raster.fol
-00017540: 6465 7243 616c 6375 6c61 746f 7228 7261  derCalculator(ra
-00017550: 7374 6572 735f 6469 722c 2073 6176 655f  sters_dir, save_
-00017560: 746f 2c20 6675 6e63 290d 0a20 2020 2020  to, func)..     
-00017570: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-00017580: 6173 7365 7274 2074 7970 6528 7261 7374  assert type(rast
-00017590: 6572 735f 6469 7229 203d 3d20 7374 722c  ers_dir) == str,
-000175a0: 2022 415f 7061 7468 2069 6e70 7574 2073   "A_path input s
-000175b0: 686f 756c 6420 6265 2073 7472 696e 6720  hould be string 
-000175c0: 7479 7065 220d 0a20 2020 2020 2020 2061  type"..        a
-000175d0: 7373 6572 7420 7479 7065 2873 6176 655f  ssert type(save_
-000175e0: 746f 2920 3d3d 2073 7472 2c20 2242 5f69  to) == str, "B_i
-000175f0: 6e70 7574 5f70 6174 6820 696e 7075 7420  nput_path input 
-00017600: 7368 6f75 6c64 2062 6520 7374 7269 6e67  should be string
-00017610: 2074 7970 6522 0d0a 2020 2020 2020 2020   type"..        
-00017620: 6173 7365 7274 2063 616c 6c61 626c 6528  assert callable(
-00017630: 6675 6e63 7469 6f6e 292c 2022 7365 636f  function), "seco
-00017640: 6e64 2061 7267 756d 656e 7420 7368 6f75  nd argument shou
-00017650: 6c64 2062 6520 6120 6675 6e63 7469 6f6e  ld be a function
-00017660: 220d 0a0d 0a20 2020 2020 2020 2069 6620  "....        if 
-00017670: 6e6f 7420 6f73 2e70 6174 682e 6578 6973  not os.path.exis
-00017680: 7473 2872 6173 7465 7273 5f64 6972 293a  ts(rasters_dir):
-00017690: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
-000176a0: 6973 6520 4669 6c65 4e6f 7446 6f75 6e64  ise FileNotFound
-000176b0: 4572 726f 7228 0d0a 2020 2020 2020 2020  Error(..        
-000176c0: 2020 2020 2020 2020 6622 7b72 6173 7465          f"{raste
-000176d0: 7273 5f64 6972 7d20 7468 6520 7061 7468  rs_dir} the path
-000176e0: 2079 6f75 2068 6176 6520 7072 6f76 6964   you have provid
-000176f0: 6564 2064 6f65 7320 6e6f 7420 6578 6973  ed does not exis
-00017700: 7422 0d0a 2020 2020 2020 2020 2020 2020  t"..            
-00017710: 290d 0a0d 0a20 2020 2020 2020 2069 6620  )....        if 
-00017720: 6e6f 7420 6f73 2e70 6174 682e 6578 6973  not os.path.exis
-00017730: 7473 2873 6176 655f 746f 293a 0d0a 2020  ts(save_to):..  
-00017740: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00017750: 4669 6c65 4e6f 7446 6f75 6e64 4572 726f  FileNotFoundErro
-00017760: 7228 0d0a 2020 2020 2020 2020 2020 2020  r(..            
-00017770: 2020 2020 6622 7b73 6176 655f 746f 7d20      f"{save_to} 
-00017780: 7468 6520 7061 7468 2079 6f75 2068 6176  the path you hav
-00017790: 6520 7072 6f76 6964 6564 2064 6f65 7320  e provided does 
-000177a0: 6e6f 7420 6578 6973 7422 0d0a 2020 2020  not exist"..    
-000177b0: 2020 2020 2020 2020 290d 0a0d 0a20 2020          )....   
-000177c0: 2020 2020 2023 2063 6865 636b 2077 6865       # check whe
-000177d0: 7468 6572 2074 6865 7265 2061 7265 2066  ther there are f
-000177e0: 696c 6573 206f 7220 6e6f 7420 696e 7369  iles or not insi
-000177f0: 6465 2074 6865 2066 6f6c 6465 720d 0a20  de the folder.. 
-00017800: 2020 2020 2020 2061 7373 6572 7420 6f73         assert os
-00017810: 2e6c 6973 7464 6972 2872 6173 7465 7273  .listdir(rasters
-00017820: 5f64 6972 2920 213d 2022 222c 2028 0d0a  _dir) != "", (..
-00017830: 2020 2020 2020 2020 2020 2020 7261 7374              rast
-00017840: 6572 735f 6469 7220 2b20 2274 6865 2070  ers_dir + "the p
-00017850: 6174 6820 796f 7520 6861 7665 2070 726f  ath you have pro
-00017860: 7669 6465 6420 6973 2065 6d70 7479 220d  vided is empty".
-00017870: 0a20 2020 2020 2020 2029 0d0a 0d0a 2020  .        )....  
-00017880: 2020 2020 2020 2320 6368 6563 6b20 6966        # check if
-00017890: 2079 6f75 2063 616e 2063 7265 6174 6520   you can create 
-000178a0: 7468 6520 666f 6c64 6572 0d0a 2020 2020  the folder..    
-000178b0: 2020 2020 2320 7472 793a 0d0a 2020 2020      # try:..    
-000178c0: 2020 2020 2320 2020 2020 6f73 2e6d 616b      #     os.mak
-000178d0: 6564 6972 7328 6f73 2e70 6174 682e 6a6f  edirs(os.path.jo
-000178e0: 696e 286f 732e 656e 7669 726f 6e5b 2754  in(os.environ['T
-000178f0: 454d 5027 5d2c 2241 6c6c 6967 6e65 6452  EMP'],"AllignedR
-00017900: 6173 7465 7273 2229 290d 0a20 2020 2020  asters"))..     
-00017910: 2020 2023 2065 7863 6570 7420 5769 6e64     # except Wind
-00017920: 6f77 7345 7272 6f72 203a 0d0a 2020 2020  owsError :..    
-00017930: 2020 2020 2320 2020 2020 2320 6966 206e      #     # if n
-00017940: 6f74 2061 626c 6520 746f 2063 7265 6174  ot able to creat
-00017950: 6520 7468 6520 666f 6c64 6572 2064 656c  e the folder del
-00017960: 6574 6520 7468 6520 666f 6c64 6572 2077  ete the folder w
-00017970: 6974 6820 7468 6520 7361 6d65 206e 616d  ith the same nam
-00017980: 6520 616e 6420 6372 6561 7465 206f 6e65  e and create one
-00017990: 2065 6d70 7479 0d0a 2020 2020 2020 2020   empty..        
-000179a0: 2320 2020 2020 7368 7574 696c 2e72 6d74  #     shutil.rmt
-000179b0: 7265 6528 6f73 2e70 6174 682e 6a6f 696e  ree(os.path.join
-000179c0: 286f 732e 656e 7669 726f 6e5b 2754 454d  (os.environ['TEM
-000179d0: 5027 5d2b 222f 416c 6c69 676e 6564 5261  P']+"/AllignedRa
-000179e0: 7374 6572 7322 2929 0d0a 2020 2020 2020  sters"))..      
-000179f0: 2020 2320 2020 2020 6f73 2e6d 616b 6564    #     os.maked
-00017a00: 6972 7328 6f73 2e70 6174 682e 6a6f 696e  irs(os.path.join
-00017a10: 286f 732e 656e 7669 726f 6e5b 2754 454d  (os.environ['TEM
-00017a20: 5027 5d2c 2241 6c6c 6967 6e65 6452 6173  P'],"AllignedRas
-00017a30: 7465 7273 2229 290d 0a0d 0a20 2020 2020  ters"))....     
-00017a40: 2020 2023 2067 6574 206e 616d 6573 206f     # get names o
-00017a50: 6620 7261 7374 6572 730d 0a20 2020 2020  f rasters..     
-00017a60: 2020 2066 696c 6573 5f6c 6973 7420 3d20     files_list = 
-00017a70: 6f73 2e6c 6973 7464 6972 2872 6173 7465  os.listdir(raste
-00017a80: 7273 5f64 6972 290d 0a20 2020 2020 2020  rs_dir)..       
-00017a90: 2069 6620 2264 6573 6b74 6f70 2e69 6e69   if "desktop.ini
-00017aa0: 2220 696e 2066 696c 6573 5f6c 6973 743a  " in files_list:
-00017ab0: 0d0a 2020 2020 2020 2020 2020 2020 6669  ..            fi
-00017ac0: 6c65 735f 6c69 7374 2e72 656d 6f76 6528  les_list.remove(
-00017ad0: 2264 6573 6b74 6f70 2e69 6e69 2229 0d0a  "desktop.ini")..
-00017ae0: 0d0a 2020 2020 2020 2020 2320 6578 6563  ..        # exec
-00017af0: 7574 6520 7468 6520 6675 6e63 7469 6f6e  ute the function
-00017b00: 206f 6e20 6561 6368 2072 6173 7465 720d   on each raster.
-00017b10: 0a20 2020 2020 2020 2066 6f72 2069 2069  .        for i i
-00017b20: 6e20 7261 6e67 6528 6c65 6e28 6669 6c65  n range(len(file
-00017b30: 735f 6c69 7374 2929 3a0d 0a20 2020 2020  s_list)):..     
-00017b40: 2020 2020 2020 2070 7269 6e74 2873 7472         print(str
-00017b50: 2869 202b 2031 2920 2b20 222f 2220 2b20  (i + 1) + "/" + 
-00017b60: 7374 7228 6c65 6e28 6669 6c65 735f 6c69  str(len(files_li
-00017b70: 7374 2929 202b 2022 202d 2022 202b 2066  st)) + " - " + f
-00017b80: 696c 6573 5f6c 6973 745b 695d 290d 0a20  iles_list[i]).. 
-00017b90: 2020 2020 2020 2020 2020 2042 203d 2067             B = g
-00017ba0: 6461 6c2e 4f70 656e 2872 6173 7465 7273  dal.Open(rasters
-00017bb0: 5f64 6972 202b 2066 696c 6573 5f6c 6973  _dir + files_lis
-00017bc0: 745b 695d 290d 0a20 2020 2020 2020 2020  t[i])..         
-00017bd0: 2020 2061 7267 7320 3d20 5b42 2c20 7361     args = [B, sa
-00017be0: 7665 5f74 6f20 2b20 6669 6c65 735f 6c69  ve_to + files_li
-00017bf0: 7374 5b69 5d5d 0d0a 2020 2020 2020 2020  st[i]]..        
-00017c00: 2020 2020 6675 6e63 7469 6f6e 2861 7267      function(arg
-00017c10: 7329 0d0a 0d0a 2020 2020 4073 7461 7469  s)....    @stati
-00017c20: 636d 6574 686f 640d 0a20 2020 2064 6566  cmethod..    def
-00017c30: 2072 6561 6452 6173 7465 7273 466f 6c64   readRastersFold
-00017c40: 6572 280d 0a20 2020 2020 2020 2070 6174  er(..        pat
-00017c50: 683a 2073 7472 2c0d 0a20 2020 2020 2020  h: str,..       
-00017c60: 2062 616e 643a 2069 6e74 203d 2031 2c0d   band: int = 1,.
-00017c70: 0a20 2020 2020 2020 2077 6974 685f 6f72  .        with_or
-00017c80: 6465 723a 2062 6f6f 6c20 3d20 5472 7565  der: bool = True
-00017c90: 2c0d 0a20 2020 2020 2020 2073 7461 7274  ,..        start
-00017ca0: 3a20 7374 7220 3d20 2222 2c0d 0a20 2020  : str = "",..   
-00017cb0: 2020 2020 2065 6e64 3a20 7374 7220 3d20       end: str = 
-00017cc0: 2222 2c0d 0a20 2020 2020 2020 2066 6d74  "",..        fmt
-00017cd0: 3a20 7374 7220 3d20 2222 2c0d 0a20 2020  : str = "",..   
-00017ce0: 2020 2020 2066 7265 713a 2073 7472 203d       freq: str =
-00017cf0: 2022 6461 696c 7922 2c0d 0a20 2020 2020   "daily",..     
-00017d00: 2020 2023 2073 6570 6172 6174 6f72 3a20     # separator: 
-00017d10: 7374 7220 3d20 222e 220d 0a20 2020 2029  str = "."..    )
-00017d20: 3a0d 0a20 2020 2020 2020 2022 2222 5265  :..        """Re
-00017d30: 6164 5261 7374 6572 7346 6f6c 6465 722e  adRastersFolder.
-00017d40: 0d0a 0d0a 2020 2020 2020 2020 7468 6973  ....        this
-00017d50: 2066 756e 6374 696f 6e20 7265 6164 7320   function reads 
-00017d60: 7261 7374 6572 7320 6672 6f6d 2061 2066  rasters from a f
-00017d70: 6f6c 6465 7220 616e 6420 6372 6561 7465  older and create
-00017d80: 7320 6120 3364 2061 7272 6179 2077 6974  s a 3d array wit
-00017d90: 6820 7468 6520 7361 6d65 0d0a 2020 2020  h the same..    
-00017da0: 2020 2020 3264 2064 696d 656e 7369 6f6e      2d dimension
-00017db0: 7320 6f66 2074 6865 2066 6972 7374 2072  s of the first r
-00017dc0: 6173 7465 7220 696e 2074 6865 2066 6f6c  aster in the fol
-00017dd0: 6465 7220 616e 6420 6c65 6e20 6173 2074  der and len as t
-00017de0: 6865 206e 756d 6265 7220 6f66 2066 696c  he number of fil
-00017df0: 6573 0d0a 0d0a 2020 2020 2020 2020 696e  es....        in
-00017e00: 7369 6465 2074 6865 2066 6f6c 6465 722e  side the folder.
-00017e10: 0d0a 2020 2020 2020 2020 2d20 616c 6c20  ..        - all 
-00017e20: 7261 7374 6572 7320 7368 6f75 6c64 2068  rasters should h
-00017e30: 6176 6520 7468 6520 7361 6d65 2064 696d  ave the same dim
-00017e40: 656e 7369 6f6e 730d 0a20 2020 2020 2020  ensions..       
-00017e50: 202d 2066 6f6c 6465 7220 7368 6f75 6c64   - folder should
-00017e60: 206f 6e6c 7920 636f 6e74 6169 6e20 7261   only contain ra
-00017e70: 7374 6572 2066 696c 6573 0d0a 2020 2020  ster files..    
-00017e80: 2020 2020 2d20 7261 7374 6572 2066 696c      - raster fil
-00017e90: 6520 6e61 6d65 2073 686f 756c 6420 6861  e name should ha
-00017ea0: 7665 2074 6865 2064 6174 6520 6174 2074  ve the date at t
-00017eb0: 6865 2065 6e64 206f 6620 7468 6520 6669  he end of the fi
-00017ec0: 6c65 206e 616d 6520 6265 666f 7265 2074  le name before t
-00017ed0: 6865 2065 7874 656e 7369 6f6e 2064 6972  he extension dir
-00017ee0: 6563 746c 790d 0a20 2020 2020 2020 2020  ectly..         
-00017ef0: 2077 6974 6820 7468 6520 5959 5959 2e4d   with the YYYY.M
-00017f00: 4d2e 4444 202f 2059 5959 592d 4d4d 2d44  M.DD / YYYY-MM-D
-00017f10: 4420 6f72 2059 5959 595f 4d4d 5f44 440d  D or YYYY_MM_DD.
-00017f20: 0a20 2020 2020 2020 2020 203e 3e3e 2022  .          >>> "
-00017f30: 3530 5f4d 5357 4550 5f31 3937 392e 3031  50_MSWEP_1979.01
-00017f40: 2e30 312e 7469 6622 0d0a 0d0a 2020 2020  .01.tif"....    
-00017f50: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
-00017f60: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00017f70: 2d2d 0d0a 2020 2020 2020 2020 7061 7468  --..        path
-00017f80: 3a5b 5374 7269 6e67 2f6c 6973 745d 0d0a  :[String/list]..
-00017f90: 2020 2020 2020 2020 2020 2020 7061 7468              path
-00017fa0: 206f 6620 7468 6520 666f 6c64 6572 2074   of the folder t
-00017fb0: 6861 7420 636f 6e74 6169 6e73 2061 6c6c  hat contains all
-00017fc0: 2074 6865 2072 6173 7465 7273 206f 720d   the rasters or.
-00017fd0: 0a20 2020 2020 2020 2020 2020 2061 206c  .            a l
-00017fe0: 6973 7420 636f 6e74 6169 6e73 2074 6865  ist contains the
-00017ff0: 2070 6174 6873 206f 6620 7468 6520 7261   paths of the ra
-00018000: 7374 6572 7320 746f 2072 6561 642e 0d0a  sters to read...
-00018010: 2020 2020 2020 2020 6261 6e64 3a20 5b69          band: [i
-00018020: 6e74 5d0d 0a20 2020 2020 2020 2020 2020  nt]..           
-00018030: 206e 756d 6265 7220 6f66 2074 6865 2062   number of the b
-00018040: 616e 6420 796f 7520 7761 6e74 2074 6f20  and you want to 
-00018050: 7265 6164 2064 6566 6175 6c74 2069 7320  read default is 
-00018060: 312e 0d0a 2020 2020 2020 2020 7769 7468  1...        with
-00018070: 5f6f 7264 6572 3a20 5b62 6f6f 6c5d 0d0a  _order: [bool]..
-00018080: 2020 2020 2020 2020 2020 2020 5472 7565              True
-00018090: 2069 6620 7468 6520 7261 7374 6572 7320   if the rasters 
-000180a0: 666f 6c6c 6f77 7320 6120 6365 7274 6169  follows a certai
-000180b0: 6e20 6f72 6465 722c 2074 6865 6e20 7468  n order, then th
-000180c0: 6520 7261 7374 6572 7320 6e61 6d65 7320  e rasters names 
-000180d0: 7368 6f75 6c64 2068 6176 6520 610d 0a20  should have a.. 
-000180e0: 2020 2020 2020 2020 2020 206e 756d 6265             numbe
-000180f0: 7220 6174 2074 6865 2062 6567 696e 6e69  r at the beginni
-00018100: 6e67 2069 6e64 6963 6174 696e 6720 7468  ng indicating th
-00018110: 6520 6f72 6465 722e 0d0a 2020 2020 2020  e order...      
-00018120: 2020 666d 743a 205b 7374 725d 0d0a 2020    fmt: [str]..  
-00018130: 2020 2020 2020 2020 2020 666f 726d 6174            format
-00018140: 206f 6620 7468 6520 6769 7665 6e20 6461   of the given da
-00018150: 7465 0d0a 2020 2020 2020 2020 7374 6172  te..        star
-00018160: 743a 205b 7374 725d 0d0a 2020 2020 2020  t: [str]..      
-00018170: 2020 2020 2020 7374 6172 7420 6461 7465        start date
-00018180: 2069 6620 796f 7520 7761 6e74 2074 6f20   if you want to 
-00018190: 7265 6164 2074 6865 2069 6e70 7574 2074  read the input t
-000181a0: 656d 7065 7261 7475 7265 2066 6f72 2061  emperature for a
-000181b0: 2073 7065 6369 6669 6320 7065 7269 6f64   specific period
-000181c0: 206f 6e6c 792c 0d0a 2020 2020 2020 2020   only,..        
-000181d0: 2020 2020 6966 206e 6f74 2067 6976 656e      if not given
-000181e0: 2061 6c6c 2072 6173 7465 7273 2069 6e20   all rasters in 
-000181f0: 7468 6520 6769 7665 6e20 7061 7468 2077  the given path w
-00018200: 696c 6c20 6265 2072 6561 642e 0d0a 2020  ill be read...  
-00018210: 2020 2020 2020 656e 643a 205b 7374 725d        end: [str]
-00018220: 0d0a 2020 2020 2020 2020 2020 2020 656e  ..            en
-00018230: 6420 6461 7465 2069 6620 796f 7520 7761  d date if you wa
-00018240: 6e74 2074 6f20 7265 6164 2074 6865 2069  nt to read the i
-00018250: 6e70 7574 2074 656d 7065 7261 7475 7265  nput temperature
-00018260: 2066 6f72 2061 2073 7065 6369 6669 6320   for a specific 
-00018270: 7065 7269 6f64 206f 6e6c 792c 0d0a 2020  period only,..  
-00018280: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-00018290: 2067 6976 656e 2061 6c6c 2072 6173 7465   given all raste
-000182a0: 7273 2069 6e20 7468 6520 6769 7665 6e20  rs in the given 
-000182b0: 7061 7468 2077 696c 6c20 6265 2072 6561  path will be rea
-000182c0: 642e 0d0a 2020 2020 2020 2020 6672 6571  d...        freq
-000182d0: 3a20 5b73 7472 5d0d 0a20 2020 2020 2020  : [str]..       
-000182e0: 2020 2020 2066 7265 7175 656e 6379 206f       frequency o
-000182f0: 6620 7468 6520 7261 7374 6572 7320 2264  f the rasters "d
-00018300: 6169 6c79 222c 2048 6f75 726c 792c 206d  aily", Hourly, m
-00018310: 6f6e 7468 6c79 0d0a 0d0a 2020 2020 2020  onthly....      
-00018320: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
-00018330: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
-00018340: 2020 2020 6172 725f 3364 3a20 5b6e 756d      arr_3d: [num
-00018350: 7079 2e6e 6461 7272 6179 5d0d 0a20 2020  py.ndarray]..   
-00018360: 2020 2020 2020 2020 2033 6420 6172 7261           3d arra
-00018370: 7920 636f 6e74 6169 6e73 2061 7272 6179  y contains array
-00018380: 7320 7265 6164 2066 726f 6d20 616c 6c20  s read from all 
-00018390: 7261 7374 6572 7320 696e 2074 6865 2066  rasters in the f
-000183a0: 6f6c 6465 722e 0d0a 0d0a 2020 2020 2020  older.....      
-000183b0: 2020 4578 616d 706c 650d 0a20 2020 2020    Example..     
-000183c0: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
-000183d0: 2020 2020 3e3e 3e20 7261 7374 6572 5f66      >>> raster_f
-000183e0: 6f6c 6465 7220 3d20 2265 7861 6d70 6c65  older = "example
-000183f0: 732f 4749 532f 6461 7461 2f72 6173 7465  s/GIS/data/raste
-00018400: 722d 666f 6c64 6572 220d 0a20 2020 2020  r-folder"..     
-00018410: 2020 203e 3e3e 2070 7265 6320 3d20 5261     >>> prec = Ra
-00018420: 7374 6572 2e72 6561 6452 6173 7465 7273  ster.readRasters
-00018430: 466f 6c64 6572 2872 6173 7465 725f 666f  Folder(raster_fo
-00018440: 6c64 6572 290d 0a0d 0a20 2020 2020 2020  lder)....       
-00018450: 203e 3e3e 2069 6d70 6f72 7420 676c 6f62   >>> import glob
-00018460: 0d0a 2020 2020 2020 2020 3e3e 3e20 7365  ..        >>> se
-00018470: 6172 6368 5f63 7269 7465 7269 6120 3d20  arch_criteria = 
-00018480: 222a 2e74 6966 220d 0a20 2020 2020 2020  "*.tif"..       
-00018490: 203e 3e3e 2066 696c 655f 6c69 7374 203d   >>> file_list =
-000184a0: 2067 6c6f 622e 676c 6f62 286f 732e 7061   glob.glob(os.pa
-000184b0: 7468 2e6a 6f69 6e28 7261 7374 6572 5f66  th.join(raster_f
-000184c0: 6f6c 6465 722c 2073 6561 7263 685f 6372  older, search_cr
-000184d0: 6974 6572 6961 2929 0d0a 2020 2020 2020  iteria))..      
-000184e0: 2020 3e3e 3e20 7072 6563 203d 2052 6173    >>> prec = Ras
-000184f0: 7465 722e 7265 6164 5261 7374 6572 7346  ter.readRastersF
-00018500: 6f6c 6465 7228 6669 6c65 5f6c 6973 742c  older(file_list,
-00018510: 2077 6974 685f 6f72 6465 723d 4661 6c73   with_order=Fals
-00018520: 6529 0d0a 2020 2020 2020 2020 2222 220d  e)..        """.
-00018530: 0a20 2020 2020 2020 2023 2069 6e70 7574  .        # input
-00018540: 2064 6174 6120 7661 6c69 6461 7469 6f6e   data validation
-00018550: 0d0a 2020 2020 2020 2020 2320 6461 7461  ..        # data
-00018560: 2074 7970 650d 0a20 2020 2020 2020 2069   type..        i
-00018570: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
-00018580: 2870 6174 682c 2073 7472 2920 616e 6420  (path, str) and 
-00018590: 6e6f 7420 6973 696e 7374 616e 6365 2870  not isinstance(p
-000185a0: 6174 682c 206c 6973 7429 3a0d 0a20 2020  ath, list):..   
-000185b0: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-000185c0: 7970 6545 7272 6f72 2866 2270 6174 6820  ypeError(f"path 
-000185d0: 696e 7075 7420 7368 6f75 6c64 2062 6520  input should be 
-000185e0: 7374 7269 6e67 2f6c 6973 7420 7479 7065  string/list type
-000185f0: 2c20 6769 7665 6e7b 7479 7065 2870 6174  , given{type(pat
-00018600: 6829 7d22 290d 0a0d 0a20 2020 2020 2020  h)}")....       
-00018610: 2069 6620 6973 696e 7374 616e 6365 2870   if isinstance(p
-00018620: 6174 682c 2073 7472 293a 0d0a 2020 2020  ath, str):..    
-00018630: 2020 2020 2020 2020 2320 6368 6563 6b20          # check 
-00018640: 7765 7468 6572 2074 6865 2070 6174 6820  wether the path 
-00018650: 6578 6973 7420 6f72 206e 6f74 0d0a 2020  exist or not..  
-00018660: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-00018670: 206f 732e 7061 7468 2e65 7869 7374 7328   os.path.exists(
-00018680: 7061 7468 293a 0d0a 2020 2020 2020 2020  path):..        
-00018690: 2020 2020 2020 2020 7261 6973 6520 4669          raise Fi
-000186a0: 6c65 4e6f 7446 6f75 6e64 4572 726f 7228  leNotFoundError(
-000186b0: 2254 6865 2070 6174 6820 796f 7520 6861  "The path you ha
-000186c0: 7665 2070 726f 7669 6465 6420 646f 6573  ve provided does
-000186d0: 206e 6f74 2065 7869 7374 2229 0d0a 2020   not exist")..  
-000186e0: 2020 2020 2020 2020 2020 2320 6765 7420            # get 
-000186f0: 6c69 7374 206f 6620 616c 6c20 6669 6c65  list of all file
-00018700: 730d 0a20 2020 2020 2020 2020 2020 2066  s..            f
-00018710: 696c 6573 203d 206f 732e 6c69 7374 6469  iles = os.listdi
-00018720: 7228 7061 7468 290d 0a20 2020 2020 2020  r(path)..       
-00018730: 2020 2020 2066 696c 6573 203d 205b 6920       files = [i 
-00018740: 666f 7220 6920 696e 2066 696c 6573 2069  for i in files i
-00018750: 6620 692e 656e 6473 7769 7468 2822 2e74  f i.endswith(".t
-00018760: 6966 2229 5d0d 0a20 2020 2020 2020 2020  if")]..         
-00018770: 2020 2023 2066 696c 6573 203d 2067 6c6f     # files = glo
-00018780: 622e 676c 6f62 286f 732e 7061 7468 2e6a  b.glob(os.path.j
-00018790: 6f69 6e28 7061 7468 2c20 222a 2e74 6966  oin(path, "*.tif
-000187a0: 2229 290d 0a20 2020 2020 2020 2020 2020  "))..           
-000187b0: 2023 2063 6865 636b 2077 6865 7468 6572   # check whether
-000187c0: 2074 6865 7265 2061 7265 2066 696c 6573   there are files
-000187d0: 206f 7220 6e6f 7420 696e 7369 6465 2074   or not inside t
-000187e0: 6865 2066 6f6c 6465 720d 0a20 2020 2020  he folder..     
-000187f0: 2020 2020 2020 2069 6620 6c65 6e28 6669         if len(fi
-00018800: 6c65 7329 203c 2031 3a0d 0a20 2020 2020  les) < 1:..     
-00018810: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00018820: 2046 696c 654e 6f74 466f 756e 6445 7272   FileNotFoundErr
-00018830: 6f72 2822 5468 6520 7061 7468 2079 6f75  or("The path you
-00018840: 2068 6176 6520 7072 6f76 6964 6564 2069   have provided i
-00018850: 7320 656d 7074 7922 290d 0a0d 0a20 2020  s empty")....   
-00018860: 2020 2020 2020 2020 2069 6620 2264 6573           if "des
-00018870: 6b74 6f70 2e69 6e69 2220 696e 2066 696c  ktop.ini" in fil
-00018880: 6573 3a0d 0a20 2020 2020 2020 2020 2020  es:..           
-00018890: 2020 2020 2066 696c 6573 2e72 656d 6f76       files.remov
-000188a0: 6528 2264 6573 6b74 6f70 2e69 6e69 2229  e("desktop.ini")
-000188b0: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-000188c0: 0a20 2020 2020 2020 2020 2020 2066 696c  .            fil
-000188d0: 6573 203d 2070 6174 685b 3a5d 0d0a 0d0a  es = path[:]....
-000188e0: 2020 2020 2020 2020 2320 746f 2073 6f72          # to sor
-000188f0: 7420 7468 6520 6669 6c65 7320 696e 2074  t the files in t
-00018900: 6865 2073 616d 6520 6f72 6465 7220 6173  he same order as
-00018910: 2074 6865 2066 6972 7374 206e 756d 6265   the first numbe
-00018920: 7220 696e 2074 6865 206e 616d 650d 0a20  r in the name.. 
-00018930: 2020 2020 2020 2069 6620 7769 7468 5f6f         if with_o
-00018940: 7264 6572 3a0d 0a20 2020 2020 2020 2020  rder:..         
-00018950: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
-00018960: 2020 2020 2020 2020 2066 696c 6573 4e6f           filesNo
-00018970: 203d 205b 696e 7428 692e 7370 6c69 7428   = [int(i.split(
-00018980: 225f 2229 5b30 5d29 2066 6f72 2069 2069  "_")[0]) for i i
-00018990: 6e20 6669 6c65 735d 0d0a 2020 2020 2020  n files]..      
-000189a0: 2020 2020 2020 6578 6365 7074 2056 616c        except Val
-000189b0: 7565 4572 726f 723a 0d0a 2020 2020 2020  ueError:..      
-000189c0: 2020 2020 2020 2020 2020 4572 726f 724d            ErrorM
-000189d0: 7367 203d 2028 0d0a 2020 2020 2020 2020  sg = (..        
-000189e0: 2020 2020 2020 2020 2020 2020 2270 6c65              "ple
-000189f0: 6173 6520 696e 636c 7564 6520 6120 6e75  ase include a nu
-00018a00: 6d62 6572 2061 7420 7468 6520 6265 6769  mber at the begi
-00018a10: 6e6e 696e 6720 6f66 2074 6865 220d 0a20  nning of the".. 
-00018a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018a30: 2020 2022 7261 7374 6572 7320 6e61 6d65     "rasters name
-00018a40: 2074 6f20 696e 6469 6361 7465 2074 6865   to indicate the
-00018a50: 206f 7264 6572 206f 6620 7468 6520 7261   order of the ra
-00018a60: 7374 6572 732e 2074 6f20 646f 2073 6f20  sters. to do so 
-00018a70: 706c 6561 7365 220d 0a20 2020 2020 2020  please"..       
-00018a80: 2020 2020 2020 2020 2020 2020 2022 7573               "us
-00018a90: 6520 7468 6520 496e 7075 7473 2e52 656e  e the Inputs.Ren
-00018aa0: 616d 6546 696c 6573 206d 6574 686f 6420  ameFiles method 
-00018ab0: 746f 2073 6f6c 7665 2074 6869 7320 6973  to solve this is
-00018ac0: 7375 6520 616e 6420 646f 6e27 7420 220d  sue and don't ".
-00018ad0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018ae0: 2020 2020 2022 696e 636c 7564 6520 616e       "include an
-00018af0: 7920 6f74 6865 7220 6669 6c65 7320 696e  y other files in
-00018b00: 2074 6865 2066 6f6c 6465 7220 7769 7468   the folder with
-00018b10: 2074 6865 2072 6173 7465 7273 220d 0a20   the rasters".. 
-00018b20: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00018b30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00018b40: 2020 6173 7365 7274 2046 616c 7365 2c20    assert False, 
-00018b50: 4572 726f 724d 7367 0d0a 0d0a 2020 2020  ErrorMsg....    
-00018b60: 2020 2020 2020 2020 6669 6c65 7475 706c          filetupl
-00018b70: 6520 3d20 736f 7274 6564 287a 6970 2866  e = sorted(zip(f
-00018b80: 696c 6573 4e6f 2c20 6669 6c65 7329 290d  ilesNo, files)).
-00018b90: 0a20 2020 2020 2020 2020 2020 2066 696c  .            fil
-00018ba0: 6573 203d 205b 7820 666f 7220 5f2c 2078  es = [x for _, x
-00018bb0: 2069 6e20 6669 6c65 7475 706c 655d 0d0a   in filetuple]..
-00018bc0: 0d0a 2020 2020 2020 2020 6966 2073 7461  ..        if sta
-00018bd0: 7274 2021 3d20 2222 206f 7220 656e 6420  rt != "" or end 
-00018be0: 213d 2022 223a 0d0a 2020 2020 2020 2020  != "":..        
-00018bf0: 2020 2020 7374 6172 7420 3d20 6474 2e64      start = dt.d
-00018c00: 6174 6574 696d 652e 7374 7270 7469 6d65  atetime.strptime
-00018c10: 2873 7461 7274 2c20 666d 7429 0d0a 2020  (start, fmt)..  
-00018c20: 2020 2020 2020 2020 2020 656e 6420 3d20            end = 
-00018c30: 6474 2e64 6174 6574 696d 652e 7374 7270  dt.datetime.strp
-00018c40: 7469 6d65 2865 6e64 2c20 666d 7429 0d0a  time(end, fmt)..
-00018c50: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-00018c60: 6765 7420 7468 6520 6461 7465 7320 666f  get the dates fo
-00018c70: 7220 6561 6368 2066 696c 650d 0a20 2020  r each file..   
-00018c80: 2020 2020 2020 2020 2064 6174 6573 203d           dates =
-00018c90: 206c 6973 7428 290d 0a20 2020 2020 2020   list()..       
-00018ca0: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
-00018cb0: 6e67 6528 6c65 6e28 6669 6c65 7329 293a  nge(len(files)):
-00018cc0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00018cd0: 2020 6966 2066 7265 7120 3d3d 2022 6461    if freq == "da
-00018ce0: 696c 7922 3a0d 0a20 2020 2020 2020 2020  ily":..         
-00018cf0: 2020 2020 2020 2020 2020 206c 203d 206c             l = l
-00018d00: 656e 2866 696c 6573 5b69 5d29 202d 2034  en(files[i]) - 4
-00018d10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00018d20: 2020 2020 2020 6461 7920 3d20 696e 7428        day = int(
-00018d30: 6669 6c65 735b 695d 5b6c 202d 2032 203a  files[i][l - 2 :
-00018d40: 206c 5d29 0d0a 2020 2020 2020 2020 2020   l])..          
-00018d50: 2020 2020 2020 2020 2020 6d6f 6e74 6820            month 
-00018d60: 3d20 696e 7428 6669 6c65 735b 695d 5b6c  = int(files[i][l
-00018d70: 202d 2035 203a 206c 202d 2033 5d29 0d0a   - 5 : l - 3])..
-00018d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018d90: 2020 2020 7965 6172 203d 2069 6e74 2866      year = int(f
-00018da0: 696c 6573 5b69 5d5b 6c20 2d20 3130 203a  iles[i][l - 10 :
-00018db0: 206c 202d 2036 5d29 0d0a 2020 2020 2020   l - 6])..      
-00018dc0: 2020 2020 2020 2020 2020 2020 2020 6461                da
-00018dd0: 7465 732e 6170 7065 6e64 2864 742e 6461  tes.append(dt.da
-00018de0: 7465 7469 6d65 2879 6561 722c 206d 6f6e  tetime(year, mon
-00018df0: 7468 2c20 6461 7929 290d 0a20 2020 2020  th, day))..     
-00018e00: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-00018e10: 6672 6571 203d 3d20 2268 6f75 726c 7922  freq == "hourly"
-00018e20: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00018e30: 2020 2020 2020 2079 6561 7220 3d20 696e         year = in
-00018e40: 7428 6669 6c65 735b 695d 2e73 706c 6974  t(files[i].split
-00018e50: 2822 5f22 295b 2d34 5d29 0d0a 2020 2020  ("_")[-4])..    
-00018e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018e70: 6d6f 6e74 6820 3d20 696e 7428 6669 6c65  month = int(file
-00018e80: 735b 695d 2e73 706c 6974 2822 5f22 295b  s[i].split("_")[
-00018e90: 2d33 5d29 0d0a 2020 2020 2020 2020 2020  -3])..          
-00018ea0: 2020 2020 2020 2020 2020 6461 7920 3d20            day = 
-00018eb0: 696e 7428 6669 6c65 735b 695d 2e73 706c  int(files[i].spl
-00018ec0: 6974 2822 5f22 295b 2d32 5d29 0d0a 2020  it("_")[-2])..  
-00018ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018ee0: 2020 686f 7572 203d 2069 6e74 2866 696c    hour = int(fil
-00018ef0: 6573 5b69 5d2e 7370 6c69 7428 225f 2229  es[i].split("_")
-00018f00: 5b2d 315d 2e73 706c 6974 2822 2e22 295b  [-1].split(".")[
-00018f10: 305d 290d 0a20 2020 2020 2020 2020 2020  0])..           
-00018f20: 2020 2020 2020 2020 2064 6174 6573 2e61           dates.a
-00018f30: 7070 656e 6428 6474 2e64 6174 6574 696d  ppend(dt.datetim
-00018f40: 6528 7965 6172 2c20 6d6f 6e74 682c 2064  e(year, month, d
-00018f50: 6179 2c20 686f 7572 2929 0d0a 0d0a 2020  ay, hour))....  
-00018f60: 2020 2020 2020 2020 2020 7374 6172 7469            starti
-00018f70: 203d 2064 6174 6573 2e69 6e64 6578 2873   = dates.index(s
-00018f80: 7461 7274 290d 0a20 2020 2020 2020 2020  tart)..         
-00018f90: 2020 2065 6e64 6920 3d20 6461 7465 732e     endi = dates.
-00018fa0: 696e 6465 7828 656e 6429 202b 2031 0d0a  index(end) + 1..
-00018fb0: 2020 2020 2020 2020 2020 2020 6173 7365              asse
-00018fc0: 7274 2061 6c6c 280d 0a20 2020 2020 2020  rt all(..       
-00018fd0: 2020 2020 2020 2020 2066 2e65 6e64 7377           f.endsw
-00018fe0: 6974 6828 222e 7469 6622 2920 666f 7220  ith(".tif") for 
-00018ff0: 6620 696e 2066 696c 6573 5b73 7461 7274  f in files[start
-00019000: 693a 656e 6469 5d0d 0a20 2020 2020 2020  i:endi]..       
-00019010: 2020 2020 2029 2c20 2261 6c6c 2066 696c       ), "all fil
-00019020: 6573 2069 6e20 7468 6520 6769 7665 6e20  es in the given 
-00019030: 666f 6c64 6572 2073 686f 756c 6420 6861  folder should ha
-00019040: 7665 202e 7469 6620 6578 7465 6e73 696f  ve .tif extensio
-00019050: 6e22 0d0a 2020 2020 2020 2020 656c 7365  n"..        else
-00019060: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
-00019070: 7461 7274 6920 3d20 300d 0a20 2020 2020  tarti = 0..     
-00019080: 2020 2020 2020 2065 6e64 6920 3d20 6c65         endi = le
-00019090: 6e28 6669 6c65 7329 0d0a 2020 2020 2020  n(files)..      
-000190a0: 2020 2020 2020 2320 6368 6563 6b20 7468        # check th
-000190b0: 6174 2066 6f6c 6465 7220 6f6e 6c79 2063  at folder only c
-000190c0: 6f6e 7461 696e 7320 7261 7374 6572 730d  ontains rasters.
-000190d0: 0a20 2020 2020 2020 2020 2020 2061 7373  .            ass
-000190e0: 6572 7420 616c 6c28 0d0a 2020 2020 2020  ert all(..      
-000190f0: 2020 2020 2020 2020 2020 662e 656e 6473            f.ends
-00019100: 7769 7468 2822 2e74 6966 2229 2066 6f72  with(".tif") for
-00019110: 2066 2069 6e20 6669 6c65 730d 0a20 2020   f in files..   
-00019120: 2020 2020 2020 2020 2029 2c20 2261 6c6c           ), "all
-00019130: 2066 696c 6573 2069 6e20 7468 6520 6769   files in the gi
-00019140: 7665 6e20 666f 6c64 6572 2073 686f 756c  ven folder shoul
-00019150: 6420 6861 7665 202e 7469 6620 6578 7465  d have .tif exte
-00019160: 6e73 696f 6e22 0d0a 2020 2020 2020 2020  nsion"..        
-00019170: 2320 6372 6561 7465 2061 2033 6420 6172  # create a 3d ar
-00019180: 7261 7920 7769 7468 2074 6865 2032 6420  ray with the 2d 
-00019190: 6469 6d65 6e73 696f 6e20 6f66 2074 6865  dimension of the
-000191a0: 2066 6972 7374 2072 6173 7465 7220 616e   first raster an
-000191b0: 6420 7468 6520 6c65 6e0d 0a20 2020 2020  d the len..     
-000191c0: 2020 2023 206f 6620 7468 6520 6e75 6d62     # of the numb
-000191d0: 6572 206f 6620 7261 7374 6572 7320 696e  er of rasters in
-000191e0: 2074 6865 2066 6f6c 6465 720d 0a20 2020   the folder..   
-000191f0: 2020 2020 2069 6620 7479 7065 2870 6174       if type(pat
-00019200: 6829 203d 3d20 6c69 7374 3a0d 0a20 2020  h) == list:..   
-00019210: 2020 2020 2020 2020 2073 616d 706c 6520           sample 
-00019220: 3d20 6764 616c 2e4f 7065 6e28 6669 6c65  = gdal.Open(file
-00019230: 735b 7374 6172 7469 5d29 0d0a 2020 2020  s[starti])..    
-00019240: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00019250: 2020 2020 2020 2073 616d 706c 6520 3d20         sample = 
-00019260: 6764 616c 2e4f 7065 6e28 7061 7468 202b  gdal.Open(path +
-00019270: 2022 2f22 202b 2066 696c 6573 5b73 7461   "/" + files[sta
-00019280: 7274 695d 290d 0a20 2020 2020 2020 2023  rti])..        #
-00019290: 2063 6865 636b 2074 6865 2067 6976 656e   check the given
-000192a0: 2062 616e 6420 6e75 6d62 6572 0d0a 2020   band number..  
-000192b0: 2020 2020 2020 6966 2062 616e 6420 3e20        if band > 
-000192c0: 7361 6d70 6c65 2e52 6173 7465 7243 6f75  sample.RasterCou
-000192d0: 6e74 3a0d 0a20 2020 2020 2020 2020 2020  nt:..           
-000192e0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-000192f0: 7228 0d0a 2020 2020 2020 2020 2020 2020  r(..            
-00019300: 2020 2020 6622 7468 6520 7261 7374 6572      f"the raster
-00019310: 2068 6173 206f 6e6c 7920 7b73 616d 706c   has only {sampl
-00019320: 652e 5261 7374 6572 436f 756e 747d 2063  e.RasterCount} c
-00019330: 6865 636b 2074 6865 2067 6976 656e 2062  heck the given b
-00019340: 616e 6420 6e75 6d62 6572 220d 0a20 2020  and number"..   
-00019350: 2020 2020 2020 2020 2029 0d0a 0d0a 2020           )....  
-00019360: 2020 2020 2020 6469 6d20 3d20 7361 6d70        dim = samp
-00019370: 6c65 2e47 6574 5261 7374 6572 4261 6e64  le.GetRasterBand
-00019380: 2862 616e 6429 2e52 6561 6441 7341 7272  (band).ReadAsArr
-00019390: 6179 2829 2e73 6861 7065 0d0a 2020 2020  ay().shape..    
-000193a0: 2020 2020 6e61 7661 6c20 3d20 7361 6d70      naval = samp
-000193b0: 6c65 2e47 6574 5261 7374 6572 4261 6e64  le.GetRasterBand
-000193c0: 2862 616e 6429 2e47 6574 4e6f 4461 7461  (band).GetNoData
-000193d0: 5661 6c75 6528 290d 0a20 2020 2020 2020  Value()..       
-000193e0: 2023 2066 696c 6c20 7468 6520 6172 7261   # fill the arra
-000193f0: 7920 7769 7468 206e 6f76 616c 2064 6174  y with noval dat
-00019400: 610d 0a20 2020 2020 2020 2061 7272 5f33  a..        arr_3
-00019410: 6420 3d20 6e70 2e6f 6e65 7328 2864 696d  d = np.ones((dim
-00019420: 5b30 5d2c 2064 696d 5b31 5d2c 206c 656e  [0], dim[1], len
-00019430: 2872 616e 6765 2873 7461 7274 692c 2065  (range(starti, e
-00019440: 6e64 6929 2929 290d 0a20 2020 2020 2020  ndi))))..       
-00019450: 2061 7272 5f33 645b 3a2c 203a 2c20 3a5d   arr_3d[:, :, :]
-00019460: 203d 206e 6176 616c 0d0a 0d0a 2020 2020   = naval....    
-00019470: 2020 2020 6966 2074 7970 6528 7061 7468      if type(path
-00019480: 2920 3d3d 206c 6973 743a 0d0a 2020 2020  ) == list:..    
-00019490: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-000194a0: 2072 616e 6765 2873 7461 7274 692c 2065   range(starti, e
-000194b0: 6e64 6929 3a0d 0a20 2020 2020 2020 2020  ndi):..         
-000194c0: 2020 2020 2020 2023 2072 6561 6420 7468         # read th
-000194d0: 6520 7469 6620 6669 6c65 0d0a 2020 2020  e tif file..    
-000194e0: 2020 2020 2020 2020 2020 2020 6620 3d20              f = 
-000194f0: 6764 616c 2e4f 7065 6e28 6669 6c65 735b  gdal.Open(files[
-00019500: 695d 290d 0a20 2020 2020 2020 2020 2020  i])..           
-00019510: 2020 2020 2061 7272 5f33 645b 3a2c 203a       arr_3d[:, :
-00019520: 2c20 695d 203d 2066 2e47 6574 5261 7374  , i] = f.GetRast
-00019530: 6572 4261 6e64 2862 616e 6429 2e52 6561  erBand(band).Rea
-00019540: 6441 7341 7272 6179 2829 0d0a 2020 2020  dAsArray()..    
-00019550: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00019560: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-00019570: 656e 756d 6572 6174 6528 7261 6e67 6528  enumerate(range(
-00019580: 7374 6172 7469 2c20 656e 6469 2929 3a0d  starti, endi)):.
-00019590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000195a0: 2023 2072 6561 6420 7468 6520 7469 6620   # read the tif 
-000195b0: 6669 6c65 0d0a 2020 2020 2020 2020 2020  file..          
-000195c0: 2020 2020 2020 6620 3d20 6764 616c 2e4f        f = gdal.O
-000195d0: 7065 6e28 7061 7468 202b 2022 2f22 202b  pen(path + "/" +
-000195e0: 2066 696c 6573 5b69 5b31 5d5d 290d 0a20   files[i[1]]).. 
-000195f0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00019600: 7272 5f33 645b 3a2c 203a 2c20 695b 305d  rr_3d[:, :, i[0]
-00019610: 5d20 3d20 662e 4765 7452 6173 7465 7242  ] = f.GetRasterB
-00019620: 616e 6428 6261 6e64 292e 5265 6164 4173  and(band).ReadAs
-00019630: 4172 7261 7928 290d 0a0d 0a20 2020 2020  Array()....     
-00019640: 2020 2072 6574 7572 6e20 6172 725f 3364     return arr_3d
-00019650: 0d0a 0d0a 2020 2020 4073 7461 7469 636d  ....    @staticm
-00019660: 6574 686f 640d 0a20 2020 2064 6566 2065  ethod..    def e
-00019670: 7874 7261 6374 5661 6c75 6573 280d 0a20  xtractValues(.. 
-00019680: 2020 2020 2020 2070 6174 683a 2073 7472         path: str
-00019690: 2c0d 0a20 2020 2020 2020 2065 7863 6c75  ,..        exclu
-000196a0: 6465 5f76 616c 7565 2c0d 0a20 2020 2020  de_value,..     
-000196b0: 2020 2063 6f6d 7072 6573 7365 643a 2062     compressed: b
-000196c0: 6f6f 6c20 3d20 5472 7565 2c0d 0a20 2020  ool = True,..   
-000196d0: 2020 2020 206f 6363 7570 6965 645f 4365       occupied_Ce
-000196e0: 6c6c 735f 6f6e 6c79 3a20 626f 6f6c 203d  lls_only: bool =
-000196f0: 2054 7275 652c 0d0a 2020 2020 293a 0d0a   True,..    ):..
-00019700: 2020 2020 2020 2020 2222 2265 7874 7261          """extra
-00019710: 6374 5661 6c75 6573 2e0d 0a0d 0a20 2020  ctValues.....   
-00019720: 2020 2020 2074 6869 7320 6675 6e63 7469       this functi
-00019730: 6f6e 2069 7320 7772 6974 7465 6e20 746f  on is written to
-00019740: 2065 7874 7261 6374 2061 6e64 2072 6574   extract and ret
-00019750: 7572 6e20 6120 6c69 7374 206f 6620 616c  urn a list of al
-00019760: 6c20 7468 6520 7661 6c75 6573 0d0a 2020  l the values..  
-00019770: 2020 2020 2020 696e 2061 206d 6170 0d0a        in a map..
-00019780: 2020 2020 2020 2020 2354 4f44 4f20 2861          #TODO (a
-00019790: 6e20 4153 4349 4920 666f 7220 6e6f 7720  n ASCII for now 
-000197a0: 746f 2062 6520 6578 7465 6e64 6564 206c  to be extended l
-000197b0: 6174 6572 2074 6f20 7265 6164 2061 6c73  ater to read als
-000197c0: 6f20 7261 7374 6572 290d 0a0d 0a20 2020  o raster)....   
-000197d0: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
-000197e0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-000197f0: 2d2d 2d0d 0a20 2020 2020 2020 2070 6174  ---..        pat
-00019800: 683a 205b 5374 7269 6e67 5d0d 0a20 2020  h: [String]..   
-00019810: 2020 2020 2020 2020 2061 2070 6174 6820           a path 
-00019820: 696e 636c 7564 6e67 2074 6865 206e 616d  includng the nam
-00019830: 6520 6f66 2074 6865 2041 5343 4949 2061  e of the ASCII a
-00019840: 6e64 2065 7874 656e 7469 6f6e 206c 696b  nd extention lik
-00019850: 650d 0a20 2020 2020 2020 2020 2020 2070  e..            p
-00019860: 6174 683d 2264 6174 612f 6372 6f70 7065  ath="data/croppe
-00019870: 642e 6173 6322 0d0a 2020 2020 2020 2020  d.asc"..        
-00019880: 6578 636c 7564 655f 7661 6c75 653a 205b  exclude_value: [
-00019890: 4e75 6d65 7269 635d 0d0a 2020 2020 2020  Numeric]..      
-000198a0: 2020 2020 2020 7661 6c75 6573 2079 6f75        values you
-000198b0: 2077 616e 7420 746f 2065 7863 6c75 6465   want to exclude
-000198c0: 2066 726f 6d20 6578 7465 6163 7465 6420   from exteacted 
-000198d0: 7661 6c75 6573 0d0a 2020 2020 2020 2020  values..        
-000198e0: 636f 6d70 7265 7373 6564 3a20 5b42 6f6f  compressed: [Boo
-000198f0: 6c5d 0d0a 2020 2020 2020 2020 2020 2020  l]..            
-00019900: 2069 6620 7468 6520 6d61 7020 796f 7520   if the map you 
-00019910: 7072 6f76 6964 6564 2069 7320 636f 6d70  provided is comp
-00019920: 7265 7373 6564 0d0a 2020 2020 2020 2020  ressed..        
-00019930: 6f63 6375 7069 6564 5f43 656c 6c73 5f6f  occupied_Cells_o
-00019940: 6e6c 793a 0d0a 2020 2020 2020 2020 2222  nly:..        ""
-00019950: 220d 0a20 2020 2020 2020 2023 2069 6e70  "..        # inp
-00019960: 7574 2064 6174 6120 7661 6c69 6461 7469  ut data validati
-00019970: 6f6e 0d0a 2020 2020 2020 2020 2320 6461  on..        # da
-00019980: 7461 2074 7970 650d 0a20 2020 2020 2020  ta type..       
-00019990: 2061 7373 6572 7420 7479 7065 2870 6174   assert type(pat
-000199a0: 6829 203d 3d20 7374 722c 2022 7061 7468  h) == str, "path
-000199b0: 2069 6e70 7574 2073 686f 756c 6420 6265   input should be
-000199c0: 2073 7472 696e 6720 7479 7065 2220 2b20   string type" + 
-000199d0: 7374 7228 7061 7468 290d 0a20 2020 2020  str(path)..     
-000199e0: 2020 2061 7373 6572 7420 7479 7065 2863     assert type(c
-000199f0: 6f6d 7072 6573 7365 6429 203d 3d20 626f  ompressed) == bo
-00019a00: 6f6c 2c20 2263 6f6d 7072 6573 7365 6420  ol, "compressed 
-00019a10: 696e 7075 7420 7368 6f75 6c64 2062 6520  input should be 
-00019a20: 426f 6f6c 656e 2074 7970 6522 0d0a 2020  Boolen type"..  
-00019a30: 2020 2020 2020 2320 696e 7075 7420 7661        # input va
-00019a40: 6c75 6573 0d0a 2020 2020 2020 2020 2320  lues..        # 
-00019a50: 6368 6563 6b20 7765 7468 6572 2074 6865  check wether the
-00019a60: 2070 6174 6820 6578 6973 7420 6f72 206e   path exist or n
-00019a70: 6f74 0d0a 2020 2020 2020 2020 6173 7365  ot..        asse
-00019a80: 7274 206f 732e 7061 7468 2e65 7869 7374  rt os.path.exist
-00019a90: 7328 7061 7468 292c 2022 7468 6520 7061  s(path), "the pa
-00019aa0: 7468 2079 6f75 2068 6176 6520 7072 6f76  th you have prov
-00019ab0: 6964 6564 2064 6f65 7320 6e6f 7420 6578  ided does not ex
-00019ac0: 6973 7422 202b 2073 7472 280d 0a20 2020  ist" + str(..   
-00019ad0: 2020 2020 2020 2020 2070 6174 680d 0a20           path.. 
-00019ae0: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
-00019af0: 2020 2320 6368 6563 6b20 7765 7468 6572    # check wether
-00019b00: 2074 6865 2070 6174 6820 6861 7320 7468   the path has th
-00019b10: 6520 6578 7465 6e74 696f 6e20 6f72 206e  e extention or n
-00019b20: 6f74 0d0a 2020 2020 2020 2020 6966 2063  ot..        if c
-00019b30: 6f6d 7072 6573 7365 643a 0d0a 2020 2020  ompressed:..    
-00019b40: 2020 2020 2020 2020 6173 7365 7274 2070          assert p
-00019b50: 6174 682e 656e 6473 7769 7468 2822 2e7a  ath.endswith(".z
-00019b60: 6970 2229 2c20 2266 696c 6522 202b 2070  ip"), "file" + p
-00019b70: 6174 6820 2b20 2220 7368 6f75 6c64 2068  ath + " should h
-00019b80: 6176 6520 2e61 7363 2065 7874 656e 7369  ave .asc extensi
-00019b90: 6f6e 220d 0a20 2020 2020 2020 2065 6c73  on"..        els
-00019ba0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00019bb0: 6173 7365 7274 2070 6174 682e 656e 6473  assert path.ends
-00019bc0: 7769 7468 2822 2e61 7363 2229 2c20 2266  with(".asc"), "f
-00019bd0: 696c 6522 202b 2070 6174 6820 2b20 2220  ile" + path + " 
-00019be0: 7368 6f75 6c64 2068 6176 6520 2e61 7363  should have .asc
-00019bf0: 2065 7874 656e 7369 6f6e 220d 0a0d 0a20   extension".... 
-00019c00: 2020 2020 2020 2045 7874 7261 6374 6564         Extracted
-00019c10: 5661 6c75 6573 203d 206c 6973 7428 290d  Values = list().
-00019c20: 0a0d 0a20 2020 2020 2020 2074 7279 3a0d  ...        try:.
-00019c30: 0a20 2020 2020 2020 2020 2020 2023 206f  .            # o
-00019c40: 7065 6e20 7468 6520 7a69 7020 6669 6c65  pen the zip file
-00019c50: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00019c60: 2063 6f6d 7072 6573 7365 643a 0d0a 2020   compressed:..  
-00019c70: 2020 2020 2020 2020 2020 2020 2020 436f                Co
-00019c80: 6d70 7265 7373 6564 6669 6c65 203d 207a  mpressedfile = z
-00019c90: 6970 6669 6c65 2e5a 6970 4669 6c65 2870  ipfile.ZipFile(p
-00019ca0: 6174 6829 0d0a 2020 2020 2020 2020 2020  ath)..          
-00019cb0: 2020 2020 2020 2320 6765 7420 7468 6520        # get the 
-00019cc0: 6669 6c65 206e 616d 650d 0a20 2020 2020  file name..     
-00019cd0: 2020 2020 2020 2020 2020 2066 6e61 6d65             fname
-00019ce0: 203d 2043 6f6d 7072 6573 7365 6466 696c   = Compressedfil
-00019cf0: 652e 696e 666f 6c69 7374 2829 5b30 5d0d  e.infolist()[0].
-00019d00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019d10: 2023 2041 5343 4949 4620 3d20 436f 6d70   # ASCIIF = Comp
-00019d20: 7265 7373 6564 6669 6c65 2e6f 7065 6e28  ressedfile.open(
-00019d30: 666e 616d 6529 0d0a 2020 2020 2020 2020  fname)..        
-00019d40: 2020 2020 2020 2020 2320 5370 6174 6961          # Spatia
-00019d50: 6c52 6566 203d 2041 5343 4949 462e 7265  lRef = ASCIIF.re
-00019d60: 6164 6c69 6e65 7328 295b 3a36 5d0d 0a20  adlines()[:6].. 
-00019d70: 2020 2020 2020 2020 2020 2020 2020 2041                 A
-00019d80: 5343 4949 4620 3d20 436f 6d70 7265 7373  SCIIF = Compress
-00019d90: 6564 6669 6c65 2e6f 7065 6e28 666e 616d  edfile.open(fnam
-00019da0: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-00019db0: 2020 2020 4153 4349 4952 6177 203d 2041      ASCIIRaw = A
-00019dc0: 5343 4949 462e 7265 6164 6c69 6e65 7328  SCIIF.readlines(
-00019dd0: 295b 363a 5d0d 0a20 2020 2020 2020 2020  )[6:]..         
-00019de0: 2020 2020 2020 2072 6f77 7320 3d20 6c65         rows = le
-00019df0: 6e28 4153 4349 4952 6177 290d 0a20 2020  n(ASCIIRaw)..   
-00019e00: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
-00019e10: 7320 3d20 6c65 6e28 4153 4349 4952 6177  s = len(ASCIIRaw
-00019e20: 5b30 5d2e 7370 6c69 7428 2929 0d0a 2020  [0].split())..  
-00019e30: 2020 2020 2020 2020 2020 2020 2020 4d61                Ma
-00019e40: 7056 616c 7565 7320 3d20 6e70 2e6f 6e65  pValues = np.one
-00019e50: 7328 2872 6f77 732c 2063 6f6c 7329 2c20  s((rows, cols), 
-00019e60: 6474 7970 653d 6e70 2e66 6c6f 6174 3332  dtype=np.float32
-00019e70: 2920 2a20 300d 0a20 2020 2020 2020 2020  ) * 0..         
-00019e80: 2020 2020 2020 2023 2072 6561 6420 7468         # read th
-00019e90: 6520 6173 6369 6920 6669 6c65 0d0a 2020  e ascii file..  
-00019ea0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00019eb0: 7220 6920 696e 2072 616e 6765 2872 6f77  r i in range(row
-00019ec0: 7329 3a0d 0a20 2020 2020 2020 2020 2020  s):..           
-00019ed0: 2020 2020 2020 2020 2078 203d 2041 5343           x = ASC
-00019ee0: 4949 5261 775b 695d 2e73 706c 6974 2829  IIRaw[i].split()
-00019ef0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00019f00: 2020 2020 2020 4d61 7056 616c 7565 735b        MapValues[
-00019f10: 692c 203a 5d20 3d20 6c69 7374 286d 6170  i, :] = list(map
-00019f20: 2866 6c6f 6174 2c20 7829 290d 0a0d 0a20  (float, x)).... 
-00019f30: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00019f40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00019f50: 2020 4d61 7056 616c 7565 732c 2053 7061    MapValues, Spa
-00019f60: 7469 616c 5265 6620 3d20 5261 7374 6572  tialRef = Raster
-00019f70: 2e72 6561 6441 5343 4949 2870 6174 6829  .readASCII(path)
-00019f80: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00019f90: 2320 636f 756e 7420 6e6f 6e7a 6572 6f20  # count nonzero 
-00019fa0: 6365 6c6c 730d 0a20 2020 2020 2020 2020  cells..         
-00019fb0: 2020 204e 6f6e 5a65 726f 4365 6c6c 7320     NonZeroCells 
-00019fc0: 3d20 6e70 2e63 6f75 6e74 5f6e 6f6e 7a65  = np.count_nonze
-00019fd0: 726f 284d 6170 5661 6c75 6573 290d 0a0d  ro(MapValues)...
-00019fe0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00019ff0: 6f63 6375 7069 6564 5f43 656c 6c73 5f6f  occupied_Cells_o
-0001a000: 6e6c 793a 0d0a 2020 2020 2020 2020 2020  nly:..          
-0001a010: 2020 2020 2020 4578 7472 6163 7465 6456        ExtractedV
-0001a020: 616c 7565 7320 3d20 300d 0a20 2020 2020  alues = 0..     
-0001a030: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0001a040: 6e20 4578 7472 6163 7465 6456 616c 7565  n ExtractedValue
-0001a050: 732c 204e 6f6e 5a65 726f 4365 6c6c 730d  s, NonZeroCells.
-0001a060: 0a0d 0a20 2020 2020 2020 2020 2020 2023  ...            #
-0001a070: 2067 6574 2074 6865 2070 6f73 6974 696f   get the positio
-0001a080: 6e20 6f66 2063 656c 6c73 2074 6861 7420  n of cells that 
-0001a090: 6973 206e 6f74 207a 6572 6f73 0d0a 2020  is not zeros..  
-0001a0a0: 2020 2020 2020 2020 2020 726f 7773 203d            rows =
-0001a0b0: 206e 702e 7768 6572 6528 4d61 7056 616c   np.where(MapVal
-0001a0c0: 7565 735b 3a2c 203a 5d20 213d 2065 7863  ues[:, :] != exc
-0001a0d0: 6c75 6465 5f76 616c 7565 295b 305d 0d0a  lude_value)[0]..
-0001a0e0: 2020 2020 2020 2020 2020 2020 636f 6c73              cols
-0001a0f0: 203d 206e 702e 7768 6572 6528 4d61 7056   = np.where(MapV
-0001a100: 616c 7565 735b 3a2c 203a 5d20 213d 2065  alues[:, :] != e
-0001a110: 7863 6c75 6465 5f76 616c 7565 295b 315d  xclude_value)[1]
-0001a120: 0d0a 0d0a 2020 2020 2020 2020 6578 6365  ....        exce
-0001a130: 7074 3a0d 0a20 2020 2020 2020 2020 2020  pt:..           
-0001a140: 2070 7269 6e74 2822 4572 726f 7220 4f70   print("Error Op
-0001a150: 656e 696e 6720 7468 6520 636f 6d70 7265  ening the compre
-0001a160: 7373 6564 2066 696c 6522 290d 0a20 2020  ssed file")..   
-0001a170: 2020 2020 2020 2020 204e 6f6e 5a65 726f           NonZero
-0001a180: 4365 6c6c 7320 3d20 2d31 0d0a 2020 2020  Cells = -1..    
-0001a190: 2020 2020 2020 2020 4578 7472 6163 7465          Extracte
-0001a1a0: 6456 616c 7565 7320 3d20 2d31 0d0a 2020  dValues = -1..  
-0001a1b0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0001a1c0: 2045 7874 7261 6374 6564 5661 6c75 6573   ExtractedValues
-0001a1d0: 2c20 4e6f 6e5a 6572 6f43 656c 6c73 0d0a  , NonZeroCells..
-0001a1e0: 0d0a 2020 2020 2020 2020 2320 6765 7420  ..        # get 
-0001a1f0: 7468 6520 7661 6c75 6573 206f 6620 7468  the values of th
-0001a200: 6520 6669 6c74 6572 6564 2063 656c 6c73  e filtered cells
-0001a210: 0d0a 2020 2020 2020 2020 666f 7220 6920  ..        for i 
-0001a220: 696e 2072 616e 6765 286c 656e 2872 6f77  in range(len(row
-0001a230: 7329 293a 0d0a 2020 2020 2020 2020 2020  s)):..          
-0001a240: 2020 4578 7472 6163 7465 6456 616c 7565    ExtractedValue
-0001a250: 732e 6170 7065 6e64 284d 6170 5661 6c75  s.append(MapValu
-0001a260: 6573 5b72 6f77 735b 695d 2c20 636f 6c73  es[rows[i], cols
-0001a270: 5b69 5d5d 290d 0a0d 0a20 2020 2020 2020  [i]])....       
-0001a280: 2072 6574 7572 6e20 4578 7472 6163 7465   return Extracte
-0001a290: 6456 616c 7565 732c 204e 6f6e 5a65 726f  dValues, NonZero
-0001a2a0: 4365 6c6c 730d 0a0d 0a20 2020 2040 7374  Cells....    @st
-0001a2b0: 6174 6963 6d65 7468 6f64 0d0a 2020 2020  aticmethod..    
-0001a2c0: 6465 6620 6f76 6572 6c61 794d 6170 280d  def overlayMap(.
-0001a2d0: 0a20 2020 2020 2020 2070 6174 683a 2073  .        path: s
-0001a2e0: 7472 2c0d 0a20 2020 2020 2020 2063 6c61  tr,..        cla
-0001a2f0: 7373 6573 5f6d 6170 3a20 556e 696f 6e5b  sses_map: Union[
-0001a300: 7374 722c 206e 702e 6e64 6172 7261 795d  str, np.ndarray]
-0001a310: 2c0d 0a20 2020 2020 2020 2065 7863 6c75  ,..        exclu
-0001a320: 6465 5f76 616c 7565 3a20 556e 696f 6e5b  de_value: Union[
-0001a330: 666c 6f61 742c 2069 6e74 5d2c 0d0a 2020  float, int],..  
-0001a340: 2020 2020 2020 636f 6d70 7265 7373 6564        compressed
-0001a350: 3a20 626f 6f6c 203d 2046 616c 7365 2c0d  : bool = False,.
-0001a360: 0a20 2020 2020 2020 206f 6363 7570 6965  .        occupie
-0001a370: 645f 6365 6c6c 735f 6f6e 6c79 3a20 626f  d_cells_only: bo
-0001a380: 6f6c 203d 2054 7275 652c 0d0a 2020 2020  ol = True,..    
-0001a390: 2920 2d3e 2054 7570 6c65 5b44 6963 745b  ) -> Tuple[Dict[
-0001a3a0: 4c69 7374 5b66 6c6f 6174 5d2c 204c 6973  List[float], Lis
-0001a3b0: 745b 666c 6f61 745d 5d2c 2069 6e74 5d3a  t[float]], int]:
-0001a3c0: 0d0a 2020 2020 2020 2020 2222 224f 7665  ..        """Ove
-0001a3d0: 726c 6179 4d61 702e 0d0a 0d0a 2020 2020  rlayMap.....    
-0001a3e0: 2020 2020 2020 2020 4f76 6572 6c61 794d          OverlayM
-0001a3f0: 6170 2065 7874 7261 6374 7320 616e 6420  ap extracts and 
-0001a400: 7265 7475 726e 2061 206c 6973 7420 6f66  return a list of
-0001a410: 2061 6c6c 2074 6865 2076 616c 7565 7320   all the values 
-0001a420: 696e 2061 6e20 4153 4349 4920 6669 6c65  in an ASCII file
-0001a430: 2c0d 0a20 2020 2020 2020 2020 2020 2069  ,..            i
-0001a440: 6620 796f 7520 6861 7665 2074 776f 206d  f you have two m
-0001a450: 6170 7320 6f6e 6520 7769 7468 2063 6c61  aps one with cla
-0001a460: 7373 6573 2c20 616e 6420 7468 6520 6f74  sses, and the ot
-0001a470: 6865 7220 6d61 7020 636f 6e74 6169 6e73  her map contains
-0001a480: 2061 6e79 2074 7970 6520 6f66 2076 616c   any type of val
-0001a490: 7565 732c 0d0a 2020 2020 2020 2020 2020  ues,..          
-0001a4a0: 2020 616e 6420 796f 7520 7761 6e74 2074    and you want t
-0001a4b0: 6f20 6b6e 6f77 2074 6865 2076 616c 7565  o know the value
-0001a4c0: 7320 696e 2065 6163 6820 636c 6173 730d  s in each class.
-0001a4d0: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-0001a4e0: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
-0001a4f0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
-0001a500: 2020 2070 6174 683a 205b 7374 725d 0d0a     path: [str]..
-0001a510: 2020 2020 2020 2020 2020 2020 6120 7061              a pa
-0001a520: 7468 2074 6f20 6173 6369 6920 6669 6c65  th to ascii file
-0001a530: 2e0d 0a20 2020 2020 2020 2063 6c61 7373  ...        class
-0001a540: 6573 5f6d 6170 3a20 5b73 7472 2f61 7272  es_map: [str/arr
-0001a550: 6179 5d0d 0a20 2020 2020 2020 2020 2020  ay]..           
-0001a560: 2061 2070 6174 6820 696e 636c 7564 6e67   a path includng
-0001a570: 2074 6865 206e 616d 6520 6f66 2074 6865   the name of the
-0001a580: 2041 5343 4949 2061 6e64 2065 7874 656e   ASCII and exten
-0001a590: 7469 6f6e 2c20 6f72 2061 6e20 6172 7261  tion, or an arra
-0001a5a0: 790d 0a20 2020 2020 2020 2020 2020 203e  y..            >
-0001a5b0: 3e3e 2070 6174 6820 3d20 2263 6c61 7373  >> path = "class
-0001a5c0: 6573 2e61 7363 220d 0a20 2020 2020 2020  es.asc"..       
-0001a5d0: 2065 7863 6c75 6465 5f76 616c 7565 3a20   exclude_value: 
-0001a5e0: 5b4e 756d 6572 6963 5d0d 0a20 2020 2020  [Numeric]..     
-0001a5f0: 2020 2020 2020 2076 616c 7565 7320 796f         values yo
-0001a600: 7520 7761 6e74 2074 6f20 6578 636c 7564  u want to exclud
-0001a610: 6520 6672 6f6d 2065 7874 7261 6374 6564  e from extracted
-0001a620: 2076 616c 7565 732e 0d0a 2020 2020 2020   values...      
-0001a630: 2020 636f 6d70 7265 7373 6564 3a20 5b42    compressed: [B
-0001a640: 6f6f 6c5d 0d0a 2020 2020 2020 2020 2020  ool]..          
-0001a650: 2020 6966 2074 6865 206d 6170 2079 6f75    if the map you
-0001a660: 2070 726f 7669 6465 6420 6973 2063 6f6d   provided is com
-0001a670: 7072 6573 7365 642e 0d0a 2020 2020 2020  pressed...      
-0001a680: 2020 6f63 6375 7069 6564 5f63 656c 6c73    occupied_cells
-0001a690: 5f6f 6e6c 793a 205b 426f 6f6c 5d0d 0a20  _only: [Bool].. 
-0001a6a0: 2020 2020 2020 2020 2020 2069 6620 796f             if yo
-0001a6b0: 7520 7761 6e74 2074 6f20 636f 756e 7420  u want to count 
-0001a6c0: 6f6e 6c79 2063 656c 6c73 2074 6861 7420  only cells that 
-0001a6d0: 6973 206e 6f74 207a 6572 6f2e 0d0a 0d0a  is not zero.....
-0001a6e0: 2020 2020 2020 2020 5265 7475 726e 730d          Returns.
-0001a6f0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0001a700: 0d0a 2020 2020 2020 2020 4578 7472 6163  ..        Extrac
-0001a710: 7465 6456 616c 7565 733a 205b 4469 6374  tedValues: [Dict
-0001a720: 5d0d 0a20 2020 2020 2020 2020 2020 2064  ]..            d
-0001a730: 6963 746f 6e61 7279 2077 6974 6820 6120  ictonary with a 
-0001a740: 6c69 7374 206f 6620 7661 6c75 6573 2069  list of values i
-0001a750: 6e20 7468 6520 6261 7365 6d61 7020 6173  n the basemap as
-0001a760: 206b 6579 730d 0a20 2020 2020 2020 2020   keys..         
-0001a770: 2020 2020 2020 2061 6e64 2066 6f72 2065         and for e
-0001a780: 6163 6820 6b65 7920 6120 6c69 7374 206f  ach key a list o
-0001a790: 6620 616c 6c20 7468 6520 696e 7465 7273  f all the inters
-0001a7a0: 6563 7465 6420 7661 6c75 6573 2069 6e20  ected values in 
-0001a7b0: 7468 650d 0a20 2020 2020 2020 2020 2020  the..           
-0001a7c0: 2020 2020 206d 6170 7320 6672 6f6d 2074       maps from t
-0001a7d0: 6865 2070 6174 682e 0d0a 2020 2020 2020  he path...      
-0001a7e0: 2020 4e6f 6e5a 6572 6f43 656c 6c73 3a20    NonZeroCells: 
-0001a7f0: 5b64 6174 6166 7261 6d65 5d0d 0a20 2020  [dataframe]..   
-0001a800: 2020 2020 2020 2020 2074 6865 206e 756d           the num
-0001a810: 6265 7220 6f66 2063 656c 6c73 2069 6e20  ber of cells in 
-0001a820: 7468 6520 6d61 702e 0d0a 2020 2020 2020  the map...      
-0001a830: 2020 2222 220d 0a20 2020 2020 2020 2069    """..        i
-0001a840: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
-0001a850: 2870 6174 682c 2073 7472 293a 0d0a 2020  (path, str):..  
-0001a860: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0001a870: 5479 7065 4572 726f 7228 6622 5061 7468  TypeError(f"Path
-0001a880: 2069 6e70 7574 2073 686f 756c 6420 6265   input should be
-0001a890: 2073 7472 696e 6720 7479 7065 202d 2067   string type - g
-0001a8a0: 6976 656e 7b74 7970 6528 7061 7468 297d  iven{type(path)}
-0001a8b0: 2229 0d0a 0d0a 2020 2020 2020 2020 6966  ")....        if
-0001a8c0: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-0001a8d0: 636f 6d70 7265 7373 6564 2c20 626f 6f6c  compressed, bool
-0001a8e0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-0001a8f0: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
-0001a900: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001a910: 2020 6622 436f 6d70 7265 7373 6564 2069    f"Compressed i
-0001a920: 6e70 7574 2073 686f 756c 6420 6265 2042  nput should be B
-0001a930: 6f6f 6c65 6e20 7479 7065 2067 6976 656e  oolen type given
-0001a940: 207b 7479 7065 2863 6f6d 7072 6573 7365   {type(compresse
-0001a950: 6429 7d22 0d0a 2020 2020 2020 2020 2020  d)}"..          
-0001a960: 2020 290d 0a0d 0a20 2020 2020 2020 2023    )....        #
-0001a970: 2063 6865 636b 2077 6574 6865 7220 7468   check wether th
-0001a980: 6520 7061 7468 2065 7869 7374 206f 7220  e path exist or 
-0001a990: 6e6f 740d 0a20 2020 2020 2020 2069 6620  not..        if 
-0001a9a0: 6e6f 7420 6f73 2e70 6174 682e 6578 6973  not os.path.exis
-0001a9b0: 7473 2870 6174 6829 3a0d 0a20 2020 2020  ts(path):..     
-0001a9c0: 2020 2020 2020 2072 6169 7365 2046 696c         raise Fil
-0001a9d0: 654e 6f74 466f 756e 6445 7272 6f72 2866  eNotFoundError(f
-0001a9e0: 2274 6865 2070 6174 6820 7b70 6174 687d  "the path {path}
-0001a9f0: 2079 6f75 2068 6176 6520 7072 6f76 6964   you have provid
-0001aa00: 6564 2064 6f65 7320 6e6f 7420 6578 6973  ed does not exis
-0001aa10: 7422 290d 0a0d 0a20 2020 2020 2020 2023  t")....        #
-0001aa20: 2072 6561 6420 7468 6520 6261 7365 206d   read the base m
-0001aa30: 6170 0d0a 2020 2020 2020 2020 6966 2069  ap..        if i
-0001aa40: 7369 6e73 7461 6e63 6528 636c 6173 7365  sinstance(classe
-0001aa50: 735f 6d61 702c 2073 7472 293a 0d0a 2020  s_map, str):..  
-0001aa60: 2020 2020 2020 2020 2020 6966 2063 6c61            if cla
-0001aa70: 7373 6573 5f6d 6170 2e65 6e64 7377 6974  sses_map.endswit
-0001aa80: 6828 222e 6173 6322 293a 0d0a 2020 2020  h(".asc"):..    
-0001aa90: 2020 2020 2020 2020 2020 2020 4261 7365              Base
-0001aaa0: 4d61 7056 2c20 5f20 3d20 5261 7374 6572  MapV, _ = Raster
-0001aab0: 2e72 6561 6441 5343 4949 2863 6c61 7373  .readASCII(class
-0001aac0: 6573 5f6d 6170 290d 0a20 2020 2020 2020  es_map)..       
-0001aad0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-0001aae0: 2020 2020 2020 2020 2020 2020 4261 7365              Base
-0001aaf0: 4d61 7020 3d20 6764 616c 2e4f 7065 6e28  Map = gdal.Open(
-0001ab00: 636c 6173 7365 735f 6d61 7029 0d0a 2020  classes_map)..  
-0001ab10: 2020 2020 2020 2020 2020 2020 2020 4261                Ba
-0001ab20: 7365 4d61 7056 203d 2042 6173 654d 6170  seMapV = BaseMap
-0001ab30: 2e52 6561 6441 7341 7272 6179 2829 0d0a  .ReadAsArray()..
-0001ab40: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-0001ab50: 2020 2020 2020 2020 2020 2042 6173 654d             BaseM
-0001ab60: 6170 5620 3d20 636c 6173 7365 735f 6d61  apV = classes_ma
-0001ab70: 700d 0a0d 0a20 2020 2020 2020 2045 7874  p....        Ext
-0001ab80: 7261 6374 6564 5661 6c75 6573 203d 2064  ractedValues = d
-0001ab90: 6963 7428 290d 0a0d 0a20 2020 2020 2020  ict()....       
-0001aba0: 2074 7279 3a0d 0a20 2020 2020 2020 2020   try:..         
-0001abb0: 2020 2023 206f 7065 6e20 7468 6520 7a69     # open the zi
-0001abc0: 7020 6669 6c65 0d0a 2020 2020 2020 2020  p file..        
-0001abd0: 2020 2020 6966 2063 6f6d 7072 6573 7365      if compresse
-0001abe0: 643a 0d0a 2020 2020 2020 2020 2020 2020  d:..            
-0001abf0: 2020 2020 436f 6d70 7265 7373 6564 6669      Compressedfi
-0001ac00: 6c65 203d 207a 6970 6669 6c65 2e5a 6970  le = zipfile.Zip
-0001ac10: 4669 6c65 2870 6174 6829 0d0a 2020 2020  File(path)..    
-0001ac20: 2020 2020 2020 2020 2020 2020 2320 6765              # ge
-0001ac30: 7420 7468 6520 6669 6c65 206e 616d 650d  t the file name.
-0001ac40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ac50: 2066 6e61 6d65 203d 2043 6f6d 7072 6573   fname = Compres
-0001ac60: 7365 6466 696c 652e 696e 666f 6c69 7374  sedfile.infolist
-0001ac70: 2829 5b30 5d0d 0a20 2020 2020 2020 2020  ()[0]..         
-0001ac80: 2020 2020 2020 2041 5343 4949 4620 3d20         ASCIIF = 
-0001ac90: 436f 6d70 7265 7373 6564 6669 6c65 2e6f  Compressedfile.o
-0001aca0: 7065 6e28 666e 616d 6529 0d0a 2020 2020  pen(fname)..    
-0001acb0: 2020 2020 2020 2020 2020 2020 2320 2020              #   
-0001acc0: 2020 2020 2020 2020 2020 2020 2053 7061               Spa
-0001acd0: 7469 616c 5265 6620 3d20 4153 4349 4946  tialRef = ASCIIF
-0001ace0: 2e72 6561 646c 696e 6573 2829 5b3a 365d  .readlines()[:6]
-0001acf0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001ad00: 2020 4153 4349 4946 203d 2043 6f6d 7072    ASCIIF = Compr
-0001ad10: 6573 7365 6466 696c 652e 6f70 656e 2866  essedfile.open(f
-0001ad20: 6e61 6d65 290d 0a20 2020 2020 2020 2020  name)..         
-0001ad30: 2020 2020 2020 2041 5343 4949 5261 7720         ASCIIRaw 
-0001ad40: 3d20 4153 4349 4946 2e72 6561 646c 696e  = ASCIIF.readlin
-0001ad50: 6573 2829 5b36 3a5d 0d0a 2020 2020 2020  es()[6:]..      
-0001ad60: 2020 2020 2020 2020 2020 726f 7773 203d            rows =
-0001ad70: 206c 656e 2841 5343 4949 5261 7729 0d0a   len(ASCIIRaw)..
-0001ad80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ad90: 636f 6c73 203d 206c 656e 2841 5343 4949  cols = len(ASCII
-0001ada0: 5261 775b 305d 2e73 706c 6974 2829 290d  Raw[0].split()).
-0001adb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001adc0: 204d 6170 5661 6c75 6573 203d 206e 702e   MapValues = np.
-0001add0: 6f6e 6573 2828 726f 7773 2c20 636f 6c73  ones((rows, cols
-0001ade0: 292c 2064 7479 7065 3d6e 702e 666c 6f61  ), dtype=np.floa
-0001adf0: 7433 3229 202a 2030 0d0a 2020 2020 2020  t32) * 0..      
-0001ae00: 2020 2020 2020 2020 2020 2320 7265 6164            # read
-0001ae10: 2074 6865 2061 7363 6969 2066 696c 650d   the ascii file.
-0001ae20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ae30: 2066 6f72 2072 6f77 2069 6e20 7261 6e67   for row in rang
-0001ae40: 6528 726f 7773 293a 0d0a 2020 2020 2020  e(rows):..      
-0001ae50: 2020 2020 2020 2020 2020 2020 2020 7820                x 
-0001ae60: 3d20 4153 4349 4952 6177 5b72 6f77 5d2e  = ASCIIRaw[row].
-0001ae70: 7370 6c69 7428 290d 0a20 2020 2020 2020  split()..       
-0001ae80: 2020 2020 2020 2020 2020 2020 204d 6170               Map
-0001ae90: 5661 6c75 6573 5b72 6f77 2c20 3a5d 203d  Values[row, :] =
-0001aea0: 206c 6973 7428 6d61 7028 666c 6f61 742c   list(map(float,
-0001aeb0: 2078 2929 0d0a 0d0a 2020 2020 2020 2020   x))....        
-0001aec0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-0001aed0: 2020 2020 2020 2020 2020 204d 6170 5661             MapVa
-0001aee0: 6c75 6573 2c20 5370 6174 6961 6c52 6566  lues, SpatialRef
-0001aef0: 203d 2052 6173 7465 722e 7265 6164 4153   = Raster.readAS
-0001af00: 4349 4928 7061 7468 290d 0a20 2020 2020  CII(path)..     
-0001af10: 2020 2020 2020 2023 2063 6f75 6e74 206e         # count n
-0001af20: 756d 6265 7220 6f66 206e 6f6e 7a65 726f  umber of nonzero
-0001af30: 2063 656c 6c73 0d0a 2020 2020 2020 2020   cells..        
-0001af40: 2020 2020 4e6f 6e5a 6572 6f43 656c 6c73      NonZeroCells
-0001af50: 203d 206e 702e 636f 756e 745f 6e6f 6e7a   = np.count_nonz
-0001af60: 6572 6f28 4d61 7056 616c 7565 7329 0d0a  ero(MapValues)..
-0001af70: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0001af80: 206f 6363 7570 6965 645f 6365 6c6c 735f   occupied_cells_
-0001af90: 6f6e 6c79 3a0d 0a20 2020 2020 2020 2020  only:..         
-0001afa0: 2020 2020 2020 2045 7874 7261 6374 6564         Extracted
-0001afb0: 5661 6c75 6573 203d 2030 0d0a 2020 2020  Values = 0..    
-0001afc0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001afd0: 726e 2045 7874 7261 6374 6564 5661 6c75  rn ExtractedValu
-0001afe0: 6573 2c20 4e6f 6e5a 6572 6f43 656c 6c73  es, NonZeroCells
-0001aff0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-0001b000: 2320 6765 7420 7468 6520 706f 7369 7469  # get the positi
-0001b010: 6f6e 206f 6620 6365 6c6c 7320 7468 6174  on of cells that
-0001b020: 2069 7320 6e6f 7420 7a65 726f 730d 0a20   is not zeros.. 
-0001b030: 2020 2020 2020 2020 2020 2072 6f77 7320             rows 
-0001b040: 3d20 6e70 2e77 6865 7265 284d 6170 5661  = np.where(MapVa
-0001b050: 6c75 6573 5b3a 2c20 3a5d 2021 3d20 6578  lues[:, :] != ex
-0001b060: 636c 7564 655f 7661 6c75 6529 5b30 5d0d  clude_value)[0].
-0001b070: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
-0001b080: 7320 3d20 6e70 2e77 6865 7265 284d 6170  s = np.where(Map
-0001b090: 5661 6c75 6573 5b3a 2c20 3a5d 2021 3d20  Values[:, :] != 
-0001b0a0: 6578 636c 7564 655f 7661 6c75 6529 5b31  exclude_value)[1
-0001b0b0: 5d0d 0a0d 0a20 2020 2020 2020 2065 7863  ]....        exc
-0001b0c0: 6570 743a 0d0a 2020 2020 2020 2020 2020  ept:..          
-0001b0d0: 2020 7072 696e 7428 2245 7272 6f72 204f    print("Error O
-0001b0e0: 7065 6e69 6e67 2074 6865 2063 6f6d 7072  pening the compr
-0001b0f0: 6573 7365 6420 6669 6c65 2229 0d0a 2020  essed file")..  
-0001b100: 2020 2020 2020 2020 2020 4e6f 6e5a 6572            NonZer
-0001b110: 6f43 656c 6c73 203d 202d 310d 0a20 2020  oCells = -1..   
-0001b120: 2020 2020 2020 2020 2045 7874 7261 6374           Extract
-0001b130: 6564 5661 6c75 6573 203d 202d 310d 0a20  edValues = -1.. 
-0001b140: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0001b150: 6e20 4578 7472 6163 7465 6456 616c 7565  n ExtractedValue
-0001b160: 732c 204e 6f6e 5a65 726f 4365 6c6c 730d  s, NonZeroCells.
-0001b170: 0a0d 0a20 2020 2020 2020 2023 2065 7874  ...        # ext
-0001b180: 7261 6374 2076 616c 7565 730d 0a20 2020  ract values..   
-0001b190: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
-0001b1a0: 6e67 6528 6c65 6e28 726f 7773 2929 3a0d  nge(len(rows)):.
-0001b1b0: 0a20 2020 2020 2020 2020 2020 2023 2066  .            # f
-0001b1c0: 6972 7374 2063 6865 636b 2069 6620 7468  irst check if th
-0001b1d0: 6520 7375 622d 6261 7369 6e20 6861 7320  e sub-basin has 
-0001b1e0: 6120 6c69 7374 2069 6e20 7468 6520 6469  a list in the di
-0001b1f0: 6374 2069 6620 6e6f 7420 6372 6561 7465  ct if not create
-0001b200: 2061 206c 6973 740d 0a20 2020 2020 2020   a list..       
-0001b210: 2020 2020 2069 6620 4261 7365 4d61 7056       if BaseMapV
-0001b220: 5b72 6f77 735b 695d 2c20 636f 6c73 5b69  [rows[i], cols[i
-0001b230: 5d5d 206e 6f74 2069 6e20 6c69 7374 2845  ]] not in list(E
-0001b240: 7874 7261 6374 6564 5661 6c75 6573 2e6b  xtractedValues.k
-0001b250: 6579 7328 2929 3a0d 0a20 2020 2020 2020  eys()):..       
-0001b260: 2020 2020 2020 2020 2045 7874 7261 6374           Extract
-0001b270: 6564 5661 6c75 6573 5b42 6173 654d 6170  edValues[BaseMap
-0001b280: 565b 726f 7773 5b69 5d2c 2063 6f6c 735b  V[rows[i], cols[
-0001b290: 695d 5d5d 203d 206c 6973 7428 290d 0a0d  i]]] = list()...
-0001b2a0: 0a20 2020 2020 2020 2020 2020 2023 2020  .            #  
-0001b2b0: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-0001b2c0: 206e 702e 6973 6e61 6e28 4d61 7056 616c   np.isnan(MapVal
-0001b2d0: 7565 735b 726f 7773 5b69 5d2c 636f 6c73  ues[rows[i],cols
-0001b2e0: 5b69 5d5d 293a 0d0a 2020 2020 2020 2020  [i]]):..        
-0001b2f0: 2020 2020 4578 7472 6163 7465 6456 616c      ExtractedVal
-0001b300: 7565 735b 4261 7365 4d61 7056 5b72 6f77  ues[BaseMapV[row
-0001b310: 735b 695d 2c20 636f 6c73 5b69 5d5d 5d2e  s[i], cols[i]]].
-0001b320: 6170 7065 6e64 280d 0a20 2020 2020 2020  append(..       
-0001b330: 2020 2020 2020 2020 204d 6170 5661 6c75           MapValu
-0001b340: 6573 5b72 6f77 735b 695d 2c20 636f 6c73  es[rows[i], cols
-0001b350: 5b69 5d5d 0d0a 2020 2020 2020 2020 2020  [i]]..          
-0001b360: 2020 290d 0a20 2020 2020 2020 2023 2020    )..        #  
-0001b370: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-0001b380: 0a20 2020 2020 2020 2023 2069 6620 7468  .        # if th
-0001b390: 6520 7661 6c75 6520 6973 206e 616e 0d0a  e value is nan..
-0001b3a0: 2020 2020 2020 2020 2320 2020 2020 2020          #       
-0001b3b0: 2020 2020 2020 2020 204e 616e 4c69 7374           NanList
-0001b3c0: 2e61 7070 656e 6428 4669 6c74 6572 6564  .append(Filtered
-0001b3d0: 4c69 7374 5b69 5d29 0d0a 0d0a 2020 2020  List[i])....    
-0001b3e0: 2020 2020 7265 7475 726e 2045 7874 7261      return Extra
-0001b3f0: 6374 6564 5661 6c75 6573 2c20 4e6f 6e5a  ctedValues, NonZ
-0001b400: 6572 6f43 656c 6c73 0d0a 0d0a 2020 2020  eroCells....    
-0001b410: 4073 7461 7469 636d 6574 686f 640d 0a20  @staticmethod.. 
-0001b420: 2020 2064 6566 206f 7665 726c 6179 4d61     def overlayMa
-0001b430: 7073 280d 0a20 2020 2020 2020 2070 6174  ps(..        pat
-0001b440: 683a 2073 7472 2c0d 0a20 2020 2020 2020  h: str,..       
-0001b450: 2062 6173 656d 6170 5f66 696c 653a 2073   basemap_file: s
-0001b460: 7472 2c0d 0a20 2020 2020 2020 2066 696c  tr,..        fil
-0001b470: 655f 7072 6566 6978 3a20 7374 722c 0d0a  e_prefix: str,..
-0001b480: 2020 2020 2020 2020 6578 636c 7564 655f          exclude_
-0001b490: 7661 6c75 653a 2055 6e69 6f6e 5b66 6c6f  value: Union[flo
-0001b4a0: 6174 2c20 696e 745d 2c0d 0a20 2020 2020  at, int],..     
-0001b4b0: 2020 2063 6f6d 7072 6573 7365 643a 2062     compressed: b
-0001b4c0: 6f6f 6c20 3d20 4661 6c73 652c 0d0a 2020  ool = False,..  
-0001b4d0: 2020 2020 2020 6f63 6375 7069 6564 5f63        occupied_c
-0001b4e0: 656c 6c73 5f6f 6e6c 793a 2062 6f6f 6c20  ells_only: bool 
-0001b4f0: 3d20 5472 7565 2c0d 0a20 2020 2029 3a0d  = True,..    ):.
-0001b500: 0a20 2020 2020 2020 2022 2222 7468 6973  .        """this
-0001b510: 2066 756e 6374 696f 6e20 6973 2077 7269   function is wri
-0001b520: 7474 656e 2074 6f20 6578 7472 6163 7420  tten to extract 
-0001b530: 616e 6420 7265 7475 726e 2061 206c 6973  and return a lis
-0001b540: 7420 6f66 2061 6c6c 2074 6865 2076 616c  t of all the val
-0001b550: 7565 7320 696e 2061 6e20 4153 4349 4920  ues in an ASCII 
-0001b560: 6669 6c65 2e0d 0a0d 0a20 2020 2020 2020  file.....       
-0001b570: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-0001b580: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-0001b590: 0a20 2020 2020 2020 2070 6174 683a 205b  .        path: [
-0001b5a0: 5374 7269 6e67 5d0d 0a20 2020 2020 2020  String]..       
-0001b5b0: 2020 2020 2061 2070 6174 6820 746f 2074       a path to t
-0001b5c0: 6865 2066 6f6c 6465 7220 696e 636c 7564  he folder includ
-0001b5d0: 6e67 2074 6865 206d 6170 732e 0d0a 2020  ng the maps...  
-0001b5e0: 2020 2020 2020 6261 7365 6d61 705f 6669        basemap_fi
-0001b5f0: 6c65 3a20 5b53 7472 696e 675d 0d0a 2020  le: [String]..  
-0001b600: 2020 2020 2020 2020 2020 6120 7061 7468            a path
-0001b610: 2069 6e63 6c75 646e 6720 7468 6520 6e61   includng the na
-0001b620: 6d65 206f 6620 7468 6520 4153 4349 4920  me of the ASCII 
-0001b630: 616e 6420 6578 7465 6e74 696f 6e20 6c69  and extention li
-0001b640: 6b65 0d0a 2020 2020 2020 2020 2020 2020  ke..            
-0001b650: 7061 7468 3d22 6461 7461 2f63 726f 7070  path="data/cropp
-0001b660: 6564 2e61 7363 220d 0a20 2020 2020 2020  ed.asc"..       
-0001b670: 2066 696c 655f 7072 6566 6978 3a20 5b53   file_prefix: [S
-0001b680: 7472 696e 675d 0d0a 2020 2020 2020 2020  tring]..        
-0001b690: 2020 2020 6120 7374 7269 6e67 2074 6861      a string tha
-0001b6a0: 7420 6d61 6b65 2074 6865 2066 696c 6573  t make the files
-0001b6b0: 2079 6f75 2077 616e 7420 746f 2066 696c   you want to fil
-0001b6c0: 7465 7220 696e 2074 6865 2066 6f6c 6465  ter in the folde
-0001b6d0: 720d 0a20 2020 2020 2020 2020 2020 2075  r..            u
-0001b6e0: 6e69 710d 0a20 2020 2020 2020 2065 7863  niq..        exc
-0001b6f0: 6c75 6465 5f76 616c 7565 3a20 5b4e 756d  lude_value: [Num
-0001b700: 6572 6963 5d0d 0a20 2020 2020 2020 2020  eric]..         
-0001b710: 2020 2076 616c 7565 7320 796f 7520 7761     values you wa
-0001b720: 6e74 2074 6f20 6578 636c 7564 6520 6672  nt to exclude fr
-0001b730: 6f6d 2065 7874 6561 6374 6564 2076 616c  om exteacted val
-0001b740: 7565 730d 0a20 2020 2020 2020 2063 6f6d  ues..        com
-0001b750: 7072 6573 7365 643a 0d0a 2020 2020 2020  pressed:..      
-0001b760: 2020 2020 2020 5b42 6f6f 6c5d 2069 6620        [Bool] if 
-0001b770: 7468 6520 6d61 7020 796f 7520 7072 6f76  the map you prov
-0001b780: 6964 6564 2069 7320 636f 6d70 7265 7373  ided is compress
-0001b790: 6564 0d0a 2020 2020 2020 2020 6f63 6375  ed..        occu
-0001b7a0: 7069 6564 5f63 656c 6c73 5f6f 6e6c 793a  pied_cells_only:
-0001b7b0: 0d0a 2020 2020 2020 2020 2020 2020 5b42  ..            [B
-0001b7c0: 6f6f 6c5d 2069 6620 796f 7520 7761 6e74  ool] if you want
-0001b7d0: 2074 6f20 636f 756e 7420 6f6e 6c79 2063   to count only c
-0001b7e0: 656c 6c73 2074 6861 7420 6973 206e 6f74  ells that is not
-0001b7f0: 207a 6572 6f0d 0a0d 0a20 2020 2020 2020   zero....       
-0001b800: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
-0001b810: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
-0001b820: 2020 2045 7874 7261 6374 6564 5661 6c75     ExtractedValu
-0001b830: 6573 3a0d 0a20 2020 2020 2020 2020 2020  es:..           
-0001b840: 205b 4469 6374 5d20 6469 6374 6f6e 6172   [Dict] dictonar
-0001b850: 7920 7769 7468 2061 206c 6973 7420 6f66  y with a list of
-0001b860: 2076 616c 7565 7320 696e 2074 6865 2062   values in the b
-0001b870: 6173 656d 6170 2061 7320 6b65 7973 0d0a  asemap as keys..
-0001b880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b890: 616e 6420 666f 7220 6561 6368 206b 6579  and for each key
-0001b8a0: 2061 206c 6973 7420 6f66 2061 6c6c 2074   a list of all t
-0001b8b0: 6865 2069 6e74 6572 7365 6374 6564 2076  he intersected v
-0001b8c0: 616c 7565 7320 696e 2074 6865 0d0a 2020  alues in the..  
-0001b8d0: 2020 2020 2020 2020 2020 2020 2020 6d61                ma
-0001b8e0: 7073 2066 726f 6d20 7468 6520 7061 7468  ps from the path
-0001b8f0: 0d0a 2020 2020 2020 2020 4e6f 6e5a 6572  ..        NonZer
-0001b900: 6f43 656c 6c73 3a0d 0a20 2020 2020 2020  oCells:..       
-0001b910: 2020 2020 205b 6461 7461 6672 616d 655d       [dataframe]
-0001b920: 2064 6174 6166 7261 6d65 2077 6974 6820   dataframe with 
-0001b930: 7468 6520 6669 7273 7420 636f 6c75 6d6e  the first column
-0001b940: 2061 7320 7468 6520 2266 696c 6522 206e   as the "file" n
-0001b950: 616d 650d 0a20 2020 2020 2020 2020 2020  ame..           
-0001b960: 2061 6e64 2074 6865 2073 6563 6f6e 6420   and the second 
-0001b970: 636f 6c75 6d6e 2069 7320 7468 6520 6e75  column is the nu
-0001b980: 6d62 6572 206f 6620 6365 6c6c 7320 696e  mber of cells in
-0001b990: 2065 6163 6820 6d61 700d 0a20 2020 2020   each map..     
-0001b9a0: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-0001b9b0: 6173 7365 7274 2074 7970 6528 7061 7468  assert type(path
-0001b9c0: 2920 3d3d 2073 7472 2c20 2250 6174 6820  ) == str, "Path 
-0001b9d0: 696e 7075 7420 7368 6f75 6c64 2062 6520  input should be 
-0001b9e0: 7374 7269 6e67 2074 7970 6522 0d0a 2020  string type"..  
-0001b9f0: 2020 2020 2020 6173 7365 7274 2074 7970        assert typ
-0001ba00: 6528 6669 6c65 5f70 7265 6669 7829 203d  e(file_prefix) =
-0001ba10: 3d20 7374 722c 2022 5061 7468 2069 6e70  = str, "Path inp
-0001ba20: 7574 2073 686f 756c 6420 6265 2073 7472  ut should be str
-0001ba30: 696e 6720 7479 7065 220d 0a20 2020 2020  ing type"..     
-0001ba40: 2020 2061 7373 6572 7420 7479 7065 2863     assert type(c
-0001ba50: 6f6d 7072 6573 7365 6429 203d 3d20 626f  ompressed) == bo
-0001ba60: 6f6c 2c20 2243 6f6d 7072 6573 7365 6420  ol, "Compressed 
-0001ba70: 696e 7075 7420 7368 6f75 6c64 2062 6520  input should be 
-0001ba80: 426f 6f6c 656e 2074 7970 6522 0d0a 2020  Boolen type"..  
-0001ba90: 2020 2020 2020 6173 7365 7274 2074 7970        assert typ
-0001baa0: 6528 6261 7365 6d61 705f 6669 6c65 2920  e(basemap_file) 
-0001bab0: 3d3d 2073 7472 2c20 2262 6173 656d 6170  == str, "basemap
-0001bac0: 5f66 696c 6520 696e 7075 7420 7368 6f75  _file input shou
-0001bad0: 6c64 2062 6520 7374 7269 6e67 2074 7970  ld be string typ
-0001bae0: 6522 0d0a 2020 2020 2020 2020 2320 696e  e"..        # in
-0001baf0: 7075 7420 7661 6c75 6573 0d0a 2020 2020  put values..    
-0001bb00: 2020 2020 2320 6368 6563 6b20 7765 7468      # check weth
-0001bb10: 6572 2074 6865 2070 6174 6820 6578 6973  er the path exis
-0001bb20: 7420 6f72 206e 6f74 0d0a 2020 2020 2020  t or not..      
-0001bb30: 2020 6173 7365 7274 206f 732e 7061 7468    assert os.path
-0001bb40: 2e65 7869 7374 7328 7061 7468 292c 2022  .exists(path), "
-0001bb50: 7468 6520 7061 7468 2079 6f75 2068 6176  the path you hav
-0001bb60: 6520 7072 6f76 6964 6564 2064 6f65 7320  e provided does 
-0001bb70: 6e6f 7420 6578 6973 7422 0d0a 2020 2020  not exist"..    
-0001bb80: 2020 2020 2320 6368 6563 6b20 7768 6574      # check whet
-0001bb90: 6865 7220 7468 6572 6520 6172 6520 6669  her there are fi
-0001bba0: 6c65 7320 6f72 206e 6f74 2069 6e73 6964  les or not insid
-0001bbb0: 6520 7468 6520 666f 6c64 6572 0d0a 2020  e the folder..  
-0001bbc0: 2020 2020 2020 6173 7365 7274 206f 732e        assert os.
-0001bbd0: 6c69 7374 6469 7228 7061 7468 2920 213d  listdir(path) !=
-0001bbe0: 2022 222c 2022 7468 6520 7061 7468 2079   "", "the path y
-0001bbf0: 6f75 2068 6176 6520 7072 6f76 6964 6564  ou have provided
-0001bc00: 2069 7320 656d 7074 7922 0d0a 2020 2020   is empty"..    
-0001bc10: 2020 2020 2320 6765 7420 6c69 7374 206f      # get list o
-0001bc20: 6620 616c 6c20 6669 6c65 730d 0a20 2020  f all files..   
-0001bc30: 2020 2020 2046 696c 6573 203d 206f 732e       Files = os.
-0001bc40: 6c69 7374 6469 7228 7061 7468 290d 0a0d  listdir(path)...
-0001bc50: 0a20 2020 2020 2020 2046 696c 7465 7265  .        Filtere
-0001bc60: 644c 6973 7420 3d20 6c69 7374 2829 0d0a  dList = list()..
-0001bc70: 0d0a 2020 2020 2020 2020 2320 6669 6c74  ..        # filt
-0001bc80: 6572 2066 696c 6520 6c69 7374 2077 6974  er file list wit
-0001bc90: 6820 7468 6520 4669 6c65 2070 7265 6669  h the File prefi
-0001bca0: 7820 696e 7075 740d 0a20 2020 2020 2020  x input..       
-0001bcb0: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-0001bcc0: 6c65 6e28 4669 6c65 7329 293a 0d0a 2020  len(Files)):..  
-0001bcd0: 2020 2020 2020 2020 2020 6966 2046 696c            if Fil
-0001bce0: 6573 5b69 5d2e 7374 6172 7473 7769 7468  es[i].startswith
-0001bcf0: 2866 696c 655f 7072 6566 6978 293a 0d0a  (file_prefix):..
-0001bd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bd10: 4669 6c74 6572 6564 4c69 7374 2e61 7070  FilteredList.app
-0001bd20: 656e 6428 4669 6c65 735b 695d 290d 0a0d  end(Files[i])...
-0001bd30: 0a20 2020 2020 2020 204e 6f6e 5a65 726f  .        NonZero
-0001bd40: 4365 6c6c 7320 3d20 7064 2e44 6174 6146  Cells = pd.DataF
-0001bd50: 7261 6d65 2829 0d0a 2020 2020 2020 2020  rame()..        
-0001bd60: 4e6f 6e5a 6572 6f43 656c 6c73 5b22 6669  NonZeroCells["fi
-0001bd70: 6c65 7322 5d20 3d20 4669 6c74 6572 6564  les"] = Filtered
-0001bd80: 4c69 7374 0d0a 2020 2020 2020 2020 4e6f  List..        No
-0001bd90: 6e5a 6572 6f43 656c 6c73 5b22 6365 6c6c  nZeroCells["cell
-0001bda0: 7322 5d20 3d20 300d 0a20 2020 2020 2020  s"] = 0..       
-0001bdb0: 2023 2072 6561 6420 7468 6520 6261 7365   # read the base
-0001bdc0: 206d 6170 0d0a 2020 2020 2020 2020 6966   map..        if
-0001bdd0: 2062 6173 656d 6170 5f66 696c 652e 656e   basemap_file.en
-0001bde0: 6473 7769 7468 2822 2e61 7363 2229 3a0d  dswith(".asc"):.
-0001bdf0: 0a20 2020 2020 2020 2020 2020 2042 6173  .            Bas
-0001be00: 654d 6170 562c 205f 203d 2052 6173 7465  eMapV, _ = Raste
-0001be10: 722e 7265 6164 4153 4349 4928 6261 7365  r.readASCII(base
-0001be20: 6d61 705f 6669 6c65 290d 0a20 2020 2020  map_file)..     
-0001be30: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-0001be40: 2020 2020 2020 4261 7365 4d61 7020 3d20        BaseMap = 
-0001be50: 6764 616c 2e4f 7065 6e28 6261 7365 6d61  gdal.Open(basema
-0001be60: 705f 6669 6c65 290d 0a20 2020 2020 2020  p_file)..       
-0001be70: 2020 2020 2042 6173 654d 6170 5620 3d20       BaseMapV = 
-0001be80: 4261 7365 4d61 702e 5265 6164 4173 4172  BaseMap.ReadAsAr
-0001be90: 7261 7928 290d 0a0d 0a20 2020 2020 2020  ray()....       
-0001bea0: 2045 7874 7261 6374 6564 5661 6c75 6573   ExtractedValues
-0001beb0: 203d 2064 6963 7428 290d 0a20 2020 2020   = dict()..     
-0001bec0: 2020 2046 696c 6573 4e6f 744f 7065 6e65     FilesNotOpene
-0001bed0: 6420 3d20 6c69 7374 2829 0d0a 0d0a 2020  d = list()....  
-0001bee0: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
-0001bef0: 616e 6765 286c 656e 2846 696c 7465 7265  ange(len(Filtere
-0001bf00: 644c 6973 7429 293a 0d0a 2020 2020 2020  dList)):..      
-0001bf10: 2020 2020 2020 7072 696e 7428 2246 696c        print("Fil
-0001bf20: 6520 2220 2b20 4669 6c74 6572 6564 4c69  e " + FilteredLi
-0001bf30: 7374 5b69 5d29 0d0a 2020 2020 2020 2020  st[i])..        
-0001bf40: 2020 2020 6966 206f 6363 7570 6965 645f      if occupied_
-0001bf50: 6365 6c6c 735f 6f6e 6c79 3a0d 0a20 2020  cells_only:..   
-0001bf60: 2020 2020 2020 2020 2020 2020 2045 7874               Ext
-0001bf70: 7261 6374 6564 5661 6c75 6573 692c 204e  ractedValuesi, N
-0001bf80: 6f6e 5a65 726f 4365 6c6c 732e 6c6f 635b  onZeroCells.loc[
-0001bf90: 692c 2022 6365 6c6c 7322 5d20 3d20 5261  i, "cells"] = Ra
-0001bfa0: 7374 6572 2e6f 7665 726c 6179 4d61 7028  ster.overlayMap(
-0001bfb0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001bfc0: 2020 2020 2020 7061 7468 202b 2022 2f22        path + "/"
-0001bfd0: 202b 2046 696c 7465 7265 644c 6973 745b   + FilteredList[
-0001bfe0: 695d 2c0d 0a20 2020 2020 2020 2020 2020  i],..           
-0001bff0: 2020 2020 2020 2020 2042 6173 654d 6170           BaseMap
-0001c000: 562c 0d0a 2020 2020 2020 2020 2020 2020  V,..            
-0001c010: 2020 2020 2020 2020 6578 636c 7564 655f          exclude_
-0001c020: 7661 6c75 652c 0d0a 2020 2020 2020 2020  value,..        
-0001c030: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
-0001c040: 7265 7373 6564 2c0d 0a20 2020 2020 2020  ressed,..       
-0001c050: 2020 2020 2020 2020 2020 2020 206f 6363               occ
-0001c060: 7570 6965 645f 6365 6c6c 735f 6f6e 6c79  upied_cells_only
-0001c070: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0001c080: 2020 2029 0d0a 2020 2020 2020 2020 2020     )..          
-0001c090: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0001c0a0: 2020 2020 2020 2020 2045 7874 7261 6374           Extract
-0001c0b0: 6564 5661 6c75 6573 692c 204e 6f6e 5a65  edValuesi, NonZe
-0001c0c0: 726f 4365 6c6c 732e 6c6f 635b 692c 2022  roCells.loc[i, "
-0001c0d0: 6365 6c6c 7322 5d20 3d20 5261 7374 6572  cells"] = Raster
-0001c0e0: 2e6f 7665 726c 6179 4d61 7028 0d0a 2020  .overlayMap(..  
-0001c0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c100: 2020 7061 7468 202b 2022 2f22 202b 2046    path + "/" + F
-0001c110: 696c 7465 7265 644c 6973 745b 695d 2c0d  ilteredList[i],.
-0001c120: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c130: 2020 2020 2042 6173 654d 6170 562c 0d0a       BaseMapV,..
-0001c140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c150: 2020 2020 6578 636c 7564 655f 7661 6c75      exclude_valu
-0001c160: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
-0001c170: 2020 2020 2020 2020 636f 6d70 7265 7373          compress
-0001c180: 6564 2c0d 0a20 2020 2020 2020 2020 2020  ed,..           
-0001c190: 2020 2020 2020 2020 206f 6363 7570 6965           occupie
-0001c1a0: 645f 6365 6c6c 735f 6f6e 6c79 2c0d 0a20  d_cells_only,.. 
-0001c1b0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0001c1c0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-0001c1d0: 2020 2020 2320 7468 6573 6520 6172 6520      # these are 
-0001c1e0: 7468 6520 6465 7374 696e 6374 2076 616c  the destinct val
-0001c1f0: 7565 7320 6672 6f6d 2074 6865 2042 6173  ues from the Bas
-0001c200: 654d 6170 2077 6869 6368 2061 7265 206b  eMap which are k
-0001c210: 6579 7320 696e 2074 6865 0d0a 2020 2020  eys in the..    
-0001c220: 2020 2020 2020 2020 2020 2020 2320 4578              # Ex
-0001c230: 7472 6163 7465 6456 616c 7565 7369 2064  tractedValuesi d
-0001c240: 6963 7420 7769 7468 2065 6163 6820 6f6e  ict with each on
-0001c250: 6520 6861 7669 6e67 2061 206c 6973 7420  e having a list 
-0001c260: 6f66 2076 616c 7565 730d 0a20 2020 2020  of values..     
-0001c270: 2020 2020 2020 2020 2020 2042 6173 654d             BaseM
-0001c280: 6170 5661 6c75 6573 203d 206c 6973 7428  apValues = list(
-0001c290: 4578 7472 6163 7465 6456 616c 7565 7369  ExtractedValuesi
-0001c2a0: 2e6b 6579 7328 2929 0d0a 0d0a 2020 2020  .keys())....    
-0001c2b0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0001c2c0: 6a20 696e 2072 616e 6765 286c 656e 2842  j in range(len(B
-0001c2d0: 6173 654d 6170 5661 6c75 6573 2929 3a0d  aseMapValues)):.
-0001c2e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c2f0: 2020 2020 2069 6620 4261 7365 4d61 7056       if BaseMapV
-0001c300: 616c 7565 735b 6a5d 206e 6f74 2069 6e20  alues[j] not in 
-0001c310: 6c69 7374 2845 7874 7261 6374 6564 5661  list(ExtractedVa
-0001c320: 6c75 6573 2e6b 6579 7328 2929 3a0d 0a20  lues.keys()):.. 
-0001c330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c340: 2020 2020 2020 2045 7874 7261 6374 6564         Extracted
-0001c350: 5661 6c75 6573 5b42 6173 654d 6170 5661  Values[BaseMapVa
-0001c360: 6c75 6573 5b6a 5d5d 203d 206c 6973 7428  lues[j]] = list(
-0001c370: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
-0001c380: 2020 2020 2020 2020 2045 7874 7261 6374           Extract
-0001c390: 6564 5661 6c75 6573 5b42 6173 654d 6170  edValues[BaseMap
-0001c3a0: 5661 6c75 6573 5b6a 5d5d 203d 2028 0d0a  Values[j]] = (..
-0001c3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c3c0: 2020 2020 2020 2020 4578 7472 6163 7465          Extracte
-0001c3d0: 6456 616c 7565 735b 4261 7365 4d61 7056  dValues[BaseMapV
-0001c3e0: 616c 7565 735b 6a5d 5d0d 0a20 2020 2020  alues[j]]..     
-0001c3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c400: 2020 202b 2045 7874 7261 6374 6564 5661     + ExtractedVa
-0001c410: 6c75 6573 695b 4261 7365 4d61 7056 616c  luesi[BaseMapVal
-0001c420: 7565 735b 6a5d 5d0d 0a20 2020 2020 2020  ues[j]]..       
-0001c430: 2020 2020 2020 2020 2020 2020 2029 0d0a               )..
-0001c440: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0001c450: 2045 7874 7261 6374 6564 5661 6c75 6573   ExtractedValues
-0001c460: 6920 3d3d 202d 3120 6f72 204e 6f6e 5a65  i == -1 or NonZe
-0001c470: 726f 4365 6c6c 732e 6c6f 635b 692c 2022  roCells.loc[i, "
-0001c480: 6365 6c6c 7322 5d20 3d3d 202d 313a 0d0a  cells"] == -1:..
-0001c490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c4a0: 4669 6c65 734e 6f74 4f70 656e 6564 2e61  FilesNotOpened.a
-0001c4b0: 7070 656e 6428 4669 6c74 6572 6564 4c69  ppend(FilteredLi
-0001c4c0: 7374 5b69 5d29 0d0a 2020 2020 2020 2020  st[i])..        
-0001c4d0: 2020 2020 2020 2020 636f 6e74 696e 7565          continue
-0001c4e0: 0d0a 0d0a 2020 2020 2020 2020 7265 7475  ....        retu
-0001c4f0: 726e 2045 7874 7261 6374 6564 5661 6c75  rn ExtractedValu
-0001c500: 6573 2c20 4e6f 6e5a 6572 6f43 656c 6c73  es, NonZeroCells
-0001c510: 0d0a 0d0a 2020 2020 4073 7461 7469 636d  ....    @staticm
-0001c520: 6574 686f 640d 0a20 2020 2064 6566 206e  ethod..    def n
-0001c530: 6f72 6d61 6c69 7a65 2861 7272 6179 3a20  ormalize(array: 
-0001c540: 6e70 2e6e 6461 7272 6179 293a 0d0a 2020  np.ndarray):..  
-0001c550: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-0001c560: 2020 204e 6f72 6d61 6c69 7a65 7320 6e75     Normalizes nu
-0001c570: 6d70 7920 6172 7261 7973 2069 6e74 6f20  mpy arrays into 
-0001c580: 7363 616c 6520 302e 3020 2d20 312e 300d  scale 0.0 - 1.0.
-0001c590: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-0001c5a0: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
-0001c5b0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
-0001c5c0: 2020 2061 7272 6179 203a 205b 6172 7261     array : [arra
-0001c5d0: 795d 0d0a 2020 2020 2020 2020 2020 2020  y]..            
-0001c5e0: 6e75 6d70 7920 6172 7261 790d 0a0d 0a20  numpy array.... 
-0001c5f0: 2020 2020 2020 2052 6574 7572 6e73 0d0a         Returns..
-0001c600: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0d          -------.
-0001c610: 0a20 2020 2020 2020 2061 7272 6179 0d0a  .        array..
-0001c620: 2020 2020 2020 2020 2020 2020 4445 5343              DESC
-0001c630: 5249 5054 494f 4e2e 0d0a 2020 2020 2020  RIPTION...      
-0001c640: 2020 2222 220d 0a20 2020 2020 2020 2061    """..        a
-0001c650: 7272 6179 5f6d 696e 203d 2061 7272 6179  rray_min = array
-0001c660: 2e6d 696e 2829 0d0a 2020 2020 2020 2020  .min()..        
-0001c670: 6172 7261 795f 6d61 7820 3d20 6172 7261  array_max = arra
-0001c680: 792e 6d61 7828 290d 0a20 2020 2020 2020  y.max()..       
-0001c690: 2076 616c 203d 2028 6172 7261 7920 2d20   val = (array - 
-0001c6a0: 6172 7261 795f 6d69 6e29 202f 2028 6172  array_min) / (ar
-0001c6b0: 7261 795f 6d61 7820 2d20 6172 7261 795f  ray_max - array_
-0001c6c0: 6d69 6e29 0d0a 2020 2020 2020 2020 7265  min)..        re
-0001c6d0: 7475 726e 2076 616c 0d0a 0d0a 2020 2020  turn val....    
-0001c6e0: 2320 544f 444f 3a20 7265 706c 6163 6520  # TODO: replace 
-0001c6f0: 6974 2020 7769 7468 2067 6574 5261 7374  it  with getRast
-0001c700: 6572 4461 7461 0d0a 2020 2020 4073 7461  erData..    @sta
-0001c710: 7469 636d 6574 686f 640d 0a20 2020 2064  ticmethod..    d
-0001c720: 6566 206f 7065 6e41 7272 6179 496e 666f  ef openArrayInfo
-0001c730: 2866 6e61 6d65 3a20 7374 7220 3d20 2222  (fname: str = ""
-0001c740: 293a 0d0a 2020 2020 2020 2020 2222 226f  ):..        """o
-0001c750: 7065 6e41 7272 6179 496e 666f 2e0d 0a0d  penArrayInfo....
-0001c760: 0a20 2020 2020 2020 204f 7065 6e69 6e67  .        Opening
-0001c770: 2061 2074 6966 6620 696e 666f 2c20 666f   a tiff info, fo
-0001c780: 7220 6578 616d 706c 6520 7369 7a65 206f  r example size o
-0001c790: 6620 6172 7261 792c 2070 726f 6a65 6374  f array, project
-0001c7a0: 696f 6e20 616e 6420 7472 616e 7366 6f72  ion and transfor
-0001c7b0: 6d20 6d61 7472 6978 2e0d 0a0d 0a20 2020  m matrix.....   
-0001c7c0: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
-0001c7d0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0001c7e0: 2d2d 2d0d 0a20 2020 2020 2020 2066 6e61  ---..        fna
-0001c7f0: 6d65 3a20 5b73 7472 5d0d 0a20 2020 2020  me: [str]..     
-0001c800: 2020 2020 2020 2070 6174 6820 746f 2074         path to t
-0001c810: 6865 2074 6966 6620 6669 6c65 0d0a 0d0a  he tiff file....
-0001c820: 2020 2020 2020 2020 5265 7475 726e 730d          Returns.
-0001c830: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0001c840: 0d0a 2020 2020 2020 2020 6765 6f74 7261  ..        geotra
-0001c850: 6e73 666f 726d 3a20 5b54 7570 6c65 5d0d  nsform: [Tuple].
-0001c860: 0a20 2020 2020 2020 2020 2020 2067 656f  .            geo
-0001c870: 7472 616e 7366 6f72 6d20 6461 7461 206f  transform data o
-0001c880: 6620 7468 6520 7570 7065 7220 6c65 6674  f the upper left
-0001c890: 2063 6f72 6e65 7220 6f66 2074 6865 2072   corner of the r
-0001c8a0: 6173 7465 720d 0a20 2020 2020 2020 2020  aster..         
-0001c8b0: 2020 2028 6d69 6e69 6d75 6d20 6c6f 6e2f     (minimum lon/
-0001c8c0: 782c 2070 6978 656c 7369 7a65 2c20 726f  x, pixelsize, ro
-0001c8d0: 7461 7469 6f6e 2c20 6d61 7869 6d75 6d20  tation, maximum 
-0001c8e0: 6c61 742f 792c 2072 6f74 6174 696f 6e2c  lat/y, rotation,
-0001c8f0: 2070 6978 656c 7369 7a65 292e 0d0a 2020   pixelsize)...  
-0001c900: 2020 2020 2020 7072 6f6a 3a20 5b73 7472        proj: [str
-0001c910: 5d0d 0a20 2020 2020 2020 2020 2020 2070  ]..            p
-0001c920: 726f 6a65 6374 696f 6e20 6173 2061 2077  rojection as a w
-0001c930: 656c 6c20 6b6e 6f77 6e20 7465 7874 2e0d  ell known text..
-0001c940: 0a20 2020 2020 2020 2063 6f6c 733a 205b  .        cols: [
-0001c950: 666c 6f61 745d 0d0a 2020 2020 2020 2020  float]..        
-0001c960: 2020 2020 6e75 6d62 6572 206f 6620 636f      number of co
-0001c970: 6c75 6d6e 730d 0a20 2020 2020 2020 2072  lumns..        r
-0001c980: 6f77 733a 205b 666c 6f61 745d 0d0a 2020  ows: [float]..  
-0001c990: 2020 2020 2020 2020 2020 6e75 6d62 6572            number
-0001c9a0: 206f 6620 726f 7773 0d0a 2020 2020 2020   of rows..      
-0001c9b0: 2020 2222 220d 0a20 2020 2020 2020 2073    """..        s
-0001c9c0: 7263 203d 2067 6461 6c2e 4f70 656e 2866  rc = gdal.Open(f
-0001c9d0: 6e61 6d65 290d 0a20 2020 2020 2020 2069  name)..        i
-0001c9e0: 6620 7372 6320 6973 204e 6f6e 653a 0d0a  f src is None:..
-0001c9f0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0001ca00: 6520 4669 6c65 4e6f 7446 6f75 6e64 4572  e FileNotFoundEr
-0001ca10: 726f 7228 6622 7b66 6e61 6d65 7d20 646f  ror(f"{fname} do
-0001ca20: 6573 206e 6f74 2065 7869 7374 7322 290d  es not exists").
-0001ca30: 0a0d 0a20 2020 2020 2020 2067 656f 203d  ...        geo =
-0001ca40: 2073 7263 2e47 6574 4765 6f54 7261 6e73   src.GetGeoTrans
-0001ca50: 666f 726d 2829 0d0a 2020 2020 2020 2020  form()..        
-0001ca60: 7072 6f6a 203d 2073 7263 2e47 6574 5072  proj = src.GetPr
-0001ca70: 6f6a 6563 7469 6f6e 2829 0d0a 2020 2020  ojection()..    
-0001ca80: 2020 2020 636f 6c73 203d 2073 7263 2e52      cols = src.R
-0001ca90: 6173 7465 7258 5369 7a65 0d0a 2020 2020  asterXSize..    
-0001caa0: 2020 2020 726f 7773 203d 2073 7263 2e52      rows = src.R
-0001cab0: 6173 7465 7259 5369 7a65 0d0a 0d0a 2020  asterYSize....  
-0001cac0: 2020 2020 2020 7265 7475 726e 2067 656f        return geo
-0001cad0: 2c20 7072 6f6a 2c20 636f 6c73 2c20 726f  , proj, cols, ro
-0001cae0: 7773 0d0a 0d0a 2020 2020 4073 7461 7469  ws....    @stati
-0001caf0: 636d 6574 686f 640d 0a20 2020 2064 6566  cmethod..    def
-0001cb00: 205f 7769 6e64 6f77 2873 7263 3a20 4461   _window(src: Da
-0001cb10: 7461 7365 742c 2073 697a 653a 2069 6e74  taset, size: int
-0001cb20: 203d 2032 3536 293a 0d0a 2020 2020 2020   = 256):..      
-0001cb30: 2020 2222 2252 6173 7465 7220 7371 7561    """Raster squa
-0001cb40: 7265 2077 696e 646f 7720 7369 7a65 2f6f  re window size/o
-0001cb50: 6666 7365 7473 2e0d 0a0d 0a20 2020 2020  ffsets.....     
-0001cb60: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-0001cb70: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0001cb80: 2d0d 0a20 2020 2020 2020 2073 7263 203a  -..        src :
-0001cb90: 205b 6764 616c 2e44 6174 6173 6574 5d0d   [gdal.Dataset].
-0001cba0: 0a20 2020 2020 2020 2020 2020 2067 6461  .            gda
-0001cbb0: 6c20 4461 7461 7365 7420 6f62 6a65 6374  l Dataset object
-0001cbc0: 2e0d 0a20 2020 2020 2020 2073 697a 6520  ...        size 
-0001cbd0: 3a20 5b69 6e74 5d0d 0a20 2020 2020 2020  : [int]..       
-0001cbe0: 2020 2020 2053 697a 6520 6f66 2077 696e       Size of win
-0001cbf0: 646f 7720 696e 2070 6978 656c 732e 204f  dow in pixels. O
-0001cc00: 6e65 2076 616c 7565 2072 6571 7569 7265  ne value require
-0001cc10: 6420 7768 6963 6820 6973 2075 7365 6420  d which is used 
-0001cc20: 666f 7220 626f 7468 2074 6865 0d0a 2020  for both the..  
-0001cc30: 2020 2020 2020 2020 2020 7820 616e 6420            x and 
-0001cc40: 7920 7369 7a65 2e20 452e 6720 3235 3620  y size. E.g 256 
-0001cc50: 6d65 616e 7320 6120 3235 3678 3235 3620  means a 256x256 
-0001cc60: 7769 6e64 6f77 2e0d 0a0d 0a20 2020 2020  window.....     
-0001cc70: 2020 2059 6965 6c64 730d 0a20 2020 2020     Yields..     
-0001cc80: 2020 202d 2d2d 2d2d 2d0d 0a20 2020 2020     ------..     
-0001cc90: 2020 2074 7570 6c65 5b69 6e74 5d0d 0a20     tuple[int].. 
-0001cca0: 2020 2020 2020 2020 2020 2034 2065 6c65             4 ele
-0001ccb0: 6d65 6e74 2074 7570 6c65 2063 6f6e 7461  ment tuple conta
-0001ccc0: 696e 696e 6720 7468 6520 7820 7369 7a65  ining the x size
-0001ccd0: 2c20 7920 7369 7a65 2c20 7820 6f66 6673  , y size, x offs
-0001cce0: 6574 2061 6e64 2079 206f 6666 7365 740d  et and y offset.
-0001ccf0: 0a20 2020 2020 2020 2020 2020 206f 6620  .            of 
-0001cd00: 7468 6520 7769 6e64 6f77 2e0d 0a20 2020  the window...   
-0001cd10: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-0001cd20: 2020 636f 6c73 203d 2073 7263 2e52 6173    cols = src.Ras
-0001cd30: 7465 7258 5369 7a65 0d0a 2020 2020 2020  terXSize..      
-0001cd40: 2020 726f 7773 203d 2073 7263 2e52 6173    rows = src.Ras
-0001cd50: 7465 7259 5369 7a65 0d0a 2020 2020 2020  terYSize..      
-0001cd60: 2020 666f 7220 786f 6666 2069 6e20 7261    for xoff in ra
-0001cd70: 6e67 6528 302c 2063 6f6c 732c 2073 697a  nge(0, cols, siz
-0001cd80: 6529 3a0d 0a20 2020 2020 2020 2020 2020  e):..           
-0001cd90: 2078 7369 7a65 203d 2073 697a 6520 6966   xsize = size if
-0001cda0: 2073 697a 6520 2b20 786f 6666 203c 3d20   size + xoff <= 
-0001cdb0: 636f 6c73 2065 6c73 6520 636f 6c73 202d  cols else cols -
-0001cdc0: 2078 6f66 660d 0a20 2020 2020 2020 2020   xoff..         
-0001cdd0: 2020 2066 6f72 2079 6f66 6620 696e 2072     for yoff in r
-0001cde0: 616e 6765 2830 2c20 726f 7773 2c20 7369  ange(0, rows, si
-0001cdf0: 7a65 293a 0d0a 2020 2020 2020 2020 2020  ze):..          
-0001ce00: 2020 2020 2020 7973 697a 6520 3d20 7369        ysize = si
-0001ce10: 7a65 2069 6620 7369 7a65 202b 2079 6f66  ze if size + yof
-0001ce20: 6620 3c3d 2072 6f77 7320 656c 7365 2072  f <= rows else r
-0001ce30: 6f77 7320 2d20 796f 6666 0d0a 2020 2020  ows - yoff..    
-0001ce40: 2020 2020 2020 2020 2020 2020 7969 656c              yiel
-0001ce50: 6420 7873 697a 652c 2079 7369 7a65 2c20  d xsize, ysize, 
-0001ce60: 786f 6666 2c20 796f 6666 0d0a 0d0a 2020  xoff, yoff....  
-0001ce70: 2020 4073 7461 7469 636d 6574 686f 640d    @staticmethod.
-0001ce80: 0a20 2020 2064 6566 2067 6574 5469 6c65  .    def getTile
-0001ce90: 2873 7263 3a20 4461 7461 7365 742c 2073  (src: Dataset, s
-0001cea0: 697a 653d 3235 3629 3a0d 0a20 2020 2020  ize=256):..     
-0001ceb0: 2020 2022 2222 6765 7473 2061 2072 6173     """gets a ras
-0001cec0: 7465 7220 6172 7261 7920 696e 2074 696c  ter array in til
-0001ced0: 6573 2e0d 0a0d 0a20 2020 2020 2020 2050  es.....        P
-0001cee0: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
-0001cef0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-0001cf00: 2020 2020 2020 2073 7263 203a 2067 6461         src : gda
-0001cf10: 6c2e 4461 7461 7365 740d 0a20 2020 2020  l.Dataset..     
-0001cf20: 2020 2020 2020 2049 6e70 7574 2072 6173         Input ras
-0001cf30: 7465 722e 0d0a 2020 2020 2020 2020 7369  ter...        si
-0001cf40: 7a65 203a 2069 6e74 0d0a 2020 2020 2020  ze : int..      
-0001cf50: 2020 2020 2020 5369 7a65 206f 6620 7769        Size of wi
-0001cf60: 6e64 6f77 2069 6e20 7069 7865 6c73 2e20  ndow in pixels. 
-0001cf70: 4f6e 6520 7661 6c75 6520 7265 7175 6972  One value requir
-0001cf80: 6564 2077 6869 6368 2069 7320 7573 6564  ed which is used
-0001cf90: 2066 6f72 2062 6f74 6820 7468 650d 0a20   for both the.. 
-0001cfa0: 2020 2020 2020 2020 2020 2078 2061 6e64             x and
-0001cfb0: 2079 2073 697a 652e 2045 2e67 2032 3536   y size. E.g 256
-0001cfc0: 206d 6561 6e73 2061 2032 3536 7832 3536   means a 256x256
-0001cfd0: 2077 696e 646f 772e 0d0a 0d0a 2020 2020   window.....    
-0001cfe0: 2020 2020 5969 656c 6473 0d0a 2020 2020      Yields..    
-0001cff0: 2020 2020 2d2d 2d2d 2d2d 0d0a 2020 2020      ------..    
-0001d000: 2020 2020 6e70 2e6e 6461 7272 6179 0d0a      np.ndarray..
-0001d010: 2020 2020 2020 2020 2020 2020 5261 7374              Rast
-0001d020: 6572 2061 7272 6179 2069 6e20 666f 726d  er array in form
-0001d030: 205b 6261 6e64 5d5b 795d 5b78 5d2e 0d0a   [band][y][x]...
-0001d040: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-0001d050: 2020 2020 2066 6f72 2078 7369 7a65 2c20       for xsize, 
-0001d060: 7973 697a 652c 2078 6f66 662c 2079 6f66  ysize, xoff, yof
-0001d070: 6620 696e 2052 6173 7465 722e 5f77 696e  f in Raster._win
-0001d080: 646f 7728 7372 632c 2073 697a 653d 7369  dow(src, size=si
-0001d090: 7a65 293a 0d0a 2020 2020 2020 2020 2020  ze):..          
-0001d0a0: 2020 2320 7265 6164 2074 6865 2061 7272    # read the arr
-0001d0b0: 6179 2061 7420 6120 6365 7274 6169 6e20  ay at a certain 
-0001d0c0: 696e 6465 6365 730d 0a20 2020 2020 2020  indeces..       
-0001d0d0: 2020 2020 2079 6965 6c64 2073 7263 2e52       yield src.R
-0001d0e0: 6561 6441 7341 7272 6179 2878 6f66 663d  eadAsArray(xoff=
-0001d0f0: 786f 6666 2c20 796f 6666 3d79 6f66 662c  xoff, yoff=yoff,
-0001d100: 2078 7369 7a65 3d78 7369 7a65 2c20 7973   xsize=xsize, ys
-0001d110: 697a 653d 7973 697a 6529 0d0a 0d0a 2020  ize=ysize)....  
-0001d120: 2020 6465 6620 6c69 7374 4174 7472 6962    def listAttrib
-0001d130: 7574 6573 2873 656c 6629 3a0d 0a20 2020  utes(self):..   
-0001d140: 2020 2020 2022 2222 5072 696e 7420 4174       """Print At
-0001d150: 7472 6962 7574 6573 204c 6973 742e 2222  tributes List.""
-0001d160: 220d 0a0d 0a20 2020 2020 2020 2070 7269  "....        pri
-0001d170: 6e74 2822 5c6e 2229 0d0a 2020 2020 2020  nt("\n")..      
-0001d180: 2020 7072 696e 7428 0d0a 2020 2020 2020    print(..      
-0001d190: 2020 2020 2020 6622 4174 7472 6962 7574        f"Attribut
-0001d1a0: 6573 204c 6973 7420 6f66 3a20 7b20 7265  es List of: { re
-0001d1b0: 7072 2873 656c 662e 5f5f 6469 6374 5f5f  pr(self.__dict__
-0001d1c0: 5b27 6e61 6d65 275d 297d 202d 207b 7365  ['name'])} - {se
-0001d1d0: 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e  lf.__class__.__n
-0001d1e0: 616d 655f 5f7d 2020 496e 7374 616e 6365  ame__}  Instance
-0001d1f0: 5c6e 220d 0a20 2020 2020 2020 2029 0d0a  \n"..        )..
-0001d200: 2020 2020 2020 2020 7365 6c66 5f6b 6579          self_key
-0001d210: 7320 3d20 6c69 7374 2873 656c 662e 5f5f  s = list(self.__
-0001d220: 6469 6374 5f5f 2e6b 6579 7328 2929 0d0a  dict__.keys())..
-0001d230: 2020 2020 2020 2020 7365 6c66 5f6b 6579          self_key
-0001d240: 732e 736f 7274 2829 0d0a 2020 2020 2020  s.sort()..      
-0001d250: 2020 666f 7220 6b65 7920 696e 2073 656c    for key in sel
-0001d260: 665f 6b65 7973 3a0d 0a20 2020 2020 2020  f_keys:..       
-0001d270: 2020 2020 2069 6620 6b65 7920 213d 2022       if key != "
-0001d280: 6e61 6d65 223a 0d0a 2020 2020 2020 2020  name":..        
-0001d290: 2020 2020 2020 2020 7072 696e 7428 7374          print(st
-0001d2a0: 7228 6b65 7929 202b 2022 203a 2022 202b  r(key) + " : " +
-0001d2b0: 2072 6570 7228 7365 6c66 2e5f 5f64 6963   repr(self.__dic
-0001d2c0: 745f 5f5b 6b65 795d 2929 0d0a 0d0a 2020  t__[key]))....  
-0001d2d0: 2020 2020 2020 7072 696e 7428 225c 6e22        print("\n"
-0001d2e0: 290d 0a                                  )..
+0000cc80: 2020 2020 2023 2048 616e 646c 6520 7369       # Handle si
+0000cc90: 6e67 6c65 2062 616e 6420 7261 7374 6572  ngle band raster
+0000cca0: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
+0000ccb0: 2020 2020 2020 2020 2020 2069 6478 203d             idx =
+0000ccc0: 2028 302c 2031 290d 0a0d 0a20 2020 2020   (0, 1)....     
+0000ccd0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0000cce0: 6173 6b5f 6172 7220 3d20 6e70 2e6f 6e65  ask_arr = np.one
+0000ccf0: 7328 2861 7272 2e73 6861 7065 5b69 6478  s((arr.shape[idx
+0000cd00: 5b30 5d5d 2c20 6172 722e 7368 6170 655b  [0]], arr.shape[
+0000cd10: 6964 785b 315d 5d29 290d 0a20 2020 2020  idx[1]]))..     
+0000cd20: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0000cd30: 6978 656c 7320 3d20 6765 745f 7069 7865  ixels = get_pixe
+0000cd40: 6c73 2861 7272 2c20 6d61 736b 5f61 7272  ls(arr, mask_arr
+0000cd50: 292e 7472 616e 7370 6f73 6528 290d 0a20  ).transpose().. 
+0000cd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cd70: 2020 2064 665f 6c69 7374 2e61 7070 656e     df_list.appen
+0000cd80: 6428 7064 2e44 6174 6146 7261 6d65 2870  d(pd.DataFrame(p
+0000cd90: 6978 656c 732c 2063 6f6c 756d 6e73 3d62  ixels, columns=b
+0000cda0: 616e 645f 6e61 6d65 7329 290d 0a0d 0a20  and_names)).... 
+0000cdb0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0000cdc0: 204d 6572 6765 2061 6c6c 2074 6865 2074   Merge all the t
+0000cdd0: 696c 6573 2e0d 0a20 2020 2020 2020 2020  iles...         
+0000cde0: 2020 2020 2020 206f 7574 5f64 6620 3d20         out_df = 
+0000cdf0: 7064 2e63 6f6e 6361 7428 6466 5f6c 6973  pd.concat(df_lis
+0000ce00: 7429 0d0a 2020 2020 2020 2020 2020 2020  t)..            
+0000ce10: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+0000ce20: 2020 2020 2020 2023 2057 6172 6e69 6e67         # Warning
+0000ce30: 3a20 6e6f 7420 6368 6563 6b65 6420 7965  : not checked ye
+0000ce40: 7420 666f 7220 6d75 6c74 6920 6261 6e64  t for multi band
+0000ce50: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
+0000ce60: 2020 2061 7272 203d 2073 656c 662e 7261     arr = self.ra
+0000ce70: 7374 6572 2e52 6561 6441 7341 7272 6179  ster.ReadAsArray
+0000ce80: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
+0000ce90: 2020 2020 7069 7865 6c73 203d 2061 7272      pixels = arr
+0000cea0: 2e66 6c61 7474 656e 2829 0d0a 2020 2020  .flatten()..    
+0000ceb0: 2020 2020 2020 2020 2020 2020 6f75 745f              out_
+0000cec0: 6466 203d 2070 642e 4461 7461 4672 616d  df = pd.DataFram
+0000ced0: 6528 7069 7865 6c73 2c20 636f 6c75 6d6e  e(pixels, column
+0000cee0: 733d 6261 6e64 5f6e 616d 6573 290d 0a0d  s=band_names)...
+0000cef0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0000cf00: 6164 645f 6765 6f6d 6574 7279 3a0d 0a20  add_geometry:.. 
+0000cf10: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000cf20: 6620 6164 645f 6765 6f6d 6574 7279 2e6c  f add_geometry.l
+0000cf30: 6f77 6572 2829 203d 3d20 2270 6f69 6e74  ower() == "point
+0000cf40: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
+0000cf50: 2020 2020 2020 2020 636f 6f72 6473 203d          coords =
+0000cf60: 2073 656c 662e 6765 745f 6365 6c6c 5f70   self.get_cell_p
+0000cf70: 6f69 6e74 7328 6d61 736b 3d54 7275 6529  oints(mask=True)
+0000cf80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000cf90: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0000cfa0: 2020 2020 2020 2020 2020 2020 2063 6f6f               coo
+0000cfb0: 7264 7320 3d20 7365 6c66 2e67 6574 5f63  rds = self.get_c
+0000cfc0: 656c 6c5f 706f 6c79 676f 6e73 286d 6173  ell_polygons(mas
+0000cfd0: 6b3d 5472 7565 290d 0a0d 0a20 2020 2020  k=True)....     
+0000cfe0: 2020 206f 7574 5f64 6620 3d20 6f75 745f     out_df = out_
+0000cff0: 6466 2e64 726f 7028 636f 6c75 6d6e 733d  df.drop(columns=
+0000d000: 5b22 6275 726e 5f76 616c 7565 222c 2022  ["burn_value", "
+0000d010: 6765 6f6d 6574 7279 225d 2c20 6572 726f  geometry"], erro
+0000d020: 7273 3d22 6967 6e6f 7265 2229 0d0a 2020  rs="ignore")..  
+0000d030: 2020 2020 2020 6966 2061 6464 5f67 656f        if add_geo
+0000d040: 6d65 7472 793a 0d0a 2020 2020 2020 2020  metry:..        
+0000d050: 2020 2020 6f75 745f 6466 203d 2067 7064      out_df = gpd
+0000d060: 2e47 656f 4461 7461 4672 616d 6528 6f75  .GeoDataFrame(ou
+0000d070: 745f 6466 2c20 6765 6f6d 6574 7279 3d63  t_df, geometry=c
+0000d080: 6f6f 7264 735b 2267 656f 6d65 7472 7922  oords["geometry"
+0000d090: 5d29 0d0a 0d0a 2020 2020 2020 2020 2320  ])....        # 
+0000d0a0: 544f 444f 206d 6173 6b20 6e6f 2064 6174  TODO mask no dat
+0000d0b0: 6120 7661 6c75 6573 2e0d 0a0d 0a20 2020  a values.....   
+0000d0c0: 2020 2020 2023 2052 656d 6f76 6520 7465       # Remove te
+0000d0d0: 6d70 6f72 6172 7920 6669 6c65 732e 0d0a  mporary files...
+0000d0e0: 2020 2020 2020 2020 6966 2074 656d 705f          if temp_
+0000d0f0: 6469 7220 6973 206e 6f74 204e 6f6e 653a  dir is not None:
+0000d100: 0d0a 2020 2020 2020 2020 2020 2020 7368  ..            sh
+0000d110: 7574 696c 2e72 6d74 7265 6528 7465 6d70  util.rmtree(temp
+0000d120: 5f64 6972 2c20 6967 6e6f 7265 5f65 7272  _dir, ignore_err
+0000d130: 6f72 733d 5472 7565 290d 0a0d 0a20 2020  ors=True)....   
+0000d140: 2020 2020 2023 2052 6574 7572 6e20 6472       # Return dr
+0000d150: 6f70 7069 6e67 2061 6e79 2065 7874 7261  opping any extra
+0000d160: 2063 6f6c 732e 0d0a 2020 2020 2020 2020   cols...        
+0000d170: 7265 7475 726e 206f 7574 5f64 660d 0a0d  return out_df...
+0000d180: 0a20 2020 2064 6566 2061 7070 6c79 2873  .    def apply(s
+0000d190: 656c 662c 2066 756e 2c20 6261 6e64 3a20  elf, fun, band: 
+0000d1a0: 696e 7420 3d20 3029 3a0d 0a20 2020 2020  int = 0):..     
+0000d1b0: 2020 2022 2222 6d61 7041 6c67 6562 7261     """mapAlgebra
+0000d1c0: 2e0d 0a0d 0a20 2020 2020 2020 202d 206d  .....        - m
+0000d1d0: 6170 416c 6765 6272 6120 6578 6563 7574  apAlgebra execut
+0000d1e0: 6573 2061 206d 6174 6865 6d61 7469 6361  es a mathematica
+0000d1f0: 6c20 6f70 6572 6174 696f 6e20 6f6e 2072  l operation on r
+0000d200: 6173 7465 7220 6172 7261 7920 616e 6420  aster array and 
+0000d210: 7265 7475 726e 730d 0a20 2020 2020 2020  returns..       
+0000d220: 2074 6865 2072 6573 756c 740d 0a20 2020   the result..   
+0000d230: 2020 2020 202d 2054 6865 206d 6170 416c       - The mapAl
+0000d240: 6765 6272 6120 6578 6563 7574 6573 2074  gebra executes t
+0000d250: 6865 2066 756e 6374 696f 6e20 6f6e 6c79  he function only
+0000d260: 206f 6e20 6f6e 6520 6365 6c6c 2061 7420   on one cell at 
+0000d270: 6120 7469 6d65 2e0d 0a0d 0a20 2020 2020  a time.....     
+0000d280: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
+0000d290: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0000d2a0: 2d0d 0a20 2020 2020 2020 2066 756e 3a20  -..        fun: 
+0000d2b0: 5b66 756e 6374 696f 6e5d 0d0a 2020 2020  [function]..    
+0000d2c0: 2020 2020 2020 2020 6465 6669 6e65 6420          defined 
+0000d2d0: 6675 6e63 7469 6f6e 2074 6861 7420 7461  function that ta
+0000d2e0: 6b65 7320 6f6e 6520 696e 7075 7420 7768  kes one input wh
+0000d2f0: 6963 6820 6973 2074 6865 2063 656c 6c20  ich is the cell 
+0000d300: 7661 6c75 652e 0d0a 2020 2020 2020 2020  value...        
+0000d310: 6261 6e64 3a20 5b69 6e74 5d0d 0a20 2020  band: [int]..   
+0000d320: 2020 2020 2020 2020 2062 616e 6420 6e75           band nu
+0000d330: 6d62 6572 2e0d 0a0d 0a20 2020 2020 2020  mber.....       
+0000d340: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
+0000d350: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
+0000d360: 2020 2044 6174 6163 7562 650d 0a20 2020     Datacube..   
+0000d370: 2020 2020 2020 2020 2067 6461 6c20 6461           gdal da
+0000d380: 7461 7365 7420 6f62 6a65 6374 0d0a 0d0a  taset object....
+0000d390: 2020 2020 2020 2020 4578 616d 706c 6573          Examples
+0000d3a0: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+0000d3b0: 2d2d 0d0a 2020 2020 2020 2020 3e3e 3e20  --..        >>> 
+0000d3c0: 7372 635f 7261 7374 6572 203d 2067 6461  src_raster = gda
+0000d3d0: 6c2e 4f70 656e 2822 6576 6170 2e74 6966  l.Open("evap.tif
+0000d3e0: 2229 0d0a 2020 2020 2020 2020 3e3e 3e20  ")..        >>> 
+0000d3f0: 6675 6e63 203d 206e 702e 6162 730d 0a20  func = np.abs.. 
+0000d400: 2020 2020 2020 203e 3e3e 206e 6577 5f72         >>> new_r
+0000d410: 6173 7465 7220 3d20 4461 7461 7365 742e  aster = Dataset.
+0000d420: 6170 706c 7928 7372 635f 7261 7374 6572  apply(src_raster
+0000d430: 2c20 6675 6e63 290d 0a20 2020 2020 2020  , func)..       
+0000d440: 2022 2222 0d0a 2020 2020 2020 2020 6966   """..        if
+0000d450: 206e 6f74 2063 616c 6c61 626c 6528 6675   not callable(fu
+0000d460: 6e29 3a0d 0a20 2020 2020 2020 2020 2020  n):..           
+0000d470: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+0000d480: 2822 7365 636f 6e64 2061 7267 756d 656e  ("second argumen
+0000d490: 7420 7368 6f75 6c64 2062 6520 6120 6675  t should be a fu
+0000d4a0: 6e63 7469 6f6e 2229 0d0a 0d0a 2020 2020  nction")....    
+0000d4b0: 2020 2020 6e6f 5f64 6174 615f 7661 6c75      no_data_valu
+0000d4c0: 6520 3d20 7365 6c66 2e6e 6f5f 6461 7461  e = self.no_data
+0000d4d0: 5f76 616c 7565 5b62 616e 645d 0d0a 2020  _value[band]..  
+0000d4e0: 2020 2020 2020 7372 635f 6172 7261 7920        src_array 
+0000d4f0: 3d20 7365 6c66 2e72 6561 645f 6172 7261  = self.read_arra
+0000d500: 7928 6261 6e64 290d 0a20 2020 2020 2020  y(band)..       
+0000d510: 2064 7479 7065 203d 2073 656c 662e 6474   dtype = self.dt
+0000d520: 7970 655b 6261 6e64 5d0d 0a0d 0a20 2020  ype[band]....   
+0000d530: 2020 2020 2023 2066 696c 6c20 7468 6520       # fill the 
+0000d540: 6e65 7720 6172 7261 7920 7769 7468 2074  new array with t
+0000d550: 6865 206e 6f64 6174 6120 7661 6c75 650d  he nodata value.
+0000d560: 0a20 2020 2020 2020 206e 6577 5f61 7272  .        new_arr
+0000d570: 6179 203d 206e 702e 6f6e 6573 2828 7365  ay = np.ones((se
+0000d580: 6c66 2e72 6f77 732c 2073 656c 662e 636f  lf.rows, self.co
+0000d590: 6c75 6d6e 7329 2920 2a20 6e6f 5f64 6174  lumns)) * no_dat
+0000d5a0: 615f 7661 6c75 650d 0a20 2020 2020 2020  a_value..       
+0000d5b0: 2023 2065 7865 6375 7465 2074 6865 2066   # execute the f
+0000d5c0: 756e 6374 696f 6e20 6f6e 2065 6163 6820  unction on each 
+0000d5d0: 6365 6c6c 0d0a 2020 2020 2020 2020 2320  cell..        # 
+0000d5e0: 544f 444f 3a20 6f70 7469 6d69 7a65 2065  TODO: optimize e
+0000d5f0: 7865 6375 7469 6e67 2061 2066 756e 6374  xecuting a funct
+0000d600: 696f 6e20 6f76 6572 2061 2077 686f 6c65  ion over a whole
+0000d610: 2061 7272 6179 0d0a 2020 2020 2020 2020   array..        
+0000d620: 666f 7220 6920 696e 2072 616e 6765 2873  for i in range(s
+0000d630: 656c 662e 726f 7773 293a 0d0a 2020 2020  elf.rows):..    
+0000d640: 2020 2020 2020 2020 666f 7220 6a20 696e          for j in
+0000d650: 2072 616e 6765 2873 656c 662e 636f 6c75   range(self.colu
+0000d660: 6d6e 7329 3a0d 0a20 2020 2020 2020 2020  mns):..         
+0000d670: 2020 2020 2020 2069 6620 6e6f 7420 6e70         if not np
+0000d680: 2e69 7363 6c6f 7365 2873 7263 5f61 7272  .isclose(src_arr
+0000d690: 6179 5b69 2c20 6a5d 2c20 6e6f 5f64 6174  ay[i, j], no_dat
+0000d6a0: 615f 7661 6c75 652c 2072 746f 6c3d 302e  a_value, rtol=0.
+0000d6b0: 3030 3129 3a0d 0a20 2020 2020 2020 2020  001):..         
+0000d6c0: 2020 2020 2020 2020 2020 206e 6577 5f61             new_a
+0000d6d0: 7272 6179 5b69 2c20 6a5d 203d 2066 756e  rray[i, j] = fun
+0000d6e0: 2873 7263 5f61 7272 6179 5b69 2c20 6a5d  (src_array[i, j]
+0000d6f0: 290d 0a0d 0a20 2020 2020 2020 2023 2063  )....        # c
+0000d700: 7265 6174 6520 7468 6520 6f75 7470 7574  reate the output
+0000d710: 2072 6173 7465 720d 0a20 2020 2020 2020   raster..       
+0000d720: 2064 7374 203d 2044 6174 6173 6574 2e5f   dst = Dataset._
+0000d730: 6372 6561 7465 5f67 6461 6c5f 6461 7461  create_gdal_data
+0000d740: 7365 7428 0d0a 2020 2020 2020 2020 2020  set(..          
+0000d750: 2020 7365 6c66 2e63 6f6c 756d 6e73 2c20    self.columns, 
+0000d760: 7365 6c66 2e72 6f77 732c 2031 2c20 6474  self.rows, 1, dt
+0000d770: 7970 652c 2064 7269 7665 723d 224d 454d  ype, driver="MEM
+0000d780: 220d 0a20 2020 2020 2020 2029 0d0a 2020  "..        )..  
+0000d790: 2020 2020 2020 2320 7365 7420 7468 6520        # set the 
+0000d7a0: 6765 6f74 7261 6e73 666f 726d 0d0a 2020  geotransform..  
+0000d7b0: 2020 2020 2020 6473 742e 5365 7447 656f        dst.SetGeo
+0000d7c0: 5472 616e 7366 6f72 6d28 7365 6c66 2e67  Transform(self.g
+0000d7d0: 656f 7472 616e 7366 6f72 6d29 0d0a 2020  eotransform)..  
+0000d7e0: 2020 2020 2020 2320 7365 7420 7468 6520        # set the 
+0000d7f0: 7072 6f6a 6563 7469 6f6e 0d0a 2020 2020  projection..    
+0000d800: 2020 2020 6473 742e 5365 7450 726f 6a65      dst.SetProje
+0000d810: 6374 696f 6e28 7365 6c66 2e63 7273 290d  ction(self.crs).
+0000d820: 0a20 2020 2020 2020 2064 7374 5f6f 626a  .        dst_obj
+0000d830: 203d 2044 6174 6173 6574 2864 7374 290d   = Dataset(dst).
+0000d840: 0a20 2020 2020 2020 2064 7374 5f6f 626a  .        dst_obj
+0000d850: 2e5f 7365 745f 6e6f 5f64 6174 615f 7661  ._set_no_data_va
+0000d860: 6c75 6528 6e6f 5f64 6174 615f 7661 6c75  lue(no_data_valu
+0000d870: 653d 6e6f 5f64 6174 615f 7661 6c75 6529  e=no_data_value)
+0000d880: 0d0a 2020 2020 2020 2020 6473 745f 6f62  ..        dst_ob
+0000d890: 6a2e 7261 7374 6572 2e47 6574 5261 7374  j.raster.GetRast
+0000d8a0: 6572 4261 6e64 2862 616e 6420 2b20 3129  erBand(band + 1)
+0000d8b0: 2e57 7269 7465 4172 7261 7928 6e65 775f  .WriteArray(new_
+0000d8c0: 6172 7261 7929 0d0a 0d0a 2020 2020 2020  array)....      
+0000d8d0: 2020 7265 7475 726e 2064 7374 5f6f 626a    return dst_obj
+0000d8e0: 0d0a 0d0a 2020 2020 6465 6620 6669 6c6c  ....    def fill
+0000d8f0: 280d 0a20 2020 2020 2020 2073 656c 662c  (..        self,
+0000d900: 2076 616c 3a20 556e 696f 6e5b 666c 6f61   val: Union[floa
+0000d910: 742c 2069 6e74 5d2c 2064 7269 7665 723a  t, int], driver:
+0000d920: 2073 7472 203d 2022 4d45 4d22 2c20 7061   str = "MEM", pa
+0000d930: 7468 3a20 7374 7220 3d20 4e6f 6e65 0d0a  th: str = None..
+0000d940: 2020 2020 2920 2d3e 2055 6e69 6f6e 5b4e      ) -> Union[N
+0000d950: 6f6e 652c 2067 6461 6c2e 4461 7461 7365  one, gdal.Datase
+0000d960: 745d 3a0d 0a20 2020 2020 2020 2022 2222  t]:..        """
+0000d970: 4669 6c6c 2e0d 0a0d 0a20 2020 2020 2020  Fill.....       
+0000d980: 2020 2020 2046 696c 6c20 7461 6b65 7320       Fill takes 
+0000d990: 6120 7261 7374 6572 2061 6e64 2066 696c  a raster and fil
+0000d9a0: 6c20 6974 2077 6974 6820 6f6e 6520 7661  l it with one va
+0000d9b0: 6c75 650d 0a0d 0a20 2020 2020 2020 2050  lue....        P
+0000d9c0: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
+0000d9d0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
+0000d9e0: 2020 2020 2020 2076 616c 3a20 5b6e 756d         val: [num
+0000d9f0: 6572 6963 5d0d 0a20 2020 2020 2020 2020  eric]..         
+0000da00: 2020 206e 756d 6572 6963 2076 616c 7565     numeric value
+0000da10: 0d0a 2020 2020 2020 2020 6472 6976 6572  ..        driver
+0000da20: 3a20 5b73 7472 5d0d 0a20 2020 2020 2020  : [str]..       
+0000da30: 2020 2020 2064 7269 7665 7220 7479 7065       driver type
+0000da40: 205b 2247 5469 6666 222c 2022 4d45 4d22   ["GTiff", "MEM"
+0000da50: 5d0d 0a20 2020 2020 2020 2070 6174 6820  ]..        path 
+0000da60: 3a20 5b73 7472 5d0d 0a20 2020 2020 2020  : [str]..       
+0000da70: 2020 2020 2070 6174 6820 696e 636c 7564       path includ
+0000da80: 696e 6720 7468 6520 6578 7465 6e73 696f  ing the extensio
+0000da90: 6e20 282e 7469 6629 0d0a 0d0a 2020 2020  n (.tif)....    
+0000daa0: 2020 2020 5265 7475 726e 730d 0a20 2020      Returns..   
+0000dab0: 2020 2020 202d 2d2d 2d2d 2d2d 0d0a 2020       -------..  
+0000dac0: 2020 2020 2020 7261 7374 6572 203a 205b        raster : [
+0000dad0: 4e6f 6e65 2f67 6461 6c2e 4461 7461 6375  None/gdal.Datacu
+0000dae0: 6265 5d0d 0a20 2020 2020 2020 2020 2020  be]..           
+0000daf0: 2069 6620 7468 6520 7261 7374 6572 2069   if the raster i
+0000db00: 7320 7361 7665 6420 6469 7265 6374 6c79  s saved directly
+0000db10: 2074 6f20 7468 6520 7061 7468 2079 6f75   to the path you
+0000db20: 2070 726f 7669 6465 6420 7468 6520 7265   provided the re
+0000db30: 7475 726e 6564 2076 616c 7565 2077 696c  turned value wil
+0000db40: 6c20 6265 204e 6f6e 652c 206f 7468 6572  l be None, other
+0000db50: 7769 7365 2074 6865 0d0a 2020 2020 2020  wise the..      
+0000db60: 2020 2020 2020 7265 7475 726e 6564 2076        returned v
+0000db70: 616c 7565 2077 696c 6c20 6265 2074 6865  alue will be the
+0000db80: 2067 6461 6c2e 4461 7461 6375 6265 2069   gdal.Datacube i
+0000db90: 7473 656c 662e 0d0a 2020 2020 2020 2020  tself...        
+0000dba0: 2222 220d 0a20 2020 2020 2020 206e 6f5f  """..        no_
+0000dbb0: 6461 7461 5f76 616c 7565 203d 2073 656c  data_value = sel
+0000dbc0: 662e 6e6f 5f64 6174 615f 7661 6c75 655b  f.no_data_value[
+0000dbd0: 305d 0d0a 2020 2020 2020 2020 7372 635f  0]..        src_
+0000dbe0: 6172 7261 7920 3d20 7365 6c66 2e72 6173  array = self.ras
+0000dbf0: 7465 722e 5265 6164 4173 4172 7261 7928  ter.ReadAsArray(
+0000dc00: 290d 0a0d 0a20 2020 2020 2020 2069 6620  )....        if 
+0000dc10: 6e6f 5f64 6174 615f 7661 6c75 6520 6973  no_data_value is
+0000dc20: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+0000dc30: 2020 2020 6e6f 5f64 6174 615f 7661 6c75      no_data_valu
+0000dc40: 6520 3d20 6e70 2e6e 616e 0d0a 0d0a 2020  e = np.nan....  
+0000dc50: 2020 2020 2020 6966 206e 6f74 206e 702e        if not np.
+0000dc60: 6973 6e61 6e28 6e6f 5f64 6174 615f 7661  isnan(no_data_va
+0000dc70: 6c75 6529 3a0d 0a20 2020 2020 2020 2020  lue):..         
+0000dc80: 2020 2073 7263 5f61 7272 6179 5b7e 6e70     src_array[~np
+0000dc90: 2e69 7363 6c6f 7365 2873 7263 5f61 7272  .isclose(src_arr
+0000dca0: 6179 2c20 6e6f 5f64 6174 615f 7661 6c75  ay, no_data_valu
+0000dcb0: 652c 2072 746f 6c3d 302e 3030 3030 3031  e, rtol=0.000001
+0000dcc0: 295d 203d 2076 616c 0d0a 2020 2020 2020  )] = val..      
+0000dcd0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0000dce0: 2020 2020 2073 7263 5f61 7272 6179 5b7e       src_array[~
+0000dcf0: 6e70 2e69 736e 616e 2873 7263 5f61 7272  np.isnan(src_arr
+0000dd00: 6179 295d 203d 2076 616c 0d0a 2020 2020  ay)] = val..    
+0000dd10: 2020 2020 6473 7420 3d20 4461 7461 7365      dst = Datase
+0000dd20: 742e 6461 7461 7365 745f 6c69 6b65 2873  t.dataset_like(s
+0000dd30: 656c 662c 2073 7263 5f61 7272 6179 2c20  elf, src_array, 
+0000dd40: 6472 6976 6572 3d64 7269 7665 722c 2070  driver=driver, p
+0000dd50: 6174 683d 7061 7468 290d 0a20 2020 2020  ath=path)..     
+0000dd60: 2020 2072 6574 7572 6e20 6473 740d 0a0d     return dst...
+0000dd70: 0a20 2020 2064 6566 2072 6573 616d 706c  .    def resampl
+0000dd80: 6528 7365 6c66 2c20 6365 6c6c 5f73 697a  e(self, cell_siz
+0000dd90: 653a 2055 6e69 6f6e 5b69 6e74 2c20 666c  e: Union[int, fl
+0000dda0: 6f61 745d 2c20 6d65 7468 6f64 3a20 7374  oat], method: st
+0000ddb0: 7220 3d20 226e 6561 7265 7374 206e 6569  r = "nearest nei
+0000ddc0: 626f 7572 2229 3a0d 0a20 2020 2020 2020  bour"):..       
+0000ddd0: 2022 2222 7265 7361 6d70 6c65 5261 7374   """resampleRast
+0000dde0: 6572 2e0d 0a0d 0a20 2020 2020 2020 2072  er.....        r
+0000ddf0: 6573 616d 706c 6520 6d65 7468 6f64 2072  esample method r
+0000de00: 6570 726f 6a65 6374 2061 2072 6173 7465  eproject a raste
+0000de10: 7220 746f 2061 6e79 2070 726f 6a65 6374  r to any project
+0000de20: 696f 6e0d 0a20 2020 2020 2020 2028 6465  ion..        (de
+0000de30: 6661 756c 7420 7468 6520 5747 5338 3420  fault the WGS84 
+0000de40: 7765 6220 6d65 7263 6174 6f72 2070 726f  web mercator pro
+0000de50: 6a65 6374 696f 6e2c 2077 6974 686f 7574  jection, without
+0000de60: 2072 6573 616d 706c 696e 6729 0d0a 2020   resampling)..  
+0000de70: 2020 2020 2020 5468 6520 6675 6e63 7469        The functi
+0000de80: 6f6e 2072 6574 7572 6e73 2061 2047 4441  on returns a GDA
+0000de90: 4c20 696e 2d6d 656d 6f72 7920 6669 6c65  L in-memory file
+0000dea0: 206f 626a 6563 742c 2077 6865 7265 2079   object, where y
+0000deb0: 6f75 2063 616e 2052 6561 6441 7341 7272  ou can ReadAsArr
+0000dec0: 6179 2065 7463 2e0d 0a0d 0a20 2020 2020  ay etc.....     
+0000ded0: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
+0000dee0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0000def0: 2d0d 0a20 2020 2020 2020 2063 656c 6c5f  -..        cell_
+0000df00: 7369 7a65 203a 205b 696e 7465 6765 725d  size : [integer]
+0000df10: 0d0a 2020 2020 2020 2020 2020 2020 206e  ..             n
+0000df20: 6577 2063 656c 6c20 7369 7a65 2074 6f20  ew cell size to 
+0000df30: 7265 7361 6d70 6c65 2074 6865 2072 6173  resample the ras
+0000df40: 7465 722e 0d0a 2020 2020 2020 2020 2020  ter...          
+0000df50: 2020 2864 6566 6175 6c74 2065 6d70 7479    (default empty
+0000df60: 2073 6f20 7261 7374 6572 2077 696c 6c20   so raster will 
+0000df70: 6e6f 7420 6265 2072 6573 616d 706c 6564  not be resampled
+0000df80: 290d 0a20 2020 2020 2020 206d 6574 686f  )..        metho
+0000df90: 6420 3a20 5b53 7472 696e 675d 0d0a 2020  d : [String]..  
+0000dfa0: 2020 2020 2020 2020 2020 7265 7361 6d70            resamp
+0000dfb0: 6c69 6e67 2074 6563 686e 6971 7565 2064  ling technique d
+0000dfc0: 6566 6175 6c74 2069 7320 224e 6561 7265  efault is "Neare
+0000dfd0: 7374 220d 0a20 2020 2020 2020 2020 2020  st"..           
+0000dfe0: 2068 7474 7073 3a2f 2f67 6973 6765 6f67   https://gisgeog
+0000dff0: 7261 7068 792e 636f 6d2f 7261 7374 6572  raphy.com/raster
+0000e000: 2d72 6573 616d 706c 696e 672f 0d0a 2020  -resampling/..  
+0000e010: 2020 2020 2020 2020 2020 226e 6561 7265            "neare
+0000e020: 7374 206e 6569 626f 7572 2220 666f 7220  st neibour" for 
+0000e030: 6e65 6172 6573 7420 6e65 6967 6862 6f75  nearest neighbou
+0000e040: 722c 2263 7562 6963 2220 666f 7220 6375  r,"cubic" for cu
+0000e050: 6269 6320 636f 6e76 6f6c 7574 696f 6e2c  bic convolution,
+0000e060: 0d0a 2020 2020 2020 2020 2020 2020 2262  ..            "b
+0000e070: 696c 696e 6561 7222 2066 6f72 2062 696c  ilinear" for bil
+0000e080: 696e 6561 720d 0a0d 0a20 2020 2020 2020  inear....       
+0000e090: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
+0000e0a0: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
+0000e0b0: 2020 2072 6173 7465 7220 3a20 5b67 6461     raster : [gda
+0000e0c0: 6c2e 4461 7461 6375 6265 5d0d 0a20 2020  l.Datacube]..   
+0000e0d0: 2020 2020 2020 2020 2020 6764 616c 206f            gdal o
+0000e0e0: 626a 6563 7420 2879 6f75 2063 616e 2072  bject (you can r
+0000e0f0: 6561 6420 6974 2062 7920 5265 6164 4173  ead it by ReadAs
+0000e100: 4172 7261 7929 0d0a 2020 2020 2020 2020  Array)..        
+0000e110: 2222 220d 0a20 2020 2020 2020 2069 6620  """..        if 
+0000e120: 6e6f 7420 6973 696e 7374 616e 6365 286d  not isinstance(m
+0000e130: 6574 686f 642c 2073 7472 293a 0d0a 2020  ethod, str):..  
+0000e140: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0000e150: 5479 7065 4572 726f 7228 0d0a 2020 2020  TypeError(..    
+0000e160: 2020 2020 2020 2020 2020 2020 2220 706c              " pl
+0000e170: 6561 7365 2065 6e74 6572 2063 6f72 7265  ease enter corre
+0000e180: 6374 206d 6574 686f 6420 6d6f 7265 2069  ct method more i
+0000e190: 6e66 6f72 6d61 7469 6f6e 2073 6565 2064  nformation see d
+0000e1a0: 6f63 6d65 6e74 6174 696f 6e20 220d 0a20  ocmentation ".. 
+0000e1b0: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
+0000e1c0: 2020 2020 2020 6966 206d 6574 686f 6420        if method 
+0000e1d0: 6e6f 7420 696e 2049 4e54 4552 504f 4c41  not in INTERPOLA
+0000e1e0: 5449 4f4e 5f4d 4554 484f 4453 2e6b 6579  TION_METHODS.key
+0000e1f0: 7328 293a 0d0a 2020 2020 2020 2020 2020  s():..          
+0000e200: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+0000e210: 6f72 280d 0a20 2020 2020 2020 2020 2020  or(..           
+0000e220: 2020 2020 2066 2254 6865 2067 6976 656e       f"The given
+0000e230: 2069 6e74 6572 706f 6c61 7469 6f6e 206d   interpolation m
+0000e240: 6574 686f 6420 646f 6573 206e 6f74 2065  ethod does not e
+0000e250: 7869 7374 2c20 6578 6973 7469 6e67 206d  xist, existing m
+0000e260: 6574 686f 6473 2061 7265 207b 494e 5445  ethods are {INTE
+0000e270: 5250 4f4c 4154 494f 4e5f 4d45 5448 4f44  RPOLATION_METHOD
+0000e280: 532e 6b65 7973 2829 7d22 0d0a 2020 2020  S.keys()}"..    
+0000e290: 2020 2020 2020 2020 290d 0a0d 0a20 2020          )....   
+0000e2a0: 2020 2020 206d 6574 686f 6420 3d20 494e       method = IN
+0000e2b0: 5445 5250 4f4c 4154 494f 4e5f 4d45 5448  TERPOLATION_METH
+0000e2c0: 4f44 532e 6765 7428 6d65 7468 6f64 290d  ODS.get(method).
+0000e2d0: 0a0d 0a20 2020 2020 2020 2073 725f 7372  ...        sr_sr
+0000e2e0: 6320 3d20 6f73 722e 5370 6174 6961 6c52  c = osr.SpatialR
+0000e2f0: 6566 6572 656e 6365 2877 6b74 3d73 656c  eference(wkt=sel
+0000e300: 662e 6372 7329 0d0a 0d0a 2020 2020 2020  f.crs)....      
+0000e310: 2020 756c 7820 3d20 7365 6c66 2e67 656f    ulx = self.geo
+0000e320: 7472 616e 7366 6f72 6d5b 305d 0d0a 2020  transform[0]..  
+0000e330: 2020 2020 2020 756c 7920 3d20 7365 6c66        uly = self
+0000e340: 2e67 656f 7472 616e 7366 6f72 6d5b 335d  .geotransform[3]
+0000e350: 0d0a 2020 2020 2020 2020 2320 7472 616e  ..        # tran
+0000e360: 7366 6f72 6d20 7468 6520 7269 6768 7420  sform the right 
+0000e370: 6c6f 7765 7220 636f 726e 6572 2070 6f69  lower corner poi
+0000e380: 6e74 0d0a 2020 2020 2020 2020 6c72 7820  nt..        lrx 
+0000e390: 3d20 7365 6c66 2e67 656f 7472 616e 7366  = self.geotransf
+0000e3a0: 6f72 6d5b 305d 202b 2073 656c 662e 6765  orm[0] + self.ge
+0000e3b0: 6f74 7261 6e73 666f 726d 5b31 5d20 2a20  otransform[1] * 
+0000e3c0: 7365 6c66 2e63 6f6c 756d 6e73 0d0a 2020  self.columns..  
+0000e3d0: 2020 2020 2020 6c72 7920 3d20 7365 6c66        lry = self
+0000e3e0: 2e67 656f 7472 616e 7366 6f72 6d5b 335d  .geotransform[3]
+0000e3f0: 202b 2073 656c 662e 6765 6f74 7261 6e73   + self.geotrans
+0000e400: 666f 726d 5b35 5d20 2a20 7365 6c66 2e72  form[5] * self.r
+0000e410: 6f77 730d 0a0d 0a20 2020 2020 2020 2070  ows....        p
+0000e420: 6978 656c 5f73 7061 6369 6e67 203d 2063  ixel_spacing = c
+0000e430: 656c 6c5f 7369 7a65 0d0a 2020 2020 2020  ell_size..      
+0000e440: 2020 2320 6e65 7720 6765 6f74 7261 6e73    # new geotrans
+0000e450: 666f 726d 0d0a 2020 2020 2020 2020 6e65  form..        ne
+0000e460: 775f 6765 6f20 3d20 280d 0a20 2020 2020  w_geo = (..     
+0000e470: 2020 2020 2020 2073 656c 662e 6765 6f74         self.geot
+0000e480: 7261 6e73 666f 726d 5b30 5d2c 0d0a 2020  ransform[0],..  
+0000e490: 2020 2020 2020 2020 2020 7069 7865 6c5f            pixel_
+0000e4a0: 7370 6163 696e 672c 0d0a 2020 2020 2020  spacing,..      
+0000e4b0: 2020 2020 2020 7365 6c66 2e67 656f 7472        self.geotr
+0000e4c0: 616e 7366 6f72 6d5b 325d 2c0d 0a20 2020  ansform[2],..   
+0000e4d0: 2020 2020 2020 2020 2073 656c 662e 6765           self.ge
+0000e4e0: 6f74 7261 6e73 666f 726d 5b33 5d2c 0d0a  otransform[3],..
+0000e4f0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000e500: 2e67 656f 7472 616e 7366 6f72 6d5b 345d  .geotransform[4]
+0000e510: 2c0d 0a20 2020 2020 2020 2020 2020 202d  ,..            -
+0000e520: 3120 2a20 7069 7865 6c5f 7370 6163 696e  1 * pixel_spacin
+0000e530: 672c 0d0a 2020 2020 2020 2020 290d 0a20  g,..        ).. 
+0000e540: 2020 2020 2020 2023 2063 7265 6174 6520         # create 
+0000e550: 6120 6e65 7720 7261 7374 6572 0d0a 2020  a new raster..  
+0000e560: 2020 2020 2020 636f 6c73 203d 2069 6e74        cols = int
+0000e570: 286e 702e 726f 756e 6428 6162 7328 6c72  (np.round(abs(lr
+0000e580: 7820 2d20 756c 7829 202f 2070 6978 656c  x - ulx) / pixel
+0000e590: 5f73 7061 6369 6e67 2929 0d0a 2020 2020  _spacing))..    
+0000e5a0: 2020 2020 726f 7773 203d 2069 6e74 286e      rows = int(n
+0000e5b0: 702e 726f 756e 6428 6162 7328 756c 7920  p.round(abs(uly 
+0000e5c0: 2d20 6c72 7929 202f 2070 6978 656c 5f73  - lry) / pixel_s
+0000e5d0: 7061 6369 6e67 2929 0d0a 2020 2020 2020  pacing))..      
+0000e5e0: 2020 6474 7970 6520 3d20 7365 6c66 2e72    dtype = self.r
+0000e5f0: 6173 7465 722e 4765 7452 6173 7465 7242  aster.GetRasterB
+0000e600: 616e 6428 3129 2e44 6174 6154 7970 650d  and(1).DataType.
+0000e610: 0a0d 0a20 2020 2020 2020 2064 7374 203d  ...        dst =
+0000e620: 2044 6174 6173 6574 2e5f 6372 6561 7465   Dataset._create
+0000e630: 5f67 6461 6c5f 6461 7461 7365 7428 636f  _gdal_dataset(co
+0000e640: 6c73 2c20 726f 7773 2c20 312c 2064 7479  ls, rows, 1, dty
+0000e650: 7065 290d 0a20 2020 2020 2020 2023 2073  pe)..        # s
+0000e660: 6574 2074 6865 2067 656f 7472 616e 7366  et the geotransf
+0000e670: 6f72 6d0d 0a20 2020 2020 2020 2064 7374  orm..        dst
+0000e680: 2e53 6574 4765 6f54 7261 6e73 666f 726d  .SetGeoTransform
+0000e690: 286e 6577 5f67 656f 290d 0a20 2020 2020  (new_geo)..     
+0000e6a0: 2020 2023 2073 6574 2074 6865 2070 726f     # set the pro
+0000e6b0: 6a65 6374 696f 6e0d 0a20 2020 2020 2020  jection..       
+0000e6c0: 2064 7374 2e53 6574 5072 6f6a 6563 7469   dst.SetProjecti
+0000e6d0: 6f6e 2873 725f 7372 632e 4578 706f 7274  on(sr_src.Export
+0000e6e0: 546f 576b 7428 2929 0d0a 2020 2020 2020  ToWkt())..      
+0000e6f0: 2020 6473 745f 6f62 6a20 3d20 4461 7461    dst_obj = Data
+0000e700: 7365 7428 6473 7429 0d0a 2020 2020 2020  set(dst)..      
+0000e710: 2020 2320 7365 7420 7468 6520 6e6f 2064    # set the no d
+0000e720: 6174 6120 7661 6c75 650d 0a20 2020 2020  ata value..     
+0000e730: 2020 206e 6f5f 6461 7461 5f76 616c 7565     no_data_value
+0000e740: 203d 2073 656c 662e 7261 7374 6572 2e47   = self.raster.G
+0000e750: 6574 5261 7374 6572 4261 6e64 2831 292e  etRasterBand(1).
+0000e760: 4765 744e 6f44 6174 6156 616c 7565 2829  GetNoDataValue()
+0000e770: 0d0a 2020 2020 2020 2020 6473 745f 6f62  ..        dst_ob
+0000e780: 6a2e 5f73 6574 5f6e 6f5f 6461 7461 5f76  j._set_no_data_v
+0000e790: 616c 7565 286e 6f5f 6461 7461 5f76 616c  alue(no_data_val
+0000e7a0: 7565 290d 0a20 2020 2020 2020 2023 2070  ue)..        # p
+0000e7b0: 6572 666f 726d 2074 6865 2070 726f 6a65  erform the proje
+0000e7c0: 6374 696f 6e20 2620 7265 7361 6d70 6c69  ction & resampli
+0000e7d0: 6e67 0d0a 2020 2020 2020 2020 6764 616c  ng..        gdal
+0000e7e0: 2e52 6570 726f 6a65 6374 496d 6167 6528  .ReprojectImage(
+0000e7f0: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+0000e800: 6c66 2e72 6173 7465 722c 0d0a 2020 2020  lf.raster,..    
+0000e810: 2020 2020 2020 2020 6473 745f 6f62 6a2e          dst_obj.
+0000e820: 7261 7374 6572 2c0d 0a20 2020 2020 2020  raster,..       
+0000e830: 2020 2020 2073 725f 7372 632e 4578 706f       sr_src.Expo
+0000e840: 7274 546f 576b 7428 292c 0d0a 2020 2020  rtToWkt(),..    
+0000e850: 2020 2020 2020 2020 7372 5f73 7263 2e45          sr_src.E
+0000e860: 7870 6f72 7454 6f57 6b74 2829 2c0d 0a20  xportToWkt(),.. 
+0000e870: 2020 2020 2020 2020 2020 206d 6574 686f             metho
+0000e880: 642c 0d0a 2020 2020 2020 2020 290d 0a0d  d,..        )...
+0000e890: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000e8a0: 6473 745f 6f62 6a0d 0a0d 0a20 2020 2064  dst_obj....    d
+0000e8b0: 6566 2074 6f5f 6372 7328 0d0a 2020 2020  ef to_crs(..    
+0000e8c0: 2020 2020 7365 6c66 2c0d 0a20 2020 2020      self,..     
+0000e8d0: 2020 2074 6f5f 6570 7367 3a20 696e 742c     to_epsg: int,
+0000e8e0: 0d0a 2020 2020 2020 2020 6d65 7468 6f64  ..        method
+0000e8f0: 3a20 7374 7220 3d20 226e 6561 7265 7374  : str = "nearest
+0000e900: 206e 6569 626f 7572 222c 0d0a 2020 2020   neibour",..    
+0000e910: 2020 2020 6d61 696e 7461 696e 5f61 6c69      maintain_ali
+0000e920: 6768 6d65 6e74 3a20 696e 7420 3d20 4661  ghment: int = Fa
+0000e930: 6c73 652c 0d0a 2020 2020 293a 0d0a 2020  lse,..    ):..  
+0000e940: 2020 2020 2020 2222 2274 6f5f 6570 7367        """to_epsg
+0000e950: 2e0d 0a0d 0a20 2020 2020 2020 2074 6f5f  .....        to_
+0000e960: 6570 7367 2072 6570 726f 6a65 6374 7320  epsg reprojects 
+0000e970: 6120 7261 7374 6572 2074 6f20 616e 7920  a raster to any 
+0000e980: 7072 6f6a 6563 7469 6f6e 0d0a 2020 2020  projection..    
+0000e990: 2020 2020 2864 6566 6175 6c74 2074 6865      (default the
+0000e9a0: 2057 4753 3834 2077 6562 206d 6572 6361   WGS84 web merca
+0000e9b0: 746f 7220 7072 6f6a 6563 7469 6f6e 2c20  tor projection, 
+0000e9c0: 7769 7468 6f75 7420 7265 7361 6d70 6c69  without resampli
+0000e9d0: 6e67 290d 0a0d 0a20 2020 2020 2020 2050  ng)....        P
+0000e9e0: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
+0000e9f0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
+0000ea00: 2020 2020 2020 2074 6f5f 6570 7367 3a20         to_epsg: 
+0000ea10: 5b69 6e74 6567 6572 5d0d 0a20 2020 2020  [integer]..     
+0000ea20: 2020 2020 2020 2072 6566 6572 656e 6365         reference
+0000ea30: 206e 756d 6265 7220 746f 2074 6865 206e   number to the n
+0000ea40: 6577 2070 726f 6a65 6374 696f 6e20 2868  ew projection (h
+0000ea50: 7474 7073 3a2f 2f65 7073 672e 696f 2f29  ttps://epsg.io/)
+0000ea60: 0d0a 2020 2020 2020 2020 2020 2020 2864  ..            (d
+0000ea70: 6566 6175 6c74 2033 3835 3720 7468 6520  efault 3857 the 
+0000ea80: 7265 6665 7265 6e63 6520 6e6f 206f 6620  reference no of 
+0000ea90: 5747 5338 3420 7765 6220 6d65 7263 6174  WGS84 web mercat
+0000eaa0: 6f72 2029 0d0a 2020 2020 2020 2020 6d65  or )..        me
+0000eab0: 7468 6f64 3a20 5b53 7472 696e 675d 0d0a  thod: [String]..
+0000eac0: 2020 2020 2020 2020 2020 2020 7265 7361              resa
+0000ead0: 6d70 6c69 6e67 2074 6563 686e 6971 7565  mpling technique
+0000eae0: 2064 6566 6175 6c74 2069 7320 224e 6561   default is "Nea
+0000eaf0: 7265 7374 220d 0a20 2020 2020 2020 2020  rest"..         
+0000eb00: 2020 2068 7474 7073 3a2f 2f67 6973 6765     https://gisge
+0000eb10: 6f67 7261 7068 792e 636f 6d2f 7261 7374  ography.com/rast
+0000eb20: 6572 2d72 6573 616d 706c 696e 672f 0d0a  er-resampling/..
+0000eb30: 2020 2020 2020 2020 2020 2020 226e 6561              "nea
+0000eb40: 7265 7374 206e 6569 626f 7572 2220 666f  rest neibour" fo
+0000eb50: 7220 6e65 6172 6573 7420 6e65 6967 6862  r nearest neighb
+0000eb60: 6f75 722c 2263 7562 6963 2220 666f 7220  our,"cubic" for 
+0000eb70: 6375 6269 6320 636f 6e76 6f6c 7574 696f  cubic convolutio
+0000eb80: 6e2c 0d0a 2020 2020 2020 2020 2020 2020  n,..            
+0000eb90: 2262 696c 696e 6561 7222 2066 6f72 2062  "bilinear" for b
+0000eba0: 696c 696e 6561 720d 0a20 2020 2020 2020  ilinear..       
+0000ebb0: 206d 6169 6e74 6169 6e5f 616c 6967 686d   maintain_alighm
+0000ebc0: 656e 7420 3a20 5b62 6f6f 6c5d 0d0a 2020  ent : [bool]..  
+0000ebd0: 2020 2020 2020 2020 2020 5472 7565 2074            True t
+0000ebe0: 6f20 6d61 696e 7461 696e 2074 6865 206e  o maintain the n
+0000ebf0: 756d 6265 7220 6f66 2072 6f77 7320 616e  umber of rows an
+0000ec00: 6420 636f 6c75 6d6e 7320 6f66 2074 6865  d columns of the
+0000ec10: 2072 6173 7465 7220 7468 6520 7361 6d65   raster the same
+0000ec20: 2061 6674 6572 2072 6570 726f 6a65 6374   after reproject
+0000ec30: 696f 6e2e 2044 6566 6175 6c74 2069 7320  ion. Default is 
+0000ec40: 4661 6c73 652e 0d0a 0d0a 2020 2020 2020  False.....      
+0000ec50: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
+0000ec60: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
+0000ec70: 2020 2020 7261 7374 6572 3a0d 0a20 2020      raster:..   
+0000ec80: 2020 2020 2020 2020 2067 6461 6c20 6461           gdal da
+0000ec90: 7461 7365 7420 2879 6f75 2063 616e 2072  taset (you can r
+0000eca0: 6561 6420 6974 2062 7920 5265 6164 4173  ead it by ReadAs
+0000ecb0: 4172 7261 7929 0d0a 0d0a 2020 2020 2020  Array)....      
+0000ecc0: 2020 4578 616d 706c 6573 0d0a 2020 2020    Examples..    
+0000ecd0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0d0a 2020      --------..  
+0000ece0: 2020 2020 2020 3e3e 3e20 6672 6f6d 2070        >>> from p
+0000ecf0: 7972 616d 6964 732e 6461 7461 7365 7420  yramids.dataset 
+0000ed00: 696d 706f 7274 2044 6174 6173 6574 0d0a  import Dataset..
+0000ed10: 2020 2020 2020 2020 3e3e 3e20 7372 6320          >>> src 
+0000ed20: 3d20 4461 7461 7365 742e 7265 6164 5f66  = Dataset.read_f
+0000ed30: 696c 6528 2270 6174 682f 7261 7374 6572  ile("path/raster
+0000ed40: 5f6e 616d 652e 7469 6622 290d 0a20 2020  _name.tif")..   
+0000ed50: 2020 2020 203e 3e3e 2070 726f 6a65 6374       >>> project
+0000ed60: 6564 5f72 6173 7465 7220 3d20 7372 632e  ed_raster = src.
+0000ed70: 746f 5f63 7273 2874 6f5f 6570 7367 3d33  to_crs(to_epsg=3
+0000ed80: 3835 3729 0d0a 2020 2020 2020 2020 2222  857)..        ""
+0000ed90: 220d 0a20 2020 2020 2020 2069 6620 6e6f  "..        if no
+0000eda0: 7420 6973 696e 7374 616e 6365 2874 6f5f  t isinstance(to_
+0000edb0: 6570 7367 2c20 696e 7429 3a0d 0a20 2020  epsg, int):..   
+0000edc0: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
+0000edd0: 7970 6545 7272 6f72 280d 0a20 2020 2020  ypeError(..     
+0000ede0: 2020 2020 2020 2020 2020 2022 706c 6561             "plea
+0000edf0: 7365 2065 6e74 6572 2063 6f72 7265 6374  se enter correct
+0000ee00: 2069 6e74 6567 6572 206e 756d 6265 7220   integer number 
+0000ee10: 666f 7220 746f 5f65 7073 6720 6d6f 7265  for to_epsg more
+0000ee20: 2069 6e66 6f72 6d61 7469 6f6e 2022 0d0a   information "..
+0000ee30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ee40: 6622 6874 7470 733a 2f2f 6570 7367 2e69  f"https://epsg.i
+0000ee50: 6f2f 2c20 6769 7665 6e20 7b74 7970 6528  o/, given {type(
+0000ee60: 746f 5f65 7073 6729 7d22 0d0a 2020 2020  to_epsg)}"..    
+0000ee70: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
+0000ee80: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
+0000ee90: 616e 6365 286d 6574 686f 642c 2073 7472  ance(method, str
+0000eea0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+0000eeb0: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
+0000eec0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000eed0: 2020 2270 6c65 6173 6520 656e 7465 7220    "please enter 
+0000eee0: 636f 7272 6563 7420 6d65 7468 6f64 206d  correct method m
+0000eef0: 6f72 6520 696e 666f 726d 6174 696f 6e20  ore information 
+0000ef00: 7365 6520 2220 2264 6f63 6d65 6e74 6174  see " "docmentat
+0000ef10: 696f 6e20 220d 0a20 2020 2020 2020 2020  ion "..         
+0000ef20: 2020 2029 0d0a 2020 2020 2020 2020 6966     )..        if
+0000ef30: 206d 6574 686f 6420 6e6f 7420 696e 2049   method not in I
+0000ef40: 4e54 4552 504f 4c41 5449 4f4e 5f4d 4554  NTERPOLATION_MET
+0000ef50: 484f 4453 2e6b 6579 7328 293a 0d0a 2020  HODS.keys():..  
+0000ef60: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0000ef70: 5661 6c75 6545 7272 6f72 280d 0a20 2020  ValueError(..   
+0000ef80: 2020 2020 2020 2020 2020 2020 2066 2254               f"T
+0000ef90: 6865 2067 6976 656e 2069 6e74 6572 706f  he given interpo
+0000efa0: 6c61 7469 6f6e 206d 6574 686f 6420 646f  lation method do
+0000efb0: 6573 206e 6f74 2065 7869 7374 2c20 6578  es not exist, ex
+0000efc0: 6973 7469 6e67 206d 6574 686f 6473 2061  isting methods a
+0000efd0: 7265 207b 494e 5445 5250 4f4c 4154 494f  re {INTERPOLATIO
+0000efe0: 4e5f 4d45 5448 4f44 532e 6b65 7973 2829  N_METHODS.keys()
+0000eff0: 7d22 0d0a 2020 2020 2020 2020 2020 2020  }"..            
+0000f000: 290d 0a0d 0a20 2020 2020 2020 206d 6574  )....        met
+0000f010: 686f 6420 3d20 494e 5445 5250 4f4c 4154  hod = INTERPOLAT
+0000f020: 494f 4e5f 4d45 5448 4f44 532e 6765 7428  ION_METHODS.get(
+0000f030: 6d65 7468 6f64 290d 0a0d 0a20 2020 2020  method)....     
+0000f040: 2020 2069 6620 6d61 696e 7461 696e 5f61     if maintain_a
+0000f050: 6c69 6768 6d65 6e74 3a0d 0a20 2020 2020  lighment:..     
+0000f060: 2020 2020 2020 2064 7374 5f6f 626a 203d         dst_obj =
+0000f070: 2073 656c 662e 5f72 6570 726f 6a65 6374   self._reproject
+0000f080: 5f77 6974 685f 5265 7072 6f6a 6563 7449  _with_ReprojectI
+0000f090: 6d61 6765 2874 6f5f 6570 7367 2c20 6d65  mage(to_epsg, me
+0000f0a0: 7468 6f64 290d 0a20 2020 2020 2020 2065  thod)..        e
+0000f0b0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+0000f0c0: 2020 6473 7420 3d20 6764 616c 2e57 6172    dst = gdal.War
+0000f0d0: 7028 2222 2c20 7365 6c66 2e72 6173 7465  p("", self.raste
+0000f0e0: 722c 2064 7374 5352 533d 6622 4550 5347  r, dstSRS=f"EPSG
+0000f0f0: 3a7b 746f 5f65 7073 677d 222c 2066 6f72  :{to_epsg}", for
+0000f100: 6d61 743d 2256 5254 2229 0d0a 2020 2020  mat="VRT")..    
+0000f110: 2020 2020 2020 2020 6473 745f 6f62 6a20          dst_obj 
+0000f120: 3d20 4461 7461 7365 7428 6473 7429 0d0a  = Dataset(dst)..
+0000f130: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0000f140: 2064 7374 5f6f 626a 0d0a 0d0a 2020 2020   dst_obj....    
+0000f150: 6465 6620 5f72 6570 726f 6a65 6374 5f77  def _reproject_w
+0000f160: 6974 685f 5265 7072 6f6a 6563 7449 6d61  ith_ReprojectIma
+0000f170: 6765 280d 0a20 2020 2020 2020 2073 656c  ge(..        sel
+0000f180: 662c 2074 6f5f 6570 7367 3a20 696e 742c  f, to_epsg: int,
+0000f190: 206d 6574 686f 643a 2073 7472 203d 2022   method: str = "
+0000f1a0: 6e65 6172 6573 7420 6e65 6962 6f75 7222  nearest neibour"
+0000f1b0: 0d0a 2020 2020 2920 2d3e 206f 626a 6563  ..    ) -> objec
+0000f1c0: 743a 0d0a 2020 2020 2020 2020 7372 635f  t:..        src_
+0000f1d0: 7072 6f6a 203d 2073 656c 662e 6372 730d  proj = self.crs.
+0000f1e0: 0a20 2020 2020 2020 2073 7263 5f67 7420  .        src_gt 
+0000f1f0: 3d20 7365 6c66 2e67 656f 7472 616e 7366  = self.geotransf
+0000f200: 6f72 6d0d 0a20 2020 2020 2020 2073 7263  orm..        src
+0000f210: 5f78 203d 2073 656c 662e 636f 6c75 6d6e  _x = self.column
+0000f220: 730d 0a20 2020 2020 2020 2073 7263 5f79  s..        src_y
+0000f230: 203d 2073 656c 662e 726f 7773 0d0a 0d0a   = self.rows....
+0000f240: 2020 2020 2020 2020 7372 635f 7372 203d          src_sr =
+0000f250: 206f 7372 2e53 7061 7469 616c 5265 6665   osr.SpatialRefe
+0000f260: 7265 6e63 6528 776b 743d 7372 635f 7072  rence(wkt=src_pr
+0000f270: 6f6a 290d 0a20 2020 2020 2020 2073 7263  oj)..        src
+0000f280: 5f65 7073 6720 3d20 7365 6c66 2e5f 6765  _epsg = self._ge
+0000f290: 745f 6570 7367 2829 0d0a 0d0a 2020 2020  t_epsg()....    
+0000f2a0: 2020 2020 2323 2320 6469 7374 696e 6174      ### distinat
+0000f2b0: 696f 6e20 7261 7374 6572 0d0a 2020 2020  ion raster..    
+0000f2c0: 2020 2020 2320 7370 6174 6961 6c20 7265      # spatial re
+0000f2d0: 660d 0a20 2020 2020 2020 2064 7374 5f73  f..        dst_s
+0000f2e0: 7220 3d20 7365 6c66 2e5f 6372 6561 7465  r = self._create
+0000f2f0: 5f73 725f 6672 6f6d 5f65 7073 6728 746f  _sr_from_epsg(to
+0000f300: 5f65 7073 6729 0d0a 0d0a 2020 2020 2020  _epsg)....      
+0000f310: 2020 2320 696e 2063 6173 6520 7468 6520    # in case the 
+0000f320: 736f 7572 6365 2063 7273 2069 7320 4743  source crs is GC
+0000f330: 5320 616e 6420 6c6f 6e67 6974 7564 6520  S and longitude 
+0000f340: 6973 2069 6e20 7468 6520 7765 7374 2068  is in the west h
+0000f350: 656d 6973 7068 6572 6520 6764 616c 0d0a  emisphere gdal..
+0000f360: 2020 2020 2020 2020 2320 7265 6164 7320          # reads 
+0000f370: 6c6f 6e67 6974 7564 6520 6672 6f6d 2030  longitude from 0
+0000f380: 2074 6f20 3336 3020 616e 6420 7472 616e   to 360 and tran
+0000f390: 7366 6f72 6d61 7469 6f6e 2066 6163 746f  sformation facto
+0000f3a0: 7220 776f 6e74 2077 6f72 6b20 7769 7468  r wont work with
+0000f3b0: 2076 616c 7565 730d 0a20 2020 2020 2020   values..       
+0000f3c0: 2023 2067 7265 6174 6572 2074 6861 6e20   # greater than 
+0000f3d0: 3138 300d 0a20 2020 2020 2020 2069 6620  180..        if 
+0000f3e0: 7372 635f 6570 7367 2021 3d20 746f 5f65  src_epsg != to_e
+0000f3f0: 7073 673a 0d0a 2020 2020 2020 2020 2020  psg:..          
+0000f400: 2020 6966 2073 7263 5f65 7073 6720 3d3d    if src_epsg ==
+0000f410: 2022 3433 3236 2220 616e 6420 7372 635f   "4326" and src_
+0000f420: 6774 5b30 5d20 3e20 3138 303a 0d0a 2020  gt[0] > 180:..  
+0000f430: 2020 2020 2020 2020 2020 2020 2020 6c6e                ln
+0000f440: 675f 6e65 7720 3d20 7372 635f 6774 5b30  g_new = src_gt[0
+0000f450: 5d20 2d20 3336 300d 0a20 2020 2020 2020  ] - 360..       
+0000f460: 2020 2020 2020 2020 2023 2074 7261 6e73           # trans
+0000f470: 666f 726d 6174 696f 6e20 6661 6374 6f72  formation factor
+0000f480: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
+0000f490: 2020 2074 7820 3d20 6f73 722e 436f 6f72     tx = osr.Coor
+0000f4a0: 6469 6e61 7465 5472 616e 7366 6f72 6d61  dinateTransforma
+0000f4b0: 7469 6f6e 2873 7263 5f73 722c 2064 7374  tion(src_sr, dst
+0000f4c0: 5f73 7229 0d0a 2020 2020 2020 2020 2020  _sr)..          
+0000f4d0: 2020 2020 2020 2320 7472 616e 7366 6f72        # transfor
+0000f4e0: 6d20 7468 6520 7269 6768 7420 7570 7065  m the right uppe
+0000f4f0: 7220 636f 726e 6572 2070 6f69 6e74 0d0a  r corner point..
+0000f500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f510: 2875 6c78 2c20 756c 792c 2075 6c7a 2920  (ulx, uly, ulz) 
+0000f520: 3d20 7478 2e54 7261 6e73 666f 726d 506f  = tx.TransformPo
+0000f530: 696e 7428 6c6e 675f 6e65 772c 2073 7263  int(lng_new, src
+0000f540: 5f67 745b 335d 290d 0a20 2020 2020 2020  _gt[3])..       
+0000f550: 2020 2020 2020 2020 2023 2074 7261 6e73           # trans
+0000f560: 666f 726d 2074 6865 2072 6967 6874 206c  form the right l
+0000f570: 6f77 6572 2063 6f72 6e65 7220 706f 696e  ower corner poin
+0000f580: 740d 0a20 2020 2020 2020 2020 2020 2020  t..             
+0000f590: 2020 2028 6c72 782c 206c 7279 2c20 6c72     (lrx, lry, lr
+0000f5a0: 7a29 203d 2074 782e 5472 616e 7366 6f72  z) = tx.Transfor
+0000f5b0: 6d50 6f69 6e74 280d 0a20 2020 2020 2020  mPoint(..       
+0000f5c0: 2020 2020 2020 2020 2020 2020 206c 6e67               lng
+0000f5d0: 5f6e 6577 202b 2073 7263 5f67 745b 315d  _new + src_gt[1]
+0000f5e0: 202a 2073 7263 5f78 2c20 7372 635f 6774   * src_x, src_gt
+0000f5f0: 5b33 5d20 2b20 7372 635f 6774 5b35 5d20  [3] + src_gt[5] 
+0000f600: 2a20 7372 635f 790d 0a20 2020 2020 2020  * src_y..       
+0000f610: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
+0000f620: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+0000f630: 2020 2020 2020 2020 2020 2020 2020 2078                 x
+0000f640: 7320 3d20 5b73 7263 5f67 745b 305d 2c20  s = [src_gt[0], 
+0000f650: 7372 635f 6774 5b30 5d20 2b20 7372 635f  src_gt[0] + src_
+0000f660: 6774 5b31 5d20 2a20 7372 635f 785d 0d0a  gt[1] * src_x]..
+0000f670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f680: 7973 203d 205b 7372 635f 6774 5b33 5d2c  ys = [src_gt[3],
+0000f690: 2073 7263 5f67 745b 335d 202b 2073 7263   src_gt[3] + src
+0000f6a0: 5f67 745b 355d 202a 2073 7263 5f79 5d0d  _gt[5] * src_y].
+0000f6b0: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+0000f6c0: 2020 205b 756c 792c 206c 7279 5d2c 205b     [uly, lry], [
+0000f6d0: 756c 782c 206c 7278 5d20 3d20 4665 6174  ulx, lrx] = Feat
+0000f6e0: 7572 6543 6f6c 6c65 6374 696f 6e2e 7265  ureCollection.re
+0000f6f0: 7072 6f6a 6563 745f 706f 696e 7473 280d  project_points(.
+0000f700: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f710: 2020 2020 2079 732c 2078 732c 2066 726f       ys, xs, fro
+0000f720: 6d5f 6570 7367 3d73 7263 5f65 7073 672c  m_epsg=src_epsg,
+0000f730: 2074 6f5f 6570 7367 3d74 6f5f 6570 7367   to_epsg=to_epsg
+0000f740: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000f750: 2020 290d 0a20 2020 2020 2020 2020 2020    )..           
+0000f760: 2020 2020 2023 206f 6c64 2074 7261 6e73       # old trans
+0000f770: 666f 726d 0d0a 2020 2020 2020 2020 2020  form..          
+0000f780: 2020 2020 2020 2320 2320 7472 616e 7366        # # transf
+0000f790: 6f72 6d20 7468 6520 7269 6768 7420 7570  orm the right up
+0000f7a0: 7065 7220 636f 726e 6572 2070 6f69 6e74  per corner point
+0000f7b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000f7c0: 2020 2320 2875 6c78 2c20 756c 792c 2075    # (ulx, uly, u
+0000f7d0: 6c7a 2920 3d20 7478 2e54 7261 6e73 666f  lz) = tx.Transfo
+0000f7e0: 726d 506f 696e 7428 7372 635f 6774 5b30  rmPoint(src_gt[0
+0000f7f0: 5d2c 2073 7263 5f67 745b 335d 290d 0a20  ], src_gt[3]).. 
+0000f800: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0000f810: 2023 2074 7261 6e73 666f 726d 2074 6865   # transform the
+0000f820: 2072 6967 6874 206c 6f77 6572 2063 6f72   right lower cor
+0000f830: 6e65 7220 706f 696e 740d 0a20 2020 2020  ner point..     
+0000f840: 2020 2020 2020 2020 2020 2023 2028 6c72             # (lr
+0000f850: 782c 206c 7279 2c20 6c72 7a29 203d 2074  x, lry, lrz) = t
+0000f860: 782e 5472 616e 7366 6f72 6d50 6f69 6e74  x.TransformPoint
+0000f870: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+0000f880: 2020 2023 2020 2020 2073 7263 5f67 745b     #     src_gt[
+0000f890: 305d 202b 2073 7263 5f67 745b 315d 202a  0] + src_gt[1] *
+0000f8a0: 2073 7263 5f78 2c20 7372 635f 6774 5b33   src_x, src_gt[3
+0000f8b0: 5d20 2b20 7372 635f 6774 5b35 5d20 2a20  ] + src_gt[5] * 
+0000f8c0: 7372 635f 790d 0a20 2020 2020 2020 2020  src_y..         
+0000f8d0: 2020 2020 2020 2023 2029 0d0a 0d0a 2020         # )....  
+0000f8e0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+0000f8f0: 2020 2020 2020 2020 2075 6c78 203d 2073           ulx = s
+0000f900: 7263 5f67 745b 305d 0d0a 2020 2020 2020  rc_gt[0]..      
+0000f910: 2020 2020 2020 756c 7920 3d20 7372 635f        uly = src_
+0000f920: 6774 5b33 5d0d 0a20 2020 2020 2020 2020  gt[3]..         
+0000f930: 2020 206c 7278 203d 2073 7263 5f67 745b     lrx = src_gt[
+0000f940: 305d 202b 2073 7263 5f67 745b 315d 202a  0] + src_gt[1] *
+0000f950: 2073 7263 5f78 0d0a 2020 2020 2020 2020   src_x..        
+0000f960: 2020 2020 6c72 7920 3d20 7372 635f 6774      lry = src_gt
+0000f970: 5b33 5d20 2b20 7372 635f 6774 5b35 5d20  [3] + src_gt[5] 
+0000f980: 2a20 7372 635f 790d 0a0d 0a20 2020 2020  * src_y....     
+0000f990: 2020 2023 2067 6574 2074 6865 2063 656c     # get the cel
+0000f9a0: 6c20 7369 7a65 2069 6e20 7468 6520 736f  l size in the so
+0000f9b0: 7572 6365 2072 6173 7465 7220 616e 6420  urce raster and 
+0000f9c0: 636f 6e76 6572 7420 6974 2074 6f20 7468  convert it to th
+0000f9d0: 6520 6e65 7720 6372 730d 0a20 2020 2020  e new crs..     
+0000f9e0: 2020 2023 2078 2063 6f6f 7264 696e 6174     # x coordinat
+0000f9f0: 6573 206f 7220 6c6f 6e67 6974 7564 6573  es or longitudes
+0000fa00: 0d0a 2020 2020 2020 2020 7873 203d 205b  ..        xs = [
+0000fa10: 7372 635f 6774 5b30 5d2c 2073 7263 5f67  src_gt[0], src_g
+0000fa20: 745b 305d 202b 2073 7263 5f67 745b 315d  t[0] + src_gt[1]
+0000fa30: 5d0d 0a20 2020 2020 2020 2023 2079 2063  ]..        # y c
+0000fa40: 6f6f 7264 696e 6174 6573 206f 7220 6c61  oordinates or la
+0000fa50: 7469 7475 6465 730d 0a20 2020 2020 2020  titudes..       
+0000fa60: 2079 7320 3d20 5b73 7263 5f67 745b 335d   ys = [src_gt[3]
+0000fa70: 2c20 7372 635f 6774 5b33 5d5d 0d0a 0d0a  , src_gt[3]]....
+0000fa80: 2020 2020 2020 2020 6966 2073 7263 5f65          if src_e
+0000fa90: 7073 6720 213d 2074 6f5f 6570 7367 3a0d  psg != to_epsg:.
+0000faa0: 0a20 2020 2020 2020 2020 2020 2023 2074  .            # t
+0000fab0: 7261 6e73 666f 726d 2074 6865 2074 776f  ransform the two
+0000fac0: 2070 6f69 6e74 7320 636f 6f72 6469 6e61   points coordina
+0000fad0: 7465 7320 746f 2074 6865 206e 6577 2063  tes to the new c
+0000fae0: 7273 2074 6f20 6361 6c63 756c 6174 6520  rs to calculate 
+0000faf0: 7468 6520 6e65 7720 6365 6c6c 2073 697a  the new cell siz
+0000fb00: 650d 0a20 2020 2020 2020 2020 2020 206e  e..            n
+0000fb10: 6577 5f79 732c 206e 6577 5f78 7320 3d20  ew_ys, new_xs = 
+0000fb20: 4665 6174 7572 6543 6f6c 6c65 6374 696f  FeatureCollectio
+0000fb30: 6e2e 7265 7072 6f6a 6563 745f 706f 696e  n.reproject_poin
+0000fb40: 7473 280d 0a20 2020 2020 2020 2020 2020  ts(..           
+0000fb50: 2020 2020 2079 732c 2078 732c 2066 726f       ys, xs, fro
+0000fb60: 6d5f 6570 7367 3d73 7263 5f65 7073 672c  m_epsg=src_epsg,
+0000fb70: 2074 6f5f 6570 7367 3d74 6f5f 6570 7367   to_epsg=to_epsg
+0000fb80: 2c20 7072 6563 6973 696f 6e3d 360d 0a20  , precision=6.. 
+0000fb90: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
+0000fba0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+0000fbb0: 2020 2020 2020 2020 206e 6577 5f78 7320           new_xs 
+0000fbc0: 3d20 7873 0d0a 2020 2020 2020 2020 2020  = xs..          
+0000fbd0: 2020 2320 6e65 775f 7973 203d 2079 730d    # new_ys = ys.
+0000fbe0: 0a0d 0a20 2020 2020 2020 2070 6978 656c  ...        pixel
+0000fbf0: 5f73 7061 6369 6e67 203d 206e 702e 6162  _spacing = np.ab
+0000fc00: 7328 6e65 775f 7873 5b30 5d20 2d20 6e65  s(new_xs[0] - ne
+0000fc10: 775f 7873 5b31 5d29 0d0a 0d0a 2020 2020  w_xs[1])....    
+0000fc20: 2020 2020 2320 6372 6561 7465 2061 206e      # create a n
+0000fc30: 6577 2072 6173 7465 720d 0a20 2020 2020  ew raster..     
+0000fc40: 2020 2063 6f6c 7320 3d20 696e 7428 6e70     cols = int(np
+0000fc50: 2e72 6f75 6e64 2861 6273 286c 7278 202d  .round(abs(lrx -
+0000fc60: 2075 6c78 2920 2f20 7069 7865 6c5f 7370   ulx) / pixel_sp
+0000fc70: 6163 696e 6729 290d 0a20 2020 2020 2020  acing))..       
+0000fc80: 2072 6f77 7320 3d20 696e 7428 6e70 2e72   rows = int(np.r
+0000fc90: 6f75 6e64 2861 6273 2875 6c79 202d 206c  ound(abs(uly - l
+0000fca0: 7279 2920 2f20 7069 7865 6c5f 7370 6163  ry) / pixel_spac
+0000fcb0: 696e 6729 290d 0a0d 0a20 2020 2020 2020  ing))....       
+0000fcc0: 2064 7479 7065 203d 2073 656c 662e 6474   dtype = self.dt
+0000fcd0: 7970 655b 305d 0d0a 2020 2020 2020 2020  ype[0]..        
+0000fce0: 6473 7420 3d20 4461 7461 7365 742e 5f63  dst = Dataset._c
+0000fcf0: 7265 6174 655f 6764 616c 5f64 6174 6173  reate_gdal_datas
+0000fd00: 6574 2863 6f6c 732c 2072 6f77 732c 2031  et(cols, rows, 1
+0000fd10: 2c20 6474 7970 6529 0d0a 0d0a 2020 2020  , dtype)....    
+0000fd20: 2020 2020 2320 6e65 7720 6765 6f74 7261      # new geotra
+0000fd30: 6e73 666f 726d 0d0a 2020 2020 2020 2020  nsform..        
+0000fd40: 6e65 775f 6765 6f20 3d20 280d 0a20 2020  new_geo = (..   
+0000fd50: 2020 2020 2020 2020 2075 6c78 2c0d 0a20           ulx,.. 
+0000fd60: 2020 2020 2020 2020 2020 2070 6978 656c             pixel
+0000fd70: 5f73 7061 6369 6e67 2c0d 0a20 2020 2020  _spacing,..     
+0000fd80: 2020 2020 2020 2073 7263 5f67 745b 325d         src_gt[2]
+0000fd90: 2c0d 0a20 2020 2020 2020 2020 2020 2075  ,..            u
+0000fda0: 6c79 2c0d 0a20 2020 2020 2020 2020 2020  ly,..           
+0000fdb0: 2073 7263 5f67 745b 345d 2c0d 0a20 2020   src_gt[4],..   
+0000fdc0: 2020 2020 2020 2020 206e 702e 7369 676e           np.sign
+0000fdd0: 2873 7263 5f67 745b 2d31 5d29 202a 2070  (src_gt[-1]) * p
+0000fde0: 6978 656c 5f73 7061 6369 6e67 2c0d 0a20  ixel_spacing,.. 
+0000fdf0: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
+0000fe00: 2020 2320 7365 7420 7468 6520 6765 6f74    # set the geot
+0000fe10: 7261 6e73 666f 726d 0d0a 2020 2020 2020  ransform..      
+0000fe20: 2020 6473 742e 5365 7447 656f 5472 616e    dst.SetGeoTran
+0000fe30: 7366 6f72 6d28 6e65 775f 6765 6f29 0d0a  sform(new_geo)..
+0000fe40: 2020 2020 2020 2020 2320 7365 7420 7468          # set th
+0000fe50: 6520 7072 6f6a 6563 7469 6f6e 0d0a 2020  e projection..  
+0000fe60: 2020 2020 2020 6473 742e 5365 7450 726f        dst.SetPro
+0000fe70: 6a65 6374 696f 6e28 6473 745f 7372 2e45  jection(dst_sr.E
+0000fe80: 7870 6f72 7454 6f57 6b74 2829 290d 0a20  xportToWkt()).. 
+0000fe90: 2020 2020 2020 2023 2073 6574 2074 6865         # set the
+0000fea0: 206e 6f20 6461 7461 2076 616c 7565 0d0a   no data value..
+0000feb0: 2020 2020 2020 2020 6e6f 5f64 6174 615f          no_data_
+0000fec0: 7661 6c75 6520 3d20 7365 6c66 2e72 6173  value = self.ras
+0000fed0: 7465 722e 4765 7452 6173 7465 7242 616e  ter.GetRasterBan
+0000fee0: 6428 3129 2e47 6574 4e6f 4461 7461 5661  d(1).GetNoDataVa
+0000fef0: 6c75 6528 290d 0a20 2020 2020 2020 2064  lue()..        d
+0000ff00: 7374 5f6f 626a 203d 2044 6174 6173 6574  st_obj = Dataset
+0000ff10: 2864 7374 290d 0a20 2020 2020 2020 2064  (dst)..        d
+0000ff20: 7374 5f6f 626a 2e5f 7365 745f 6e6f 5f64  st_obj._set_no_d
+0000ff30: 6174 615f 7661 6c75 6528 6e6f 5f64 6174  ata_value(no_dat
+0000ff40: 615f 7661 6c75 6529 0d0a 2020 2020 2020  a_value)..      
+0000ff50: 2020 2320 7065 7266 6f72 6d20 7468 6520    # perform the 
+0000ff60: 7072 6f6a 6563 7469 6f6e 2026 2072 6573  projection & res
+0000ff70: 616d 706c 696e 670d 0a20 2020 2020 2020  ampling..       
+0000ff80: 2067 6461 6c2e 5265 7072 6f6a 6563 7449   gdal.ReprojectI
+0000ff90: 6d61 6765 280d 0a20 2020 2020 2020 2020  mage(..         
+0000ffa0: 2020 2073 656c 662e 7261 7374 6572 2c0d     self.raster,.
+0000ffb0: 0a20 2020 2020 2020 2020 2020 2064 7374  .            dst
+0000ffc0: 5f6f 626a 2e72 6173 7465 722c 0d0a 2020  _obj.raster,..  
+0000ffd0: 2020 2020 2020 2020 2020 7372 635f 7372            src_sr
+0000ffe0: 2e45 7870 6f72 7454 6f57 6b74 2829 2c0d  .ExportToWkt(),.
+0000fff0: 0a20 2020 2020 2020 2020 2020 2064 7374  .            dst
+00010000: 5f73 722e 4578 706f 7274 546f 576b 7428  _sr.ExportToWkt(
+00010010: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
+00010020: 6d65 7468 6f64 2c0d 0a20 2020 2020 2020  method,..       
+00010030: 2029 0d0a 2020 2020 2020 2020 7265 7475   )..        retu
+00010040: 726e 2064 7374 5f6f 626a 0d0a 0d0a 2020  rn dst_obj....  
+00010050: 2020 6465 6620 5f63 726f 705f 616c 6c69    def _crop_alli
+00010060: 676e 6564 280d 0a20 2020 2020 2020 2073  gned(..        s
+00010070: 656c 662c 0d0a 2020 2020 2020 2020 6d61  elf,..        ma
+00010080: 736b 3a20 556e 696f 6e5b 6764 616c 2e44  sk: Union[gdal.D
+00010090: 6174 6173 6574 2c20 6e70 2e6e 6461 7272  ataset, np.ndarr
+000100a0: 6179 5d2c 0d0a 2020 2020 2020 2020 6d61  ay],..        ma
+000100b0: 736b 5f6e 6f76 616c 3a20 556e 696f 6e5b  sk_noval: Union[
+000100c0: 696e 742c 2066 6c6f 6174 5d20 3d20 4e6f  int, float] = No
+000100d0: 6e65 2c0d 0a20 2020 2020 2020 2062 616e  ne,..        ban
+000100e0: 643a 2069 6e74 203d 2031 2c0d 0a20 2020  d: int = 1,..   
+000100f0: 2029 202d 3e20 556e 696f 6e5b 6e70 2e6e   ) -> Union[np.n
+00010100: 6461 7272 6179 2c20 6764 616c 2e44 6174  darray, gdal.Dat
+00010110: 6173 6574 5d3a 0d0a 2020 2020 2020 2020  aset]:..        
+00010120: 2222 2263 726f 7041 6c6c 6967 6e65 642e  """cropAlligned.
+00010130: 0d0a 0d0a 2020 2020 2020 2020 6372 6f70  ....        crop
+00010140: 416c 6c69 676e 6564 2063 6c69 702f 6372  Alligned clip/cr
+00010150: 6f70 2028 6d61 7463 6865 7320 7468 6520  op (matches the 
+00010160: 6c6f 6361 7469 6f6e 206f 6620 6e6f 6461  location of noda
+00010170: 7461 2076 616c 7565 2066 726f 6d20 6d61  ta value from ma
+00010180: 736b 2074 6f20 7372 630d 0a20 2020 2020  sk to src..     
+00010190: 2020 2072 6173 7465 7229 2c0d 0a20 2020     raster),..   
+000101a0: 2020 2020 2020 2020 202d 2042 6f74 6820           - Both 
+000101b0: 7261 7374 6572 7320 6861 7665 2074 6f20  rasters have to 
+000101c0: 6861 7665 2074 6865 2073 616d 6520 6469  have the same di
+000101d0: 6d65 6e73 696f 6e73 2028 6e6f 206f 6620  mensions (no of 
+000101e0: 726f 7773 2026 2063 6f6c 756d 6e73 290d  rows & columns).
+000101f0: 0a20 2020 2020 2020 2020 2020 2073 6f20  .            so 
+00010200: 4d61 7463 6852 6173 7465 7241 6c69 676e  MatchRasterAlign
+00010210: 6d65 6e74 2073 686f 756c 6420 6265 2075  ment should be u
+00010220: 7365 6420 7072 696f 7220 746f 2074 6869  sed prior to thi
+00010230: 7320 6675 6e63 7469 6f6e 2074 6f20 616c  s function to al
+00010240: 6967 6e20 626f 7468 0d0a 2020 2020 2020  ign both..      
+00010250: 2020 2020 2020 7261 7374 6572 730d 0a0d        rasters...
+00010260: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+00010270: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
+00010280: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+00010290: 2054 4f44 4f3a 2074 6865 206f 7269 6967   TODO: the oriig
+000102a0: 696e 616c 2066 756e 6374 696f 6e20 6861  inal function ha
+000102b0: 6420 7468 6520 6162 696c 6974 7920 746f  d the ability to
+000102c0: 2063 726f 7020 616e 2061 7272 6179 2077   crop an array w
+000102d0: 6974 6820 6120 6461 7461 7365 7420 6f62  ith a dataset ob
+000102e0: 6a65 6374 2061 6e64 2074 6865 206f 7070  ject and the opp
+000102f0: 6f73 6974 650d 0a20 2020 2020 2020 2073  osite..        s
+00010300: 7263 3a20 5b67 6461 6c2e 6461 7461 7365  rc: [gdal.datase
+00010310: 742f 6e70 2e6e 6461 7272 6179 5d0d 0a20  t/np.ndarray].. 
+00010320: 2020 2020 2020 2020 2020 2072 6173 7465             raste
+00010330: 7220 796f 7520 7761 6e74 2074 6f20 636c  r you want to cl
+00010340: 6970 2f73 746f 7265 204e 6f44 6174 6156  ip/store NoDataV
+00010350: 616c 7565 2069 6e20 6974 7320 6365 6c6c  alue in its cell
+00010360: 730d 0a20 2020 2020 2020 2020 2020 2065  s..            e
+00010370: 7861 6374 6c79 2074 6865 2073 616d 6520  xactly the same 
+00010380: 6c69 6b65 206d 6173 6b20 7261 7374 6572  like mask raster
+00010390: 0d0a 2020 2020 2020 2020 6d61 736b 3a20  ..        mask: 
+000103a0: 5b67 6461 6c2e 6461 7461 7365 742f 6e70  [gdal.dataset/np
+000103b0: 2e6e 6461 7272 6179 5d0d 0a20 2020 2020  .ndarray]..     
+000103c0: 2020 2020 2020 206d 6173 6b20 7261 7374         mask rast
+000103d0: 6572 2074 6f20 6765 7420 7468 6520 6c6f  er to get the lo
+000103e0: 6361 7469 6f6e 206f 6620 7468 6520 4e6f  cation of the No
+000103f0: 4461 7461 5661 6c75 6520 616e 640d 0a20  DataValue and.. 
+00010400: 2020 2020 2020 2020 2020 2077 6865 7265             where
+00010410: 2069 7420 6973 2069 6e20 7468 6520 6172   it is in the ar
+00010420: 7261 790d 0a20 2020 2020 2020 206d 6173  ray..        mas
+00010430: 6b5f 6e6f 7661 6c3a 205b 6e75 6d65 7269  k_noval: [numeri
+00010440: 635d 0d0a 2020 2020 2020 2020 2020 2020  c]..            
+00010450: 696e 2063 6173 6520 7468 6520 6d61 736b  in case the mask
+00010460: 2069 7320 6e70 2e6e 6461 7272 6179 2c20   is np.ndarray, 
+00010470: 7468 6520 6d61 736b 5f6e 6f76 616c 2068  the mask_noval h
+00010480: 6176 6520 746f 2062 6520 6769 7665 6e2e  ave to be given.
+00010490: 0d0a 2020 2020 2020 2020 6261 6e64 3a20  ..        band: 
+000104a0: 5b69 6e74 5d0d 0a20 2020 2020 2020 2020  [int]..         
+000104b0: 2020 2062 616e 6420 696e 6465 782c 2073     band index, s
+000104c0: 7461 7274 7320 6672 6f6d 2031 2074 6f20  tarts from 1 to 
+000104d0: 7468 6520 6e75 6d62 6572 206f 6620 6261  the number of ba
+000104e0: 6e64 732e 0d0a 0d0a 2020 2020 2020 2020  nds.....        
+000104f0: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
+00010500: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020   -------..      
+00010510: 2020 6473 743a 205b 6764 616c 2e64 6174    dst: [gdal.dat
+00010520: 6173 6574 5d0d 0a20 2020 2020 2020 2020  aset]..         
+00010530: 2020 2074 6865 2073 6563 6f6e 6420 7261     the second ra
+00010540: 7374 6572 2077 6974 6820 4e6f 4461 7461  ster with NoData
+00010550: 5661 6c75 6520 7374 6f72 6564 2069 6e20  Value stored in 
+00010560: 6974 7320 6365 6c6c 730d 0a20 2020 2020  its cells..     
+00010570: 2020 2020 2020 2065 7861 6374 6c79 2074         exactly t
+00010580: 6865 2073 616d 6520 6c69 6b65 2073 7263  he same like src
+00010590: 2072 6173 7465 720d 0a20 2020 2020 2020   raster..       
+000105a0: 2022 2222 0d0a 2020 2020 2020 2020 2320   """..        # 
+000105b0: 6368 6563 6b20 7468 6520 6d61 736b 0d0a  check the mask..
+000105c0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+000105d0: 7461 6e63 6528 6d61 736b 2c20 4461 7461  tance(mask, Data
+000105e0: 7365 7429 3a0d 0a20 2020 2020 2020 2020  set):..         
+000105f0: 2020 206d 6173 6b5f 6774 203d 206d 6173     mask_gt = mas
+00010600: 6b2e 6765 6f74 7261 6e73 666f 726d 0d0a  k.geotransform..
+00010610: 2020 2020 2020 2020 2020 2020 2320 6d61              # ma
+00010620: 736b 5f70 726f 6a20 3d20 6d61 736b 2e70  sk_proj = mask.p
+00010630: 726f 6a0d 0a20 2020 2020 2020 2020 2020  roj..           
+00010640: 2023 206d 6173 6b5f 7372 6566 203d 206f   # mask_sref = o
+00010650: 7372 2e53 7061 7469 616c 5265 6665 7265  sr.SpatialRefere
+00010660: 6e63 6528 776b 743d 6d61 736b 5f70 726f  nce(wkt=mask_pro
+00010670: 6a29 0d0a 2020 2020 2020 2020 2020 2020  j)..            
+00010680: 6d61 736b 5f65 7073 6720 3d20 6d61 736b  mask_epsg = mask
+00010690: 2e65 7073 670d 0a20 2020 2020 2020 2020  .epsg..         
+000106a0: 2020 2072 6f77 203d 206d 6173 6b2e 726f     row = mask.ro
+000106b0: 7773 0d0a 2020 2020 2020 2020 2020 2020  ws..            
+000106c0: 636f 6c20 3d20 6d61 736b 2e63 6f6c 756d  col = mask.colum
+000106d0: 6e73 0d0a 2020 2020 2020 2020 2020 2020  ns..            
+000106e0: 6d61 736b 5f6e 6f76 616c 203d 206d 6173  mask_noval = mas
+000106f0: 6b2e 6e6f 5f64 6174 615f 7661 6c75 655b  k.no_data_value[
+00010700: 6261 6e64 202d 2031 5d0d 0a20 2020 2020  band - 1]..     
+00010710: 2020 2020 2020 206d 6173 6b5f 6172 7261         mask_arra
+00010720: 7920 3d20 6d61 736b 2e72 6173 7465 722e  y = mask.raster.
+00010730: 5265 6164 4173 4172 7261 7928 290d 0a20  ReadAsArray().. 
+00010740: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
+00010750: 7374 616e 6365 286d 6173 6b2c 206e 702e  stance(mask, np.
+00010760: 6e64 6172 7261 7929 3a0d 0a20 2020 2020  ndarray):..     
+00010770: 2020 2020 2020 2069 6620 6d61 736b 5f6e         if mask_n
+00010780: 6f76 616c 2069 7320 4e6f 6e65 3a0d 0a20  oval is None:.. 
+00010790: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+000107a0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+000107b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000107c0: 2020 2020 2020 2259 6f75 2068 6176 6520        "You have 
+000107d0: 746f 2065 6e74 6572 2074 6865 2076 616c  to enter the val
+000107e0: 7565 206f 6620 7468 6520 6e6f 5f76 616c  ue of the no_val
+000107f0: 2070 6172 616d 6574 6572 2077 6865 6e20   parameter when 
+00010800: 7468 6520 6d61 736b 2069 7320 6120 6e75  the mask is a nu
+00010810: 6d70 7920 6172 7261 7922 0d0a 2020 2020  mpy array"..    
+00010820: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
+00010830: 2020 2020 2020 2020 2020 206d 6173 6b5f             mask_
+00010840: 6172 7261 7920 3d20 6d61 736b 2e63 6f70  array = mask.cop
+00010850: 7928 290d 0a20 2020 2020 2020 2020 2020  y()..           
+00010860: 2072 6f77 2c20 636f 6c20 3d20 6d61 736b   row, col = mask
+00010870: 2e73 6861 7065 0d0a 2020 2020 2020 2020  .shape..        
+00010880: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+00010890: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+000108a0: 6f72 280d 0a20 2020 2020 2020 2020 2020  or(..           
+000108b0: 2020 2020 2022 5468 6520 7365 636f 6e64       "The second
+000108c0: 2070 6172 616d 6574 6572 2027 6d61 736b   parameter 'mask
+000108d0: 2720 6861 7320 746f 2062 6520 6569 7468  ' has to be eith
+000108e0: 6572 2067 6461 6c2e 4461 7461 6375 6265  er gdal.Datacube
+000108f0: 206f 7220 6e75 6d70 7920 6172 7261 7922   or numpy array"
+00010900: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00010910: 2020 6622 6769 7665 6e20 2d20 7b74 7970    f"given - {typ
+00010920: 6528 6d61 736b 297d 220d 0a20 2020 2020  e(mask)}"..     
+00010930: 2020 2020 2020 2029 0d0a 0d0a 2020 2020         )....    
+00010940: 2020 2020 2320 6966 2074 6865 2074 6f20      # if the to 
+00010950: 6265 2063 6c69 7070 6564 206f 626a 6563  be clipped objec
+00010960: 7420 6973 2072 6173 7465 720d 0a20 2020  t is raster..   
+00010970: 2020 2020 2073 7263 5f6e 6f76 616c 203d       src_noval =
+00010980: 2073 656c 662e 6e6f 5f64 6174 615f 7661   self.no_data_va
+00010990: 6c75 655b 6261 6e64 202d 2031 5d0d 0a20  lue[band - 1].. 
+000109a0: 2020 2020 2020 2064 7479 7065 203d 2073         dtype = s
+000109b0: 656c 662e 6474 7970 655b 6261 6e64 202d  elf.dtype[band -
+000109c0: 2031 5d0d 0a0d 0a20 2020 2020 2020 2073   1]....        s
+000109d0: 7263 5f73 7265 6620 3d20 6f73 722e 5370  rc_sref = osr.Sp
+000109e0: 6174 6961 6c52 6566 6572 656e 6365 2877  atialReference(w
+000109f0: 6b74 3d73 656c 662e 6372 7329 0d0a 2020  kt=self.crs)..  
+00010a00: 2020 2020 2020 7372 635f 6172 7261 7920        src_array 
+00010a10: 3d20 7365 6c66 2e72 6173 7465 722e 5265  = self.raster.Re
+00010a20: 6164 4173 4172 7261 7928 290d 0a20 2020  adAsArray()..   
+00010a30: 2020 2020 2023 2057 6172 6e69 6e67 3a20       # Warning: 
+00010a40: 6465 6c65 7465 206c 6174 6572 2074 6865  delete later the
+00010a50: 2073 656c 662e 7261 7374 6572 2077 696c   self.raster wil
+00010a60: 6c20 6e65 7665 7220 6265 2061 6e20 6172  l never be an ar
+00010a70: 7261 790d 0a20 2020 2020 2020 2069 6620  ray..        if 
+00010a80: 6973 696e 7374 616e 6365 2873 656c 662e  isinstance(self.
+00010a90: 7261 7374 6572 2c20 6e70 2e6e 6461 7272  raster, np.ndarr
+00010aa0: 6179 293a 0d0a 2020 2020 2020 2020 2020  ay):..          
+00010ab0: 2020 2320 6966 2074 6865 206f 626a 6563    # if the objec
+00010ac0: 7420 746f 2062 6520 6372 6f70 7065 6420  t to be cropped 
+00010ad0: 6973 2061 7272 6179 0d0a 2020 2020 2020  is array..      
+00010ae0: 2020 2020 2020 7372 635f 6172 7261 7920        src_array 
+00010af0: 3d20 7365 6c66 2e72 6173 7465 722e 636f  = self.raster.co
+00010b00: 7079 2829 0d0a 2020 2020 2020 2020 2020  py()..          
+00010b10: 2020 6474 7970 6520 3d20 7365 6c66 2e72    dtype = self.r
+00010b20: 6173 7465 722e 6474 7970 650d 0a0d 0a20  aster.dtype.... 
+00010b30: 2020 2020 2020 2023 2063 6865 636b 2070         # check p
+00010b40: 726f 6a0d 0a20 2020 2020 2020 2069 6620  roj..        if 
+00010b50: 6e6f 7420 6d61 736b 5f61 7272 6179 2e73  not mask_array.s
+00010b60: 6861 7065 203d 3d20 7372 635f 6172 7261  hape == src_arra
+00010b70: 792e 7368 6170 653a 0d0a 2020 2020 2020  y.shape:..      
+00010b80: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00010b90: 6545 7272 6f72 280d 0a20 2020 2020 2020  eError(..       
+00010ba0: 2020 2020 2020 2020 2022 5477 6f20 7261           "Two ra
+00010bb0: 7374 6572 7320 6861 7320 6469 6666 6572  sters has differ
+00010bc0: 656e 7420 6e75 6d62 6572 206f 6620 636f  ent number of co
+00010bd0: 6c75 6d6e 7320 6f72 2072 6f77 7320 706c  lumns or rows pl
+00010be0: 6561 7365 2072 6573 616d 706c 6520 6f72  ease resample or
+00010bf0: 206d 6174 6368 2062 6f74 6820 7261 7374   match both rast
+00010c00: 6572 7322 0d0a 2020 2020 2020 2020 2020  ers"..          
+00010c10: 2020 290d 0a0d 0a20 2020 2020 2020 2023    )....        #
+00010c20: 2069 6620 626f 7468 2069 6e70 7574 7320   if both inputs 
+00010c30: 6172 6520 7261 7374 6572 730d 0a20 2020  are rasters..   
+00010c40: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00010c50: 6365 286d 6173 6b2c 2044 6174 6173 6574  ce(mask, Dataset
+00010c60: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00010c70: 6966 206e 6f74 2073 656c 662e 6765 6f74  if not self.geot
+00010c80: 7261 6e73 666f 726d 203d 3d20 6d61 736b  ransform == mask
+00010c90: 5f67 743a 0d0a 2020 2020 2020 2020 2020  _gt:..          
+00010ca0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00010cb0: 6545 7272 6f72 280d 0a20 2020 2020 2020  eError(..       
+00010cc0: 2020 2020 2020 2020 2020 2020 2022 6c6f               "lo
+00010cd0: 6361 7469 6f6e 206f 6620 7570 7065 7220  cation of upper 
+00010ce0: 6c65 6674 2063 6f72 6e65 7220 6f66 2062  left corner of b
+00010cf0: 6f74 6820 7261 7374 6572 7320 6172 6520  oth rasters are 
+00010d00: 6e6f 7420 7468 6520 7361 6d65 206f 7220  not the same or 
+00010d10: 6365 6c6c 2073 697a 6520 6973 2022 0d0a  cell size is "..
+00010d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010d30: 2020 2020 2264 6966 6665 7265 6e74 2070      "different p
+00010d40: 6c65 6173 6520 6d61 7463 6820 626f 7468  lease match both
+00010d50: 2072 6173 7465 7273 2066 6972 7374 2022   rasters first "
+00010d60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00010d70: 2020 290d 0a0d 0a20 2020 2020 2020 2020    )....         
+00010d80: 2020 2069 6620 6e6f 7420 6d61 736b 5f65     if not mask_e
+00010d90: 7073 6720 3d3d 2073 656c 662e 6570 7367  psg == self.epsg
+00010da0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00010db0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+00010dc0: 726f 7228 0d0a 2020 2020 2020 2020 2020  ror(..          
+00010dd0: 2020 2020 2020 2020 2020 2244 6174 6173            "Datas
+00010de0: 6574 2041 2026 2042 2061 7265 2075 7369  et A & B are usi
+00010df0: 6e67 2064 6966 6665 7265 6e74 2063 6f6f  ng different coo
+00010e00: 7264 696e 6174 6520 7379 7374 656d 2070  rdinate system p
+00010e10: 6c65 6173 6520 7265 7072 6f6a 6563 7420  lease reproject 
+00010e20: 6f6e 6520 6f66 2074 6865 6d20 746f 2022  one of them to "
+00010e30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00010e40: 2020 2020 2020 2274 6865 206f 7468 6572        "the other
+00010e50: 2072 6173 7465 7220 636f 6f72 6469 6e61   raster coordina
+00010e60: 7465 2073 7973 7465 6d22 0d0a 2020 2020  te system"..    
+00010e70: 2020 2020 2020 2020 2020 2020 290d 0a0d              )...
+00010e80: 0a20 2020 2020 2020 2073 7263 5f61 7272  .        src_arr
+00010e90: 6179 5b6e 702e 6973 636c 6f73 6528 6d61  ay[np.isclose(ma
+00010ea0: 736b 5f61 7272 6179 2c20 6d61 736b 5f6e  sk_array, mask_n
+00010eb0: 6f76 616c 2c20 7274 6f6c 3d30 2e30 3031  oval, rtol=0.001
+00010ec0: 295d 203d 206d 6173 6b5f 6e6f 7661 6c0d  )] = mask_noval.
+00010ed0: 0a0d 0a20 2020 2020 2020 2023 2061 6c69  ...        # ali
+00010ee0: 676e 2066 756e 6374 696f 6e20 6f6e 6c79  gn function only
+00010ef0: 2065 7175 6174 6520 7468 6520 6e6f 206f   equate the no o
+00010f00: 6620 726f 7773 2061 6e64 2063 6f6c 756d  f rows and colum
+00010f10: 6e73 206f 6e6c 790d 0a20 2020 2020 2020  ns only..       
+00010f20: 2023 206d 6174 6368 206e 6f64 6174 6176   # match nodatav
+00010f30: 616c 7565 2069 6e73 6572 7473 206e 6f64  alue inserts nod
+00010f40: 6174 6176 616c 7565 2069 6e20 7372 6320  atavalue in src 
+00010f50: 7261 7374 6572 2074 6f20 616c 6c20 706c  raster to all pl
+00010f60: 6163 6573 206c 696b 6520 6d61 736b 0d0a  aces like mask..
+00010f70: 2020 2020 2020 2020 2320 7374 696c 6c20          # still 
+00010f80: 706c 6163 6573 2074 6861 7420 6861 7320  places that has 
+00010f90: 6e6f 6461 7461 7661 6c75 6520 696e 2074  nodatavalue in t
+00010fa0: 6865 2073 7263 2072 6173 7465 7220 6275  he src raster bu
+00010fb0: 7420 6974 2069 7320 6e6f 7420 6e6f 6461  t it is not noda
+00010fc0: 7461 7661 6c75 6520 696e 2074 6865 206d  tavalue in the m
+00010fd0: 6173 6b0d 0a20 2020 2020 2020 2023 2061  ask..        # a
+00010fe0: 6e64 206e 6f77 2068 6173 2074 6f20 6265  nd now has to be
+00010ff0: 2066 696c 6c65 6420 7769 7468 2076 616c   filled with val
+00011000: 7565 730d 0a20 2020 2020 2020 2023 2063  ues..        # c
+00011010: 6f6d 7061 7265 206e 6f20 6f66 2065 6c65  ompare no of ele
+00011020: 6d65 6e74 2074 6861 7420 6973 206e 6f74  ment that is not
+00011030: 206e 6f64 6174 6176 616c 7565 2069 6e20   nodatavalue in 
+00011040: 626f 7468 2072 6173 7465 7273 2074 6f20  both rasters to 
+00011050: 6d61 6b65 2073 7572 6520 7468 6579 2061  make sure they a
+00011060: 7265 206d 6174 6368 6564 0d0a 2020 2020  re matched..    
+00011070: 2020 2020 2320 6966 2062 6f74 6820 696e      # if both in
+00011080: 7075 7473 2061 7265 2072 6173 7465 7273  puts are rasters
+00011090: 0d0a 2020 2020 2020 2020 6966 2069 7369  ..        if isi
+000110a0: 6e73 7461 6e63 6528 6d61 736b 2c20 6764  nstance(mask, gd
+000110b0: 616c 2e44 6174 6173 6574 2920 616e 6420  al.Dataset) and 
+000110c0: 6973 696e 7374 616e 6365 2873 656c 662e  isinstance(self.
+000110d0: 7261 7374 6572 2c20 6764 616c 2e44 6174  raster, gdal.Dat
+000110e0: 6173 6574 293a 0d0a 2020 2020 2020 2020  aset):..        
+000110f0: 2020 2020 2320 7468 6572 6520 6d69 6768      # there migh
+00011100: 7420 6265 2063 656c 6c73 2074 6861 7420  t be cells that 
+00011110: 6172 6520 6f75 7420 6f66 2064 6f6d 6169  are out of domai
+00011120: 6e20 696e 2074 6865 2073 7263 2062 7574  n in the src but
+00011130: 206e 6f74 206f 7574 206f 6620 646f 6d61   not out of doma
+00011140: 696e 2069 6e20 7468 6520 6d61 736b 0d0a  in in the mask..
+00011150: 2020 2020 2020 2020 2020 2020 2320 736f              # so
+00011160: 2063 6861 6e67 6520 616c 6c20 7468 6520   change all the 
+00011170: 7372 635f 6e6f 7661 6c20 746f 206d 6173  src_noval to mas
+00011180: 6b5f 6e6f 7661 6c20 696e 2074 6865 2073  k_noval in the s
+00011190: 7263 5f61 7272 6179 0d0a 2020 2020 2020  rc_array..      
+000111a0: 2020 2020 2020 7372 635f 6172 7261 795b        src_array[
+000111b0: 6e70 2e69 7363 6c6f 7365 2873 7263 5f61  np.isclose(src_a
+000111c0: 7272 6179 2c20 7372 635f 6e6f 7661 6c2c  rray, src_noval,
+000111d0: 2072 746f 6c3d 302e 3030 3129 5d20 3d20   rtol=0.001)] = 
+000111e0: 6d61 736b 5f6e 6f76 616c 0d0a 2020 2020  mask_noval..    
+000111f0: 2020 2020 2020 2020 2320 7468 656e 2063          # then c
+00011200: 6f75 6e74 2074 6865 6d20 286f 7574 206f  ount them (out o
+00011210: 6620 646f 6d61 696e 2063 656c 6c73 2920  f domain cells) 
+00011220: 696e 2074 6865 2073 7263 5f61 7272 6179  in the src_array
+00011230: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+00011240: 656d 5f73 7263 203d 206e 702e 7369 7a65  em_src = np.size
+00011250: 2873 7263 5f61 7272 6179 5b3a 2c20 3a5d  (src_array[:, :]
+00011260: 2920 2d20 6e70 2e63 6f75 6e74 5f6e 6f6e  ) - np.count_non
+00011270: 7a65 726f 280d 0a20 2020 2020 2020 2020  zero(..         
+00011280: 2020 2020 2020 2028 7372 635f 6172 7261         (src_arra
+00011290: 795b 6e70 2e69 7363 6c6f 7365 2873 7263  y[np.isclose(src
+000112a0: 5f61 7272 6179 2c20 6d61 736b 5f6e 6f76  _array, mask_nov
+000112b0: 616c 2c20 7274 6f6c 3d30 2e30 3031 295d  al, rtol=0.001)]
+000112c0: 290d 0a20 2020 2020 2020 2020 2020 2029  )..            )
+000112d0: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+000112e0: 636f 756e 7420 7468 6520 6f75 7420 6f66  count the out of
+000112f0: 2064 6f6d 6961 6e20 6365 6c6c 7320 696e   domian cells in
+00011300: 2074 6865 206d 6173 6b0d 0a20 2020 2020   the mask..     
+00011310: 2020 2020 2020 2065 6c65 6d5f 6d61 736b         elem_mask
+00011320: 203d 206e 702e 7369 7a65 286d 6173 6b5f   = np.size(mask_
+00011330: 6172 7261 795b 3a2c 203a 5d29 202d 206e  array[:, :]) - n
+00011340: 702e 636f 756e 745f 6e6f 6e7a 6572 6f28  p.count_nonzero(
+00011350: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00011360: 2020 286d 6173 6b5f 6172 7261 795b 6e70    (mask_array[np
+00011370: 2e69 7363 6c6f 7365 286d 6173 6b5f 6172  .isclose(mask_ar
+00011380: 7261 792c 206d 6173 6b5f 6e6f 7661 6c2c  ray, mask_noval,
+00011390: 2072 746f 6c3d 302e 3030 3129 5d29 0d0a   rtol=0.001)])..
+000113a0: 2020 2020 2020 2020 2020 2020 290d 0a0d              )...
+000113b0: 0a20 2020 2020 2020 2020 2020 2023 2069  .            # i
+000113c0: 6620 6e6f 7420 6571 7561 6c20 7468 656e  f not equal then
+000113d0: 2073 746f 7265 2069 6e64 6963 6573 206f   store indices o
+000113e0: 6620 7468 6f73 6520 6365 6c6c 7320 7468  f those cells th
+000113f0: 6174 2064 6f65 736e 2774 206d 6174 6368  at doesn't match
+00011400: 730d 0a20 2020 2020 2020 2020 2020 2069  s..            i
+00011410: 6620 656c 656d 5f6d 6173 6b20 3e20 656c  f elem_mask > el
+00011420: 656d 5f73 7263 3a0d 0a20 2020 2020 2020  em_src:..       
+00011430: 2020 2020 2020 2020 2072 6f77 7320 3d20           rows = 
+00011440: 5b0d 0a20 2020 2020 2020 2020 2020 2020  [..             
+00011450: 2020 2020 2020 2069 0d0a 2020 2020 2020         i..      
+00011460: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00011470: 7220 6920 696e 2072 616e 6765 2872 6f77  r i in range(row
+00011480: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00011490: 2020 2020 2020 2066 6f72 206a 2069 6e20         for j in 
+000114a0: 7261 6e67 6528 636f 6c29 0d0a 2020 2020  range(col)..    
+000114b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000114c0: 6966 206e 702e 6973 636c 6f73 6528 7372  if np.isclose(sr
+000114d0: 635f 6172 7261 795b 692c 206a 5d2c 206d  c_array[i, j], m
+000114e0: 6173 6b5f 6e6f 7661 6c2c 2072 746f 6c3d  ask_noval, rtol=
+000114f0: 302e 3030 3129 0d0a 2020 2020 2020 2020  0.001)..        
+00011500: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+00011510: 6e6f 7420 6e70 2e69 7363 6c6f 7365 286d  not np.isclose(m
+00011520: 6173 6b5f 6172 7261 795b 692c 206a 5d2c  ask_array[i, j],
+00011530: 206d 6173 6b5f 6e6f 7661 6c2c 2072 746f   mask_noval, rto
+00011540: 6c3d 302e 3030 3129 0d0a 2020 2020 2020  l=0.001)..      
+00011550: 2020 2020 2020 2020 2020 5d0d 0a20 2020            ]..   
+00011560: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
+00011570: 7320 3d20 5b0d 0a20 2020 2020 2020 2020  s = [..         
+00011580: 2020 2020 2020 2020 2020 206a 0d0a 2020             j..  
+00011590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000115a0: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
+000115b0: 2872 6f77 290d 0a20 2020 2020 2020 2020  (row)..         
+000115c0: 2020 2020 2020 2020 2020 2066 6f72 206a             for j
+000115d0: 2069 6e20 7261 6e67 6528 636f 6c29 0d0a   in range(col)..
+000115e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000115f0: 2020 2020 6966 206e 702e 6973 636c 6f73      if np.isclos
+00011600: 6528 7372 635f 6172 7261 795b 692c 206a  e(src_array[i, j
+00011610: 5d2c 206d 6173 6b5f 6e6f 7661 6c2c 2072  ], mask_noval, r
+00011620: 746f 6c3d 302e 3030 3129 0d0a 2020 2020  tol=0.001)..    
+00011630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011640: 616e 6420 6e6f 7420 6e70 2e69 7363 6c6f  and not np.isclo
+00011650: 7365 286d 6173 6b5f 6172 7261 795b 692c  se(mask_array[i,
+00011660: 206a 5d2c 206d 6173 6b5f 6e6f 7661 6c2c   j], mask_noval,
+00011670: 2072 746f 6c3d 302e 3030 3129 0d0a 2020   rtol=0.001)..  
+00011680: 2020 2020 2020 2020 2020 2020 2020 5d0d                ].
+00011690: 0a20 2020 2020 2020 2020 2020 2023 2069  .            # i
+000116a0: 6e74 6572 706f 6c61 7465 2074 686f 7365  nterpolate those
+000116b0: 206d 6973 7369 6e67 2063 656c 6c73 2062   missing cells b
+000116c0: 7920 6e65 6172 6573 7420 6e65 6967 6862  y nearest neighb
+000116d0: 6f75 720d 0a20 2020 2020 2020 2020 2020  our..           
+000116e0: 2069 6620 656c 656d 5f6d 6173 6b20 3e20   if elem_mask > 
+000116f0: 656c 656d 5f73 7263 3a0d 0a20 2020 2020  elem_src:..     
+00011700: 2020 2020 2020 2020 2020 2073 7263 5f61             src_a
+00011710: 7272 6179 203d 2044 6174 6173 6574 2e5f  rray = Dataset._
+00011720: 6e65 6172 6573 745f 6e65 6967 6862 6f75  nearest_neighbou
+00011730: 7228 0d0a 2020 2020 2020 2020 2020 2020  r(..            
+00011740: 2020 2020 2020 2020 7372 635f 6172 7261          src_arra
+00011750: 792c 206d 6173 6b5f 6e6f 7661 6c2c 2072  y, mask_noval, r
+00011760: 6f77 732c 2063 6f6c 730d 0a20 2020 2020  ows, cols..     
+00011770: 2020 2020 2020 2020 2020 2029 0d0a 0d0a             )....
+00011780: 2020 2020 2020 2020 2320 6966 2074 6865          # if the
+00011790: 2064 7374 2069 7320 6120 7261 7374 6572   dst is a raster
+000117a0: 0d0a 2020 2020 2020 2020 6966 2069 7369  ..        if isi
+000117b0: 6e73 7461 6e63 6528 7365 6c66 2e72 6173  nstance(self.ras
+000117c0: 7465 722c 2067 6461 6c2e 4461 7461 7365  ter, gdal.Datase
+000117d0: 7429 3a0d 0a20 2020 2020 2020 2020 2020  t):..           
+000117e0: 2064 7374 203d 2044 6174 6173 6574 2e5f   dst = Dataset._
+000117f0: 6372 6561 7465 5f67 6461 6c5f 6461 7461  create_gdal_data
+00011800: 7365 7428 636f 6c2c 2072 6f77 2c20 312c  set(col, row, 1,
+00011810: 2064 7479 7065 2c20 6472 6976 6572 3d22   dtype, driver="
+00011820: 4d45 4d22 290d 0a20 2020 2020 2020 2020  MEM")..         
+00011830: 2020 2023 2062 7574 2077 6974 6820 6c6f     # but with lo
+00011840: 7420 6f66 2063 6f6d 7075 7461 7469 6f6e  t of computation
+00011850: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+00011860: 6966 2074 6865 206d 6173 6b20 6973 2061  if the mask is a
+00011870: 6e20 6172 7261 7920 616e 6420 7468 6520  n array and the 
+00011880: 6d61 736b 5f67 7420 6973 206e 6f74 2064  mask_gt is not d
+00011890: 6566 696e 6564 2075 7365 2074 6865 2073  efined use the s
+000118a0: 7263 5f67 7420 6173 2062 6f74 6820 7468  rc_gt as both th
+000118b0: 6520 6d61 736b 2061 6e64 2074 6865 2073  e mask and the s
+000118c0: 7263 0d0a 2020 2020 2020 2020 2020 2020  rc..            
+000118d0: 2320 6172 6520 616c 6967 6e65 6420 736f  # are aligned so
+000118e0: 2074 6865 7920 6861 7665 2074 6865 2073   they have the s
+000118f0: 616d 2067 740d 0a20 2020 2020 2020 2020  am gt..         
+00011900: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
+00011910: 2020 2020 2020 2020 2023 2073 6574 2074           # set t
+00011920: 6865 2067 656f 7472 616e 7366 6f72 6d0d  he geotransform.
+00011930: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011940: 2064 7374 2e53 6574 4765 6f54 7261 6e73   dst.SetGeoTrans
+00011950: 666f 726d 286d 6173 6b5f 6774 290d 0a20  form(mask_gt).. 
+00011960: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00011970: 2073 6574 2074 6865 2070 726f 6a65 6374   set the project
+00011980: 696f 6e0d 0a20 2020 2020 2020 2020 2020  ion..           
+00011990: 2020 2020 2064 7374 2e53 6574 5072 6f6a       dst.SetProj
+000119a0: 6563 7469 6f6e 286d 6173 6b2e 6372 7329  ection(mask.crs)
+000119b0: 0d0a 2020 2020 2020 2020 2020 2020 6578  ..            ex
+000119c0: 6365 7074 2055 6e62 6f75 6e64 4c6f 6361  cept UnboundLoca
+000119d0: 6c45 7272 6f72 3a0d 0a20 2020 2020 2020  lError:..       
+000119e0: 2020 2020 2020 2020 2064 7374 2e53 6574           dst.Set
+000119f0: 4765 6f54 7261 6e73 666f 726d 2873 656c  GeoTransform(sel
+00011a00: 662e 6765 6f74 7261 6e73 666f 726d 290d  f.geotransform).
+00011a10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011a20: 2064 7374 2e53 6574 5072 6f6a 6563 7469   dst.SetProjecti
+00011a30: 6f6e 2873 7263 5f73 7265 662e 4578 706f  on(src_sref.Expo
+00011a40: 7274 546f 576b 7428 2929 0d0a 0d0a 2020  rtToWkt())....  
+00011a50: 2020 2020 2020 2020 2020 6473 745f 6f62            dst_ob
+00011a60: 6a20 3d20 4461 7461 7365 7428 6473 7429  j = Dataset(dst)
+00011a70: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+00011a80: 7365 7420 7468 6520 6e6f 2064 6174 6120  set the no data 
+00011a90: 7661 6c75 650d 0a20 2020 2020 2020 2020  value..         
+00011aa0: 2020 2064 7374 5f6f 626a 2e5f 7365 745f     dst_obj._set_
+00011ab0: 6e6f 5f64 6174 615f 7661 6c75 6528 6d61  no_data_value(ma
+00011ac0: 736b 5f6e 6f76 616c 290d 0a20 2020 2020  sk_noval)..     
+00011ad0: 2020 2020 2020 2064 7374 5f6f 626a 2e72         dst_obj.r
+00011ae0: 6173 7465 722e 4765 7452 6173 7465 7242  aster.GetRasterB
+00011af0: 616e 6428 3129 2e57 7269 7465 4172 7261  and(1).WriteArra
+00011b00: 7928 7372 635f 6172 7261 7929 0d0a 2020  y(src_array)..  
+00011b10: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00011b20: 2064 7374 5f6f 626a 0d0a 2020 2020 2020   dst_obj..      
+00011b30: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+00011b40: 2020 2020 2072 6574 7572 6e20 7372 635f       return src_
+00011b50: 6172 7261 790d 0a0d 0a20 2020 2064 6566  array....    def
+00011b60: 205f 6368 6563 6b5f 616c 6967 6e6d 656e   _check_alignmen
+00011b70: 7428 7365 6c66 2c20 6d61 736b 2920 2d3e  t(self, mask) ->
+00011b80: 2062 6f6f 6c3a 0d0a 2020 2020 2020 2020   bool:..        
+00011b90: 2222 2243 6865 636b 2069 6620 7261 7374  """Check if rast
+00011ba0: 6572 2069 7320 616c 6967 6e65 6420 7769  er is aligned wi
+00011bb0: 7468 2061 2067 6976 656e 206d 6173 6b20  th a given mask 
+00011bc0: 7261 7374 6572 2222 220d 0a20 2020 2020  raster"""..     
+00011bd0: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
+00011be0: 616e 6365 286d 6173 6b2c 2044 6174 6173  ance(mask, Datas
+00011bf0: 6574 293a 0d0a 2020 2020 2020 2020 2020  et):..          
+00011c00: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
+00011c10: 7228 2254 6865 2073 6563 6f6e 6420 7061  r("The second pa
+00011c20: 7261 6d65 7465 7220 7368 6f75 6c64 2062  rameter should b
+00011c30: 6520 6120 4461 7461 7365 7422 290d 0a0d  e a Dataset")...
+00011c40: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00011c50: 7365 6c66 2e72 6f77 7320 3d3d 206d 6173  self.rows == mas
+00011c60: 6b2e 726f 7773 2061 6e64 2073 656c 662e  k.rows and self.
+00011c70: 636f 6c75 6d6e 7320 3d3d 206d 6173 6b2e  columns == mask.
+00011c80: 636f 6c75 6d6e 730d 0a0d 0a20 2020 2064  columns....    d
+00011c90: 6566 2061 6c69 676e 280d 0a20 2020 2020  ef align(..     
+00011ca0: 2020 2073 656c 662c 0d0a 2020 2020 2020     self,..      
+00011cb0: 2020 616c 6967 6e6d 656e 745f 7372 632c    alignment_src,
+00011cc0: 0d0a 2020 2020 2920 2d3e 2067 6461 6c2e  ..    ) -> gdal.
+00011cd0: 4461 7461 7365 743a 0d0a 2020 2020 2020  Dataset:..      
+00011ce0: 2020 2222 226d 6174 6368 5261 7374 6572    """matchRaster
+00011cf0: 416c 6967 6e6d 656e 742e 0d0a 0d0a 2020  Alignment.....  
+00011d00: 2020 2020 2020 6d61 7463 6852 6173 7465        matchRaste
+00011d10: 7241 6c69 676e 6d65 6e74 206d 6574 686f  rAlignment metho
+00011d20: 6420 636f 7069 6573 2074 6865 2066 6f6c  d copies the fol
+00011d30: 6c6f 7769 6e67 2064 6174 610d 0a20 2020  lowing data..   
+00011d40: 2020 2020 2020 2020 202d 2054 6865 2063           - The c
+00011d50: 6f6f 7264 696e 6174 6520 7379 7374 656d  oordinate system
+00011d60: 0d0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
+00011d70: 5468 6520 6e75 6d62 6572 206f 6620 6f66  The number of of
+00011d80: 2072 6f77 7320 2620 636f 6c75 6d6e 730d   rows & columns.
+00011d90: 0a20 2020 2020 2020 2020 2020 202d 2063  .            - c
+00011da0: 656c 6c20 7369 7a65 0d0a 2020 2020 2020  ell size..      
+00011db0: 2020 6672 6f6d 2061 6c69 676e 6d65 6e74    from alignment
+00011dc0: 5f73 7263 2074 6f20 6120 6461 7461 5f73  _src to a data_s
+00011dd0: 7263 2072 6173 7465 7220 2874 6865 2073  rc raster (the s
+00011de0: 6f75 7263 6520 6f66 2064 6174 6120 7661  ource of data va
+00011df0: 6c75 6573 2069 6e20 6365 6c6c 7329 0d0a  lues in cells)..
+00011e00: 0d0a 2020 2020 2020 2020 7468 6520 7265  ..        the re
+00011e10: 7375 6c74 2077 696c 6c20 6265 2061 2072  sult will be a r
+00011e20: 6173 7465 7220 7769 7468 2074 6865 2073  aster with the s
+00011e30: 616d 6520 7374 7275 6374 7572 6520 6c69  ame structure li
+00011e40: 6b65 2061 6c69 676e 6d65 6e74 5f73 7263  ke alignment_src
+00011e50: 2062 7574 2077 6974 680d 0a20 2020 2020   but with..     
+00011e60: 2020 2076 616c 7565 7320 6672 6f6d 2064     values from d
+00011e70: 6174 615f 7372 6320 7573 696e 6720 4e65  ata_src using Ne
+00011e80: 6172 6573 7420 4e65 6967 6862 6f75 7220  arest Neighbour 
+00011e90: 696e 7465 7270 6f6c 6174 696f 6e20 616c  interpolation al
+00011ea0: 676f 7269 7468 6d0d 0a0d 0a20 2020 2020  gorithm....     
+00011eb0: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
+00011ec0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00011ed0: 2d0d 0a20 2020 2020 2020 2061 6c69 676e  -..        align
+00011ee0: 6d65 6e74 5f73 7263 203a 205b 6764 616c  ment_src : [gdal
+00011ef0: 2e64 6174 6173 6574 2f73 7472 696e 675d  .dataset/string]
+00011f00: 0d0a 2020 2020 2020 2020 2020 2020 7370  ..            sp
+00011f10: 6174 6961 6c20 696e 666f 726d 6174 696f  atial informatio
+00011f20: 6e20 736f 7572 6365 2072 6173 7465 7220  n source raster 
+00011f30: 746f 2067 6574 2074 6865 2073 7061 7469  to get the spati
+00011f40: 616c 2069 6e66 6f72 6d61 7469 6f6e 0d0a  al information..
+00011f50: 2020 2020 2020 2020 2020 2020 2863 6f6f              (coo
+00011f60: 7264 696e 6174 6520 7379 7374 656d 2c20  rdinate system, 
+00011f70: 6e6f 206f 6620 726f 7773 2026 2063 6f6c  no of rows & col
+00011f80: 756d 6e73 290d 0a20 2020 2020 2020 2020  umns)..         
+00011f90: 2020 2064 6174 6120 7661 6c75 6573 2073     data values s
+00011fa0: 6f75 7263 6520 7261 7374 6572 2074 6f20  ource raster to 
+00011fb0: 6765 7420 7468 6520 6461 7461 2028 7661  get the data (va
+00011fc0: 6c75 6573 206f 6620 6561 6368 2063 656c  lues of each cel
+00011fd0: 6c29 0d0a 0d0a 2020 2020 2020 2020 5265  l)....        Re
+00011fe0: 7475 726e 730d 0a20 2020 2020 2020 202d  turns..        -
+00011ff0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+00012000: 6473 7420 3a20 5b52 6173 7465 725d 0d0a  dst : [Raster]..
+00012010: 2020 2020 2020 2020 2020 2020 5261 7374              Rast
+00012020: 6572 206f 626a 6563 740d 0a0d 0a20 2020  er object....   
+00012030: 2020 2020 2045 7861 6d70 6c65 730d 0a20       Examples.. 
+00012040: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0d         --------.
+00012050: 0a20 2020 2020 2020 203e 3e3e 2041 203d  .        >>> A =
+00012060: 2067 6461 6c2e 4f70 656e 2822 6578 616d   gdal.Open("exam
+00012070: 706c 6573 2f47 4953 2f64 6174 612f 6163  ples/GIS/data/ac
+00012080: 6334 3030 302e 7469 6622 290d 0a20 2020  c4000.tif")..   
+00012090: 2020 2020 203e 3e3e 2042 203d 2067 6461       >>> B = gda
+000120a0: 6c2e 4f70 656e 2822 6578 616d 706c 6573  l.Open("examples
+000120b0: 2f47 4953 2f64 6174 612f 736f 696c 5f72  /GIS/data/soil_r
+000120c0: 6173 7465 722e 7469 6622 290d 0a20 2020  aster.tif")..   
+000120d0: 2020 2020 203e 3e3e 2052 6173 7465 7242       >>> RasterB
+000120e0: 4d61 7463 6865 6420 3d20 4461 7461 7365  Matched = Datase
+000120f0: 742e 616c 6967 6e28 412c 4229 0d0a 2020  t.align(A,B)..  
+00012100: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+00012110: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00012120: 2861 6c69 676e 6d65 6e74 5f73 7263 2c20  (alignment_src, 
+00012130: 4461 7461 7365 7429 3a0d 0a20 2020 2020  Dataset):..     
+00012140: 2020 2020 2020 2073 7263 203d 2061 6c69         src = ali
+00012150: 676e 6d65 6e74 5f73 7263 0d0a 2020 2020  gnment_src..    
+00012160: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
+00012170: 6e63 6528 616c 6967 6e6d 656e 745f 7372  nce(alignment_sr
+00012180: 632c 2073 7472 293a 0d0a 2020 2020 2020  c, str):..      
+00012190: 2020 2020 2020 7372 6320 3d20 4461 7461        src = Data
+000121a0: 7365 742e 7265 6164 5f66 696c 6528 616c  set.read_file(al
+000121b0: 6967 6e6d 656e 745f 7372 6329 0d0a 2020  ignment_src)..  
+000121c0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+000121d0: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
+000121e0: 7970 6545 7272 6f72 280d 0a20 2020 2020  ypeError(..     
+000121f0: 2020 2020 2020 2020 2020 2022 4669 7273             "Firs
+00012200: 7420 7061 7261 6d65 7465 7220 7368 6f75  t parameter shou
+00012210: 6c64 2062 6520 6120 4461 7461 7365 7420  ld be a Dataset 
+00012220: 7265 6164 2075 7369 6e67 2044 6174 6173  read using Datas
+00012230: 6574 2e6f 7065 6e52 6173 7465 7220 6f72  et.openRaster or
+00012240: 2061 2070 6174 6820 746f 2074 6865 2072   a path to the r
+00012250: 6173 7465 722c 2022 0d0a 2020 2020 2020  aster, "..      
+00012260: 2020 2020 2020 2020 2020 6622 6769 7665            f"give
+00012270: 6e20 7b74 7970 6528 616c 6967 6e6d 656e  n {type(alignmen
+00012280: 745f 7372 6329 7d22 0d0a 2020 2020 2020  t_src)}"..      
+00012290: 2020 2020 2020 290d 0a0d 0a20 2020 2020        )....     
+000122a0: 2020 2023 2072 6570 726f 6a65 6374 2074     # reproject t
+000122b0: 6865 2072 6173 7465 7220 746f 206d 6174  he raster to mat
+000122c0: 6368 2074 6865 2070 726f 6a65 6374 696f  ch the projectio
+000122d0: 6e20 6f66 2061 6c69 676e 6d65 6e74 5f73  n of alignment_s
+000122e0: 7263 0d0a 2020 2020 2020 2020 7265 7072  rc..        repr
+000122f0: 6f6a 6563 7465 645f 5261 7374 6572 4220  ojected_RasterB 
+00012300: 3d20 7365 6c66 2e74 6f5f 6372 7328 7372  = self.to_crs(sr
+00012310: 632e 6570 7367 290d 0a20 2020 2020 2020  c.epsg)..       
+00012320: 2023 2063 7265 6174 6520 6120 6e65 7720   # create a new 
+00012330: 7261 7374 6572 0d0a 2020 2020 2020 2020  raster..        
+00012340: 6473 7420 3d20 4461 7461 7365 742e 5f63  dst = Dataset._c
+00012350: 7265 6174 655f 6764 616c 5f64 6174 6173  reate_gdal_datas
+00012360: 6574 280d 0a20 2020 2020 2020 2020 2020  et(..           
+00012370: 2073 7263 2e63 6f6c 756d 6e73 2c20 7372   src.columns, sr
+00012380: 632e 726f 7773 2c20 312c 2073 7263 2e64  c.rows, 1, src.d
+00012390: 7479 7065 5b30 5d2c 2064 7269 7665 723d  type[0], driver=
+000123a0: 224d 454d 220d 0a20 2020 2020 2020 2029  "MEM"..        )
+000123b0: 0d0a 2020 2020 2020 2020 2320 7365 7420  ..        # set 
+000123c0: 7468 6520 6765 6f74 7261 6e73 666f 726d  the geotransform
+000123d0: 0d0a 2020 2020 2020 2020 6473 742e 5365  ..        dst.Se
+000123e0: 7447 656f 5472 616e 7366 6f72 6d28 7372  tGeoTransform(sr
+000123f0: 632e 6765 6f74 7261 6e73 666f 726d 290d  c.geotransform).
+00012400: 0a20 2020 2020 2020 2023 2073 6574 2074  .        # set t
+00012410: 6865 2070 726f 6a65 6374 696f 6e0d 0a20  he projection.. 
+00012420: 2020 2020 2020 2064 7374 2e53 6574 5072         dst.SetPr
+00012430: 6f6a 6563 7469 6f6e 2873 7263 2e63 7273  ojection(src.crs
+00012440: 290d 0a20 2020 2020 2020 2023 2073 6574  )..        # set
+00012450: 2074 6865 206e 6f20 6461 7461 2076 616c   the no data val
+00012460: 7565 0d0a 2020 2020 2020 2020 6473 745f  ue..        dst_
+00012470: 6f62 6a20 3d20 4461 7461 7365 7428 6473  obj = Dataset(ds
+00012480: 7429 0d0a 2020 2020 2020 2020 6473 745f  t)..        dst_
+00012490: 6f62 6a2e 5f73 6574 5f6e 6f5f 6461 7461  obj._set_no_data
+000124a0: 5f76 616c 7565 2873 7263 2e6e 6f5f 6461  _value(src.no_da
+000124b0: 7461 5f76 616c 7565 5b30 5d29 0d0a 2020  ta_value[0])..  
+000124c0: 2020 2020 2020 2320 7065 7266 6f72 6d20        # perform 
+000124d0: 7468 6520 7072 6f6a 6563 7469 6f6e 2026  the projection &
+000124e0: 2072 6573 616d 706c 696e 670d 0a20 2020   resampling..   
+000124f0: 2020 2020 206d 6574 686f 6420 3d20 6764       method = gd
+00012500: 616c 2e47 5241 5f4e 6561 7265 7374 4e65  al.GRA_NearestNe
+00012510: 6967 6862 6f75 720d 0a20 2020 2020 2020  ighbour..       
+00012520: 2023 2072 6573 616d 706c 6520 7468 6520   # resample the 
+00012530: 7265 7072 6f6a 6563 7465 645f 5261 7374  reprojected_Rast
+00012540: 6572 420d 0a20 2020 2020 2020 2067 6461  erB..        gda
+00012550: 6c2e 5265 7072 6f6a 6563 7449 6d61 6765  l.ReprojectImage
+00012560: 280d 0a20 2020 2020 2020 2020 2020 2072  (..            r
+00012570: 6570 726f 6a65 6374 6564 5f52 6173 7465  eprojected_Raste
+00012580: 7242 2e72 6173 7465 722c 0d0a 2020 2020  rB.raster,..    
+00012590: 2020 2020 2020 2020 6473 745f 6f62 6a2e          dst_obj.
+000125a0: 7261 7374 6572 2c0d 0a20 2020 2020 2020  raster,..       
+000125b0: 2020 2020 2073 7263 2e63 7273 2c0d 0a20       src.crs,.. 
+000125c0: 2020 2020 2020 2020 2020 2073 7263 2e63             src.c
+000125d0: 7273 2c0d 0a20 2020 2020 2020 2020 2020  rs,..           
+000125e0: 206d 6574 686f 642c 0d0a 2020 2020 2020   method,..      
+000125f0: 2020 290d 0a0d 0a20 2020 2020 2020 2072    )....        r
+00012600: 6574 7572 6e20 6473 745f 6f62 6a0d 0a0d  eturn dst_obj...
+00012610: 0a20 2020 2064 6566 205f 6372 6f70 5f77  .    def _crop_w
+00012620: 6974 685f 7261 7374 6572 280d 0a20 2020  ith_raster(..   
+00012630: 2020 2020 2073 656c 662c 0d0a 2020 2020       self,..    
+00012640: 2020 2020 6d61 736b 3a20 556e 696f 6e5b      mask: Union[
+00012650: 6764 616c 2e44 6174 6173 6574 2c20 7374  gdal.Dataset, st
+00012660: 725d 2c0d 0a20 2020 2029 202d 3e20 6764  r],..    ) -> gd
+00012670: 616c 2e44 6174 6173 6574 3a0d 0a20 2020  al.Dataset:..   
+00012680: 2020 2020 2022 2222 6372 6f70 2e0d 0a0d       """crop....
+00012690: 0a20 2020 2020 2020 2020 2020 2063 726f  .            cro
+000126a0: 7020 6d65 7468 6f64 2063 726f 7073 2061  p method crops a
+000126b0: 2072 6173 7465 7220 7573 696e 6720 616e   raster using an
+000126c0: 6f74 6865 7220 7261 7374 6572 2028 626f  other raster (bo
+000126d0: 7468 2072 6173 7465 7273 2064 6f65 7320  th rasters does 
+000126e0: 6e6f 7420 6861 7665 2074 6f20 6265 2061  not have to be a
+000126f0: 6c69 676e 6564 292e 0d0a 0d0a 2020 2020  ligned).....    
+00012700: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
+00012710: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00012720: 2d2d 2d0d 0a20 2020 2020 2020 206d 6173  ---..        mas
+00012730: 6b20 3a20 5b73 7472 696e 672f 4461 7461  k : [string/Data
+00012740: 7365 745d 0d0a 2020 2020 2020 2020 2020  set]..          
+00012750: 2020 7468 6520 7261 7374 6572 2079 6f75    the raster you
+00012760: 2077 616e 7420 746f 2075 7365 2061 7320   want to use as 
+00012770: 6120 6d61 736b 2074 6f20 6372 6f70 206f  a mask to crop o
+00012780: 7468 6572 2072 6173 7465 722c 0d0a 2020  ther raster,..  
+00012790: 2020 2020 2020 2020 2020 7468 6520 6d61            the ma
+000127a0: 736b 2063 616e 2062 6520 616c 736f 2061  sk can be also a
+000127b0: 2070 6174 6820 6f72 2061 2067 6461 6c20   path or a gdal 
+000127c0: 6f62 6a65 6374 2e0d 0a0d 0a20 2020 2020  object.....     
+000127d0: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
+000127e0: 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020      -------..   
+000127f0: 2020 2020 2064 7374 203a 205b 4461 7461       dst : [Data
+00012800: 7365 745d 0d0a 2020 2020 2020 2020 2020  set]..          
+00012810: 2020 7468 6520 6372 6f70 7065 6420 7261    the cropped ra
+00012820: 7374 6572 2077 696c 6c20 6265 2072 6574  ster will be ret
+00012830: 7572 6e65 642c 2069 6620 7468 6520 7361  urned, if the sa
+00012840: 7665 2070 6172 616d 6574 6572 2077 6173  ve parameter was
+00012850: 2054 7275 652c 0d0a 2020 2020 2020 2020   True,..        
+00012860: 2020 2020 7468 6520 6372 6f70 7065 6420      the cropped 
+00012870: 7261 7374 6572 2077 696c 6c20 616c 736f  raster will also
+00012880: 2062 6520 7361 7665 6420 746f 2064 6973   be saved to dis
+00012890: 6b20 696e 2074 6865 204f 7574 7075 7450  k in the OutputP
+000128a0: 6174 680d 0a20 2020 2020 2020 2020 2020  ath..           
+000128b0: 2064 6972 6563 746f 7279 2e0d 0a20 2020   directory...   
+000128c0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+000128d0: 2020 2320 6765 7420 696e 666f 726d 6174    # get informat
+000128e0: 696f 6e20 6672 6f6d 2074 6865 206d 6173  ion from the mas
+000128f0: 6b20 7261 7374 6572 0d0a 2020 2020 2020  k raster..      
+00012900: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00012910: 6d61 736b 2c20 7374 7229 3a0d 0a20 2020  mask, str):..   
+00012920: 2020 2020 2020 2020 206d 6173 6b20 3d20           mask = 
+00012930: 4461 7461 7365 742e 7265 6164 5f66 696c  Dataset.read_fil
+00012940: 6528 6d61 736b 290d 0a20 2020 2020 2020  e(mask)..       
+00012950: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
+00012960: 286d 6173 6b2c 2044 6174 6173 6574 293a  (mask, Dataset):
+00012970: 0d0a 2020 2020 2020 2020 2020 2020 6d61  ..            ma
+00012980: 736b 203d 206d 6173 6b0d 0a20 2020 2020  sk = mask..     
+00012990: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+000129a0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
+000129b0: 4572 726f 7228 0d0a 2020 2020 2020 2020  Error(..        
+000129c0: 2020 2020 2020 2020 2253 6563 6f6e 6420          "Second 
+000129d0: 7061 7261 6d65 7465 7220 6861 7320 746f  parameter has to
+000129e0: 2062 6520 6569 7468 6572 2070 6174 6820   be either path 
+000129f0: 746f 2074 6865 206d 6173 6b20 7261 7374  to the mask rast
+00012a00: 6572 206f 7220 6120 6764 616c 2e44 6174  er or a gdal.Dat
+00012a10: 6163 7562 6520 6f62 6a65 6374 220d 0a20  acube object".. 
+00012a20: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
+00012a30: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
+00012a40: 662e 5f63 6865 636b 5f61 6c69 676e 6d65  f._check_alignme
+00012a50: 6e74 286d 6173 6b29 3a0d 0a20 2020 2020  nt(mask):..     
+00012a60: 2020 2020 2020 2023 2066 6972 7374 2061         # first a
+00012a70: 6c69 676e 2074 6865 206d 6173 6b20 7769  lign the mask wi
+00012a80: 7468 2074 6865 2073 7263 2072 6173 7465  th the src raste
+00012a90: 720d 0a20 2020 2020 2020 2020 2020 206d  r..            m
+00012aa0: 6173 6b20 3d20 6d61 736b 2e61 6c69 676e  ask = mask.align
+00012ab0: 2873 656c 6629 0d0a 2020 2020 2020 2020  (self)..        
+00012ac0: 2320 6372 6f70 2074 6865 2073 7263 2072  # crop the src r
+00012ad0: 6173 7465 7220 7769 7468 2074 6865 2061  aster with the a
+00012ae0: 6c69 676e 6564 206d 6173 6b0d 0a20 2020  ligned mask..   
+00012af0: 2020 2020 2064 7374 5f6f 626a 203d 2073       dst_obj = s
+00012b00: 656c 662e 5f63 726f 705f 616c 6c69 676e  elf._crop_allign
+00012b10: 6564 286d 6173 6b29 0d0a 0d0a 2020 2020  ed(mask)....    
+00012b20: 2020 2020 7265 7475 726e 2064 7374 5f6f      return dst_o
+00012b30: 626a 0d0a 0d0a 2020 2020 6465 6620 5f63  bj....    def _c
+00012b40: 726f 705f 7769 7468 5f70 6f6c 7967 6f6e  rop_with_polygon
+00012b50: 2873 656c 662c 2070 6f6c 793a 2047 656f  (self, poly: Geo
+00012b60: 4461 7461 4672 616d 6529 3a0d 0a20 2020  DataFrame):..   
+00012b70: 2020 2020 2022 2222 6372 6f70 5769 7468       """cropWith
+00012b80: 506f 6c79 676f 6e2e 0d0a 0d0a 2020 2020  Polygon.....    
+00012b90: 2020 2020 2020 2020 636c 6970 2074 6865          clip the
+00012ba0: 2052 6173 7465 7220 6f62 6a65 6374 2075   Raster object u
+00012bb0: 7369 6e67 2061 2070 6f6c 7967 6f6e 2076  sing a polygon v
+00012bc0: 6563 746f 722e 0d0a 0d0a 2020 2020 2020  ector.....      
+00012bd0: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
+00012be0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00012bf0: 0d0a 2020 2020 2020 2020 706f 6c79 3a20  ..        poly: 
+00012c00: 5b50 6f6c 7967 6f6e 2047 656f 4461 7461  [Polygon GeoData
+00012c10: 4672 616d 655d 0d0a 2020 2020 2020 2020  Frame]..        
+00012c20: 2020 2020 4765 6f64 6174 6146 7261 6d65      GeodataFrame
+00012c30: 2077 6974 6820 6120 6765 6f6d 6574 7279   with a geometry
+00012c40: 206f 6620 706f 6c79 676f 6e20 7479 7065   of polygon type
+00012c50: 2e0d 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
+00012c60: 6e73 0d0a 2020 2020 2020 2020 2d2d 2d2d  ns..        ----
+00012c70: 2d2d 2d0d 0a20 2020 2020 2020 2044 6174  ---..        Dat
+00012c80: 6173 6574 0d0a 2020 2020 2020 2020 2222  aset..        ""
+00012c90: 220d 0a20 2020 2020 2020 2069 6620 6e6f  "..        if no
+00012ca0: 7420 6973 696e 7374 616e 6365 2870 6f6c  t isinstance(pol
+00012cb0: 792c 2047 656f 4461 7461 4672 616d 6529  y, GeoDataFrame)
+00012cc0: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
+00012cd0: 6169 7365 2054 7970 6545 7272 6f72 280d  aise TypeError(.
+00012ce0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012cf0: 2022 5468 6520 7365 636f 6e64 2070 6172   "The second par
+00012d00: 616d 6574 6572 3a20 706f 6c79 2073 686f  ameter: poly sho
+00012d10: 756c 6420 6265 206f 6620 7479 7065 2047  uld be of type G
+00012d20: 656f 4461 7461 4672 616d 6520 220d 0a20  eoDataFrame ".. 
+00012d30: 2020 2020 2020 2020 2020 2029 0d0a 0d0a             )....
+00012d40: 2020 2020 2020 2020 706f 6c79 5f65 7073          poly_eps
+00012d50: 6720 3d20 706f 6c79 2e63 7273 2e74 6f5f  g = poly.crs.to_
+00012d60: 6570 7367 2829 0d0a 2020 2020 2020 2020  epsg()..        
+00012d70: 7372 635f 6570 7367 203d 2073 656c 662e  src_epsg = self.
+00012d80: 6570 7367 0d0a 2020 2020 2020 2020 6966  epsg..        if
+00012d90: 2070 6f6c 795f 6570 7367 2021 3d20 7372   poly_epsg != sr
+00012da0: 635f 6570 7367 3a0d 0a20 2020 2020 2020  c_epsg:..       
+00012db0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+00012dc0: 4572 726f 7228 0d0a 2020 2020 2020 2020  Error(..        
+00012dd0: 2020 2020 2020 2020 2250 726f 6a65 6374          "Project
+00012de0: 696f 6e20 4572 726f 723a 2074 6865 2072  ion Error: the r
+00012df0: 6173 7465 7220 616e 6420 7665 6374 6f72  aster and vector
+00012e00: 2070 6f6c 7967 6f6e 2068 6176 6520 6469   polygon have di
+00012e10: 6666 6572 656e 7420 7072 6f6a 6563 7469  fferent projecti
+00012e20: 6f6e 2070 6c65 6173 6520 220d 0a20 2020  on please "..   
+00012e30: 2020 2020 2020 2020 2020 2020 2022 756e               "un
+00012e40: 6966 7920 7072 6f6a 6563 7469 6f6e 220d  ify projection".
+00012e50: 0a20 2020 2020 2020 2020 2020 2029 0d0a  .            )..
+00012e60: 2020 2020 2020 2020 7665 6374 6f72 203d          vector =
+00012e70: 2046 6561 7475 7265 436f 6c6c 6563 7469   FeatureCollecti
+00012e80: 6f6e 2870 6f6c 7929 0d0a 2020 2020 2020  on(poly)..      
+00012e90: 2020 6d61 736b 203d 2076 6563 746f 722e    mask = vector.
+00012ea0: 746f 5f64 6174 6173 6574 2864 6174 6173  to_dataset(datas
+00012eb0: 6574 3d73 656c 6629 0d0a 2020 2020 2020  et=self)..      
+00012ec0: 2020 6372 6f70 7065 645f 6f62 6a20 3d20    cropped_obj = 
+00012ed0: 7365 6c66 2e5f 6372 6f70 5f77 6974 685f  self._crop_with_
+00012ee0: 7261 7374 6572 286d 6173 6b29 0d0a 0d0a  raster(mask)....
+00012ef0: 2020 2020 2020 2020 2320 786d 696e 2c20          # xmin, 
+00012f00: 796d 696e 2c20 786d 6178 2c20 796d 6178  ymin, xmax, ymax
+00012f10: 203d 2070 6f6c 792e 626f 756e 6473 2e76   = poly.bounds.v
+00012f20: 616c 7565 732e 746f 6c69 7374 2829 5b30  alues.tolist()[0
+00012f30: 5d0d 0a20 2020 2020 2020 2023 2077 696e  ]..        # win
+00012f40: 646f 7720 3d20 2878 6d69 6e2c 2079 6d61  dow = (xmin, yma
+00012f50: 782c 2078 6d61 782c 2079 6d69 6e29 0d0a  x, xmax, ymin)..
+00012f60: 2020 2020 2020 2020 2320 2320 6764 616c          # # gdal
+00012f70: 2e54 7261 6e73 6c61 7465 4f70 7469 6f6e  .TranslateOption
+00012f80: 7328 6473 742c 2073 732c 2070 726f 6a57  s(dst, ss, projW
+00012f90: 696e 3d77 696e 646f 7729 0d0a 2020 2020  in=window)..    
+00012fa0: 2020 2020 2320 2320 636f 7079 2074 6865      # # copy the
+00012fb0: 2073 7263 2072 6173 7465 720d 0a20 2020   src raster..   
+00012fc0: 2020 2020 2023 2064 7276 203d 2067 6461       # drv = gda
+00012fd0: 6c2e 4765 7444 7269 7665 7242 794e 616d  l.GetDriverByNam
+00012fe0: 6528 224d 454d 2229 0d0a 2020 2020 2020  e("MEM")..      
+00012ff0: 2020 2320 6473 7420 3d20 6472 762e 4372    # dst = drv.Cr
+00013000: 6561 7465 436f 7079 2822 222c 2073 656c  eateCopy("", sel
+00013010: 662e 7261 7374 6572 2c20 3029 0d0a 2020  f.raster, 0)..  
+00013020: 2020 2020 2020 2320 7472 793a 0d0a 2020        # try:..  
+00013030: 2020 2020 2020 2320 2020 2020 6764 616c        #     gdal
+00013040: 2e54 7261 6e73 6c61 7465 2864 7374 2c20  .Translate(dst, 
+00013050: 7365 6c66 2e72 6173 7465 722c 2070 726f  self.raster, pro
+00013060: 6a57 696e 3d77 696e 646f 7729 0d0a 2020  jWin=window)..  
+00013070: 2020 2020 2020 2320 6578 6365 7074 2052        # except R
+00013080: 756e 7469 6d65 4572 726f 723a 0d0a 2020  untimeError:..  
+00013090: 2020 2020 2020 2320 2020 2020 7061 7373        #     pass
+000130a0: 0d0a 0d0a 2020 2020 2020 2020 2320 6372  ....        # cr
+000130b0: 6f70 7065 645f 6f62 6a20 3d20 4461 7461  opped_obj = Data
+000130c0: 7365 7428 6473 7429 0d0a 0d0a 2020 2020  set(dst)....    
+000130d0: 2020 2020 7265 7475 726e 2063 726f 7070      return cropp
+000130e0: 6564 5f6f 626a 0d0a 0d0a 2020 2020 6465  ed_obj....    de
+000130f0: 6620 6372 6f70 2873 656c 662c 206d 6173  f crop(self, mas
+00013100: 6b3a 2055 6e69 6f6e 5b47 656f 4461 7461  k: Union[GeoData
+00013110: 4672 616d 655d 293a 0d0a 2020 2020 2020  Frame]):..      
+00013120: 2020 2222 220d 0a0d 0a20 2020 2020 2020    """....       
+00013130: 2020 2020 2063 6c69 7020 7468 6520 4461       clip the Da
+00013140: 7461 7365 7420 6f62 6a65 6374 2075 7369  taset object usi
+00013150: 6e67 2061 2070 6f6c 7967 6f6e 2f61 6e6f  ng a polygon/ano
+00013160: 7468 6572 2072 6173 7465 7220 2862 6f74  ther raster (bot
+00013170: 6820 7261 7374 6572 7320 646f 6573 206e  h rasters does n
+00013180: 6f74 2068 6176 6520 746f 2062 6520 616c  ot have to be al
+00013190: 6967 6e65 6429 2e0d 0a0d 0a20 2020 2020  igned).....     
+000131a0: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
+000131b0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+000131c0: 2d0d 0a20 2020 2020 2020 206d 6173 6b3a  -..        mask:
+000131d0: 205b 506f 6c79 676f 6e20 4765 6f44 6174   [Polygon GeoDat
+000131e0: 6146 7261 6d65 2f44 6174 6173 6574 206f  aFrame/Dataset o
+000131f0: 626a 6563 745d 0d0a 2020 2020 2020 2020  bject]..        
+00013200: 2020 2020 4765 6f64 6174 6146 7261 6d65      GeodataFrame
+00013210: 2077 6974 6820 6120 6765 6f6d 6574 7279   with a geometry
+00013220: 206f 6620 706f 6c79 676f 6e20 7479 7065   of polygon type
+00013230: 0d0a 0d0a 2020 2020 2020 2020 5265 7475  ....        Retu
+00013240: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
+00013250: 2d2d 2d2d 0d0a 2020 2020 2020 2020 4461  ----..        Da
+00013260: 7461 7365 7420 4f62 6a65 6374 0d0a 2020  taset Object..  
+00013270: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+00013280: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00013290: 286d 6173 6b2c 2047 656f 4461 7461 4672  (mask, GeoDataFr
+000132a0: 616d 6529 3a0d 0a20 2020 2020 2020 2020  ame):..         
+000132b0: 2020 2064 7374 203d 2073 656c 662e 5f63     dst = self._c
+000132c0: 726f 705f 7769 7468 5f70 6f6c 7967 6f6e  rop_with_polygon
+000132d0: 286d 6173 6b29 0d0a 2020 2020 2020 2020  (mask)..        
+000132e0: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
+000132f0: 6d61 736b 2c20 4461 7461 7365 7429 3a0d  mask, Dataset):.
+00013300: 0a20 2020 2020 2020 2020 2020 2064 7374  .            dst
+00013310: 203d 2073 656c 662e 5f63 726f 705f 7769   = self._crop_wi
+00013320: 7468 5f72 6173 7465 7228 6d61 736b 290d  th_raster(mask).
+00013330: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+00013340: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00013350: 6520 5479 7065 4572 726f 7228 0d0a 2020  e TypeError(..  
+00013360: 2020 2020 2020 2020 2020 2020 2020 2254                "T
+00013370: 6865 2073 6563 6f6e 6420 7061 7261 6d65  he second parame
+00013380: 7465 723a 206d 6173 6b20 636f 756c 6420  ter: mask could 
+00013390: 6265 2065 6974 6865 7220 4765 6f44 6174  be either GeoDat
+000133a0: 6146 7261 6d65 206f 7220 4461 7461 7365  aFrame or Datase
+000133b0: 7420 6f62 6a65 6374 220d 0a20 2020 2020  t object"..     
+000133c0: 2020 2020 2020 2029 0d0a 0d0a 2020 2020         )....    
+000133d0: 2020 2020 7265 7475 726e 2064 7374 0d0a      return dst..
+000133e0: 0d0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
+000133f0: 686f 640d 0a20 2020 2064 6566 205f 6e65  hod..    def _ne
+00013400: 6172 6573 745f 6e65 6967 6862 6f75 7228  arest_neighbour(
+00013410: 0d0a 2020 2020 2020 2020 6172 7261 793a  ..        array:
+00013420: 206e 702e 6e64 6172 7261 792c 206e 6f64   np.ndarray, nod
+00013430: 6174 6176 616c 7565 3a20 556e 696f 6e5b  atavalue: Union[
+00013440: 666c 6f61 742c 2069 6e74 5d2c 2072 6f77  float, int], row
+00013450: 733a 206c 6973 742c 2063 6f6c 733a 206c  s: list, cols: l
+00013460: 6973 740d 0a20 2020 2029 202d 3e20 6e70  ist..    ) -> np
+00013470: 2e6e 6461 7272 6179 3a0d 0a20 2020 2020  .ndarray:..     
+00013480: 2020 2022 2222 6e65 6172 6573 744e 6569     """nearestNei
+00013490: 6768 626f 7572 2e0d 0a0d 0a20 2020 2020  ghbour.....     
+000134a0: 2020 2020 2020 202d 2066 696c 6c73 2074         - fills t
+000134b0: 6865 2063 656c 6c73 206f 6620 6120 6769  he cells of a gi
+000134c0: 7665 6e20 696e 6469 6365 7320 696e 2072  ven indices in r
+000134d0: 6f77 7320 616e 6420 636f 6c73 2077 6974  ows and cols wit
+000134e0: 6820 7468 6520 7661 6c75 6520 6f66 2074  h the value of t
+000134f0: 6865 206e 6561 7265 7374 0d0a 2020 2020  he nearest..    
+00013500: 2020 2020 2020 2020 6e65 6967 6862 6f75          neighbou
+00013510: 722e 0d0a 2020 2020 2020 2020 2020 2020  r...            
+00013520: 2d20 5373 2074 6865 2072 6173 7465 7220  - Ss the raster 
+00013530: 6772 6964 2069 7320 7371 7561 7265 2073  grid is square s
+00013540: 6f20 7468 6520 3420 7065 7270 656e 6469  o the 4 perpendi
+00013550: 6375 6c61 7220 6469 7265 6374 696f 6e20  cular direction 
+00013560: 6172 6520 6f66 2074 6865 2073 616d 6520  are of the same 
+00013570: 7072 6f78 696d 6974 7920 736f 2074 6865  proximity so the
+00013580: 2066 756e 6374 696f 6e0d 0a20 2020 2020   function..     
+00013590: 2020 2020 2020 2067 6976 6573 2070 7269         gives pri
+000135a0: 6f72 6974 7920 746f 2074 6865 2072 6967  ority to the rig
+000135b0: 6874 2074 6865 6e20 6c65 6674 2074 6865  ht then left the
+000135c0: 6e20 626f 7474 6f6d 2074 6865 6e20 746f  n bottom then to
+000135d0: 7020 616e 6420 7468 6520 7361 6d65 2066  p and the same f
+000135e0: 6f72 2034 3520 6465 6772 6565 2069 6e63  or 45 degree inc
+000135f0: 6c69 6e65 6420 6469 7265 6374 696f 6e0d  lined direction.
+00013600: 0a20 2020 2020 2020 2020 2020 2072 6967  .            rig
+00013610: 6874 2062 6f74 746f 6d20 7468 656e 206c  ht bottom then l
+00013620: 6566 7420 626f 7474 6f6d 2074 6865 6e20  eft bottom then 
+00013630: 6c65 6674 2054 6f70 2074 6865 6e20 7269  left Top then ri
+00013640: 6768 7420 546f 702e 0d0a 0d0a 2020 2020  ght Top.....    
+00013650: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
+00013660: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00013670: 2d2d 0d0a 2020 2020 2020 2020 6172 7261  --..        arra
+00013680: 793a 205b 6e75 6d70 792e 6172 7261 795d  y: [numpy.array]
+00013690: 0d0a 2020 2020 2020 2020 2020 2020 4172  ..            Ar
+000136a0: 7261 7920 746f 2066 696c 6c20 736f 6d65  ray to fill some
+000136b0: 206f 6620 6974 7320 6365 6c6c 7320 7769   of its cells wi
+000136c0: 7468 204e 6561 7265 7374 2076 616c 7565  th Nearest value
+000136d0: 2e0d 0a20 2020 2020 2020 206e 6f64 6174  ...        nodat
+000136e0: 6176 616c 7565 3a20 5b66 6c6f 6174 3332  avalue: [float32
+000136f0: 5d0d 0a20 2020 2020 2020 2020 2020 2076  ]..            v
+00013700: 616c 7565 2073 746f 7265 6420 696e 2063  alue stored in c
+00013710: 656c 6c73 2074 6861 7420 6973 206f 7574  ells that is out
+00013720: 206f 6620 7468 6520 646f 6d61 696e 0d0a   of the domain..
+00013730: 2020 2020 2020 2020 726f 7773 3a20 5b4c          rows: [L
+00013740: 6973 745d 0d0a 2020 2020 2020 2020 2020  ist]..          
+00013750: 2020 6c69 7374 206f 6620 7468 6520 726f    list of the ro
+00013760: 7773 2069 6e64 6578 206f 6620 7468 6520  ws index of the 
+00013770: 6365 6c6c 7320 796f 7520 7761 6e74 2074  cells you want t
+00013780: 6f20 6669 6c6c 2069 7420 7769 7468 0d0a  o fill it with..
+00013790: 2020 2020 2020 2020 2020 2020 6e65 6172              near
+000137a0: 6573 7420 6e65 6967 6862 6f75 722e 0d0a  est neighbour...
+000137b0: 2020 2020 2020 2020 636f 6c73 3a20 5b4c          cols: [L
+000137c0: 6973 745d 0d0a 2020 2020 2020 2020 2020  ist]..          
+000137d0: 2020 6c69 7374 206f 6620 7468 6520 636f    list of the co
+000137e0: 6c75 6d6e 2069 6e64 6578 206f 6620 7468  lumn index of th
+000137f0: 6520 6365 6c6c 7320 796f 7520 7761 6e74  e cells you want
+00013800: 2074 6f20 6669 6c6c 2069 7420 7769 7468   to fill it with
+00013810: 0d0a 2020 2020 2020 2020 2020 2020 6e65  ..            ne
+00013820: 6172 6573 7420 6e65 6967 6862 6f75 722e  arest neighbour.
+00013830: 0d0a 0d0a 2020 2020 2020 2020 5265 7475  ....        Retu
+00013840: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
+00013850: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6172  ----..        ar
+00013860: 7261 793a 205b 6e75 6d70 7920 6172 7261  ray: [numpy arra
+00013870: 795d 0d0a 2020 2020 2020 2020 2020 2020  y]..            
+00013880: 4365 6c6c 7320 6f66 2067 6976 656e 2069  Cells of given i
+00013890: 6e64 6963 6573 2077 696c 6c20 6265 2066  ndices will be f
+000138a0: 696c 6c65 6420 7769 7468 2076 616c 7565  illed with value
+000138b0: 206f 6620 7468 6520 4e65 6172 6573 7420   of the Nearest 
+000138c0: 6e65 6967 6862 6f75 720d 0a0d 0a20 2020  neighbour....   
+000138d0: 2020 2020 2045 7861 6d70 6c65 730d 0a20       Examples.. 
+000138e0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0d         --------.
+000138f0: 0a20 2020 2020 2020 203e 3e3e 2072 6173  .        >>> ras
+00013900: 7465 7220 3d20 6764 616c 2e4f 7065 6e28  ter = gdal.Open(
+00013910: 2264 656d 2e74 6966 2229 0d0a 2020 2020  "dem.tif")..    
+00013920: 2020 2020 3e3e 3e20 7265 715f 726f 7773      >>> req_rows
+00013930: 203d 205b 332c 3132 5d0d 0a20 2020 2020   = [3,12]..     
+00013940: 2020 203e 3e3e 2072 6571 5f63 6f6c 7320     >>> req_cols 
+00013950: 3d20 5b39 2c32 5d0d 0a20 2020 2020 2020  = [9,2]..       
+00013960: 203e 3e3e 206e 6577 5f61 7272 6179 203d   >>> new_array =
+00013970: 2044 6174 6173 6574 2e5f 6e65 6172 6573   Dataset._neares
+00013980: 745f 6e65 6967 6862 6f75 7228 7261 7374  t_neighbour(rast
+00013990: 6572 2c20 7265 715f 726f 7773 2c20 7265  er, req_rows, re
+000139a0: 715f 636f 6c73 290d 0a20 2020 2020 2020  q_cols)..       
+000139b0: 2022 2222 0d0a 2020 2020 2020 2020 6966   """..        if
+000139c0: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+000139d0: 6172 7261 792c 206e 702e 6e64 6172 7261  array, np.ndarra
+000139e0: 7929 3a0d 0a20 2020 2020 2020 2020 2020  y):..           
+000139f0: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+00013a00: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+00013a10: 2020 2022 7372 6320 7368 6f75 6c64 2062     "src should b
+00013a20: 6520 7265 6164 2075 7369 6e67 2067 6461  e read using gda
+00013a30: 6c20 2867 6461 6c20 6461 7461 7365 7420  l (gdal dataset 
+00013a40: 706c 6561 7365 2072 6561 6420 6974 2075  please read it u
+00013a50: 7369 6e67 2067 6461 6c20 6c69 6272 6172  sing gdal librar
+00013a60: 7929 2022 0d0a 2020 2020 2020 2020 2020  y) "..          
+00013a70: 2020 290d 0a20 2020 2020 2020 2069 6620    )..        if 
+00013a80: 6e6f 7420 6973 696e 7374 616e 6365 2872  not isinstance(r
+00013a90: 6f77 732c 206c 6973 7429 3a0d 0a20 2020  ows, list):..   
+00013aa0: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
+00013ab0: 7970 6545 7272 6f72 2822 726f 7773 2069  ypeError("rows i
+00013ac0: 6e70 7574 2068 6173 2074 6f20 6265 206f  nput has to be o
+00013ad0: 6620 7479 7065 206c 6973 7422 290d 0a20  f type list").. 
+00013ae0: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
+00013af0: 696e 7374 616e 6365 2863 6f6c 732c 206c  instance(cols, l
+00013b00: 6973 7429 3a0d 0a20 2020 2020 2020 2020  ist):..         
+00013b10: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+00013b20: 6f72 2822 636f 6c73 2069 6e70 7574 2068  or("cols input h
+00013b30: 6173 2074 6f20 6265 206f 6620 7479 7065  as to be of type
+00013b40: 206c 6973 7422 290d 0a0d 0a20 2020 2020   list")....     
+00013b50: 2020 2023 2020 2020 6172 7261 793d 7261     #    array=ra
+00013b60: 7374 6572 2e52 6561 6441 7341 7272 6179  ster.ReadAsArray
+00013b70: 2829 0d0a 2020 2020 2020 2020 2320 2020  ()..        #   
+00013b80: 206e 6f64 6174 6176 616c 7565 3d6e 702e   nodatavalue=np.
+00013b90: 666c 6f61 7433 3228 7261 7374 6572 2e47  float32(raster.G
+00013ba0: 6574 5261 7374 6572 4261 6e64 2831 292e  etRasterBand(1).
+00013bb0: 4765 744e 6f44 6174 6156 616c 7565 2829  GetNoDataValue()
+00013bc0: 290d 0a0d 0a20 2020 2020 2020 206e 6f5f  )....        no_
+00013bd0: 726f 7773 203d 206e 702e 7368 6170 6528  rows = np.shape(
+00013be0: 6172 7261 7929 5b30 5d0d 0a20 2020 2020  array)[0]..     
+00013bf0: 2020 206e 6f5f 636f 6c73 203d 206e 702e     no_cols = np.
+00013c00: 7368 6170 6528 6172 7261 7929 5b31 5d0d  shape(array)[1].
+00013c10: 0a0d 0a20 2020 2020 2020 2066 6f72 2069  ...        for i
+00013c20: 2069 6e20 7261 6e67 6528 6c65 6e28 726f   in range(len(ro
+00013c30: 7773 2929 3a0d 0a20 2020 2020 2020 2020  ws)):..         
+00013c40: 2020 2023 2067 6976 6520 7468 6520 6365     # give the ce
+00013c50: 6c6c 2074 6865 2076 616c 7565 206f 6620  ll the value of 
+00013c60: 7468 6520 6365 6c6c 2074 6861 7420 6973  the cell that is
+00013c70: 2061 7420 7468 6520 7269 6768 740d 0a20   at the right.. 
+00013c80: 2020 2020 2020 2020 2020 2069 6620 6172             if ar
+00013c90: 7261 795b 726f 7773 5b69 5d2c 2063 6f6c  ray[rows[i], col
+00013ca0: 735b 695d 202b 2031 5d20 213d 206e 6f64  s[i] + 1] != nod
+00013cb0: 6174 6176 616c 7565 2061 6e64 2063 6f6c  atavalue and col
+00013cc0: 735b 695d 202b 2031 203c 3d20 6e6f 5f63  s[i] + 1 <= no_c
+00013cd0: 6f6c 733a 0d0a 2020 2020 2020 2020 2020  ols:..          
+00013ce0: 2020 2020 2020 6172 7261 795b 726f 7773        array[rows
+00013cf0: 5b69 5d2c 2063 6f6c 735b 695d 5d20 3d20  [i], cols[i]] = 
+00013d00: 6172 7261 795b 726f 7773 5b69 5d2c 2063  array[rows[i], c
+00013d10: 6f6c 735b 695d 202b 2031 5d0d 0a0d 0a20  ols[i] + 1].... 
+00013d20: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00013d30: 6172 7261 795b 726f 7773 5b69 5d2c 2063  array[rows[i], c
+00013d40: 6f6c 735b 695d 202d 2031 5d20 213d 206e  ols[i] - 1] != n
+00013d50: 6f64 6174 6176 616c 7565 2061 6e64 2063  odatavalue and c
+00013d60: 6f6c 735b 695d 202d 2031 203e 2030 3a0d  ols[i] - 1 > 0:.
+00013d70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013d80: 2023 2067 6976 6520 7468 6520 6365 6c6c   # give the cell
+00013d90: 2074 6865 2076 616c 7565 206f 6620 7468   the value of th
+00013da0: 6520 6365 6c6c 2074 6861 7420 6973 2061  e cell that is a
+00013db0: 7420 7468 6520 6c65 6674 0d0a 2020 2020  t the left..    
+00013dc0: 2020 2020 2020 2020 2020 2020 6172 7261              arra
+00013dd0: 795b 726f 7773 5b69 5d2c 2063 6f6c 735b  y[rows[i], cols[
+00013de0: 695d 5d20 3d20 6172 7261 795b 726f 7773  i]] = array[rows
+00013df0: 5b69 5d2c 2063 6f6c 735b 695d 202d 2031  [i], cols[i] - 1
+00013e00: 5d0d 0a0d 0a20 2020 2020 2020 2020 2020  ]....           
+00013e10: 2065 6c69 6620 6172 7261 795b 726f 7773   elif array[rows
+00013e20: 5b69 5d20 2d20 312c 2063 6f6c 735b 695d  [i] - 1, cols[i]
+00013e30: 5d20 213d 206e 6f64 6174 6176 616c 7565  ] != nodatavalue
+00013e40: 2061 6e64 2072 6f77 735b 695d 202d 2031   and rows[i] - 1
+00013e50: 203e 2030 3a0d 0a20 2020 2020 2020 2020   > 0:..         
+00013e60: 2020 2020 2020 2023 2067 6976 6520 7468         # give th
+00013e70: 6520 6365 6c6c 2074 6865 2076 616c 7565  e cell the value
+00013e80: 206f 6620 7468 6520 6365 6c6c 2074 6861   of the cell tha
+00013e90: 7420 6973 2061 7420 7468 6520 626f 7474  t is at the bott
+00013ea0: 6f6d 0d0a 2020 2020 2020 2020 2020 2020  om..            
+00013eb0: 2020 2020 6172 7261 795b 726f 7773 5b69      array[rows[i
+00013ec0: 5d2c 2063 6f6c 735b 695d 5d20 3d20 6172  ], cols[i]] = ar
+00013ed0: 7261 795b 726f 7773 5b69 5d20 2d20 312c  ray[rows[i] - 1,
+00013ee0: 2063 6f6c 735b 695d 5d0d 0a0d 0a20 2020   cols[i]]....   
+00013ef0: 2020 2020 2020 2020 2065 6c69 6620 6172           elif ar
+00013f00: 7261 795b 726f 7773 5b69 5d20 2b20 312c  ray[rows[i] + 1,
+00013f10: 2063 6f6c 735b 695d 5d20 213d 206e 6f64   cols[i]] != nod
+00013f20: 6174 6176 616c 7565 2061 6e64 2072 6f77  atavalue and row
+00013f30: 735b 695d 202b 2031 203c 3d20 6e6f 5f72  s[i] + 1 <= no_r
+00013f40: 6f77 733a 0d0a 2020 2020 2020 2020 2020  ows:..          
+00013f50: 2020 2020 2020 2320 6769 7665 2074 6865        # give the
+00013f60: 2063 656c 6c20 7468 6520 7661 6c75 6520   cell the value 
+00013f70: 6f66 2074 6865 2063 656c 6c20 7468 6174  of the cell that
+00013f80: 2069 7320 6174 2074 6865 2054 6f70 0d0a   is at the Top..
+00013f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013fa0: 6172 7261 795b 726f 7773 5b69 5d2c 2063  array[rows[i], c
+00013fb0: 6f6c 735b 695d 5d20 3d20 6172 7261 795b  ols[i]] = array[
+00013fc0: 726f 7773 5b69 5d20 2b20 312c 2063 6f6c  rows[i] + 1, col
+00013fd0: 735b 695d 5d0d 0a0d 0a20 2020 2020 2020  s[i]]....       
+00013fe0: 2020 2020 2065 6c69 6620 280d 0a20 2020       elif (..   
+00013ff0: 2020 2020 2020 2020 2020 2020 2061 7272               arr
+00014000: 6179 5b72 6f77 735b 695d 202d 2031 2c20  ay[rows[i] - 1, 
+00014010: 636f 6c73 5b69 5d20 2b20 315d 2021 3d20  cols[i] + 1] != 
+00014020: 6e6f 6461 7461 7661 6c75 650d 0a20 2020  nodatavalue..   
+00014030: 2020 2020 2020 2020 2020 2020 2061 6e64               and
+00014040: 2072 6f77 735b 695d 202d 2031 203e 2030   rows[i] - 1 > 0
+00014050: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00014060: 2020 616e 6420 636f 6c73 5b69 5d20 2b20    and cols[i] + 
+00014070: 3120 3c3d 206e 6f5f 636f 6c73 0d0a 2020  1 <= no_cols..  
+00014080: 2020 2020 2020 2020 2020 293a 0d0a 2020            ):..  
+00014090: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+000140a0: 6769 7665 2074 6865 2063 656c 6c20 7468  give the cell th
+000140b0: 6520 7661 6c75 6520 6f66 2074 6865 2063  e value of the c
+000140c0: 656c 6c20 7468 6174 2069 7320 6174 2074  ell that is at t
+000140d0: 6865 2072 6967 6874 2062 6f74 746f 6d0d  he right bottom.
+000140e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000140f0: 2061 7272 6179 5b72 6f77 735b 695d 2c20   array[rows[i], 
+00014100: 636f 6c73 5b69 5d5d 203d 2061 7272 6179  cols[i]] = array
+00014110: 5b72 6f77 735b 695d 202d 2031 2c20 636f  [rows[i] - 1, co
+00014120: 6c73 5b69 5d20 2b20 315d 0d0a 0d0a 2020  ls[i] + 1]....  
+00014130: 2020 2020 2020 2020 2020 656c 6966 2028            elif (
+00014140: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00014150: 2020 6172 7261 795b 726f 7773 5b69 5d20    array[rows[i] 
+00014160: 2d20 312c 2063 6f6c 735b 695d 202d 2031  - 1, cols[i] - 1
+00014170: 5d20 213d 206e 6f64 6174 6176 616c 7565  ] != nodatavalue
+00014180: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00014190: 2020 616e 6420 726f 7773 5b69 5d20 2d20    and rows[i] - 
+000141a0: 3120 3e20 300d 0a20 2020 2020 2020 2020  1 > 0..         
+000141b0: 2020 2020 2020 2061 6e64 2063 6f6c 735b         and cols[
+000141c0: 695d 202d 2031 203e 2030 0d0a 2020 2020  i] - 1 > 0..    
+000141d0: 2020 2020 2020 2020 293a 0d0a 2020 2020          ):..    
+000141e0: 2020 2020 2020 2020 2020 2020 2320 6769              # gi
+000141f0: 7665 2074 6865 2063 656c 6c20 7468 6520  ve the cell the 
+00014200: 7661 6c75 6520 6f66 2074 6865 2063 656c  value of the cel
+00014210: 6c20 7468 6174 2069 7320 6174 2074 6865  l that is at the
+00014220: 206c 6566 7420 626f 7474 6f6d 0d0a 2020   left bottom..  
+00014230: 2020 2020 2020 2020 2020 2020 2020 6172                ar
+00014240: 7261 795b 726f 7773 5b69 5d2c 2063 6f6c  ray[rows[i], col
+00014250: 735b 695d 5d20 3d20 6172 7261 795b 726f  s[i]] = array[ro
+00014260: 7773 5b69 5d20 2d20 312c 2063 6f6c 735b  ws[i] - 1, cols[
+00014270: 695d 202d 2031 5d0d 0a0d 0a20 2020 2020  i] - 1]....     
+00014280: 2020 2020 2020 2065 6c69 6620 280d 0a20         elif (.. 
+00014290: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+000142a0: 7272 6179 5b72 6f77 735b 695d 202b 2031  rray[rows[i] + 1
+000142b0: 2c20 636f 6c73 5b69 5d20 2d20 315d 2021  , cols[i] - 1] !
+000142c0: 3d20 6e6f 6461 7461 7661 6c75 650d 0a20  = nodatavalue.. 
+000142d0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+000142e0: 6e64 2072 6f77 735b 695d 202b 2031 203c  nd rows[i] + 1 <
+000142f0: 3d20 6e6f 5f72 6f77 730d 0a20 2020 2020  = no_rows..     
+00014300: 2020 2020 2020 2020 2020 2061 6e64 2063             and c
+00014310: 6f6c 735b 695d 202d 2031 203e 2030 0d0a  ols[i] - 1 > 0..
+00014320: 2020 2020 2020 2020 2020 2020 293a 0d0a              ):..
+00014330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014340: 2320 6769 7665 2074 6865 2063 656c 6c20  # give the cell 
+00014350: 7468 6520 7661 6c75 6520 6f66 2074 6865  the value of the
+00014360: 2063 656c 6c20 7468 6174 2069 7320 6174   cell that is at
+00014370: 2074 6865 206c 6566 7420 546f 700d 0a20   the left Top.. 
+00014380: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00014390: 7272 6179 5b72 6f77 735b 695d 2c20 636f  rray[rows[i], co
+000143a0: 6c73 5b69 5d5d 203d 2061 7272 6179 5b72  ls[i]] = array[r
+000143b0: 6f77 735b 695d 202b 2031 2c20 636f 6c73  ows[i] + 1, cols
+000143c0: 5b69 5d20 2d20 315d 0d0a 0d0a 2020 2020  [i] - 1]....    
+000143d0: 2020 2020 2020 2020 656c 6966 2028 0d0a          elif (..
+000143e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000143f0: 6172 7261 795b 726f 7773 5b69 5d20 2b20  array[rows[i] + 
+00014400: 312c 2063 6f6c 735b 695d 202b 2031 5d20  1, cols[i] + 1] 
+00014410: 213d 206e 6f64 6174 6176 616c 7565 0d0a  != nodatavalue..
+00014420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014430: 616e 6420 726f 7773 5b69 5d20 2b20 3120  and rows[i] + 1 
+00014440: 3c3d 206e 6f5f 726f 7773 0d0a 2020 2020  <= no_rows..    
+00014450: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+00014460: 636f 6c73 5b69 5d20 2b20 3120 3c3d 206e  cols[i] + 1 <= n
+00014470: 6f5f 636f 6c73 0d0a 2020 2020 2020 2020  o_cols..        
+00014480: 2020 2020 293a 0d0a 2020 2020 2020 2020      ):..        
+00014490: 2020 2020 2020 2020 2320 6769 7665 2074          # give t
+000144a0: 6865 2063 656c 6c20 7468 6520 7661 6c75  he cell the valu
+000144b0: 6520 6f66 2074 6865 2063 656c 6c20 7468  e of the cell th
+000144c0: 6174 2069 7320 6174 2074 6865 2072 6967  at is at the rig
+000144d0: 6874 2054 6f70 0d0a 2020 2020 2020 2020  ht Top..        
+000144e0: 2020 2020 2020 2020 6172 7261 795b 726f          array[ro
+000144f0: 7773 5b69 5d2c 2063 6f6c 735b 695d 5d20  ws[i], cols[i]] 
+00014500: 3d20 6172 7261 795b 726f 7773 5b69 5d20  = array[rows[i] 
+00014510: 2b20 312c 2063 6f6c 735b 695d 202b 2031  + 1, cols[i] + 1
+00014520: 5d0d 0a20 2020 2020 2020 2020 2020 2065  ]..            e
+00014530: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00014540: 2020 2020 2020 7072 696e 7428 2274 6865        print("the
+00014550: 2063 656c 6c20 6973 2069 736f 6c61 7465   cell is isolate
+00014560: 6420 284e 6f20 7375 7272 6f75 6e64 696e  d (No surroundin
+00014570: 6720 6365 6c6c 7320 6578 6973 7429 2229  g cells exist)")
+00014580: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00014590: 2061 7272 6179 0d0a 0d0a 2020 2020 6465   array....    de
+000145a0: 6620 6c6f 6361 7465 5f70 6f69 6e74 7328  f locate_points(
+000145b0: 0d0a 2020 2020 2020 2020 7365 6c66 2c0d  ..        self,.
+000145c0: 0a20 2020 2020 2020 2070 6f69 6e74 733a  .        points:
+000145d0: 2055 6e69 6f6e 5b47 656f 4461 7461 4672   Union[GeoDataFr
+000145e0: 616d 652c 2046 6561 7475 7265 436f 6c6c  ame, FeatureColl
+000145f0: 6563 7469 6f6e 2c20 4461 7461 4672 616d  ection, DataFram
+00014600: 655d 2c0d 0a20 2020 2029 202d 3e20 6e70  e],..    ) -> np
+00014610: 2e6e 6461 7272 6179 3a0d 0a20 2020 2020  .ndarray:..     
+00014620: 2020 2022 2222 6e65 6172 6573 7443 656c     """nearestCel
+00014630: 6c2e 0d0a 0d0a 2020 2020 2020 2020 2020  l.....          
+00014640: 2020 6e65 6172 6573 7443 656c 6c20 6361    nearestCell ca
+00014650: 6c63 756c 6174 6573 2074 6865 2074 6865  lculates the the
+00014660: 2069 6e64 6963 6573 2028 726f 7773 2c20   indices (rows, 
+00014670: 636f 6c29 206f 6620 6e65 6172 6573 7420  col) of nearest 
+00014680: 6365 6c6c 2069 6e20 6120 6769 7665 6e0d  cell in a given.
+00014690: 0a20 2020 2020 2020 2020 2020 2072 6173  .            ras
+000146a0: 7465 7220 746f 2061 2073 7461 7469 6f6e  ter to a station
+000146b0: 0d0a 2020 2020 2020 2020 2020 2020 636f  ..            co
+000146c0: 6f72 6469 6e61 7465 2073 7973 7465 6d20  ordinate system 
+000146d0: 6f66 2074 6865 2072 6173 7465 7220 6861  of the raster ha
+000146e0: 7320 746f 2062 6520 7072 6f6a 6563 7465  s to be projecte
+000146f0: 6420 746f 2062 6520 6162 6c65 2074 6f20  d to be able to 
+00014700: 6361 6c63 756c 6174 650d 0a20 2020 2020  calculate..     
+00014710: 2020 2020 2020 2074 6865 2064 6973 7461         the dista
+00014720: 6e63 650d 0a0d 0a20 2020 2020 2020 2050  nce....        P
+00014730: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
+00014740: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
+00014750: 2020 2020 2020 2070 6f69 6e74 733a 205b         points: [
+00014760: 4461 7461 6672 616d 655d 0d0a 2020 2020  Dataframe]..    
+00014770: 2020 2020 2020 2020 6461 7461 6672 616d          datafram
+00014780: 6520 7769 7468 2050 4f49 4e54 2067 656f  e with POINT geo
+00014790: 6d65 7472 792e 0d0a 0d0a 2020 2020 2020  metry.....      
+000147a0: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
+000147b0: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
+000147c0: 2020 2020 6172 7261 793a 0d0a 2020 2020      array:..    
+000147d0: 2020 2020 2020 2020 6172 7261 7920 7769          array wi
+000147e0: 7468 2061 2073 6861 7065 2028 616e 792c  th a shape (any,
+000147f0: 2032 292c 2066 6f72 2074 6865 2072 6f77   2), for the row
+00014800: 2c20 636f 6c75 6d6e 2069 6e64 6963 6573  , column indices
+00014810: 2069 6e20 7468 6520 6172 7261 792e 0d0a   in the array...
+00014820: 2020 2020 2020 2020 2020 2020 6172 7261              arra
+00014830: 7928 5b5b 2035 2c20 2034 5d2c 0d0a 2020  y([[ 5,  4],..  
+00014840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014850: 205b 2032 2c20 2039 5d2c 0d0a 2020 2020   [ 2,  9],..    
+00014860: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+00014870: 2035 2c20 2039 5d5d 290d 0a20 2020 2020   5,  9]])..     
+00014880: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+00014890: 6966 2069 7369 6e73 7461 6e63 6528 706f  if isinstance(po
+000148a0: 696e 7473 2c20 4765 6f44 6174 6146 7261  ints, GeoDataFra
+000148b0: 6d65 293a 0d0a 2020 2020 2020 2020 2020  me):..          
+000148c0: 2020 706f 696e 7473 203d 2046 6561 7475    points = Featu
+000148d0: 7265 436f 6c6c 6563 7469 6f6e 2870 6f69  reCollection(poi
+000148e0: 6e74 7329 0d0a 2020 2020 2020 2020 656c  nts)..        el
+000148f0: 6966 2069 7369 6e73 7461 6e63 6528 706f  if isinstance(po
+00014900: 696e 7473 2c20 4461 7461 4672 616d 6529  ints, DataFrame)
+00014910: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+00014920: 6620 616c 6c28 656c 656d 206e 6f74 2069  f all(elem not i
+00014930: 6e20 706f 696e 7473 2e63 6f6c 756d 6e73  n points.columns
+00014940: 2066 6f72 2065 6c65 6d20 696e 205b 2278   for elem in ["x
+00014950: 222c 2022 7922 5d29 3a0d 0a20 2020 2020  ", "y"]):..     
+00014960: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00014970: 2056 616c 7565 4572 726f 7228 0d0a 2020   ValueError(..  
+00014980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014990: 2020 2249 6620 7468 6520 696e 7075 7420    "If the input 
+000149a0: 696e 2061 2044 6174 6146 7261 6d65 2c20  in a DataFrame, 
+000149b0: 6974 2073 686f 756c 6420 6861 7665 2074  it should have t
+000149c0: 776f 2063 6f6c 756d 6e73 2078 2c20 616e  wo columns x, an
+000149d0: 6420 7922 0d0a 2020 2020 2020 2020 2020  d y"..          
+000149e0: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
+000149f0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+00014a00: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
+00014a10: 7461 6e63 6528 706f 696e 7473 2c20 4665  tance(points, Fe
+00014a20: 6174 7572 6543 6f6c 6c65 6374 696f 6e29  atureCollection)
+00014a30: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00014a40: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+00014a50: 6f72 280d 0a20 2020 2020 2020 2020 2020  or(..           
+00014a60: 2020 2020 2020 2020 2066 2270 6c65 6173           f"pleas
+00014a70: 6520 6368 6563 6b20 706f 696e 7473 2069  e check points i
+00014a80: 6e70 7574 2069 7420 7368 6f75 6c64 2062  nput it should b
+00014a90: 6520 4765 6f44 6174 6146 7261 6d65 2f46  e GeoDataFrame/F
+00014aa0: 6561 7475 7265 436f 6c6c 6563 7469 6f6e  eatureCollection
+00014ab0: 202d 2067 6976 656e 207b 7479 7065 2870   - given {type(p
+00014ac0: 6f69 6e74 7329 7d22 0d0a 2020 2020 2020  oints)}"..      
+00014ad0: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
+00014ae0: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
+00014af0: 7374 616e 6365 2870 6f69 6e74 732c 2044  stance(points, D
+00014b00: 6174 6146 7261 6d65 293a 0d0a 2020 2020  ataFrame):..    
+00014b10: 2020 2020 2020 2020 2320 6765 7420 7468          # get th
+00014b20: 6520 782c 2079 2063 6f6f 7264 696e 6174  e x, y coordinat
+00014b30: 6573 2e0d 0a20 2020 2020 2020 2020 2020  es...           
+00014b40: 2070 6f69 6e74 732e 7879 2829 0d0a 2020   points.xy()..  
+00014b50: 2020 2020 2020 2020 2020 706f 696e 7473            points
+00014b60: 203d 2070 6f69 6e74 732e 6665 6174 7572   = points.featur
+00014b70: 652e 6c6f 635b 3a2c 205b 2278 222c 2022  e.loc[:, ["x", "
+00014b80: 7922 5d5d 2e76 616c 7565 730d 0a20 2020  y"]].values..   
+00014b90: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+00014ba0: 2020 2020 2020 2020 706f 696e 7473 203d          points =
+00014bb0: 2070 6f69 6e74 732e 6c6f 635b 3a2c 205b   points.loc[:, [
+00014bc0: 2278 222c 2022 7922 5d5d 2e76 616c 7565  "x", "y"]].value
+00014bd0: 730d 0a0d 0a20 2020 2020 2020 2023 2073  s....        # s
+00014be0: 696e 6365 2066 6972 7374 2072 6f77 2069  ince first row i
+00014bf0: 7320 782d 636f 6f72 6473 2073 6f20 7468  s x-coords so th
+00014c00: 6520 6669 7273 7420 636f 6c75 6d6e 2069  e first column i
+00014c10: 6e20 7468 6520 696e 6469 6365 7320 6973  n the indices is
+00014c20: 2074 6865 2063 6f6c 756d 6e20 696e 6465   the column inde
+00014c30: 780d 0a20 2020 2020 2020 2069 6e64 6963  x..        indic
+00014c40: 6573 203d 206c 6f63 6174 655f 7661 6c75  es = locate_valu
+00014c50: 6573 2870 6f69 6e74 732c 2073 656c 662e  es(points, self.
+00014c60: 782c 2073 656c 662e 7929 0d0a 2020 2020  x, self.y)..    
+00014c70: 2020 2020 2320 7265 6172 7261 6e67 6520      # rearrange 
+00014c80: 7468 6520 636f 6c75 6d6e 7320 746f 206d  the columns to m
+00014c90: 616b 6520 7468 6520 726f 7720 696e 6465  ake the row inde
+00014ca0: 7820 6669 7273 740d 0a20 2020 2020 2020  x first..       
+00014cb0: 2069 6e64 6963 6573 203d 2069 6e64 6963   indices = indic
+00014cc0: 6573 5b3a 2c20 5b31 2c20 305d 5d0d 0a20  es[:, [1, 0]].. 
+00014cd0: 2020 2020 2020 2072 6574 7572 6e20 696e         return in
+00014ce0: 6469 6365 730d 0a0d 0a20 2020 2064 6566  dices....    def
+00014cf0: 2065 7874 7261 6374 280d 0a20 2020 2020   extract(..     
+00014d00: 2020 2073 656c 662c 0d0a 2020 2020 2020     self,..      
+00014d10: 2020 6578 636c 7564 655f 7661 6c75 653a    exclude_value:
+00014d20: 2041 6e79 203d 204e 6f6e 652c 0d0a 2020   Any = None,..  
+00014d30: 2020 2020 2020 6665 6174 7572 653a 2055        feature: U
+00014d40: 6e69 6f6e 5b46 6561 7475 7265 436f 6c6c  nion[FeatureColl
+00014d50: 6563 7469 6f6e 2c20 4765 6f44 6174 6146  ection, GeoDataF
+00014d60: 7261 6d65 5d20 3d20 4e6f 6e65 2c0d 0a20  rame] = None,.. 
+00014d70: 2020 2029 202d 3e20 4c69 7374 3a0d 0a20     ) -> List:.. 
+00014d80: 2020 2020 2020 2022 2222 4578 7472 6163         """Extrac
+00014d90: 742e 0d0a 0d0a 2020 2020 2020 2020 2020  t.....          
+00014da0: 2020 2d20 4578 7472 6163 7420 6d65 7468    - Extract meth
+00014db0: 6f64 2067 6574 2061 6c6c 2074 6865 2076  od get all the v
+00014dc0: 616c 7565 7320 696e 2061 2072 6173 7465  alues in a raste
+00014dd0: 722c 2061 6e64 2065 7863 6c75 6465 2074  r, and exclude t
+00014de0: 6865 2076 616c 7565 7320 696e 2074 6865  he values in the
+00014df0: 2065 7863 6c75 6465 5f76 616c 7565 2070   exclude_value p
+00014e00: 6172 616d 6574 6572 2e0d 0a20 2020 2020  arameter...     
+00014e10: 2020 2020 2020 202d 2049 6620 7468 6520         - If the 
+00014e20: 6665 6174 7572 6520 7061 7261 6d65 7465  feature paramete
+00014e30: 7220 6973 2067 6976 656e 2074 6865 2072  r is given the r
+00014e40: 6173 7465 7220 7769 6c6c 2062 6520 636c  aster will be cl
+00014e50: 6970 6564 2074 6f20 7468 6520 6578 7465  iped to the exte
+00014e60: 6e74 206f 6620 7468 6520 6769 7665 6e20  nt of the given 
+00014e70: 6665 6174 7572 6520 616e 6420 7468 650d  feature and the.
+00014e80: 0a20 2020 2020 2020 2020 2020 2076 616c  .            val
+00014e90: 7565 7320 7769 7468 696e 2074 6865 2066  ues within the f
+00014ea0: 6561 7475 7265 2061 7265 2065 7874 7261  eature are extra
+00014eb0: 6374 6564 2e0d 0a0d 0a20 2020 2020 2020  cted.....       
+00014ec0: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+00014ed0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
+00014ee0: 0a20 2020 2020 2020 2065 7863 6c75 6465  .        exclude
+00014ef0: 5f76 616c 7565 3a20 5b4e 756d 6572 6963  _value: [Numeric
+00014f00: 5d0d 0a20 2020 2020 2020 2020 2020 2076  ]..            v
+00014f10: 616c 7565 7320 796f 7520 7761 6e74 2074  alues you want t
+00014f20: 6f20 6578 636c 7564 6520 6672 6f6d 2065  o exclude from e
+00014f30: 7874 6561 6374 6564 2076 616c 7565 730d  xteacted values.
+00014f40: 0a20 2020 2020 2020 2066 6561 7475 7265  .        feature
+00014f50: 3a20 5b46 6561 7475 7265 436f 6c6c 6563  : [FeatureCollec
+00014f60: 7469 6f6e 2f47 656f 4461 7461 4672 616d  tion/GeoDataFram
+00014f70: 655d 0d0a 2020 2020 2020 2020 2020 2020  e]..            
+00014f80: 7665 6374 6f72 2066 696c 6520 636f 6e74  vector file cont
+00014f90: 6169 6e73 2067 656f 6d65 7472 6965 7320  ains geometries 
+00014fa0: 796f 7520 7761 6e74 2074 6f20 6578 7472  you want to extr
+00014fb0: 6163 7420 7468 6520 7661 6c75 6573 2061  act the values a
+00014fc0: 7420 7468 6569 7220 6c6f 6361 7469 6f6e  t their location
+00014fd0: 2e20 4465 6661 756c 7420 6973 204e 6f6e  . Default is Non
+00014fe0: 652e 0d0a 2020 2020 2020 2020 2222 220d  e...        """.
+00014ff0: 0a20 2020 2020 2020 2061 7272 203d 2073  .        arr = s
+00015000: 656c 662e 7265 6164 5f61 7272 6179 2829  elf.read_array()
+00015010: 0d0a 0d0a 2020 2020 2020 2020 6966 2066  ....        if f
+00015020: 6561 7475 7265 2069 7320 4e6f 6e65 3a0d  eature is None:.
+00015030: 0a20 2020 2020 2020 2020 2020 206d 6173  .            mas
+00015040: 6b20 3d20 280d 0a20 2020 2020 2020 2020  k = (..         
+00015050: 2020 2020 2020 205b 7365 6c66 2e6e 6f5f         [self.no_
+00015060: 6461 7461 5f76 616c 7565 5b30 5d2c 2065  data_value[0], e
+00015070: 7863 6c75 6465 5f76 616c 7565 5d0d 0a20  xclude_value].. 
+00015080: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00015090: 6620 6578 636c 7564 655f 7661 6c75 6520  f exclude_value 
+000150a0: 6973 206e 6f74 204e 6f6e 650d 0a20 2020  is not None..   
+000150b0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+000150c0: 6520 5b73 656c 662e 6e6f 5f64 6174 615f  e [self.no_data_
+000150d0: 7661 6c75 655b 305d 5d0d 0a20 2020 2020  value[0]]..     
+000150e0: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
+000150f0: 2020 2020 2020 7661 6c75 6573 203d 2067        values = g
+00015100: 6574 5f70 6978 656c 7332 2861 7272 2c20  et_pixels2(arr, 
+00015110: 6d61 736b 290d 0a20 2020 2020 2020 2065  mask)..        e
+00015120: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00015130: 2020 696e 6469 6365 7320 3d20 7365 6c66    indices = self
+00015140: 2e6c 6f63 6174 655f 706f 696e 7473 2866  .locate_points(f
+00015150: 6561 7475 7265 290d 0a20 2020 2020 2020  eature)..       
+00015160: 2020 2020 2076 616c 7565 7320 3d20 6172       values = ar
+00015170: 725b 696e 6469 6365 735b 3a2c 2030 5d2c  r[indices[:, 0],
+00015180: 2069 6e64 6963 6573 5b3a 2c20 315d 5d0d   indices[:, 1]].
+00015190: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000151a0: 7661 6c75 6573 0d0a 0d0a 2020 2020 6465  values....    de
+000151b0: 6620 6f76 6572 6c61 7928 0d0a 2020 2020  f overlay(..    
+000151c0: 2020 2020 7365 6c66 2c0d 0a20 2020 2020      self,..     
+000151d0: 2020 2063 6c61 7373 6573 5f6d 6170 2c0d     classes_map,.
+000151e0: 0a20 2020 2020 2020 2065 7863 6c75 6465  .        exclude
+000151f0: 5f76 616c 7565 3a20 556e 696f 6e5b 666c  _value: Union[fl
+00015200: 6f61 742c 2069 6e74 5d20 3d20 4e6f 6e65  oat, int] = None
+00015210: 2c0d 0a20 2020 2029 202d 3e20 4469 6374  ,..    ) -> Dict
+00015220: 5b4c 6973 745b 666c 6f61 745d 2c20 4c69  [List[float], Li
+00015230: 7374 5b66 6c6f 6174 5d5d 3a0d 0a20 2020  st[float]]:..   
+00015240: 2020 2020 2022 2222 4f76 6572 6c61 794d       """OverlayM
+00015250: 6170 2e0d 0a0d 0a20 2020 2020 2020 2020  ap.....         
+00015260: 2020 206f 7665 726c 6179 2065 7874 7261     overlay extra
+00015270: 6374 7320 616c 6c20 7468 6520 7661 6c75  cts all the valu
+00015280: 6573 2069 6e20 7261 7361 7465 7220 6669  es in rasater fi
+00015290: 6c65 2c20 6966 2079 6f75 2068 6176 6520  le, if you have 
+000152a0: 7477 6f20 6d61 7073 206f 6e65 2077 6974  two maps one wit
+000152b0: 6820 636c 6173 7365 732c 2061 6e64 2074  h classes, and t
+000152c0: 6865 206f 7468 6572 206d 6170 0d0a 2020  he other map..  
+000152d0: 2020 2020 2020 2020 2020 636f 6e74 6169            contai
+000152e0: 6e73 2061 6e79 2074 7970 6520 6f66 2076  ns any type of v
+000152f0: 616c 7565 732c 2061 6e64 2079 6f75 2077  alues, and you w
+00015300: 616e 7420 746f 206b 6e6f 7720 7468 6520  ant to know the 
+00015310: 7661 6c75 6573 2069 6e20 6561 6368 2063  values in each c
+00015320: 6c61 7373 2e0d 0a0d 0a20 2020 2020 2020  lass.....       
+00015330: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+00015340: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
+00015350: 0a20 2020 2020 2020 2063 6c61 7373 6573  .        classes
+00015360: 5f6d 6170 3a20 5b44 6174 6173 6574 5d0d  _map: [Dataset].
+00015370: 0a20 2020 2020 2020 2020 2020 2044 6174  .            Dat
+00015380: 6173 6574 204f 626a 6563 7420 666f 7220  aset Object for 
+00015390: 7468 6520 7261 7374 6572 2074 6861 7420  the raster that 
+000153a0: 6861 7665 2063 6c61 7373 6573 2079 6f75  have classes you
+000153b0: 2077 616e 7420 746f 206f 7665 726c 6179   want to overlay
+000153c0: 2077 6974 6820 7468 6520 7261 7374 6572   with the raster
+000153d0: 2e0d 0a20 2020 2020 2020 2065 7863 6c75  ...        exclu
+000153e0: 6465 5f76 616c 7565 3a20 5b4e 756d 6572  de_value: [Numer
+000153f0: 6963 5d0d 0a20 2020 2020 2020 2020 2020  ic]..           
+00015400: 2076 616c 7565 7320 796f 7520 7761 6e74   values you want
+00015410: 2074 6f20 6578 636c 7564 6520 6672 6f6d   to exclude from
+00015420: 2065 7874 7261 6374 6564 2076 616c 7565   extracted value
+00015430: 732e 0d0a 0d0a 2020 2020 2020 2020 5265  s.....        Re
+00015440: 7475 726e 730d 0a20 2020 2020 2020 202d  turns..        -
+00015450: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+00015460: 4469 6374 696f 6e61 7279 3a0d 0a20 2020  Dictionary:..   
+00015470: 2020 2020 2020 2020 2064 6963 746f 6e61           dictona
+00015480: 7279 2077 6974 6820 6120 6c69 7374 206f  ry with a list o
+00015490: 6620 7661 6c75 6573 2069 6e20 7468 6520  f values in the 
+000154a0: 6261 7365 6d61 7020 6173 206b 6579 7320  basemap as keys 
+000154b0: 616e 6420 666f 7220 6561 6368 206b 6579  and for each key
+000154c0: 2061 206c 6973 7420 6f66 2061 6c6c 2074   a list of all t
+000154d0: 6865 2069 6e74 6572 7365 6374 6564 0d0a  he intersected..
+000154e0: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
+000154f0: 6573 2069 6e20 7468 6520 6d61 7073 2066  es in the maps f
+00015500: 726f 6d20 7468 6520 7061 7468 2e0d 0a20  rom the path... 
+00015510: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+00015520: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
+00015530: 5f63 6865 636b 5f61 6c69 676e 6d65 6e74  _check_alignment
+00015540: 2863 6c61 7373 6573 5f6d 6170 293a 0d0a  (classes_map):..
+00015550: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00015560: 6520 416c 6967 6e6d 656e 7445 7272 6f72  e AlignmentError
+00015570: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+00015580: 2020 2022 5468 6520 636c 6173 7320 4461     "The class Da
+00015590: 7461 7365 7420 6973 206e 6f74 2061 6c69  taset is not ali
+000155a0: 676e 6564 2077 6974 6820 7468 6520 6375  gned with the cu
+000155b0: 7272 656e 7420 7261 7374 6572 2c20 706c  rrent raster, pl
+000155c0: 6173 6520 7573 6520 7468 6520 6d65 7468  ase use the meth
+000155d0: 6f64 2022 0d0a 2020 2020 2020 2020 2020  od "..          
+000155e0: 2020 2020 2020 2227 616c 6967 6e27 2074        "'align' t
+000155f0: 6f20 616c 6967 6e20 626f 7468 2072 6173  o align both ras
+00015600: 7465 7273 2e22 0d0a 2020 2020 2020 2020  ters."..        
+00015610: 2020 2020 290d 0a20 2020 2020 2020 2061      )..        a
+00015620: 7272 203d 2073 656c 662e 7265 6164 5f61  rr = self.read_a
+00015630: 7272 6179 2829 0d0a 2020 2020 2020 2020  rray()..        
+00015640: 6d61 736b 203d 2028 0d0a 2020 2020 2020  mask = (..      
+00015650: 2020 2020 2020 5b73 656c 662e 6e6f 5f64        [self.no_d
+00015660: 6174 615f 7661 6c75 655b 305d 2c20 6578  ata_value[0], ex
+00015670: 636c 7564 655f 7661 6c75 655d 0d0a 2020  clude_value]..  
+00015680: 2020 2020 2020 2020 2020 6966 2065 7863            if exc
+00015690: 6c75 6465 5f76 616c 7565 2069 7320 6e6f  lude_value is no
+000156a0: 7420 4e6f 6e65 0d0a 2020 2020 2020 2020  t None..        
+000156b0: 2020 2020 656c 7365 205b 7365 6c66 2e6e      else [self.n
+000156c0: 6f5f 6461 7461 5f76 616c 7565 5b30 5d5d  o_data_value[0]]
+000156d0: 0d0a 2020 2020 2020 2020 290d 0a20 2020  ..        )..   
+000156e0: 2020 2020 2069 6e64 203d 2067 6574 5f69       ind = get_i
+000156f0: 6e64 6963 6573 3228 6172 722c 206d 6173  ndices2(arr, mas
+00015700: 6b29 0d0a 2020 2020 2020 2020 636c 6173  k)..        clas
+00015710: 7365 7320 3d20 636c 6173 7365 735f 6d61  ses = classes_ma
+00015720: 702e 7265 6164 5f61 7272 6179 2829 0d0a  p.read_array()..
+00015730: 2020 2020 2020 2020 7661 6c75 6573 203d          values =
+00015740: 2064 6963 7428 290d 0a0d 0a20 2020 2020   dict()....     
+00015750: 2020 2023 2065 7874 7261 6374 2076 616c     # extract val
+00015760: 7565 730d 0a20 2020 2020 2020 2066 6f72  ues..        for
+00015770: 2069 2c20 696e 645f 6920 696e 2065 6e75   i, ind_i in enu
+00015780: 6d65 7261 7465 2869 6e64 293a 0d0a 2020  merate(ind):..  
+00015790: 2020 2020 2020 2020 2020 2320 6669 7273            # firs
+000157a0: 7420 6368 6563 6b20 6966 2074 6865 2073  t check if the s
+000157b0: 7562 2d62 6173 696e 2068 6173 2061 206c  ub-basin has a l
+000157c0: 6973 7420 696e 2074 6865 2064 6963 7420  ist in the dict 
+000157d0: 6966 206e 6f74 2063 7265 6174 6520 6120  if not create a 
+000157e0: 6c69 7374 0d0a 2020 2020 2020 2020 2020  list..          
+000157f0: 2020 6b65 7920 3d20 636c 6173 7365 735b    key = classes[
+00015800: 696e 645f 695b 305d 2c20 696e 645f 695b  ind_i[0], ind_i[
+00015810: 315d 5d0d 0a20 2020 2020 2020 2020 2020  1]]..           
+00015820: 2069 6620 6b65 7920 6e6f 7420 696e 206c   if key not in l
+00015830: 6973 7428 7661 6c75 6573 2e6b 6579 7328  ist(values.keys(
+00015840: 2929 3a0d 0a20 2020 2020 2020 2020 2020  )):..           
+00015850: 2020 2020 2076 616c 7565 735b 6b65 795d       values[key]
+00015860: 203d 206c 6973 7428 290d 0a0d 0a20 2020   = list()....   
+00015870: 2020 2020 2020 2020 2076 616c 7565 735b           values[
+00015880: 6b65 795d 2e61 7070 656e 6428 6172 725b  key].append(arr[
+00015890: 696e 645f 695b 305d 2c20 696e 645f 695b  ind_i[0], ind_i[
+000158a0: 315d 5d29 0d0a 0d0a 2020 2020 2020 2020  1]])....        
+000158b0: 7265 7475 726e 2076 616c 7565 730d 0a0d  return values...
+000158c0: 0a20 2020 2064 6566 2066 6f6f 7470 7269  .    def footpri
+000158d0: 6e74 280d 0a20 2020 2020 2020 2073 656c  nt(..        sel
+000158e0: 662c 0d0a 2020 2020 2020 2020 6261 6e64  f,..        band
+000158f0: 3a20 696e 7420 3d20 302c 0d0a 2020 2020  : int = 0,..    
+00015900: 2020 2020 6578 636c 7564 655f 7661 6c75      exclude_valu
+00015910: 6573 3a20 4f70 7469 6f6e 616c 5b4c 6973  es: Optional[Lis
+00015920: 745b 416e 795d 5d20 3d20 4e6f 6e65 2c0d  t[Any]] = None,.
+00015930: 0a20 2020 2029 202d 3e20 556e 696f 6e5b  .    ) -> Union[
+00015940: 4765 6f44 6174 6146 7261 6d65 2c20 4e6f  GeoDataFrame, No
+00015950: 6e65 5d3a 0d0a 2020 2020 2020 2020 2222  ne]:..        ""
+00015960: 2266 6f6f 7470 7269 6e74 2e0d 0a0d 0a20  "footprint..... 
+00015970: 2020 2020 2020 2020 2020 2065 7874 7261             extra
+00015980: 6374 5f65 7874 656e 7420 7461 6b65 7320  ct_extent takes 
+00015990: 6120 6764 616c 2072 6173 7465 7220 6f62  a gdal raster ob
+000159a0: 6a65 6374 2061 6e64 2072 6574 7572 6e73  ject and returns
+000159b0: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
+000159c0: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
+000159d0: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+000159e0: 2020 2020 6261 6e64 3a20 5b69 6e74 5d0d      band: [int].
+000159f0: 0a20 2020 2020 2020 2020 2020 2062 616e  .            ban
+00015a00: 6420 696e 6465 782e 2044 6566 6175 6c74  d index. Default
+00015a10: 2069 7320 302e 0d0a 2020 2020 2020 2020   is 0...        
+00015a20: 6578 636c 7564 655f 7661 6c75 6573 3a0d  exclude_values:.
+00015a30: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00015a40: 796f 7520 7761 6e74 2074 6f20 6578 636c  you want to excl
+00015a50: 7564 655f 7661 6c75 6573 2061 2063 6572  ude_values a cer
+00015a60: 7461 696e 2076 616c 7565 2069 6e20 7468  tain value in th
+00015a70: 6520 7261 7374 6572 2077 6974 6820 616e  e raster with an
+00015a80: 6f74 6865 7220 7661 6c75 6520 696e 7465  other value inte
+00015a90: 7220 7468 6520 7477 6f20 7661 6c75 6573  r the two values
+00015aa0: 2061 7320 6120 6c69 7374 206f 6620 7475   as a list of tu
+00015ab0: 706c 6573 2061 0d0a 2020 2020 2020 2020  ples a..        
+00015ac0: 2020 2020 5b28 7661 6c75 655f 746f 5f62      [(value_to_b
+00015ad0: 655f 6578 636c 7564 655f 7661 6c75 6573  e_exclude_values
+00015ae0: 642c 206e 6577 5f76 616c 7565 295d 0d0a  d, new_value)]..
+00015af0: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+00015b00: 6578 636c 7564 655f 7661 6c75 6573 203d  exclude_values =
+00015b10: 205b 305d 0d0a 2020 2020 2020 2020 2020   [0]..          
+00015b20: 2020 2d20 5468 6973 2070 6172 616d 6574    - This paramet
+00015b30: 6572 2069 7320 696e 7472 6f64 7563 6564  er is introduced
+00015b40: 2070 6172 7469 6375 6c61 726c 7920 666f   particularly fo
+00015b50: 7220 7468 6520 6361 7365 206f 6620 7261  r the case of ra
+00015b60: 7374 6572 7320 7468 6174 2068 6173 2074  sters that has t
+00015b70: 6865 206e 6f64 6174 6176 616c 7565 2073  he nodatavalue s
+00015b80: 746f 7265 6420 696e 2074 6865 0d0a 2020  tored in the..  
+00015b90: 2020 2020 2020 2020 2020 6172 7261 7920            array 
+00015ba0: 646f 6573 206e 6f74 206d 6174 6368 2074  does not match t
+00015bb0: 6865 2076 616c 7565 2073 746f 7265 6420  he value stored 
+00015bc0: 696e 2061 7272 6179 2c20 736f 2074 6869  in array, so thi
+00015bd0: 7320 6f70 7469 6f6e 2063 616e 2063 6f72  s option can cor
+00015be0: 7265 6374 2074 6869 7320 6265 6861 7669  rect this behavi
+00015bf0: 6f72 2e0d 0a0d 0a20 2020 2020 2020 2052  or.....        R
+00015c00: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
+00015c10: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+00015c20: 2047 656f 4461 7461 4672 616d 653a 0d0a   GeoDataFrame:..
+00015c30: 2020 2020 2020 2020 2020 2020 2d20 6765              - ge
+00015c40: 6f64 6174 6166 7261 6d65 2063 6f6e 7461  odataframe conta
+00015c50: 696e 696e 6720 7468 6520 706f 6c79 676f  ining the polygo
+00015c60: 6e20 7265 7072 6573 656e 7469 6e67 2074  n representing t
+00015c70: 6865 2065 7874 656e 7420 6f66 2074 6865  he extent of the
+00015c80: 2072 6173 7465 722e 2074 6865 2065 7874   raster. the ext
+00015c90: 656e 7420 636f 6c75 6d6e 2073 686f 756c  ent column shoul
+00015ca0: 640d 0a20 2020 2020 2020 2020 2020 2063  d..            c
+00015cb0: 6f6e 7461 696e 7320 6120 7661 6c75 6520  ontains a value 
+00015cc0: 6f66 2020 3220 6f6e 6c79 2e0d 0a20 2020  of  2 only...   
+00015cd0: 2020 2020 2020 2020 202d 2069 6620 7468           - if th
+00015ce0: 6520 6461 7461 7365 7420 6861 6420 7365  e dataset had se
+00015cf0: 7061 7261 7465 2070 6f6c 7967 6f6e 7320  parate polygons 
+00015d00: 6561 6368 2070 6f6c 7967 6f6e 2077 696c  each polygon wil
+00015d10: 6c20 6265 2069 6e20 6120 7365 7061 7261  l be in a separa
+00015d20: 7465 2072 6f77 2e0d 0a20 2020 2020 2020  te row...       
+00015d30: 2022 2222 0d0a 2020 2020 2020 2020 6172   """..        ar
+00015d40: 7220 3d20 7365 6c66 2e72 6561 645f 6172  r = self.read_ar
+00015d50: 7261 7928 6261 6e64 3d62 616e 6429 0d0a  ray(band=band)..
+00015d60: 2020 2020 2020 2020 6e6f 5f64 6174 615f          no_data_
+00015d70: 7661 6c20 3d20 7365 6c66 2e6e 6f5f 6461  val = self.no_da
+00015d80: 7461 5f76 616c 7565 5b62 616e 645d 0d0a  ta_value[band]..
+00015d90: 0d0a 2020 2020 2020 2020 6966 206e 6f5f  ..        if no_
+00015da0: 6461 7461 5f76 616c 2069 7320 4e6f 6e65  data_val is None
+00015db0: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+00015dc0: 6620 6e6f 7420 286e 702e 6973 6e61 6e28  f not (np.isnan(
+00015dd0: 6172 7229 292e 616e 7928 293a 0d0a 2020  arr)).any():..  
+00015de0: 2020 2020 2020 2020 2020 2020 2020 6c6f                lo
+00015df0: 6767 6572 2e77 6172 6e69 6e67 280d 0a20  gger.warning(.. 
+00015e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015e10: 2020 2022 7468 6520 6e6f 6461 7461 2076     "the nodata v
+00015e20: 616c 7565 7320 7374 6f72 6564 2069 6e20  alues stored in 
+00015e30: 7468 6520 7261 7374 6572 2064 6f65 7320  the raster does 
+00015e40: 6e6f 7420 6578 6973 7420 696e 2074 6865  not exist in the
+00015e50: 2072 6173 7465 7220 220d 0a20 2020 2020   raster "..     
+00015e60: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00015e70: 736f 2065 6974 6865 7220 7468 6520 7261  so either the ra
+00015e80: 7374 6572 2065 7874 656e 7420 6973 2061  ster extent is a
+00015e90: 6c6c 2066 756c 6c20 7769 7468 2064 6174  ll full with dat
+00015ea0: 6120 6f72 2074 6865 206e 6f64 6174 6176  a or the nodatav
+00015eb0: 616c 7565 2073 746f 7265 6420 696e 2074  alue stored in t
+00015ec0: 6865 2072 6173 7465 7220 6973 220d 0a20  he raster is".. 
+00015ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015ee0: 2020 2022 206e 6f74 2063 6f72 7265 6374     " not correct
+00015ef0: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
+00015f00: 2020 2029 0d0a 2020 2020 2020 2020 656c     )..        el
+00015f10: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00015f20: 2069 6620 6e6f 7420 286e 702e 6973 636c   if not (np.iscl
+00015f30: 6f73 6528 6172 722c 206e 6f5f 6461 7461  ose(arr, no_data
+00015f40: 5f76 616c 2c20 7274 6f6c 3d30 2e30 3030  _val, rtol=0.000
+00015f50: 3031 2929 2e61 6e79 2829 3a0d 0a20 2020  01)).any():..   
+00015f60: 2020 2020 2020 2020 2020 2020 206c 6f67               log
+00015f70: 6765 722e 7761 726e 696e 6728 0d0a 2020  ger.warning(..  
+00015f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015f90: 2020 2274 6865 206e 6f64 6174 6120 7661    "the nodata va
+00015fa0: 6c75 6573 2073 746f 7265 6420 696e 2074  lues stored in t
+00015fb0: 6865 2072 6173 7465 7220 646f 6573 206e  he raster does n
+00015fc0: 6f74 2065 7869 7374 2069 6e20 7468 6520  ot exist in the 
+00015fd0: 7261 7374 6572 2022 0d0a 2020 2020 2020  raster "..      
+00015fe0: 2020 2020 2020 2020 2020 2020 2020 2273                "s
+00015ff0: 6f20 6569 7468 6572 2074 6865 2072 6173  o either the ras
+00016000: 7465 7220 6578 7465 6e74 2069 7320 616c  ter extent is al
+00016010: 6c20 6675 6c6c 2077 6974 6820 6461 7461  l full with data
+00016020: 206f 7220 7468 6520 6e6f 6461 7461 7661   or the nodatava
+00016030: 6c75 6520 7374 6f72 6564 2069 6e20 7468  lue stored in th
+00016040: 6520 7261 7374 6572 2069 7322 0d0a 2020  e raster is"..  
+00016050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016060: 2020 2220 6e6f 7420 636f 7272 6563 7422    " not correct"
+00016070: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00016080: 2020 290d 0a20 2020 2020 2020 2023 2069    )..        # i
+00016090: 6620 796f 7520 7761 6e74 2074 6f20 6578  f you want to ex
+000160a0: 636c 7564 655f 7661 6c75 6573 2061 6e79  clude_values any
+000160b0: 2076 616c 7565 2069 6e20 7468 6520 7261   value in the ra
+000160c0: 7374 6572 0d0a 2020 2020 2020 2020 6966  ster..        if
+000160d0: 2065 7863 6c75 6465 5f76 616c 7565 733a   exclude_values:
+000160e0: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
+000160f0: 7220 7661 6c20 696e 2065 7863 6c75 6465  r val in exclude
+00016100: 5f76 616c 7565 733a 0d0a 2020 2020 2020  _values:..      
+00016110: 2020 2020 2020 2020 2020 7472 793a 0d0a            try:..
+00016120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016130: 2020 2020 2320 696e 2063 6173 6520 7468      # in case th
+00016140: 6520 7661 6c32 2069 7320 4e6f 6e65 2061  e val2 is None a
+00016150: 6e64 2074 6865 2061 7272 6179 2069 7320  nd the array is 
+00016160: 696e 7420 7479 7065 2074 6865 2066 6f6c  int type the fol
+00016170: 6c6f 7769 6e67 206c 696e 6520 7769 6c6c  lowing line will
+00016180: 2067 6976 6520 6572 726f 7220 6173 204e   give error as N
+00016190: 6f6e 650d 0a20 2020 2020 2020 2020 2020  one..           
+000161a0: 2020 2020 2020 2020 2023 2069 7320 636f           # is co
+000161b0: 6e73 6964 6572 6564 2061 7320 666c 6f61  nsidered as floa
+000161c0: 740d 0a20 2020 2020 2020 2020 2020 2020  t..             
+000161d0: 2020 2020 2020 2061 7272 5b6e 702e 6973         arr[np.is
+000161e0: 636c 6f73 6528 6172 722c 2076 616c 295d  close(arr, val)]
+000161f0: 203d 206e 6f5f 6461 7461 5f76 616c 0d0a   = no_data_val..
+00016200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016210: 6578 6365 7074 2054 7970 6545 7272 6f72  except TypeError
+00016220: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00016230: 2020 2020 2020 2061 7272 203d 2061 7272         arr = arr
+00016240: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
+00016250: 3332 290d 0a20 2020 2020 2020 2020 2020  32)..           
+00016260: 2020 2020 2020 2020 2061 7272 5b6e 702e           arr[np.
+00016270: 6973 636c 6f73 6528 6172 722c 2076 616c  isclose(arr, val
+00016280: 295d 203d 206e 6f5f 6461 7461 5f76 616c  )] = no_data_val
+00016290: 0d0a 0d0a 2020 2020 2020 2020 2320 7265  ....        # re
+000162a0: 706c 6163 6520 616c 6c20 7468 6520 7661  place all the va
+000162b0: 6c75 6573 2077 6974 6820 320d 0a20 2020  lues with 2..   
+000162c0: 2020 2020 2069 6620 6e6f 5f64 6174 615f       if no_data_
+000162d0: 7661 6c20 6973 204e 6f6e 653a 0d0a 2020  val is None:..  
+000162e0: 2020 2020 2020 2020 2020 2320 6368 6563            # chec
+000162f0: 6b20 6966 2074 6865 2077 686f 6c65 2072  k if the whole r
+00016300: 6173 7465 7220 6973 2066 756c 6c20 6f66  aster is full of
+00016310: 206e 6f5f 6461 7461 5f76 616c 7565 0d0a   no_data_value..
+00016320: 2020 2020 2020 2020 2020 2020 6966 2028              if (
+00016330: 6e70 2e69 736e 616e 2861 7272 2929 2e61  np.isnan(arr)).a
+00016340: 6c6c 2829 3a0d 0a20 2020 2020 2020 2020  ll():..         
+00016350: 2020 2020 2020 206c 6f67 6765 722e 7761         logger.wa
+00016360: 726e 696e 6728 2274 6865 2072 6173 7465  rning("the raste
+00016370: 7220 6973 2066 756c 6c20 6f66 206e 6f5f  r is full of no_
+00016380: 6461 7461 5f76 616c 7565 2229 0d0a 2020  data_value")..  
+00016390: 2020 2020 2020 2020 2020 2020 2020 7265                re
+000163a0: 7475 726e 204e 6f6e 650d 0a0d 0a20 2020  turn None....   
+000163b0: 2020 2020 2020 2020 2061 7272 5b7e 6e70           arr[~np
+000163c0: 2e69 736e 616e 2861 7272 295d 203d 2032  .isnan(arr)] = 2
+000163d0: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+000163e0: 0a20 2020 2020 2020 2020 2020 2023 2063  .            # c
+000163f0: 6865 636b 2069 6620 7468 6520 7768 6f6c  heck if the whol
+00016400: 6520 7261 7374 6572 2069 7320 6675 6c6c  e raster is full
+00016410: 206f 6620 6e6f 6461 7461 7661 6c75 650d   of nodatavalue.
+00016420: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00016430: 286e 702e 6973 636c 6f73 6528 6172 722c  (np.isclose(arr,
+00016440: 206e 6f5f 6461 7461 5f76 616c 2c20 7274   no_data_val, rt
+00016450: 6f6c 3d30 2e30 3030 3031 2929 2e61 6c6c  ol=0.00001)).all
+00016460: 2829 3a0d 0a20 2020 2020 2020 2020 2020  ():..           
+00016470: 2020 2020 206c 6f67 6765 722e 7761 726e       logger.warn
+00016480: 696e 6728 2274 6865 2072 6173 7465 7220  ing("the raster 
+00016490: 6973 2066 756c 6c20 6f66 206e 6f5f 6461  is full of no_da
+000164a0: 7461 5f76 616c 7565 2229 0d0a 2020 2020  ta_value")..    
+000164b0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+000164c0: 726e 204e 6f6e 650d 0a0d 0a20 2020 2020  rn None....     
+000164d0: 2020 2020 2020 2061 7272 5b7e 6e70 2e69         arr[~np.i
+000164e0: 7363 6c6f 7365 2861 7272 2c20 6e6f 5f64  sclose(arr, no_d
+000164f0: 6174 615f 7661 6c2c 2072 746f 6c3d 302e  ata_val, rtol=0.
+00016500: 3030 3030 3129 5d20 3d20 320d 0a20 2020  00001)] = 2..   
+00016510: 2020 2020 206e 6577 5f64 6174 6173 6574       new_dataset
+00016520: 203d 2073 656c 662e 6372 6561 7465 5f66   = self.create_f
+00016530: 726f 6d5f 6172 7261 7928 0d0a 2020 2020  rom_array(..    
+00016540: 2020 2020 2020 2020 6172 722c 2073 656c          arr, sel
+00016550: 662e 6765 6f74 7261 6e73 666f 726d 2c20  f.geotransform, 
+00016560: 7365 6c66 2e65 7073 672c 2073 656c 662e  self.epsg, self.
+00016570: 6e6f 5f64 6174 615f 7661 6c75 650d 0a20  no_data_value.. 
+00016580: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
+00016590: 2020 2320 7468 656e 2063 6f6e 7665 7274    # then convert
+000165a0: 2074 6865 2072 6173 6174 6572 2069 6e74   the rasater int
+000165b0: 6f20 706f 6c79 676f 6e0d 0a20 2020 2020  o polygon..     
+000165c0: 2020 2067 6466 203d 206e 6577 5f64 6174     gdf = new_dat
+000165d0: 6173 6574 2e74 6f5f 706f 6c79 676f 6e28  aset.to_polygon(
+000165e0: 6261 6e64 3d62 616e 6429 0d0a 0d0a 2020  band=band)....  
+000165f0: 2020 2020 2020 7265 7475 726e 2067 6466        return gdf
+00016600: 0d0a 0d0a 2020 2020 4073 7461 7469 636d  ....    @staticm
+00016610: 6574 686f 640d 0a20 2020 2064 6566 206e  ethod..    def n
+00016620: 6f72 6d61 6c69 7a65 2861 7272 6179 3a20  ormalize(array: 
+00016630: 6e70 2e6e 6461 7272 6179 293a 0d0a 2020  np.ndarray):..  
+00016640: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+00016650: 2020 204e 6f72 6d61 6c69 7a65 7320 6e75     Normalizes nu
+00016660: 6d70 7920 6172 7261 7973 2069 6e74 6f20  mpy arrays into 
+00016670: 7363 616c 6520 302e 3020 2d20 312e 300d  scale 0.0 - 1.0.
+00016680: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+00016690: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
+000166a0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+000166b0: 2020 2061 7272 6179 203a 205b 6172 7261     array : [arra
+000166c0: 795d 0d0a 2020 2020 2020 2020 2020 2020  y]..            
+000166d0: 6e75 6d70 7920 6172 7261 790d 0a0d 0a20  numpy array.... 
+000166e0: 2020 2020 2020 2052 6574 7572 6e73 0d0a         Returns..
+000166f0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0d          -------.
+00016700: 0a20 2020 2020 2020 2061 7272 6179 0d0a  .        array..
+00016710: 2020 2020 2020 2020 2020 2020 4445 5343              DESC
+00016720: 5249 5054 494f 4e2e 0d0a 2020 2020 2020  RIPTION...      
+00016730: 2020 2222 220d 0a20 2020 2020 2020 2061    """..        a
+00016740: 7272 6179 5f6d 696e 203d 2061 7272 6179  rray_min = array
+00016750: 2e6d 696e 2829 0d0a 2020 2020 2020 2020  .min()..        
+00016760: 6172 7261 795f 6d61 7820 3d20 6172 7261  array_max = arra
+00016770: 792e 6d61 7828 290d 0a20 2020 2020 2020  y.max()..       
+00016780: 2076 616c 203d 2028 6172 7261 7920 2d20   val = (array - 
+00016790: 6172 7261 795f 6d69 6e29 202f 2028 6172  array_min) / (ar
+000167a0: 7261 795f 6d61 7820 2d20 6172 7261 795f  ray_max - array_
+000167b0: 6d69 6e29 0d0a 2020 2020 2020 2020 7265  min)..        re
+000167c0: 7475 726e 2076 616c 0d0a 0d0a 2020 2020  turn val....    
+000167d0: 4073 7461 7469 636d 6574 686f 640d 0a20  @staticmethod.. 
+000167e0: 2020 2064 6566 205f 7769 6e64 6f77 2873     def _window(s
+000167f0: 7263 3a20 6764 616c 2e44 6174 6173 6574  rc: gdal.Dataset
+00016800: 2c20 7369 7a65 3a20 696e 7420 3d20 3235  , size: int = 25
+00016810: 3629 3a0d 0a20 2020 2020 2020 2022 2222  6):..        """
+00016820: 4461 7461 7365 7420 7371 7561 7265 2077  Dataset square w
+00016830: 696e 646f 7720 7369 7a65 2f6f 6666 7365  indow size/offse
+00016840: 7473 2e0d 0a0d 0a20 2020 2020 2020 2050  ts.....        P
+00016850: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
+00016860: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
+00016870: 2020 2020 2020 2073 7263 203a 205b 6764         src : [gd
+00016880: 616c 2e44 6174 6163 7562 655d 0d0a 2020  al.Datacube]..  
+00016890: 2020 2020 2020 2020 2020 6764 616c 2044            gdal D
+000168a0: 6174 6163 7562 6520 6f62 6a65 6374 2e0d  atacube object..
+000168b0: 0a20 2020 2020 2020 2073 697a 6520 3a20  .        size : 
+000168c0: 5b69 6e74 5d0d 0a20 2020 2020 2020 2020  [int]..         
+000168d0: 2020 2053 697a 6520 6f66 2077 696e 646f     Size of windo
+000168e0: 7720 696e 2070 6978 656c 732e 204f 6e65  w in pixels. One
+000168f0: 2076 616c 7565 2072 6571 7569 7265 6420   value required 
+00016900: 7768 6963 6820 6973 2075 7365 6420 666f  which is used fo
+00016910: 7220 626f 7468 2074 6865 0d0a 2020 2020  r both the..    
+00016920: 2020 2020 2020 2020 7820 616e 6420 7920          x and y 
+00016930: 7369 7a65 2e20 452e 6720 3235 3620 6d65  size. E.g 256 me
+00016940: 616e 7320 6120 3235 3678 3235 3620 7769  ans a 256x256 wi
+00016950: 6e64 6f77 2e0d 0a0d 0a20 2020 2020 2020  ndow.....       
+00016960: 2059 6965 6c64 730d 0a20 2020 2020 2020   Yields..       
+00016970: 202d 2d2d 2d2d 2d0d 0a20 2020 2020 2020   ------..       
+00016980: 2074 7570 6c65 5b69 6e74 5d0d 0a20 2020   tuple[int]..   
+00016990: 2020 2020 2020 2020 2034 2065 6c65 6d65           4 eleme
+000169a0: 6e74 2074 7570 6c65 2063 6f6e 7461 696e  nt tuple contain
+000169b0: 696e 6720 7468 6520 7820 7369 7a65 2c20  ing the x size, 
+000169c0: 7920 7369 7a65 2c20 7820 6f66 6673 6574  y size, x offset
+000169d0: 2061 6e64 2079 206f 6666 7365 740d 0a20   and y offset.. 
+000169e0: 2020 2020 2020 2020 2020 206f 6620 7468             of th
+000169f0: 6520 7769 6e64 6f77 2e0d 0a20 2020 2020  e window...     
+00016a00: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+00016a10: 636f 6c73 203d 2073 7263 2e52 6173 7465  cols = src.Raste
+00016a20: 7258 5369 7a65 0d0a 2020 2020 2020 2020  rXSize..        
+00016a30: 726f 7773 203d 2073 7263 2e52 6173 7465  rows = src.Raste
+00016a40: 7259 5369 7a65 0d0a 2020 2020 2020 2020  rYSize..        
+00016a50: 666f 7220 786f 6666 2069 6e20 7261 6e67  for xoff in rang
+00016a60: 6528 302c 2063 6f6c 732c 2073 697a 6529  e(0, cols, size)
+00016a70: 3a0d 0a20 2020 2020 2020 2020 2020 2078  :..            x
+00016a80: 7369 7a65 203d 2073 697a 6520 6966 2073  size = size if s
+00016a90: 697a 6520 2b20 786f 6666 203c 3d20 636f  ize + xoff <= co
+00016aa0: 6c73 2065 6c73 6520 636f 6c73 202d 2078  ls else cols - x
+00016ab0: 6f66 660d 0a20 2020 2020 2020 2020 2020  off..           
+00016ac0: 2066 6f72 2079 6f66 6620 696e 2072 616e   for yoff in ran
+00016ad0: 6765 2830 2c20 726f 7773 2c20 7369 7a65  ge(0, rows, size
+00016ae0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00016af0: 2020 2020 7973 697a 6520 3d20 7369 7a65      ysize = size
+00016b00: 2069 6620 7369 7a65 202b 2079 6f66 6620   if size + yoff 
+00016b10: 3c3d 2072 6f77 7320 656c 7365 2072 6f77  <= rows else row
+00016b20: 7320 2d20 796f 6666 0d0a 2020 2020 2020  s - yoff..      
+00016b30: 2020 2020 2020 2020 2020 7969 656c 6420            yield 
+00016b40: 7873 697a 652c 2079 7369 7a65 2c20 786f  xsize, ysize, xo
+00016b50: 6666 2c20 796f 6666 0d0a 0d0a 2020 2020  ff, yoff....    
+00016b60: 6465 6620 6765 745f 7469 6c65 2873 656c  def get_tile(sel
+00016b70: 662c 2073 697a 653d 3235 3629 3a0d 0a20  f, size=256):.. 
+00016b80: 2020 2020 2020 2022 2222 6765 7473 2061         """gets a
+00016b90: 2072 6173 7465 7220 6172 7261 7920 696e   raster array in
+00016ba0: 2074 696c 6573 2e0d 0a0d 0a20 2020 2020   tiles.....     
+00016bb0: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
+00016bc0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00016bd0: 2d0d 0a20 2020 2020 2020 2073 697a 6520  -..        size 
+00016be0: 3a20 696e 740d 0a20 2020 2020 2020 2020  : int..         
+00016bf0: 2020 2053 697a 6520 6f66 2077 696e 646f     Size of windo
+00016c00: 7720 696e 2070 6978 656c 732e 204f 6e65  w in pixels. One
+00016c10: 2076 616c 7565 2072 6571 7569 7265 6420   value required 
+00016c20: 7768 6963 6820 6973 2075 7365 6420 666f  which is used fo
+00016c30: 7220 626f 7468 2074 6865 0d0a 2020 2020  r both the..    
+00016c40: 2020 2020 2020 2020 7820 616e 6420 7920          x and y 
+00016c50: 7369 7a65 2e20 452e 6720 3235 3620 6d65  size. E.g 256 me
+00016c60: 616e 7320 6120 3235 3678 3235 3620 7769  ans a 256x256 wi
+00016c70: 6e64 6f77 2e0d 0a0d 0a20 2020 2020 2020  ndow.....       
+00016c80: 2059 6965 6c64 730d 0a20 2020 2020 2020   Yields..       
+00016c90: 202d 2d2d 2d2d 2d0d 0a20 2020 2020 2020   ------..       
+00016ca0: 206e 702e 6e64 6172 7261 790d 0a20 2020   np.ndarray..   
+00016cb0: 2020 2020 2020 2020 2044 6174 6173 6574           Dataset
+00016cc0: 2061 7272 6179 2069 6e20 666f 726d 205b   array in form [
+00016cd0: 6261 6e64 5d5b 795d 5b78 5d2e 0d0a 2020  band][y][x]...  
+00016ce0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+00016cf0: 2020 2066 6f72 2078 7369 7a65 2c20 7973     for xsize, ys
+00016d00: 697a 652c 2078 6f66 662c 2079 6f66 6620  ize, xoff, yoff 
+00016d10: 696e 2073 656c 662e 5f77 696e 646f 7728  in self._window(
+00016d20: 7365 6c66 2e72 6173 7465 722c 2073 697a  self.raster, siz
+00016d30: 653d 7369 7a65 293a 0d0a 2020 2020 2020  e=size):..      
+00016d40: 2020 2020 2020 2320 7265 6164 2074 6865        # read the
+00016d50: 2061 7272 6179 2061 7420 6120 6365 7274   array at a cert
+00016d60: 6169 6e20 696e 6465 6365 730d 0a20 2020  ain indeces..   
+00016d70: 2020 2020 2020 2020 2079 6965 6c64 2073           yield s
+00016d80: 656c 662e 7261 7374 6572 2e52 6561 6441  elf.raster.ReadA
+00016d90: 7341 7272 6179 280d 0a20 2020 2020 2020  sArray(..       
+00016da0: 2020 2020 2020 2020 2078 6f66 663d 786f           xoff=xo
+00016db0: 6666 2c20 796f 6666 3d79 6f66 662c 2078  ff, yoff=yoff, x
+00016dc0: 7369 7a65 3d78 7369 7a65 2c20 7973 697a  size=xsize, ysiz
+00016dd0: 653d 7973 697a 650d 0a20 2020 2020 2020  e=ysize..       
+00016de0: 2020 2020 2029 0d0a 0d0a 2020 2020 6465       )....    de
+00016df0: 6620 6c69 7374 4174 7472 6962 7574 6573  f listAttributes
+00016e00: 2873 656c 6629 3a0d 0a20 2020 2020 2020  (self):..       
+00016e10: 2022 2222 5072 696e 7420 4174 7472 6962   """Print Attrib
+00016e20: 7574 6573 204c 6973 742e 2222 220d 0a0d  utes List."""...
+00016e30: 0a20 2020 2020 2020 2070 7269 6e74 2822  .        print("
+00016e40: 5c6e 2229 0d0a 2020 2020 2020 2020 7072  \n")..        pr
+00016e50: 696e 7428 0d0a 2020 2020 2020 2020 2020  int(..          
+00016e60: 2020 6622 4174 7472 6962 7574 6573 204c    f"Attributes L
+00016e70: 6973 7420 6f66 3a20 7b20 7265 7072 2873  ist of: { repr(s
+00016e80: 656c 662e 5f5f 6469 6374 5f5f 5b27 6e61  elf.__dict__['na
+00016e90: 6d65 275d 297d 202d 207b 7365 6c66 2e5f  me'])} - {self._
+00016ea0: 5f63 6c61 7373 5f5f 2e5f 5f6e 616d 655f  _class__.__name_
+00016eb0: 5f7d 2020 496e 7374 616e 6365 5c6e 220d  _}  Instance\n".
+00016ec0: 0a20 2020 2020 2020 2029 0d0a 2020 2020  .        )..    
+00016ed0: 2020 2020 7365 6c66 5f6b 6579 7320 3d20      self_keys = 
+00016ee0: 6c69 7374 2873 656c 662e 5f5f 6469 6374  list(self.__dict
+00016ef0: 5f5f 2e6b 6579 7328 2929 0d0a 2020 2020  __.keys())..    
+00016f00: 2020 2020 7365 6c66 5f6b 6579 732e 736f      self_keys.so
+00016f10: 7274 2829 0d0a 2020 2020 2020 2020 666f  rt()..        fo
+00016f20: 7220 6b65 7920 696e 2073 656c 665f 6b65  r key in self_ke
+00016f30: 7973 3a0d 0a20 2020 2020 2020 2020 2020  ys:..           
+00016f40: 2069 6620 6b65 7920 213d 2022 6e61 6d65   if key != "name
+00016f50: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
+00016f60: 2020 2020 7072 696e 7428 7374 7228 6b65      print(str(ke
+00016f70: 7929 202b 2022 203a 2022 202b 2072 6570  y) + " : " + rep
+00016f80: 7228 7365 6c66 2e5f 5f64 6963 745f 5f5b  r(self.__dict__[
+00016f90: 6b65 795d 2929 0d0a 0d0a 2020 2020 2020  key]))....      
+00016fa0: 2020 7072 696e 7428 225c 6e22 290d 0a0d    print("\n")...
+00016fb0: 0a0d 0a63 6c61 7373 2044 6174 6163 7562  ...class Datacub
+00016fc0: 653a 0d0a 0d0a 2020 2020 6669 6c65 733a  e:....    files:
+00016fd0: 204c 6973 745b 7374 725d 0d0a 2020 2020   List[str]..    
+00016fe0: 6461 7461 3a20 6e70 2e6e 6461 7272 6179  data: np.ndarray
+00016ff0: 0d0a 0d0a 2020 2020 2222 220d 0a20 2020  ....    """..   
+00017000: 2066 696c 6573 3a0d 0a20 2020 2020 2020   files:..       
+00017010: 206c 6973 7420 6f66 2067 656f 7469 6666   list of geotiff
+00017020: 2066 696c 6573 2720 6e61 6d65 730d 0a20   files' names.. 
+00017030: 2020 2022 2222 0d0a 0d0a 2020 2020 6465     """....    de
+00017040: 6620 5f5f 696e 6974 5f5f 280d 0a20 2020  f __init__(..   
+00017050: 2020 2020 2073 656c 662c 0d0a 2020 2020       self,..    
+00017060: 2020 2020 7372 633a 2044 6174 6173 6574      src: Dataset
+00017070: 2c0d 0a20 2020 2020 2020 2074 696d 655f  ,..        time_
+00017080: 6c65 6e67 7468 3a20 696e 742c 0d0a 2020  length: int,..  
+00017090: 2020 2020 2020 6669 6c65 733a 204c 6973        files: Lis
+000170a0: 745b 7374 725d 203d 204e 6f6e 652c 0d0a  t[str] = None,..
+000170b0: 2020 2020 293a 0d0a 2020 2020 2020 2020      ):..        
+000170c0: 7365 6c66 2e5f 6261 7365 203d 2073 7263  self._base = src
+000170d0: 0d0a 2020 2020 2020 2020 7365 6c66 2e66  ..        self.f
+000170e0: 696c 6573 203d 2066 696c 6573 0d0a 2020  iles = files..  
+000170f0: 2020 2020 2020 7365 6c66 2e5f 7469 6d65        self._time
+00017100: 5f6c 656e 6774 6820 3d20 7469 6d65 5f6c  _length = time_l
+00017110: 656e 6774 680d 0a0d 0a20 2020 2020 2020  ength....       
+00017120: 2070 6173 730d 0a0d 0a20 2020 2064 6566   pass....    def
+00017130: 205f 5f73 7472 5f5f 2873 656c 6629 3a0d   __str__(self):.
+00017140: 0a20 2020 2020 2020 206d 6573 7361 6765  .        message
+00017150: 203d 2066 2222 220d 0a20 2020 2020 2020   = f"""..       
+00017160: 2020 2020 2046 696c 6573 3a20 7b6c 656e       Files: {len
+00017170: 2873 656c 662e 6669 6c65 7329 7d0d 0a20  (self.files)}.. 
+00017180: 2020 2020 2020 2020 2020 2043 656c 6c20             Cell 
+00017190: 7369 7a65 3a20 7b73 656c 662e 5f62 6173  size: {self._bas
+000171a0: 652e 6365 6c6c 5f73 697a 657d 0d0a 2020  e.cell_size}..  
+000171b0: 2020 2020 2020 2020 2020 4550 5347 3a20            EPSG: 
+000171c0: 7b73 656c 662e 5f62 6173 652e 6570 7367  {self._base.epsg
+000171d0: 7d0d 0a20 2020 2020 2020 2020 2020 2056  }..            V
+000171e0: 6172 6961 626c 6573 3a20 7b73 656c 662e  ariables: {self.
+000171f0: 5f62 6173 652e 7661 7269 6162 6c65 737d  _base.variables}
+00017200: 0d0a 2020 2020 2020 2020 2020 2020 4469  ..            Di
+00017210: 6d65 6e73 696f 6e3a 207b 7365 6c66 2e72  mension: {self.r
+00017220: 6f77 7320 2a20 7365 6c66 2e63 6f6c 756d  ows * self.colum
+00017230: 6e73 7d0d 0a20 2020 2020 2020 2020 2020  ns}..           
+00017240: 204d 6173 6b3a 207b 7365 6c66 2e5f 6261   Mask: {self._ba
+00017250: 7365 2e6e 6f5f 6461 7461 5f76 616c 7565  se.no_data_value
+00017260: 5b30 5d7d 0d0a 2020 2020 2020 2020 2222  [0]}..        ""
+00017270: 220d 0a20 2020 2020 2020 2072 6574 7572  "..        retur
+00017280: 6e20 6d65 7373 6167 650d 0a0d 0a20 2020  n message....   
+00017290: 2040 7072 6f70 6572 7479 0d0a 2020 2020   @property..    
+000172a0: 6465 6620 6261 7365 2873 656c 6629 202d  def base(self) -
+000172b0: 3e20 4461 7461 7365 743a 0d0a 2020 2020  > Dataset:..    
+000172c0: 2020 2020 2222 2262 6173 652e 0d0a 0d0a      """base.....
+000172d0: 2020 2020 2020 2020 4261 7365 2044 6174          Base Dat
+000172e0: 6173 6574 0d0a 2020 2020 2020 2020 2222  aset..        ""
+000172f0: 220d 0a20 2020 2020 2020 2072 6574 7572  "..        retur
+00017300: 6e20 7365 6c66 2e5f 6261 7365 0d0a 0d0a  n self._base....
+00017310: 2020 2020 4070 726f 7065 7274 790d 0a20      @property.. 
+00017320: 2020 2064 6566 2074 696d 655f 6c65 6e67     def time_leng
+00017330: 7468 2873 656c 6629 202d 3e20 696e 743a  th(self) -> int:
+00017340: 0d0a 2020 2020 2020 2020 2222 226c 656e  ..        """len
+00017350: 6774 6820 6f66 2074 6865 2064 6174 6173  gth of the datas
+00017360: 6574 2e22 2222 0d0a 2020 2020 2020 2020  et."""..        
+00017370: 7265 7475 726e 2073 656c 662e 5f74 696d  return self._tim
+00017380: 655f 6c65 6e67 7468 0d0a 0d0a 2020 2020  e_length....    
+00017390: 4070 726f 7065 7274 790d 0a20 2020 2064  @property..    d
+000173a0: 6566 2072 6f77 7328 7365 6c66 293a 0d0a  ef rows(self):..
+000173b0: 2020 2020 2020 2020 2222 224e 756d 6265          """Numbe
+000173c0: 7220 6f66 2072 6f77 7322 2222 0d0a 2020  r of rows"""..  
+000173d0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+000173e0: 662e 5f62 6173 652e 726f 7773 0d0a 0d0a  f._base.rows....
+000173f0: 2020 2020 4070 726f 7065 7274 790d 0a20      @property.. 
+00017400: 2020 2064 6566 2073 6861 7065 2873 656c     def shape(sel
+00017410: 6629 3a0d 0a20 2020 2020 2020 2022 2222  f):..        """
+00017420: 4e75 6d62 6572 206f 6620 726f 7773 2222  Number of rows""
+00017430: 220d 0a20 2020 2020 2020 2072 6574 7572  "..        retur
+00017440: 6e20 7365 6c66 2e74 696d 655f 6c65 6e67  n self.time_leng
+00017450: 7468 2c20 7365 6c66 2e72 6f77 732c 2073  th, self.rows, s
+00017460: 656c 662e 636f 6c75 6d6e 730d 0a0d 0a20  elf.columns.... 
+00017470: 2020 2040 7072 6f70 6572 7479 0d0a 2020     @property..  
+00017480: 2020 6465 6620 636f 6c75 6d6e 7328 7365    def columns(se
+00017490: 6c66 293a 0d0a 2020 2020 2020 2020 2222  lf):..        ""
+000174a0: 224e 756d 6265 7220 6f66 2063 6f6c 756d  "Number of colum
+000174b0: 6e73 2222 220d 0a20 2020 2020 2020 2072  ns"""..        r
+000174c0: 6574 7572 6e20 7365 6c66 2e5f 6261 7365  eturn self._base
+000174d0: 2e63 6f6c 756d 6e73 0d0a 0d0a 2020 2020  .columns....    
+000174e0: 4063 6c61 7373 6d65 7468 6f64 0d0a 2020  @classmethod..  
+000174f0: 2020 6465 6620 6372 6561 7465 5f63 7562    def create_cub
+00017500: 6528 636c 732c 2073 7263 3a20 4461 7461  e(cls, src: Data
+00017510: 7365 742c 2064 6174 6173 6574 5f6c 656e  set, dataset_len
+00017520: 6774 683a 2069 6e74 293a 0d0a 2020 2020  gth: int):..    
+00017530: 2020 2020 2222 2243 7265 6174 6520 4461      """Create Da
+00017540: 7461 6375 6265 2e0d 0a0d 0a20 2020 2020  tacube.....     
+00017550: 2020 2020 2020 202d 2043 7265 6174 6520         - Create 
+00017560: 4461 7461 6375 6265 2066 726f 6d20 6120  Datacube from a 
+00017570: 7361 6d70 6c65 2072 6173 7465 7220 616e  sample raster an
+00017580: 640d 0a0d 0a20 2020 2020 2020 2050 6172  d....        Par
+00017590: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
+000175a0: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
+000175b0: 2020 2020 2073 7263 3a20 5b44 6174 6173       src: [Datas
+000175c0: 6574 5d0d 0a20 2020 2020 2020 2020 2020  et]..           
+000175d0: 2052 4173 7465 7220 4f62 6a65 6374 0d0a   RAster Object..
+000175e0: 2020 2020 2020 2020 6461 7461 7365 745f          dataset_
+000175f0: 6c65 6e67 7468 3a20 5b69 6e74 5d0d 0a20  length: [int].. 
+00017600: 2020 2020 2020 2020 2020 206c 656e 6774             lengt
+00017610: 6820 6f66 2074 6865 2064 6174 6173 6574  h of the dataset
+00017620: 2e0d 0a0d 0a20 2020 2020 2020 2052 6574  .....        Ret
+00017630: 7572 6e73 0d0a 2020 2020 2020 2020 2d2d  urns..        --
+00017640: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2044  -----..        D
+00017650: 6174 6163 7562 6520 6f62 6a65 6374 2e0d  atacube object..
+00017660: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+00017670: 2020 2020 2020 7265 7475 726e 2063 6c73        return cls
+00017680: 2873 7263 2c20 6461 7461 7365 745f 6c65  (src, dataset_le
+00017690: 6e67 7468 290d 0a0d 0a20 2020 2064 6566  ngth)....    def
+000176a0: 2075 7064 6174 655f 6375 6265 2873 656c   update_cube(sel
+000176b0: 662c 2061 7272 6179 3a20 6e70 2e6e 6461  f, array: np.nda
+000176c0: 7272 6179 293a 0d0a 2020 2020 2020 2020  rray):..        
+000176d0: 2222 2255 7064 6174 6520 6461 7461 7365  """Update datase
+000176e0: 7420 6461 7461 2e0d 0a0d 0a20 2020 2020  t data.....     
+000176f0: 2020 2020 2020 202d 2054 6869 7320 6675         - This fu
+00017700: 6e63 7469 6f6e 2063 7265 6174 6573 2061  nction creates a
+00017710: 2047 656f 7469 6666 2072 6173 7465 7220   Geotiff raster 
+00017720: 6c69 6b65 2061 6e6f 7468 6572 2069 6e70  like another inp
+00017730: 7574 2072 6173 7465 722c 206e 6577 2072  ut raster, new r
+00017740: 6173 7465 7220 7769 6c6c 2068 6176 6520  aster will have 
+00017750: 7468 6520 7361 6d65 0d0a 2020 2020 2020  the same..      
+00017760: 2020 2020 2020 7072 6f6a 6563 7469 6f6e        projection
+00017770: 2c20 636f 6f72 6469 6e61 7465 7320 6f72  , coordinates or
+00017780: 2074 6865 2074 6f70 206c 6566 7420 636f   the top left co
+00017790: 726e 6572 206f 6620 7468 6520 6f72 6967  rner of the orig
+000177a0: 696e 616c 2072 6173 7465 722c 2063 656c  inal raster, cel
+000177b0: 6c20 7369 7a65 2c20 6e6f 6461 7461 2076  l size, nodata v
+000177c0: 656c 7565 2c20 616e 6420 6e75 6d62 6572  elue, and number
+000177d0: 0d0a 2020 2020 2020 2020 2020 2020 6f66  ..            of
+000177e0: 2072 6f77 7320 616e 6420 636f 6c75 6d6e   rows and column
+000177f0: 730d 0a20 2020 2020 2020 2020 2020 202d  s..            -
+00017800: 2074 6865 2072 6173 7465 7220 616e 6420   the raster and 
+00017810: 7468 6520 6769 7665 6e20 6172 7261 7920  the given array 
+00017820: 7368 6f75 6c64 2068 6176 6520 7468 6520  should have the 
+00017830: 7361 6d65 206e 756d 6265 7220 6f66 2063  same number of c
+00017840: 6f6c 756d 6e73 2061 6e64 2072 6f77 732e  olumns and rows.
+00017850: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
+00017860: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
+00017870: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+00017880: 2020 2020 6172 7261 793a 205b 6e75 6d70      array: [nump
+00017890: 7920 6172 7261 795d 0d0a 2020 2020 2020  y array]..      
+000178a0: 2020 2020 2020 3344 2061 7272 6179 2074        3D array t
+000178b0: 6f20 6265 2073 746f 7265 7320 6173 2061  o be stores as a
+000178c0: 2072 6173 7465 7273 2c20 7468 6520 6469   rasters, the di
+000178d0: 6d65 6e73 696f 6e73 2073 686f 756c 6420  mensions should 
+000178e0: 6265 0d0a 2020 2020 2020 2020 2020 2020  be..            
+000178f0: 5b72 6f77 732c 2063 6f6c 756d 6e73 2c20  [rows, columns, 
+00017900: 7469 6d65 7365 7269 6573 206c 656e 6774  timeseries lengt
+00017910: 685d 0d0a 0d0a 2020 2020 2020 2020 5265  h]....        Re
+00017920: 7475 726e 730d 0a20 2020 2020 2020 202d  turns..        -
+00017930: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+00017940: 7361 7665 2074 6865 206e 6577 2072 6173  save the new ras
+00017950: 7465 7220 746f 2074 6865 2067 6976 656e  ter to the given
+00017960: 2070 6174 680d 0a0d 0a20 2020 2020 2020   path....       
+00017970: 2045 7861 6d70 6c65 730d 0a20 2020 2020   Examples..     
+00017980: 2020 202d 2d2d 2d2d 2d2d 2d0d 0a20 2020     --------..   
+00017990: 2020 2020 203e 3e3e 2073 7263 5f72 6173       >>> src_ras
+000179a0: 7465 7220 3d20 6764 616c 2e4f 7065 6e28  ter = gdal.Open(
+000179b0: 2244 454d 2e74 6966 2229 0d0a 2020 2020  "DEM.tif")..    
+000179c0: 2020 2020 3e3e 3e20 6e61 6d65 203d 205b      >>> name = [
+000179d0: 2251 5f32 3031 325f 3031 5f30 315f 3031  "Q_2012_01_01_01
+000179e0: 2e74 6966 222c 2251 5f32 3031 325f 3031  .tif","Q_2012_01
+000179f0: 5f30 315f 3032 2e74 6966 222c 2251 5f32  _01_02.tif","Q_2
+00017a00: 3031 325f 3031 5f30 315f 3033 2e74 6966  012_01_01_03.tif
+00017a10: 222c 2251 5f32 3031 325f 3031 5f30 315f  ","Q_2012_01_01_
+00017a20: 3034 2e74 6966 225d 0d0a 2020 2020 2020  04.tif"]..      
+00017a30: 2020 3e3e 3e20 4461 7461 6375 6265 2e72    >>> Datacube.r
+00017a40: 6173 7465 7273 4c69 6b65 2873 7263 5f72  astersLike(src_r
+00017a50: 6173 7465 722c 2064 6174 612c 206e 616d  aster, data, nam
+00017a60: 6529 0d0a 2020 2020 2020 2020 2222 220d  e)..        """.
+00017a70: 0a20 2020 2020 2020 2073 656c 662e 6461  .        self.da
+00017a80: 7461 203d 2061 7272 6179 0d0a 0d0a 2020  ta = array....  
+00017a90: 2020 4063 6c61 7373 6d65 7468 6f64 0d0a    @classmethod..
+00017aa0: 2020 2020 6465 6620 7265 6164 5f73 6570      def read_sep
+00017ab0: 6172 6174 655f 6669 6c65 7328 0d0a 2020  arate_files(..  
+00017ac0: 2020 2020 2020 636c 732c 0d0a 2020 2020        cls,..    
+00017ad0: 2020 2020 7061 7468 3a20 556e 696f 6e5b      path: Union[
+00017ae0: 7374 722c 204c 6973 745b 7374 725d 5d2c  str, List[str]],
+00017af0: 0d0a 2020 2020 2020 2020 7769 7468 5f6f  ..        with_o
+00017b00: 7264 6572 3a20 626f 6f6c 203d 2046 616c  rder: bool = Fal
+00017b10: 7365 2c0d 0a20 2020 2020 2020 2073 7461  se,..        sta
+00017b20: 7274 3a20 7374 7220 3d20 4e6f 6e65 2c0d  rt: str = None,.
+00017b30: 0a20 2020 2020 2020 2065 6e64 3a20 7374  .        end: st
+00017b40: 7220 3d20 4e6f 6e65 2c0d 0a20 2020 2020  r = None,..     
+00017b50: 2020 2066 6d74 3a20 7374 7220 3d20 2225     fmt: str = "%
+00017b60: 592d 256d 2d25 6422 2c0d 0a20 2020 2020  Y-%m-%d",..     
+00017b70: 2020 2066 7265 713a 2073 7472 203d 2022     freq: str = "
+00017b80: 6461 696c 7922 2c0d 0a20 2020 2020 2020  daily",..       
+00017b90: 2073 6570 6172 6174 6f72 3a20 7374 7220   separator: str 
+00017ba0: 3d20 225f 222c 0d0a 2020 2020 2020 2020  = "_",..        
+00017bb0: 6578 7465 6e73 696f 6e3a 2073 7472 203d  extension: str =
+00017bc0: 2022 2e74 6966 222c 0d0a 2020 2020 293a   ".tif",..    ):
+00017bd0: 0d0a 2020 2020 2020 2020 2222 2272 6561  ..        """rea
+00017be0: 645f 7365 7061 7261 7465 5f66 696c 6573  d_separate_files
+00017bf0: 2e0d 0a0d 0a20 2020 2020 2020 2020 2020  .....           
+00017c00: 202d 2072 6561 6473 2072 6173 7465 7273   - reads rasters
+00017c10: 2066 726f 6d20 6120 666f 6c64 6572 2061   from a folder a
+00017c20: 6e64 2063 7265 6174 6573 2061 2033 6420  nd creates a 3d 
+00017c30: 6172 7261 7920 7769 7468 2074 6865 2073  array with the s
+00017c40: 616d 6520 3264 2064 696d 656e 7369 6f6e  ame 2d dimension
+00017c50: 7320 6f66 2074 6865 2066 6972 7374 2072  s of the first r
+00017c60: 6173 7465 7220 696e 0d0a 2020 2020 2020  aster in..      
+00017c70: 2020 2020 2020 7468 6520 666f 6c64 6572        the folder
+00017c80: 2061 6e64 206c 656e 2061 7320 7468 6520   and len as the 
+00017c90: 6e75 6d62 6572 206f 6620 6669 6c65 730d  number of files.
+00017ca0: 0a0d 0a20 2020 2020 2020 2069 6e73 6964  ...        insid
+00017cb0: 6520 7468 6520 666f 6c64 6572 2e0d 0a20  e the folder... 
+00017cc0: 2020 2020 2020 2020 2020 202d 2041 6c6c             - All
+00017cd0: 2072 6173 7465 7273 2073 686f 756c 6420   rasters should 
+00017ce0: 6861 7665 2074 6865 2073 616d 6520 6469  have the same di
+00017cf0: 6d65 6e73 696f 6e73 0d0a 2020 2020 2020  mensions..      
+00017d00: 2020 2020 2020 2d20 466f 6c64 6572 2073        - Folder s
+00017d10: 686f 756c 6420 6f6e 6c79 2063 6f6e 7461  hould only conta
+00017d20: 696e 2072 6173 7465 7220 6669 6c65 730d  in raster files.
+00017d30: 0a20 2020 2020 2020 2020 2020 202d 2072  .            - r
+00017d40: 6173 7465 7220 6669 6c65 206e 616d 6520  aster file name 
+00017d50: 7368 6f75 6c64 2068 6176 6520 7468 6520  should have the 
+00017d60: 6461 7465 2061 7420 7468 6520 656e 6420  date at the end 
+00017d70: 6f66 2074 6865 2066 696c 6520 6e61 6d65  of the file name
+00017d80: 2062 6566 6f72 6520 7468 6520 6578 7465   before the exte
+00017d90: 6e73 696f 6e20 6469 7265 6374 6c79 0d0a  nsion directly..
+00017da0: 2020 2020 2020 2020 2020 2020 2020 7769                wi
+00017db0: 7468 2074 6865 2059 5959 592e 4d4d 2e44  th the YYYY.MM.D
+00017dc0: 4420 2f20 5959 5959 2d4d 4d2d 4444 206f  D / YYYY-MM-DD o
+00017dd0: 7220 5959 5959 5f4d 4d5f 4444 0d0a 2020  r YYYY_MM_DD..  
+00017de0: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+00017df0: 2235 305f 4d53 5745 505f 3139 3739 2e30  "50_MSWEP_1979.0
+00017e00: 312e 3031 2e74 6966 220d 0a0d 0a20 2020  1.01.tif"....   
+00017e10: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
+00017e20: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00017e30: 2d2d 2d0d 0a20 2020 2020 2020 2070 6174  ---..        pat
+00017e40: 683a 5b53 7472 696e 672f 6c69 7374 5d0d  h:[String/list].
+00017e50: 0a20 2020 2020 2020 2020 2020 2070 6174  .            pat
+00017e60: 6820 6f66 2074 6865 2066 6f6c 6465 7220  h of the folder 
+00017e70: 7468 6174 2063 6f6e 7461 696e 7320 616c  that contains al
+00017e80: 6c20 7468 6520 7261 7374 6572 7320 6f72  l the rasters or
+00017e90: 0d0a 2020 2020 2020 2020 2020 2020 6120  ..            a 
+00017ea0: 6c69 7374 2063 6f6e 7461 696e 7320 7468  list contains th
+00017eb0: 6520 7061 7468 7320 6f66 2074 6865 2072  e paths of the r
+00017ec0: 6173 7465 7273 2074 6f20 7265 6164 2e0d  asters to read..
+00017ed0: 0a20 2020 2020 2020 2077 6974 685f 6f72  .        with_or
+00017ee0: 6465 723a 205b 626f 6f6c 5d0d 0a20 2020  der: [bool]..   
+00017ef0: 2020 2020 2020 2020 2054 7275 6520 6966           True if
+00017f00: 2074 6865 2072 6173 7465 7273 2066 6f6c   the rasters fol
+00017f10: 6c6f 7773 2061 2063 6572 7461 696e 206f  lows a certain o
+00017f20: 7264 6572 2c20 7468 656e 2074 6865 2072  rder, then the r
+00017f30: 6173 7465 7273 206e 616d 6573 2073 686f  asters names sho
+00017f40: 756c 6420 6861 7665 2061 0d0a 2020 2020  uld have a..    
+00017f50: 2020 2020 2020 2020 6e75 6d62 6572 2061          number a
+00017f60: 7420 7468 6520 6265 6769 6e6e 696e 6720  t the beginning 
+00017f70: 6f66 2074 6865 2066 696c 6520 6e61 6d65  of the file name
+00017f80: 2069 6e64 6963 6174 696e 6720 7468 6520   indicating the 
+00017f90: 6f72 6465 722e 0d0a 2020 2020 2020 2020  order...        
+00017fa0: 2020 2020 3e3e 3e20 2230 315f 4d53 5745      >>> "01_MSWE
+00017fb0: 505f 3139 3739 2e30 312e 3031 2e74 6966  P_1979.01.01.tif
+00017fc0: 220d 0a20 2020 2020 2020 2020 2020 203e  "..            >
+00017fd0: 3e3e 2022 3032 5f4d 5357 4550 5f31 3937  >> "02_MSWEP_197
+00017fe0: 392e 3031 2e30 322e 7469 6622 0d0a 2020  9.01.02.tif"..  
+00017ff0: 2020 2020 2020 2020 2020 3e3e 3e20 2e2e            >>> ..
+00018000: 2e0d 0a20 2020 2020 2020 2020 2020 203e  ...            >
+00018010: 3e3e 2022 3230 5f4d 5357 4550 5f31 3937  >> "20_MSWEP_197
+00018020: 392e 3031 2e32 302e 7469 6622 0d0a 2020  9.01.20.tif"..  
+00018030: 2020 2020 2020 2020 2020 2d20 6375 7272            - curr
+00018040: 656e 746c 7920 7468 6520 6675 6e63 7469  ently the functi
+00018050: 6f6e 2064 6570 656e 6473 206d 6169 6e6c  on depends mainl
+00018060: 7920 6f6e 2074 6865 2073 6570 6172 6174  y on the separat
+00018070: 6f72 2022 5f22 2074 6861 7420 7365 7061  or "_" that sepa
+00018080: 7261 7465 2074 6865 206f 7264 6572 206e  rate the order n
+00018090: 756d 6265 7220 6672 6f6d 2074 6865 2072  umber from the r
+000180a0: 6573 7420 6f66 0d0a 2020 2020 2020 2020  est of..        
+000180b0: 2020 2020 6669 6c65 206e 616d 652e 0d0a      file name...
+000180c0: 2020 2020 2020 2020 2020 2020 2d20 7468              - th
+000180d0: 6520 7365 7061 7261 746f 7220 6265 7477  e separator betw
+000180e0: 6565 6e20 7468 6520 6461 7465 2070 6172  een the date par
+000180f0: 7473 2059 5959 592e 4d4d 2e44 4420 6972  ts YYYY.MM.DD ir
+00018100: 2059 5959 595f 4d4d 5f44 4420 6f72 2061   YYYY_MM_DD or a
+00018110: 6e79 206f 7468 6572 2073 6570 6172 6174  ny other separat
+00018120: 6f72 2064 6f65 7320 6e6f 7420 6d61 7474  or does not matt
+00018130: 6572 2c0d 0a20 2020 2020 2020 2020 2020  er,..           
+00018140: 2068 6f77 6576 6572 2074 6865 2073 6570   however the sep
+00018150: 6172 6174 6f72 2068 6173 2074 6f20 6265  arator has to be
+00018160: 206f 6e6c 7920 6f6e 6520 6c65 7474 6572   only one letter
+00018170: 2e0d 0a20 2020 2020 2020 2066 6d74 3a20  ...        fmt: 
+00018180: 5b73 7472 5d0d 0a20 2020 2020 2020 2020  [str]..         
+00018190: 2020 2066 6f72 6d61 7420 6f66 2074 6865     format of the
+000181a0: 2067 6976 656e 2064 6174 650d 0a20 2020   given date..   
+000181b0: 2020 2020 2073 7461 7274 3a20 5b73 7472       start: [str
+000181c0: 5d0d 0a20 2020 2020 2020 2020 2020 2073  ]..            s
+000181d0: 7461 7274 2064 6174 6520 6966 2079 6f75  tart date if you
+000181e0: 2077 616e 7420 746f 2072 6561 6420 7468   want to read th
+000181f0: 6520 696e 7075 7420 7261 7374 6572 2066  e input raster f
+00018200: 6f72 2061 2073 7065 6369 6669 6320 7065  or a specific pe
+00018210: 7269 6f64 206f 6e6c 7920 616e 6420 6e6f  riod only and no
+00018220: 7420 616c 6c20 7261 7374 6572 732c 0d0a  t all rasters,..
+00018230: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00018240: 6f74 2067 6976 656e 2061 6c6c 2072 6173  ot given all ras
+00018250: 7465 7273 2069 6e20 7468 6520 6769 7665  ters in the give
+00018260: 6e20 7061 7468 2077 696c 6c20 6265 2072  n path will be r
+00018270: 6561 642e 0d0a 2020 2020 2020 2020 2020  ead...          
+00018280: 2020 4869 6e74 3a0d 0a20 2020 2020 2020    Hint:..       
+00018290: 2020 2020 2020 2020 2054 6865 2064 6174           The dat
+000182a0: 6520 696e 2074 6865 2072 6173 7465 7220  e in the raster 
+000182b0: 6669 6c65 206e 616d 6520 7368 6f75 6c64  file name should
+000182c0: 2062 6520 7468 6520 6c61 7374 2073 7472   be the last str
+000182d0: 696e 6720 6265 666f 7220 7468 6520 6669  ing befor the fi
+000182e0: 6c65 2065 7874 656e 7369 6f6e 0d0a 2020  le extension..  
+000182f0: 2020 2020 2020 2020 2020 2020 2020 3e3e                >>
+00018300: 3e20 2232 305f 4d53 5745 505f 5959 5959  > "20_MSWEP_YYYY
+00018310: 2e4d 4d2e 4444 2e74 6966 220d 0a20 2020  .MM.DD.tif"..   
+00018320: 2020 2020 2065 6e64 3a20 5b73 7472 5d0d       end: [str].
+00018330: 0a20 2020 2020 2020 2020 2020 2065 6e64  .            end
+00018340: 2064 6174 6520 6966 2079 6f75 2077 616e   date if you wan
+00018350: 7420 746f 2072 6561 6420 7468 6520 696e  t to read the in
+00018360: 7075 7420 7465 6d70 6572 6174 7572 6520  put temperature 
+00018370: 666f 7220 6120 7370 6563 6966 6963 2070  for a specific p
+00018380: 6572 696f 6420 6f6e 6c79 2c0d 0a20 2020  eriod only,..   
+00018390: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+000183a0: 6769 7665 6e20 616c 6c20 7261 7374 6572  given all raster
+000183b0: 7320 696e 2074 6865 2067 6976 656e 2070  s in the given p
+000183c0: 6174 6820 7769 6c6c 2062 6520 7265 6164  ath will be read
+000183d0: 2e0d 0a20 2020 2020 2020 2020 2020 2048  ...            H
+000183e0: 696e 743a 0d0a 2020 2020 2020 2020 2020  int:..          
+000183f0: 2020 2020 2020 5468 6520 6461 7465 2069        The date i
+00018400: 6e20 7468 6520 7261 7374 6572 2066 696c  n the raster fil
+00018410: 6520 6e61 6d65 2073 686f 756c 6420 6265  e name should be
+00018420: 2074 6865 206c 6173 7420 7374 7269 6e67   the last string
+00018430: 2062 6566 6f72 2074 6865 2066 696c 6520   befor the file 
+00018440: 6578 7465 6e73 696f 6e0d 0a20 2020 2020  extension..     
+00018450: 2020 2020 2020 2020 2020 203e 3e3e 2022             >>> "
+00018460: 3230 5f4d 5357 4550 5f59 5959 592e 4d4d  20_MSWEP_YYYY.MM
+00018470: 2e44 442e 7469 6622 0d0a 2020 2020 2020  .DD.tif"..      
+00018480: 2020 6672 6571 3a20 5b73 7472 5d0d 0a20    freq: [str].. 
+00018490: 2020 2020 2020 2020 2020 2066 7265 7175             frequ
+000184a0: 656e 6379 206f 6620 7468 6520 7261 7374  ency of the rast
+000184b0: 6572 7320 2264 6169 6c79 222c 2048 6f75  ers "daily", Hou
+000184c0: 726c 792c 206d 6f6e 7468 6c79 0d0a 2020  rly, monthly..  
+000184d0: 2020 2020 2020 7365 7061 7261 746f 723a        separator:
+000184e0: 205b 7374 725d 0d0a 2020 2020 2020 2020   [str]..        
+000184f0: 2020 2020 7365 7061 7261 746f 7220 6265      separator be
+00018500: 7477 6565 6e20 7468 6520 6f72 6465 7220  tween the order 
+00018510: 696e 2074 6865 2062 6567 696e 6e69 6e67  in the beginning
+00018520: 206f 6620 7468 6520 7261 7374 6572 2066   of the raster f
+00018530: 696c 6520 6e61 6d65 2061 6e64 2074 6865  ile name and the
+00018540: 2072 6573 7420 6f66 2074 6865 2066 696c   rest of the fil
+00018550: 650d 0a20 2020 2020 2020 2020 2020 206e  e..            n
+00018560: 616d 652e 2044 6566 6175 6c74 2069 7320  ame. Default is 
+00018570: 225f 222e 0d0a 2020 2020 2020 2020 6578  "_"...        ex
+00018580: 7465 6e73 696f 6e3a 205b 7374 725d 0d0a  tension: [str]..
+00018590: 2020 2020 2020 2020 2020 2020 7468 6520              the 
+000185a0: 6578 7465 6e73 696f 6e20 6f66 2074 6865  extension of the
+000185b0: 2066 696c 6573 2079 6f75 2077 616e 7420   files you want 
+000185c0: 746f 2072 6561 6420 6672 6f6d 2074 6865  to read from the
+000185d0: 2067 6976 656e 2070 6174 682e 2044 6566   given path. Def
+000185e0: 6175 6c74 2069 7320 222e 7469 6622 2e0d  ault is ".tif"..
+000185f0: 0a0d 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
+00018600: 6e73 0d0a 2020 2020 2020 2020 2d2d 2d2d  ns..        ----
+00018610: 2d2d 2d0d 0a20 2020 2020 2020 2061 7272  ---..        arr
+00018620: 5f33 643a 205b 6e75 6d70 792e 6e64 6172  _3d: [numpy.ndar
+00018630: 7261 795d 0d0a 2020 2020 2020 2020 2020  ray]..          
+00018640: 2020 3364 2061 7272 6179 2063 6f6e 7461    3d array conta
+00018650: 696e 7320 6172 7261 7973 2072 6561 6420  ins arrays read 
+00018660: 6672 6f6d 2061 6c6c 2072 6173 7465 7273  from all rasters
+00018670: 2069 6e20 7468 6520 666f 6c64 6572 2e0d   in the folder..
+00018680: 0a0d 0a20 2020 2020 2020 2045 7861 6d70  ...        Examp
+00018690: 6c65 0d0a 2020 2020 2020 2020 2d2d 2d2d  le..        ----
+000186a0: 2d2d 2d0d 0a20 2020 2020 2020 203e 3e3e  ---..        >>>
+000186b0: 2066 726f 6d20 7079 7261 6d69 6473 2e64   from pyramids.d
+000186c0: 6174 6173 6574 2069 6d70 6f72 7420 4461  ataset import Da
+000186d0: 7461 6375 6265 0d0a 2020 2020 2020 2020  tacube..        
+000186e0: 3e3e 3e20 7261 7374 6572 5f66 6f6c 6465  >>> raster_folde
+000186f0: 7220 3d20 2265 7861 6d70 6c65 732f 4749  r = "examples/GI
+00018700: 532f 6461 7461 2f72 6173 7465 722d 666f  S/data/raster-fo
+00018710: 6c64 6572 220d 0a20 2020 2020 2020 203e  lder"..        >
+00018720: 3e3e 2070 7265 6320 3d20 4461 7461 6375  >> prec = Datacu
+00018730: 6265 2e72 6561 645f 7365 7061 7261 7465  be.read_separate
+00018740: 5f66 696c 6573 2872 6173 7465 725f 666f  _files(raster_fo
+00018750: 6c64 6572 290d 0a0d 0a20 2020 2020 2020  lder)....       
+00018760: 203e 3e3e 2069 6d70 6f72 7420 676c 6f62   >>> import glob
+00018770: 0d0a 2020 2020 2020 2020 3e3e 3e20 7365  ..        >>> se
+00018780: 6172 6368 5f63 7269 7465 7269 6120 3d20  arch_criteria = 
+00018790: 222a 2e74 6966 220d 0a20 2020 2020 2020  "*.tif"..       
+000187a0: 203e 3e3e 2066 696c 655f 6c69 7374 203d   >>> file_list =
+000187b0: 2067 6c6f 622e 676c 6f62 286f 732e 7061   glob.glob(os.pa
+000187c0: 7468 2e6a 6f69 6e28 7261 7374 6572 5f66  th.join(raster_f
+000187d0: 6f6c 6465 722c 2073 6561 7263 685f 6372  older, search_cr
+000187e0: 6974 6572 6961 2929 0d0a 2020 2020 2020  iteria))..      
+000187f0: 2020 3e3e 3e20 7072 6563 203d 2044 6174    >>> prec = Dat
+00018800: 6163 7562 652e 7265 6164 5f73 6570 6172  acube.read_separ
+00018810: 6174 655f 6669 6c65 7328 6669 6c65 5f6c  ate_files(file_l
+00018820: 6973 742c 2077 6974 685f 6f72 6465 723d  ist, with_order=
+00018830: 4661 6c73 6529 0d0a 2020 2020 2020 2020  False)..        
+00018840: 2222 220d 0a20 2020 2020 2020 2069 6620  """..        if 
+00018850: 6e6f 7420 6973 696e 7374 616e 6365 2870  not isinstance(p
+00018860: 6174 682c 2073 7472 2920 616e 6420 6e6f  ath, str) and no
+00018870: 7420 6973 696e 7374 616e 6365 2870 6174  t isinstance(pat
+00018880: 682c 206c 6973 7429 3a0d 0a20 2020 2020  h, list):..     
+00018890: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
+000188a0: 6545 7272 6f72 2866 2270 6174 6820 696e  eError(f"path in
+000188b0: 7075 7420 7368 6f75 6c64 2062 6520 7374  put should be st
+000188c0: 7269 6e67 2f6c 6973 7420 7479 7065 2c20  ring/list type, 
+000188d0: 6769 7665 6e7b 7479 7065 2870 6174 6829  given{type(path)
+000188e0: 7d22 290d 0a0d 0a20 2020 2020 2020 2069  }")....        i
+000188f0: 6620 6973 696e 7374 616e 6365 2870 6174  f isinstance(pat
+00018900: 682c 2073 7472 293a 0d0a 2020 2020 2020  h, str):..      
+00018910: 2020 2020 2020 2320 6368 6563 6b20 7765        # check we
+00018920: 7468 6572 2074 6865 2070 6174 6820 6578  ther the path ex
+00018930: 6973 7420 6f72 206e 6f74 0d0a 2020 2020  ist or not..    
+00018940: 2020 2020 2020 2020 6966 206e 6f74 206f          if not o
+00018950: 732e 7061 7468 2e65 7869 7374 7328 7061  s.path.exists(pa
+00018960: 7468 293a 0d0a 2020 2020 2020 2020 2020  th):..          
+00018970: 2020 2020 2020 7261 6973 6520 4669 6c65        raise File
+00018980: 4e6f 7446 6f75 6e64 4572 726f 7228 2254  NotFoundError("T
+00018990: 6865 2070 6174 6820 796f 7520 6861 7665  he path you have
+000189a0: 2070 726f 7669 6465 6420 646f 6573 206e   provided does n
+000189b0: 6f74 2065 7869 7374 2229 0d0a 2020 2020  ot exist")..    
+000189c0: 2020 2020 2020 2020 2320 6765 7420 6c69          # get li
+000189d0: 7374 206f 6620 616c 6c20 6669 6c65 730d  st of all files.
+000189e0: 0a20 2020 2020 2020 2020 2020 2066 696c  .            fil
+000189f0: 6573 203d 206f 732e 6c69 7374 6469 7228  es = os.listdir(
+00018a00: 7061 7468 290d 0a20 2020 2020 2020 2020  path)..         
+00018a10: 2020 2066 696c 6573 203d 205b 6920 666f     files = [i fo
+00018a20: 7220 6920 696e 2066 696c 6573 2069 6620  r i in files if 
+00018a30: 692e 656e 6473 7769 7468 2865 7874 656e  i.endswith(exten
+00018a40: 7369 6f6e 295d 0d0a 2020 2020 2020 2020  sion)]..        
+00018a50: 2020 2020 2320 6669 6c65 7320 3d20 676c      # files = gl
+00018a60: 6f62 2e67 6c6f 6228 6f73 2e70 6174 682e  ob.glob(os.path.
+00018a70: 6a6f 696e 2870 6174 682c 2022 2a2e 7469  join(path, "*.ti
+00018a80: 6622 2929 0d0a 2020 2020 2020 2020 2020  f"))..          
+00018a90: 2020 2320 6368 6563 6b20 7768 6574 6865    # check whethe
+00018aa0: 7220 7468 6572 6520 6172 6520 6669 6c65  r there are file
+00018ab0: 7320 6f72 206e 6f74 2069 6e73 6964 6520  s or not inside 
+00018ac0: 7468 6520 666f 6c64 6572 0d0a 2020 2020  the folder..    
+00018ad0: 2020 2020 2020 2020 6966 206c 656e 2866          if len(f
+00018ae0: 696c 6573 2920 3c20 313a 0d0a 2020 2020  iles) < 1:..    
+00018af0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00018b00: 6520 4669 6c65 4e6f 7446 6f75 6e64 4572  e FileNotFoundEr
+00018b10: 726f 7228 2254 6865 2070 6174 6820 796f  ror("The path yo
+00018b20: 7520 6861 7665 2070 726f 7669 6465 6420  u have provided 
+00018b30: 6973 2065 6d70 7479 2229 0d0a 2020 2020  is empty")..    
+00018b40: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00018b50: 2020 2020 2020 2066 696c 6573 203d 2070         files = p
+00018b60: 6174 685b 3a5d 0d0a 2020 2020 2020 2020  ath[:]..        
+00018b70: 2320 746f 2073 6f72 7420 7468 6520 6669  # to sort the fi
+00018b80: 6c65 7320 696e 2074 6865 2073 616d 6520  les in the same 
+00018b90: 6f72 6465 7220 6173 2074 6865 2066 6972  order as the fir
+00018ba0: 7374 206e 756d 6265 7220 696e 2074 6865  st number in the
+00018bb0: 206e 616d 650d 0a20 2020 2020 2020 2069   name..        i
+00018bc0: 6620 7769 7468 5f6f 7264 6572 3a0d 0a20  f with_order:.. 
+00018bd0: 2020 2020 2020 2020 2020 2074 7279 3a0d             try:.
+00018be0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018bf0: 2066 696c 6573 4e6f 203d 205b 696e 7428   filesNo = [int(
+00018c00: 692e 7370 6c69 7428 7365 7061 7261 746f  i.split(separato
+00018c10: 7229 5b30 5d29 2066 6f72 2069 2069 6e20  r)[0]) for i in 
+00018c20: 6669 6c65 735d 0d0a 2020 2020 2020 2020  files]..        
+00018c30: 2020 2020 6578 6365 7074 2056 616c 7565      except Value
+00018c40: 4572 726f 723a 0d0a 2020 2020 2020 2020  Error:..        
+00018c50: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00018c60: 6c75 6545 7272 6f72 280d 0a20 2020 2020  lueError(..     
+00018c70: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00018c80: 706c 6561 7365 2069 6e63 6c75 6465 2061  please include a
+00018c90: 206e 756d 6265 7220 6174 2074 6865 2062   number at the b
+00018ca0: 6567 696e 6e69 6e67 206f 6620 7468 6522  eginning of the"
+00018cb0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00018cc0: 2020 2020 2020 2272 6173 7465 7273 206e        "rasters n
+00018cd0: 616d 6520 746f 2069 6e64 6963 6174 6520  ame to indicate 
+00018ce0: 7468 6520 6f72 6465 7220 6f66 2074 6865  the order of the
+00018cf0: 2072 6173 7465 7273 2e20 746f 2064 6f20   rasters. to do 
+00018d00: 736f 2070 6c65 6173 6522 0d0a 2020 2020  so please"..    
+00018d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018d20: 2275 7365 2074 6865 2049 6e70 7574 732e  "use the Inputs.
+00018d30: 5265 6e61 6d65 4669 6c65 7320 6d65 7468  RenameFiles meth
+00018d40: 6f64 2074 6f20 736f 6c76 6520 7468 6973  od to solve this
+00018d50: 2069 7373 7565 2061 6e64 2064 6f6e 2774   issue and don't
+00018d60: 2022 0d0a 2020 2020 2020 2020 2020 2020   "..            
+00018d70: 2020 2020 2020 2020 2269 6e63 6c75 6465          "include
+00018d80: 2061 6e79 206f 7468 6572 2066 696c 6573   any other files
+00018d90: 2069 6e20 7468 6520 666f 6c64 6572 2077   in the folder w
+00018da0: 6974 6820 7468 6520 7261 7374 6572 7322  ith the rasters"
+00018db0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00018dc0: 2020 290d 0a0d 0a20 2020 2020 2020 2020    )....         
+00018dd0: 2020 2066 696c 655f 7475 706c 6520 3d20     file_tuple = 
+00018de0: 736f 7274 6564 287a 6970 2866 696c 6573  sorted(zip(files
+00018df0: 4e6f 2c20 6669 6c65 7329 290d 0a20 2020  No, files))..   
+00018e00: 2020 2020 2020 2020 2066 696c 6573 203d           files =
+00018e10: 205b 7820 666f 7220 5f2c 2078 2069 6e20   [x for _, x in 
+00018e20: 6669 6c65 5f74 7570 6c65 5d0d 0a0d 0a20  file_tuple].... 
+00018e30: 2020 2020 2020 2069 6620 7374 6172 7420         if start 
+00018e40: 6973 206e 6f74 204e 6f6e 6520 6f72 2065  is not None or e
+00018e50: 6e64 2069 7320 6e6f 7420 4e6f 6e65 3a0d  nd is not None:.
+00018e60: 0a20 2020 2020 2020 2020 2020 2073 7461  .            sta
+00018e70: 7274 203d 2064 742e 6461 7465 7469 6d65  rt = dt.datetime
+00018e80: 2e73 7472 7074 696d 6528 7374 6172 742c  .strptime(start,
+00018e90: 2066 6d74 290d 0a20 2020 2020 2020 2020   fmt)..         
+00018ea0: 2020 2065 6e64 203d 2064 742e 6461 7465     end = dt.date
+00018eb0: 7469 6d65 2e73 7472 7074 696d 6528 656e  time.strptime(en
+00018ec0: 642c 2066 6d74 290d 0a0d 0a20 2020 2020  d, fmt)....     
+00018ed0: 2020 2020 2020 2023 2067 6574 2074 6865         # get the
+00018ee0: 2064 6174 6573 2066 6f72 2065 6163 6820   dates for each 
+00018ef0: 6669 6c65 0d0a 2020 2020 2020 2020 2020  file..          
+00018f00: 2020 6461 7465 7320 3d20 6c69 7374 2829    dates = list()
+00018f10: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
+00018f20: 7220 692c 2066 696c 655f 6920 696e 2065  r i, file_i in e
+00018f30: 6e75 6d65 7261 7465 2866 696c 6573 293a  numerate(files):
+00018f40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00018f50: 2020 6966 2066 7265 7120 3d3d 2022 6461    if freq == "da
+00018f60: 696c 7922 3a0d 0a20 2020 2020 2020 2020  ily":..         
+00018f70: 2020 2020 2020 2020 2020 206c 203d 206c             l = l
+00018f80: 656e 2866 696c 655f 6929 202d 2034 0d0a  en(file_i) - 4..
+00018f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018fa0: 2020 2020 6461 7920 3d20 696e 7428 6669      day = int(fi
+00018fb0: 6c65 5f69 5b6c 202d 2032 203a 206c 5d29  le_i[l - 2 : l])
+00018fc0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00018fd0: 2020 2020 2020 6d6f 6e74 6820 3d20 696e        month = in
+00018fe0: 7428 6669 6c65 5f69 5b6c 202d 2035 203a  t(file_i[l - 5 :
+00018ff0: 206c 202d 2033 5d29 0d0a 2020 2020 2020   l - 3])..      
+00019000: 2020 2020 2020 2020 2020 2020 2020 7965                ye
+00019010: 6172 203d 2069 6e74 2866 696c 655f 695b  ar = int(file_i[
+00019020: 6c20 2d20 3130 203a 206c 202d 2036 5d29  l - 10 : l - 6])
+00019030: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00019040: 2020 2020 2020 6461 7465 732e 6170 7065        dates.appe
+00019050: 6e64 2864 742e 6461 7465 7469 6d65 2879  nd(dt.datetime(y
+00019060: 6561 722c 206d 6f6e 7468 2c20 6461 7929  ear, month, day)
+00019070: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00019080: 2020 2065 6c69 6620 6672 6571 203d 3d20     elif freq == 
+00019090: 2268 6f75 726c 7922 3a0d 0a20 2020 2020  "hourly":..     
+000190a0: 2020 2020 2020 2020 2020 2020 2020 2079                 y
+000190b0: 6561 7220 3d20 696e 7428 6669 6c65 5f69  ear = int(file_i
+000190c0: 2e73 706c 6974 2822 5f22 295b 2d34 5d29  .split("_")[-4])
+000190d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000190e0: 2020 2020 2020 6d6f 6e74 6820 3d20 696e        month = in
+000190f0: 7428 6669 6c65 5f69 2e73 706c 6974 2822  t(file_i.split("
+00019100: 5f22 295b 2d33 5d29 0d0a 2020 2020 2020  _")[-3])..      
+00019110: 2020 2020 2020 2020 2020 2020 2020 6461                da
+00019120: 7920 3d20 696e 7428 6669 6c65 5f69 2e73  y = int(file_i.s
+00019130: 706c 6974 2822 5f22 295b 2d32 5d29 0d0a  plit("_")[-2])..
+00019140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019150: 2020 2020 686f 7572 203d 2069 6e74 2866      hour = int(f
+00019160: 696c 655f 692e 7370 6c69 7428 225f 2229  ile_i.split("_")
+00019170: 5b2d 315d 2e73 706c 6974 2822 2e22 295b  [-1].split(".")[
+00019180: 305d 290d 0a20 2020 2020 2020 2020 2020  0])..           
+00019190: 2020 2020 2020 2020 2064 6174 6573 2e61           dates.a
+000191a0: 7070 656e 6428 6474 2e64 6174 6574 696d  ppend(dt.datetim
+000191b0: 6528 7965 6172 2c20 6d6f 6e74 682c 2064  e(year, month, d
+000191c0: 6179 2c20 686f 7572 2929 0d0a 0d0a 2020  ay, hour))....  
+000191d0: 2020 2020 2020 2020 2020 7374 6172 7469            starti
+000191e0: 203d 2064 6174 6573 2e69 6e64 6578 2873   = dates.index(s
+000191f0: 7461 7274 290d 0a20 2020 2020 2020 2020  tart)..         
+00019200: 2020 2065 6e64 6920 3d20 6461 7465 732e     endi = dates.
+00019210: 696e 6465 7828 656e 6429 202b 2031 0d0a  index(end) + 1..
+00019220: 2020 2020 2020 2020 2020 2020 6173 7365              asse
+00019230: 7274 2061 6c6c 280d 0a20 2020 2020 2020  rt all(..       
+00019240: 2020 2020 2020 2020 2066 696c 655f 692e           file_i.
+00019250: 656e 6473 7769 7468 2822 2e74 6966 2229  endswith(".tif")
+00019260: 2066 6f72 2066 696c 655f 6920 696e 2066   for file_i in f
+00019270: 696c 6573 5b73 7461 7274 693a 656e 6469  iles[starti:endi
+00019280: 5d0d 0a20 2020 2020 2020 2020 2020 2029  ]..            )
+00019290: 2c20 2261 6c6c 2066 696c 6573 2069 6e20  , "all files in 
+000192a0: 7468 6520 6769 7665 6e20 666f 6c64 6572  the given folder
+000192b0: 2073 686f 756c 6420 6861 7665 202e 7469   should have .ti
+000192c0: 6620 6578 7465 6e73 696f 6e22 0d0a 2020  f extension"..  
+000192d0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+000192e0: 2020 2020 2020 2020 2073 7461 7274 6920           starti 
+000192f0: 3d20 300d 0a20 2020 2020 2020 2020 2020  = 0..           
+00019300: 2065 6e64 6920 3d20 6c65 6e28 6669 6c65   endi = len(file
+00019310: 7329 0d0a 2020 2020 2020 2020 2020 2020  s)..            
+00019320: 2320 6368 6563 6b20 7468 6174 2066 6f6c  # check that fol
+00019330: 6465 7220 6f6e 6c79 2063 6f6e 7461 696e  der only contain
+00019340: 7320 7261 7374 6572 730d 0a20 2020 2020  s rasters..     
+00019350: 2020 2020 2020 2061 7373 6572 7420 616c         assert al
+00019360: 6c28 0d0a 2020 2020 2020 2020 2020 2020  l(..            
+00019370: 2020 2020 6669 6c65 5f69 2e65 6e64 7377      file_i.endsw
+00019380: 6974 6828 6578 7465 6e73 696f 6e29 2066  ith(extension) f
+00019390: 6f72 2066 696c 655f 6920 696e 2066 696c  or file_i in fil
+000193a0: 6573 0d0a 2020 2020 2020 2020 2020 2020  es..            
+000193b0: 292c 2022 616c 6c20 6669 6c65 7320 696e  ), "all files in
+000193c0: 2074 6865 2067 6976 656e 2066 6f6c 6465   the given folde
+000193d0: 7220 7368 6f75 6c64 2068 6176 6520 2e74  r should have .t
+000193e0: 6966 2065 7874 656e 7369 6f6e 220d 0a0d  if extension"...
+000193f0: 0a20 2020 2020 2020 2023 2066 696c 6573  .        # files
+00019400: 2074 6f20 6265 2072 6561 640d 0a20 2020   to be read..   
+00019410: 2020 2020 2066 696c 6573 203d 2066 696c       files = fil
+00019420: 6573 5b73 7461 7274 693a 656e 6469 5d0d  es[starti:endi].
+00019430: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+00019440: 6973 696e 7374 616e 6365 2870 6174 682c  isinstance(path,
+00019450: 206c 6973 7429 3a0d 0a20 2020 2020 2020   list):..       
+00019460: 2020 2020 2023 2061 6464 2074 6865 2070       # add the p
+00019470: 6174 6820 746f 2061 6c6c 2074 6865 2066  ath to all the f
+00019480: 696c 6573 0d0a 2020 2020 2020 2020 2020  iles..          
+00019490: 2020 6669 6c65 7320 3d20 5b66 227b 7061    files = [f"{pa
+000194a0: 7468 7d2f 7b69 7d22 2066 6f72 2069 2069  th}/{i}" for i i
+000194b0: 6e20 6669 6c65 735d 0d0a 2020 2020 2020  n files]..      
+000194c0: 2020 2320 6372 6561 7465 2061 2033 6420    # create a 3d 
+000194d0: 6172 7261 7920 7769 7468 2074 6865 2032  array with the 2
+000194e0: 6420 6469 6d65 6e73 696f 6e20 6f66 2074  d dimension of t
+000194f0: 6865 2066 6972 7374 2072 6173 7465 7220  he first raster 
+00019500: 616e 6420 7468 6520 6c65 6e0d 0a20 2020  and the len..   
+00019510: 2020 2020 2023 206f 6620 7468 6520 6e75       # of the nu
+00019520: 6d62 6572 206f 6620 7261 7374 6572 7320  mber of rasters 
+00019530: 696e 2074 6865 2066 6f6c 6465 720d 0a20  in the folder.. 
+00019540: 2020 2020 2020 2073 616d 706c 6520 3d20         sample = 
+00019550: 4461 7461 7365 742e 7265 6164 5f66 696c  Dataset.read_fil
+00019560: 6528 6669 6c65 735b 305d 290d 0a0d 0a20  e(files[0]).... 
+00019570: 2020 2020 2020 2072 6574 7572 6e20 636c         return cl
+00019580: 7328 7361 6d70 6c65 2c20 6c65 6e28 6669  s(sample, len(fi
+00019590: 6c65 7329 2c20 6669 6c65 7329 0d0a 0d0a  les), files)....
+000195a0: 2020 2020 6465 6620 7265 6164 5f64 6174      def read_dat
+000195b0: 6173 6574 2873 656c 662c 2062 616e 643a  aset(self, band:
+000195c0: 2069 6e74 203d 2030 293a 0d0a 2020 2020   int = 0):..    
+000195d0: 2020 2020 2222 2252 6561 6420 6172 7261      """Read arra
+000195e0: 792e 0d0a 0d0a 2020 2020 2020 2020 2020  y.....          
+000195f0: 2020 5265 6164 2076 616c 7565 7320 666f    Read values fo
+00019600: 726d 2074 6865 2067 6976 656e 2062 616e  rm the given ban
+00019610: 6473 2061 7320 4172 7261 7973 2066 6f72  ds as Arrays for
+00019620: 2061 6c6c 2066 696c 6573 0d0a 0d0a 2020   all files....  
+00019630: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+00019640: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00019650: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6261  ----..        ba
+00019660: 6e64 3a20 5b69 6e74 5d0d 0a20 2020 2020  nd: [int]..     
+00019670: 2020 2020 2020 2069 6e64 6578 206f 6620         index of 
+00019680: 7468 6520 6261 6e64 2079 6f75 2077 616e  the band you wan
+00019690: 7420 746f 2072 6561 6420 6465 6661 756c  t to read defaul
+000196a0: 7420 6973 2030 2e0d 0a0d 0a20 2020 2020  t is 0.....     
+000196b0: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
+000196c0: 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020      -------..   
+000196d0: 2020 2020 2041 7272 6179 0d0a 2020 2020       Array..    
+000196e0: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
+000196f0: 2023 2063 6865 636b 2074 6865 2067 6976   # check the giv
+00019700: 656e 2062 616e 6420 6e75 6d62 6572 0d0a  en band number..
+00019710: 2020 2020 2020 2020 6966 206e 6f74 2068          if not h
+00019720: 6173 6174 7472 2873 656c 662c 2022 6261  asattr(self, "ba
+00019730: 7365 2229 3a0d 0a20 2020 2020 2020 2020  se"):..         
+00019740: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+00019750: 726f 7228 0d0a 2020 2020 2020 2020 2020  ror(..          
+00019760: 2020 2020 2020 2270 6c65 6173 6520 7573        "please us
+00019770: 6520 7468 6520 7265 6164 5f73 6570 6172  e the read_separ
+00019780: 6174 655f 6669 6c65 7320 6d65 7468 6f64  ate_files method
+00019790: 2074 6f20 6765 7420 7468 6520 6669 6c65   to get the file
+000197a0: 7320 2874 6966 662f 6173 6369 6929 2069  s (tiff/ascii) i
+000197b0: 6e20 7468 6522 0d0a 2020 2020 2020 2020  n the"..        
+000197c0: 2020 2020 2020 2020 2264 6174 6173 6574          "dataset
+000197d0: 2064 6972 6563 746f 7279 220d 0a20 2020   directory"..   
+000197e0: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
+000197f0: 2020 2020 6966 2062 616e 6420 3e20 7365      if band > se
+00019800: 6c66 2e62 6173 652e 6261 6e64 5f63 6f75  lf.base.band_cou
+00019810: 6e74 202d 2031 3a0d 0a20 2020 2020 2020  nt - 1:..       
+00019820: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+00019830: 4572 726f 7228 0d0a 2020 2020 2020 2020  Error(..        
+00019840: 2020 2020 2020 2020 6622 7468 6520 7261          f"the ra
+00019850: 7374 6572 2068 6173 206f 6e6c 7920 7b73  ster has only {s
+00019860: 656c 662e 6261 7365 2e62 616e 645f 636f  elf.base.band_co
+00019870: 756e 747d 2063 6865 636b 2074 6865 2067  unt} check the g
+00019880: 6976 656e 2062 616e 6420 6e75 6d62 6572  iven band number
+00019890: 220d 0a20 2020 2020 2020 2020 2020 2029  "..            )
+000198a0: 0d0a 2020 2020 2020 2020 2320 6669 6c6c  ..        # fill
+000198b0: 2074 6865 2061 7272 6179 2077 6974 6820   the array with 
+000198c0: 6e6f 5f64 6174 615f 7661 6c75 6520 6461  no_data_value da
+000198d0: 7461 0d0a 2020 2020 2020 2020 7365 6c66  ta..        self
+000198e0: 2e5f 6461 7461 203d 206e 702e 6f6e 6573  ._data = np.ones
+000198f0: 280d 0a20 2020 2020 2020 2020 2020 2028  (..            (
+00019900: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00019910: 2020 7365 6c66 2e74 696d 655f 6c65 6e67    self.time_leng
+00019920: 7468 2c0d 0a20 2020 2020 2020 2020 2020  th,..           
+00019930: 2020 2020 2073 656c 662e 6261 7365 2e72       self.base.r
+00019940: 6f77 732c 0d0a 2020 2020 2020 2020 2020  ows,..          
+00019950: 2020 2020 2020 7365 6c66 2e62 6173 652e        self.base.
+00019960: 636f 6c75 6d6e 732c 0d0a 2020 2020 2020  columns,..      
+00019970: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
+00019980: 2029 0d0a 2020 2020 2020 2020 7365 6c66   )..        self
+00019990: 2e5f 6461 7461 5b3a 2c20 3a2c 203a 5d20  ._data[:, :, :] 
+000199a0: 3d20 6e70 2e6e 616e 0d0a 0d0a 2020 2020  = np.nan....    
+000199b0: 2020 2020 666f 7220 692c 2066 696c 655f      for i, file_
+000199c0: 6920 696e 2065 6e75 6d65 7261 7465 2873  i in enumerate(s
+000199d0: 656c 662e 6669 6c65 7329 3a0d 0a20 2020  elf.files):..   
+000199e0: 2020 2020 2020 2020 2023 2072 6561 6420           # read 
+000199f0: 7468 6520 7469 6620 6669 6c65 0d0a 2020  the tif file..  
+00019a00: 2020 2020 2020 2020 2020 7261 7374 6572            raster
+00019a10: 5f69 203d 2067 6461 6c2e 4f70 656e 2866  _i = gdal.Open(f
+00019a20: 227b 6669 6c65 5f69 7d22 290d 0a20 2020  "{file_i}")..   
+00019a30: 2020 2020 2020 2020 2073 656c 662e 5f64           self._d
+00019a40: 6174 615b 692c 203a 2c20 3a5d 203d 2072  ata[i, :, :] = r
+00019a50: 6173 7465 725f 692e 4765 7452 6173 7465  aster_i.GetRaste
+00019a60: 7242 616e 6428 6261 6e64 202b 2031 292e  rBand(band + 1).
+00019a70: 5265 6164 4173 4172 7261 7928 290d 0a0d  ReadAsArray()...
+00019a80: 0a20 2020 2040 7072 6f70 6572 7479 0d0a  .    @property..
+00019a90: 2020 2020 6465 6620 6461 7461 2873 656c      def data(sel
+00019aa0: 6629 202d 3e20 6e70 2e6e 6461 7272 6179  f) -> np.ndarray
+00019ab0: 3a0d 0a20 2020 2020 2020 2022 2222 6461  :..        """da
+00019ac0: 7461 2061 7474 7269 6275 7465 2e0d 0a0d  ta attribute....
+00019ad0: 0a20 2020 2020 2020 202d 2054 6865 2061  .        - The a
+00019ae0: 7474 7269 6275 7465 2077 6865 7265 2074  ttribute where t
+00019af0: 6865 2064 6174 6173 6574 2061 7272 6179  he dataset array
+00019b00: 2069 7320 7374 6f72 6564 2e0d 0a20 2020   is stored...   
+00019b10: 2020 2020 202d 2074 6865 2033 4420 6e75       - the 3D nu
+00019b20: 6d70 7920 6172 7261 792c 205b 6461 7461  mpy array, [data
+00019b30: 7365 7420 6c65 6e67 7468 2c20 726f 7773  set length, rows
+00019b40: 2c20 636f 6c73 5d2c 205b 6461 7461 7365  , cols], [datase
+00019b50: 7420 6c65 6e67 7468 2c20 6c6f 6e73 2c20  t length, lons, 
+00019b60: 6c61 7473 5d0d 0a20 2020 2020 2020 2022  lats]..        "
+00019b70: 2222 0d0a 2020 2020 2020 2020 6966 206e  ""..        if n
+00019b80: 6f74 2068 6173 6174 7472 2873 656c 662c  ot hasattr(self,
+00019b90: 2022 5f64 6174 6122 293a 0d0a 2020 2020   "_data"):..    
+00019ba0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00019bb0: 6c75 6545 7272 6f72 2822 706c 6561 7365  lueError("please
+00019bc0: 2075 7365 2074 6865 2072 6561 645f 6461   use the read_da
+00019bd0: 7461 7365 7420 746f 2072 6561 6420 7468  taset to read th
+00019be0: 6520 6461 7461 2066 6972 7374 2e22 290d  e data first.").
+00019bf0: 0a0d 0a20 2020 2020 2020 2072 6574 7572  ...        retur
+00019c00: 6e20 7365 6c66 2e5f 6461 7461 0d0a 0d0a  n self._data....
+00019c10: 2020 2020 4064 6174 612e 7365 7474 6572      @data.setter
+00019c20: 0d0a 2020 2020 6465 6620 6461 7461 2873  ..    def data(s
+00019c30: 656c 662c 2076 616c 293a 0d0a 2020 2020  elf, val):..    
+00019c40: 2020 2020 2222 2244 6174 6120 6174 7472      """Data attr
+00019c50: 6962 7574 652e 0d0a 0d0a 2020 2020 2020  ibute.....      
+00019c60: 2020 2d20 7365 7474 696e 6720 7468 6520    - setting the 
+00019c70: 6461 7461 2028 6172 7261 7929 2064 6f65  data (array) doe
+00019c80: 7320 6e6f 7420 616c 6c6f 7720 6469 6666  s not allow diff
+00019c90: 6572 656e 7420 6469 6d65 6e73 696f 6e20  erent dimension 
+00019ca0: 6672 6f6d 2074 6865 2064 696d 656e 7369  from the dimensi
+00019cb0: 6f6e 2074 6861 7420 6861 7665 2062 6565  on that have bee
+00019cc0: 6e0d 0a20 2020 2020 2020 2064 6566 696e  n..        defin
+00019cd0: 6564 2069 6e63 7265 6174 696e 6720 7468  ed increating th
+00019ce0: 6520 6461 7461 7365 742e 0d0a 2020 2020  e dataset...    
+00019cf0: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
+00019d00: 2023 2069 6620 7468 6520 6174 7472 6962   # if the attrib
+00019d10: 7574 6520 6973 2064 6566 696e 6564 2062  ute is defined b
+00019d20: 6566 6f72 6520 6368 6563 6b20 7468 6520  efore check the 
+00019d30: 6469 6d65 6e73 696f 6e0d 0a20 2020 2020  dimension..     
+00019d40: 2020 2069 6620 6861 7361 7474 7228 7365     if hasattr(se
+00019d50: 6c66 2c20 2264 6174 6122 293a 0d0a 2020  lf, "data"):..  
+00019d60: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+00019d70: 662e 5f64 6174 612e 7368 6170 6520 213d  f._data.shape !=
+00019d80: 2076 616c 2e73 6861 7065 3a0d 0a20 2020   val.shape:..   
+00019d90: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+00019da0: 7365 2056 616c 7565 4572 726f 7228 0d0a  se ValueError(..
+00019db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019dc0: 2020 2020 6622 5468 6520 6469 6d65 6e73      f"The dimens
+00019dd0: 696f 6e20 6f66 2074 6865 206e 6577 2064  ion of the new d
+00019de0: 6174 613a 207b 7661 6c2e 7368 6170 657d  ata: {val.shape}
+00019df0: 2c20 6469 6666 6572 7320 6672 6f6d 2074  , differs from t
+00019e00: 6865 2064 696d 656e 7369 6f6e 206f 6620  he dimension of 
+00019e10: 7468 6520 220d 0a20 2020 2020 2020 2020  the "..         
+00019e20: 2020 2020 2020 2020 2020 2066 226f 7269             f"ori
+00019e30: 6769 6e61 6c20 6461 7461 7365 743a 207b  ginal dataset: {
+00019e40: 7365 6c66 2e5f 6461 7461 2e73 6861 7065  self._data.shape
+00019e50: 7d2c 2070 6c65 6173 6520 7265 6465 6669  }, please redefi
+00019e60: 6e65 2074 6865 2062 6173 6520 4461 7461  ne the base Data
+00019e70: 7365 7420 616e 6420 220d 0a20 2020 2020  set and "..     
+00019e80: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00019e90: 2264 6174 6173 6574 5f6c 656e 6774 6820  "dataset_length 
+00019ea0: 6669 7273 7422 0d0a 2020 2020 2020 2020  first"..        
+00019eb0: 2020 2020 2020 2020 290d 0a0d 0a20 2020          )....   
+00019ec0: 2020 2020 2073 656c 662e 5f64 6174 6120       self._data 
+00019ed0: 3d20 7661 6c0d 0a0d 0a20 2020 2040 6461  = val....    @da
+00019ee0: 7461 2e64 656c 6574 6572 0d0a 2020 2020  ta.deleter..    
+00019ef0: 6465 6620 6461 7461 2873 656c 6629 3a0d  def data(self):.
+00019f00: 0a20 2020 2020 2020 2073 656c 662e 5f64  .        self._d
+00019f10: 6174 6120 3d20 4e6f 6e65 0d0a 0d0a 2020  ata = None....  
+00019f20: 2020 6465 6620 5f5f 6765 7469 7465 6d5f    def __getitem_
+00019f30: 5f28 7365 6c66 2c20 6b65 7929 3a0d 0a20  _(self, key):.. 
+00019f40: 2020 2020 2020 2069 6620 6e6f 7420 6861         if not ha
+00019f50: 7361 7474 7228 7365 6c66 2c20 2264 6174  sattr(self, "dat
+00019f60: 6122 293a 0d0a 2020 2020 2020 2020 2020  a"):..          
+00019f70: 2020 7261 6973 6520 4174 7472 6962 7574    raise Attribut
+00019f80: 6545 7272 6f72 2822 506c 6561 7365 2075  eError("Please u
+00019f90: 7365 2074 6865 2072 6561 645f 6461 7461  se the read_data
+00019fa0: 7365 7420 6d65 7468 6f64 2074 2072 6561  set method t rea
+00019fb0: 6420 7468 6520 6461 7461 2229 0d0a 2020  d the data")..  
+00019fc0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00019fd0: 662e 5f64 6174 615b 6b65 792c 203a 2c20  f._data[key, :, 
+00019fe0: 3a5d 0d0a 0d0a 2020 2020 6465 6620 5f5f  :]....    def __
+00019ff0: 7365 7469 7465 6d5f 5f28 7365 6c66 2c20  setitem__(self, 
+0001a000: 6b65 792c 2076 616c 7565 3a20 6e70 2e6e  key, value: np.n
+0001a010: 6461 7272 6179 293a 0d0a 2020 2020 2020  darray):..      
+0001a020: 2020 6966 206e 6f74 2068 6173 6174 7472    if not hasattr
+0001a030: 2873 656c 662c 2022 6461 7461 2229 3a0d  (self, "data"):.
+0001a040: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0001a050: 7365 2041 7474 7269 6275 7465 4572 726f  se AttributeErro
+0001a060: 7228 2250 6c65 6173 6520 7573 6520 7468  r("Please use th
+0001a070: 6520 7265 6164 5f64 6174 6173 6574 206d  e read_dataset m
+0001a080: 6574 686f 6420 7420 7265 6164 2074 6865  ethod t read the
+0001a090: 2064 6174 6122 290d 0a20 2020 2020 2020   data")..       
+0001a0a0: 2073 656c 662e 5f64 6174 615b 6b65 792c   self._data[key,
+0001a0b0: 203a 2c20 3a5d 203d 2076 616c 7565 0d0a   :, :] = value..
+0001a0c0: 0d0a 2020 2020 6465 6620 5f5f 6c65 6e5f  ..    def __len_
+0001a0d0: 5f28 7365 6c66 293a 0d0a 2020 2020 2020  _(self):..      
+0001a0e0: 2020 7265 7475 726e 2073 656c 662e 5f64    return self._d
+0001a0f0: 6174 612e 7368 6170 655b 305d 0d0a 0d0a  ata.shape[0]....
+0001a100: 2020 2020 6465 6620 5f5f 6974 6572 5f5f      def __iter__
+0001a110: 2873 656c 6629 3a0d 0a20 2020 2020 2020  (self):..       
+0001a120: 2072 6574 7572 6e20 6974 6572 2873 656c   return iter(sel
+0001a130: 662e 5f64 6174 615b 3a5d 290d 0a0d 0a20  f._data[:]).... 
+0001a140: 2020 2064 6566 2068 6561 6428 7365 6c66     def head(self
+0001a150: 2c20 6e3a 2069 6e74 203d 2035 293a 0d0a  , n: int = 5):..
+0001a160: 2020 2020 2020 2020 2222 2246 6972 7374          """First
+0001a170: 2035 2044 6174 6173 6574 732e 2222 220d   5 Datasets.""".
+0001a180: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001a190: 7365 6c66 2e5f 6461 7461 5b3a 6e2c 203a  self._data[:n, :
+0001a1a0: 2c20 3a5d 0d0a 0d0a 2020 2020 6465 6620  , :]....    def 
+0001a1b0: 7461 696c 2873 656c 662c 206e 3a20 696e  tail(self, n: in
+0001a1c0: 7420 3d20 2d35 293a 0d0a 2020 2020 2020  t = -5):..      
+0001a1d0: 2020 2222 224c 6173 7420 3520 4461 7461    """Last 5 Data
+0001a1e0: 7365 7473 2e22 2222 0d0a 2020 2020 2020  sets."""..      
+0001a1f0: 2020 7265 7475 726e 2073 656c 662e 5f64    return self._d
+0001a200: 6174 615b 6e3a 2c20 3a2c 203a 5d0d 0a0d  ata[n:, :, :]...
+0001a210: 0a20 2020 2064 6566 2066 6972 7374 2873  .    def first(s
+0001a220: 656c 6629 3a0d 0a20 2020 2020 2020 2022  elf):..        "
+0001a230: 2222 4669 7273 7420 4461 7461 7365 742e  ""First Dataset.
+0001a240: 2222 220d 0a20 2020 2020 2020 2072 6574  """..        ret
+0001a250: 7572 6e20 7365 6c66 2e5f 6461 7461 5b30  urn self._data[0
+0001a260: 2c20 3a2c 203a 5d0d 0a0d 0a20 2020 2064  , :, :]....    d
+0001a270: 6566 206c 6173 7428 7365 6c66 293a 0d0a  ef last(self):..
+0001a280: 2020 2020 2020 2020 2222 224c 6173 7420          """Last 
+0001a290: 4461 7461 7365 742e 2222 220d 0a20 2020  Dataset."""..   
+0001a2a0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0001a2b0: 2e5f 6461 7461 5b2d 312c 203a 2c20 3a5d  ._data[-1, :, :]
+0001a2c0: 0d0a 0d0a 2020 2020 6465 6620 696c 6f63  ....    def iloc
+0001a2d0: 2873 656c 662c 2069 293a 0d0a 2020 2020  (self, i):..    
+0001a2e0: 2020 2020 2222 2269 6c6f 632e 0d0a 0d0a      """iloc.....
+0001a2f0: 2020 2020 2020 2020 2020 2020 2d20 4163              - Ac
+0001a300: 6365 7373 2064 6174 6173 6574 2061 7272  cess dataset arr
+0001a310: 6179 2075 7369 6e67 2069 6e64 6578 2e0d  ay using index..
+0001a320: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+0001a330: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
+0001a340: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+0001a350: 2020 2069 3a20 5b69 6e74 5d0d 0a20 2020     i: [int]..   
+0001a360: 2020 2020 2020 2020 2069 6e64 6578 0d0a           index..
+0001a370: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+0001a380: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+0001a390: 2d2d 0d0a 2020 2020 2020 2020 4461 7461  --..        Data
+0001a3a0: 7365 743a 0d0a 2020 2020 2020 2020 2020  set:..          
+0001a3b0: 2020 4461 7461 7365 7420 6f62 6a65 6374    Dataset object
+0001a3c0: 2e0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
+0001a3d0: 2020 2020 2020 2020 6966 206e 6f74 2068          if not h
+0001a3e0: 6173 6174 7472 2873 656c 662c 2022 6461  asattr(self, "da
+0001a3f0: 7461 2229 3a0d 0a20 2020 2020 2020 2020  ta"):..         
+0001a400: 2020 2072 6169 7365 2044 6174 6173 6574     raise Dataset
+0001a410: 4e6f 466f 756e 6445 7272 6f72 2822 706c  NoFoundError("pl
+0001a420: 6561 7365 2072 6561 6420 7468 6520 6461  ease read the da
+0001a430: 7461 7365 7420 6669 7273 7422 290d 0a20  taset first").. 
+0001a440: 2020 2020 2020 2061 7272 203d 2073 656c         arr = sel
+0001a450: 662e 5f64 6174 615b 692c 203a 2c20 3a5d  f._data[i, :, :]
+0001a460: 0d0a 2020 2020 2020 2020 6473 7420 3d20  ..        dst = 
+0001a470: 6764 616c 2e47 6574 4472 6976 6572 4279  gdal.GetDriverBy
+0001a480: 4e61 6d65 2822 4d45 4d22 292e 4372 6561  Name("MEM").Crea
+0001a490: 7465 436f 7079 2822 222c 2073 656c 662e  teCopy("", self.
+0001a4a0: 6261 7365 2e72 6173 7465 722c 2030 290d  base.raster, 0).
+0001a4b0: 0a20 2020 2020 2020 2064 7374 2e47 6574  .        dst.Get
+0001a4c0: 5261 7374 6572 4261 6e64 2831 292e 5772  RasterBand(1).Wr
+0001a4d0: 6974 6541 7272 6179 2861 7272 290d 0a20  iteArray(arr).. 
+0001a4e0: 2020 2020 2020 2072 6574 7572 6e20 4461         return Da
+0001a4f0: 7461 7365 7428 6473 7429 0d0a 0d0a 2020  taset(dst)....  
+0001a500: 2020 6465 6620 706c 6f74 2873 656c 662c    def plot(self,
+0001a510: 2062 616e 643a 2069 6e74 203d 2030 2c20   band: int = 0, 
+0001a520: 6578 636c 7564 655f 7661 6c75 653a 2041  exclude_value: A
+0001a530: 6e79 203d 204e 6f6e 652c 202a 2a6b 7761  ny = None, **kwa
+0001a540: 7267 7329 3a0d 0a20 2020 2020 2020 2022  rgs):..        "
+0001a550: 2222 5265 6164 2041 7272 6179 0d0a 0d0a  ""Read Array....
+0001a560: 2020 2020 2020 2020 2020 2020 2d20 7265              - re
+0001a570: 6164 2074 6865 2076 616c 7565 7320 7374  ad the values st
+0001a580: 6f72 6564 2069 6e20 6120 6769 7665 6e20  ored in a given 
+0001a590: 6261 6e64 2e0d 0a0d 0a20 2020 2020 2020  band.....       
+0001a5a0: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+0001a5b0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
+0001a5c0: 0a20 2020 2020 2020 2062 616e 6420 3a20  .        band : 
+0001a5d0: 5b69 6e74 6567 6572 5d0d 0a20 2020 2020  [integer]..     
+0001a5e0: 2020 2020 2020 2074 6865 2062 616e 6420         the band 
+0001a5f0: 796f 7520 7761 6e74 2074 6f20 6765 7420  you want to get 
+0001a600: 6974 7320 6461 7461 2e20 4465 6661 756c  its data. Defaul
+0001a610: 7420 6973 2030 0d0a 2020 2020 2020 2020  t is 0..        
+0001a620: 6578 636c 7564 655f 7661 6c75 653a 205b  exclude_value: [
+0001a630: 416e 795d 0d0a 2020 2020 2020 2020 2020  Any]..          
+0001a640: 2020 7661 6c75 6520 746f 2065 7865 636c    value to execl
+0001a650: 7564 6520 6672 6f6d 2074 6865 2070 6c6f  ude from the plo
+0001a660: 742e 2044 6566 6175 6c74 2069 7320 4e6f  t. Default is No
+0001a670: 6e65 2e0d 0a20 2020 2020 2020 202a 2a6b  ne...        **k
+0001a680: 7761 7267 730d 0a20 2020 2020 2020 2020  wargs..         
+0001a690: 2020 2070 6f69 6e74 7320 3a20 5b61 7272     points : [arr
+0001a6a0: 6179 5d0d 0a20 2020 2020 2020 2020 2020  ay]..           
+0001a6b0: 2020 2020 2033 2063 6f6c 756d 6e20 6172       3 column ar
+0001a6c0: 7261 7920 7769 7468 2074 6865 2066 6972  ray with the fir
+0001a6d0: 7374 2063 6f6c 756d 6e20 6173 2074 6865  st column as the
+0001a6e0: 2076 616c 7565 2079 6f75 2077 616e 7420   value you want 
+0001a6f0: 746f 2064 6973 706c 6179 2066 6f72 2074  to display for t
+0001a700: 6865 2070 6f69 6e74 2c20 7468 6520 7365  he point, the se
+0001a710: 636f 6e64 2069 7320 7468 6520 726f 7773  cond is the rows
+0001a720: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001a730: 2020 696e 6465 7820 6f66 2074 6865 2070    index of the p
+0001a740: 6f69 6e74 2069 6e20 7468 6520 6172 7261  oint in the arra
+0001a750: 792c 2061 6e64 2074 6865 2074 6869 7264  y, and the third
+0001a760: 2063 6f6c 756d 6e20 6173 2074 6865 2063   column as the c
+0001a770: 6f6c 756d 6e20 696e 6465 7820 696e 2074  olumn index in t
+0001a780: 6865 2061 7272 6179 2e0d 0a20 2020 2020  he array...     
+0001a790: 2020 2020 2020 2020 2020 202d 2074 6865             - the
+0001a7a0: 2073 6563 6f6e 6420 616e 6420 7468 6972   second and thir
+0001a7b0: 6420 636f 6c75 6d6e 2074 656c 6c73 2074  d column tells t
+0001a7c0: 6865 206c 6f63 6174 696f 6e20 6f66 2074  he location of t
+0001a7d0: 6865 2070 6f69 6e74 2069 6e20 7468 6520  he point in the 
+0001a7e0: 6172 7261 792e 0d0a 2020 2020 2020 2020  array...        
+0001a7f0: 2020 2020 706f 696e 745f 636f 6c6f 723a      point_color:
+0001a800: 205b 7374 725d 0d0a 2020 2020 2020 2020   [str]..        
+0001a810: 2020 2020 2020 2020 636f 6c6f 722e 0d0a          color...
+0001a820: 2020 2020 2020 2020 2020 2020 706f 696e              poin
+0001a830: 745f 7369 7a65 3a20 5b41 6e79 5d0d 0a20  t_size: [Any].. 
+0001a840: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001a850: 697a 6520 6f66 2074 6865 2070 6f69 6e74  ize of the point
+0001a860: 2e0d 0a20 2020 2020 2020 2020 2020 2070  ...            p
+0001a870: 6964 5f63 6f6c 6f72 3a20 5b73 7472 5d0d  id_color: [str].
+0001a880: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a890: 2074 6865 2063 6f6c 6f72 206f 6620 7468   the color of th
+0001a8a0: 6520 616e 6f74 6174 696f 6e20 6f66 2074  e anotation of t
+0001a8b0: 6865 2070 6f69 6e74 2e20 4465 6661 756c  he point. Defaul
+0001a8c0: 7420 6973 2062 6c75 652e 0d0a 2020 2020  t is blue...    
+0001a8d0: 2020 2020 2020 2020 7069 645f 7369 7a65          pid_size
+0001a8e0: 3a20 5b41 6e79 5d0d 0a20 2020 2020 2020  : [Any]..       
+0001a8f0: 2020 2020 2020 2020 2073 697a 6520 6f66           size of
+0001a900: 2074 6865 2070 6f69 6e74 2061 6e6e 6f74   the point annot
+0001a910: 6174 696f 6e2e 0d0a 2020 2020 2020 2020  ation...        
+0001a920: 2020 2020 6669 6773 697a 6520 3a20 5b74      figsize : [t
+0001a930: 7570 6c65 5d2c 206f 7074 696f 6e61 6c0d  uple], optional.
+0001a940: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a950: 2066 6967 7572 6520 7369 7a65 2e20 5468   figure size. Th
+0001a960: 6520 6465 6661 756c 7420 6973 2028 382c  e default is (8,
+0001a970: 3829 2e0d 0a20 2020 2020 2020 2020 2020  8)...           
+0001a980: 2074 6974 6c65 203a 205b 7374 725d 2c20   title : [str], 
+0001a990: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
+0001a9a0: 2020 2020 2020 2020 2020 7469 746c 6520            title 
+0001a9b0: 6f66 2074 6865 2070 6c6f 742e 2054 6865  of the plot. The
+0001a9c0: 2064 6566 6175 6c74 2069 7320 2754 6f74   default is 'Tot
+0001a9d0: 616c 2044 6973 6368 6172 6765 272e 0d0a  al Discharge'...
+0001a9e0: 2020 2020 2020 2020 2020 2020 7469 746c              titl
+0001a9f0: 655f 7369 7a65 203a 205b 696e 7465 6765  e_size : [intege
+0001aa00: 725d 2c20 6f70 7469 6f6e 616c 0d0a 2020  r], optional..  
+0001aa10: 2020 2020 2020 2020 2020 2020 2020 7469                ti
+0001aa20: 746c 6520 7369 7a65 2e20 5468 6520 6465  tle size. The de
+0001aa30: 6661 756c 7420 6973 2031 352e 0d0a 2020  fault is 15...  
+0001aa40: 2020 2020 2020 2020 2020 6f72 6965 6e74            orient
+0001aa50: 6174 696f 6e20 3a20 5b73 7472 696e 675d  ation : [string]
+0001aa60: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
+0001aa70: 2020 2020 2020 2020 2020 2020 6f72 696e              orin
+0001aa80: 7461 7469 6f6e 206f 6620 7468 6520 636f  tation of the co
+0001aa90: 6c6f 7262 6172 2068 6f72 697a 6f6e 7461  lorbar horizonta
+0001aaa0: 6c2f 7665 7274 6963 616c 2e20 5468 6520  l/vertical. The 
+0001aab0: 6465 6661 756c 7420 6973 2027 7665 7274  default is 'vert
+0001aac0: 6963 616c 272e 0d0a 2020 2020 2020 2020  ical'...        
+0001aad0: 2020 2020 726f 7461 7469 6f6e 203a 205b      rotation : [
+0001aae0: 6e75 6d62 6572 5d2c 206f 7074 696f 6e61  number], optiona
+0001aaf0: 6c0d 0a20 2020 2020 2020 2020 2020 2020  l..             
+0001ab00: 2020 2072 6f74 6174 696f 6e20 6f66 2074     rotation of t
+0001ab10: 6865 2063 6f6c 6f72 6261 7220 6c61 6265  he colorbar labe
+0001ab20: 6c2e 2054 6865 2064 6566 6175 6c74 2069  l. The default i
+0001ab30: 7320 2d39 302e 0d0a 2020 2020 2020 2020  s -90...        
+0001ab40: 2020 2020 6f72 6965 6e74 6174 696f 6e20      orientation 
+0001ab50: 3a20 5b73 7472 696e 675d 2c20 6f70 7469  : [string], opti
+0001ab60: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
+0001ab70: 2020 2020 2020 6f72 696e 7461 7469 6f6e        orintation
+0001ab80: 206f 6620 7468 6520 636f 6c6f 7262 6172   of the colorbar
+0001ab90: 2068 6f72 697a 6f6e 7461 6c2f 7665 7274   horizontal/vert
+0001aba0: 6963 616c 2e20 5468 6520 6465 6661 756c  ical. The defaul
+0001abb0: 7420 6973 2027 7665 7274 6963 616c 272e  t is 'vertical'.
+0001abc0: 0d0a 2020 2020 2020 2020 2020 2020 6362  ..            cb
+0001abd0: 6172 5f6c 656e 6774 6820 3a20 5b66 6c6f  ar_length : [flo
+0001abe0: 6174 5d2c 206f 7074 696f 6e61 6c0d 0a20  at], optional.. 
+0001abf0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0001ac00: 6174 696f 2074 6f20 636f 6e74 726f 6c20  atio to control 
+0001ac10: 7468 6520 6865 6967 6874 206f 6620 7468  the height of th
+0001ac20: 6520 636f 6c6f 7262 6172 2e20 5468 6520  e colorbar. The 
+0001ac30: 6465 6661 756c 7420 6973 2030 2e37 352e  default is 0.75.
+0001ac40: 0d0a 2020 2020 2020 2020 2020 2020 7469  ..            ti
+0001ac50: 636b 735f 7370 6163 696e 6720 3a20 5b69  cks_spacing : [i
+0001ac60: 6e74 6567 6572 5d2c 206f 7074 696f 6e61  nteger], optiona
+0001ac70: 6c0d 0a20 2020 2020 2020 2020 2020 2020  l..             
+0001ac80: 2020 2053 7061 6369 6e67 2069 6e20 7468     Spacing in th
+0001ac90: 6520 636f 6c6f 7262 6172 2074 6963 6b73  e colorbar ticks
+0001aca0: 2e20 5468 6520 6465 6661 756c 7420 6973  . The default is
+0001acb0: 2032 2e0d 0a20 2020 2020 2020 2020 2020   2...           
+0001acc0: 2063 6261 725f 6c61 6265 6c5f 7369 7a65   cbar_label_size
+0001acd0: 203a 2069 6e74 6567 6572 2c20 6f70 7469   : integer, opti
+0001ace0: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
+0001acf0: 2020 2020 2020 7369 7a65 206f 6620 7468        size of th
+0001ad00: 6520 636f 6c6f 7220 6261 7220 6c61 6265  e color bar labe
+0001ad10: 6c2e 2054 6865 2064 6566 6175 6c74 2069  l. The default i
+0001ad20: 7320 3132 2e0d 0a20 2020 2020 2020 2020  s 12...         
+0001ad30: 2020 2063 6261 725f 6c61 6265 6c20 3a20     cbar_label : 
+0001ad40: 7374 722c 206f 7074 696f 6e61 6c0d 0a20  str, optional.. 
+0001ad50: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+0001ad60: 6162 656c 206f 6620 7468 6520 636f 6c6f  abel of the colo
+0001ad70: 7220 6261 722e 2054 6865 2064 6566 6175  r bar. The defau
+0001ad80: 6c74 2069 7320 2744 6973 6368 6172 6765  lt is 'Discharge
+0001ad90: 206d 332f 7327 2e0d 0a20 2020 2020 2020   m3/s'...       
+0001ada0: 2020 2020 2063 6f6c 6f72 5f73 6361 6c65       color_scale
+0001adb0: 203a 2069 6e74 6567 6572 2c20 6f70 7469   : integer, opti
+0001adc0: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
+0001add0: 2020 2020 2020 7468 6572 6520 6172 6520        there are 
+0001ade0: 3520 6f70 7469 6f6e 7320 746f 2063 6861  5 options to cha
+0001adf0: 6e67 6520 7468 6520 7363 616c 6520 6f66  nge the scale of
+0001ae00: 2074 6865 2063 6f6c 6f72 732e 2054 6865   the colors. The
+0001ae10: 2064 6566 6175 6c74 2069 7320 312e 0d0a   default is 1...
+0001ae20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ae30: 312d 2063 6f6c 6f72 5f73 6361 6c65 2031  1- color_scale 1
+0001ae40: 2069 7320 7468 6520 6e6f 726d 616c 2073   is the normal s
+0001ae50: 6361 6c65 0d0a 2020 2020 2020 2020 2020  cale..          
+0001ae60: 2020 2020 2020 322d 2063 6f6c 6f72 5f73        2- color_s
+0001ae70: 6361 6c65 2032 2069 7320 7468 6520 706f  cale 2 is the po
+0001ae80: 7765 7220 7363 616c 650d 0a20 2020 2020  wer scale..     
+0001ae90: 2020 2020 2020 2020 2020 2033 2d20 636f             3- co
+0001aea0: 6c6f 725f 7363 616c 6520 3320 6973 2074  lor_scale 3 is t
+0001aeb0: 6865 2053 796d 4c6f 674e 6f72 6d20 7363  he SymLogNorm sc
+0001aec0: 616c 650d 0a20 2020 2020 2020 2020 2020  ale..           
+0001aed0: 2020 2020 2034 2d20 636f 6c6f 725f 7363       4- color_sc
+0001aee0: 616c 6520 3420 6973 2074 6865 2050 6f77  ale 4 is the Pow
+0001aef0: 6572 4e6f 726d 2073 6361 6c65 0d0a 2020  erNorm scale..  
+0001af00: 2020 2020 2020 2020 2020 2020 2020 352d                5-
+0001af10: 2063 6f6c 6f72 5f73 6361 6c65 2035 2069   color_scale 5 i
+0001af20: 7320 7468 6520 426f 756e 6461 7279 4e6f  s the BoundaryNo
+0001af30: 726d 2073 6361 6c65 0d0a 2020 2020 2020  rm scale..      
+0001af40: 2020 2020 2020 2020 2020 2d2d 2d2d 2d2d            ------
+0001af50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0001af60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0001af70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0001af80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ------------..  
+0001af90: 2020 2020 2020 2020 2020 2020 2020 6761                ga
+0001afa0: 6d6d 6120 3a20 5b66 6c6f 6174 5d2c 206f  mma : [float], o
+0001afb0: 7074 696f 6e61 6c0d 0a20 2020 2020 2020  ptional..       
+0001afc0: 2020 2020 2020 2020 2020 2020 2076 616c               val
+0001afd0: 7565 206e 6565 6465 6420 666f 7220 6f70  ue needed for op
+0001afe0: 7469 6f6e 2032 202e 2054 6865 2064 6566  tion 2 . The def
+0001aff0: 6175 6c74 2069 7320 312e 2f32 2e2e 0d0a  ault is 1./2....
+0001b000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b010: 6c69 6e65 5f74 6872 6573 686f 6c64 203a  line_threshold :
+0001b020: 205b 666c 6f61 745d 2c20 6f70 7469 6f6e   [float], option
+0001b030: 616c 0d0a 2020 2020 2020 2020 2020 2020  al..            
+0001b040: 2020 2020 2020 2020 7661 6c75 6520 6e65          value ne
+0001b050: 6564 6564 2066 6f72 206f 7074 696f 6e20  eded for option 
+0001b060: 332e 2054 6865 2064 6566 6175 6c74 2069  3. The default i
+0001b070: 7320 302e 3030 3031 2e0d 0a20 2020 2020  s 0.0001...     
+0001b080: 2020 2020 2020 2020 2020 206c 696e 655f             line_
+0001b090: 7363 616c 6520 3a20 5b66 6c6f 6174 5d2c  scale : [float],
+0001b0a0: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
+0001b0b0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+0001b0c0: 616c 7565 206e 6565 6465 6420 666f 7220  alue needed for 
+0001b0d0: 6f70 7469 6f6e 2033 2e20 5468 6520 6465  option 3. The de
+0001b0e0: 6661 756c 7420 6973 2030 2e30 3031 2e0d  fault is 0.001..
+0001b0f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b100: 2062 6f75 6e64 733a 205b 4c69 7374 5d0d   bounds: [List].
+0001b110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b120: 2020 2020 2061 206c 6973 7420 6f66 206e       a list of n
+0001b130: 756d 6265 7220 746f 2062 6520 7573 6564  umber to be used
+0001b140: 2061 7320 6120 6469 7363 7265 7465 2062   as a discrete b
+0001b150: 6f75 6e64 7320 666f 7220 7468 6520 636f  ounds for the co
+0001b160: 6c6f 7220 7363 616c 6520 342e 4465 6661  lor scale 4.Defa
+0001b170: 756c 7420 6973 204e 6f6e 652c 0d0a 2020  ult is None,..  
+0001b180: 2020 2020 2020 2020 2020 2020 2020 6d69                mi
+0001b190: 6470 6f69 6e74 203a 205b 666c 6f61 745d  dpoint : [float]
+0001b1a0: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
+0001b1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b1c0: 7661 6c75 6520 6e65 6564 6564 2066 6f72  value needed for
+0001b1d0: 206f 7074 696f 6e20 352e 2054 6865 2064   option 5. The d
+0001b1e0: 6566 6175 6c74 2069 7320 302e 0d0a 2020  efault is 0...  
+0001b1f0: 2020 2020 2020 2020 2020 2020 2020 2d2d                --
+0001b200: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0001b210: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0001b220: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0001b230: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0001b240: 0d0a 2020 2020 2020 2020 2020 2020 636d  ..            cm
+0001b250: 6170 203a 205b 7374 725d 2c20 6f70 7469  ap : [str], opti
+0001b260: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
+0001b270: 2020 2020 2020 636f 6c6f 7220 7374 796c        color styl
+0001b280: 652e 2054 6865 2064 6566 6175 6c74 2069  e. The default i
+0001b290: 7320 2763 6f6f 6c77 6172 6d5f 7227 2e0d  s 'coolwarm_r'..
+0001b2a0: 0a20 2020 2020 2020 2020 2020 2064 6973  .            dis
+0001b2b0: 706c 6179 5f63 656c 6c5f 7661 6c75 6520  play_cell_value 
+0001b2c0: 3a20 5b62 6f6f 6c5d 0d0a 2020 2020 2020  : [bool]..      
+0001b2d0: 2020 2020 2020 2020 2020 5472 7565 2069            True i
+0001b2e0: 6620 796f 7520 7761 6e74 2074 6f20 6469  f you want to di
+0001b2f0: 7370 6c61 7920 7468 6520 7661 6c75 6573  splay the values
+0001b300: 206f 6620 7468 6520 6365 6c6c 7320 6173   of the cells as
+0001b310: 2061 2074 6578 740d 0a20 2020 2020 2020   a text..       
+0001b320: 2020 2020 206e 756d 5f73 697a 6520 3a20       num_size : 
+0001b330: 696e 7465 6765 722c 206f 7074 696f 6e61  integer, optiona
+0001b340: 6c0d 0a20 2020 2020 2020 2020 2020 2020  l..             
+0001b350: 2020 2073 697a 6520 6f66 2074 6865 206e     size of the n
+0001b360: 756d 6265 7273 2070 6c6f 7474 6564 2069  umbers plotted i
+0001b370: 6e74 6f70 206f 6620 6561 6368 2063 656c  ntop of each cel
+0001b380: 6c73 2e20 5468 6520 6465 6661 756c 7420  ls. The default 
+0001b390: 6973 2038 2e0d 0a20 2020 2020 2020 2020  is 8...         
+0001b3a0: 2020 2062 6163 6b67 726f 756e 645f 636f     background_co
+0001b3b0: 6c6f 725f 7468 7265 7368 6f6c 6420 3a20  lor_threshold : 
+0001b3c0: 5b66 6c6f 6174 2f69 6e74 6567 6572 5d2c  [float/integer],
+0001b3d0: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
+0001b3e0: 2020 2020 2020 2020 2020 2074 6872 6573             thres
+0001b3f0: 686f 6c64 2076 616c 7565 2069 6620 7468  hold value if th
+0001b400: 6520 7661 6c75 6520 6f66 2074 6865 2063  e value of the c
+0001b410: 656c 6c20 6973 2067 7265 6174 6572 2c20  ell is greater, 
+0001b420: 7468 6520 706c 6f74 7465 640d 0a20 2020  the plotted..   
+0001b430: 2020 2020 2020 2020 2020 2020 206e 756d               num
+0001b440: 6265 7273 2077 696c 6c20 6265 2062 6c61  bers will be bla
+0001b450: 636b 2061 6e64 2069 6620 736d 616c 6c65  ck and if smalle
+0001b460: 7220 7468 6520 706c 6f74 7465 6420 6e75  r the plotted nu
+0001b470: 6d62 6572 2077 696c 6c20 6265 2077 6869  mber will be whi
+0001b480: 7465 0d0a 2020 2020 2020 2020 2020 2020  te..            
+0001b490: 2020 2020 6966 204e 6f6e 6520 6769 7665      if None give
+0001b4a0: 6e20 7468 6520 6d61 7876 616c 7565 2f32  n the maxvalue/2
+0001b4b0: 2077 696c 6c20 6265 2063 6f6e 7369 6465   will be conside
+0001b4c0: 7265 642e 2054 6865 2064 6566 6175 6c74  red. The default
+0001b4d0: 2069 7320 4e6f 6e65 2e0d 0a0d 0a20 2020   is None.....   
+0001b4e0: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
+0001b4f0: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
+0001b500: 2020 2020 2020 2061 7865 733a 205b 6669         axes: [fi
+0001b510: 6775 7265 2061 7865 735d 2e0d 0a20 2020  gure axes]...   
+0001b520: 2020 2020 2020 2020 2074 6865 2061 7865           the axe
+0001b530: 7320 6f66 2074 6865 206d 6174 706c 6f74  s of the matplot
+0001b540: 6c69 6220 6669 6775 7265 0d0a 2020 2020  lib figure..    
+0001b550: 2020 2020 6669 673a 205b 6d61 7470 6c6f      fig: [matplo
+0001b560: 746c 6962 2066 6967 7572 6520 6f62 6a65  tlib figure obje
+0001b570: 6374 5d0d 0a20 2020 2020 2020 2020 2020  ct]..           
+0001b580: 2074 6865 2066 6967 7572 6520 6f62 6a65   the figure obje
+0001b590: 6374 0d0a 2020 2020 2020 2020 2222 220d  ct..        """.
+0001b5a0: 0a20 2020 2020 2020 2069 6d70 6f72 745f  .        import_
+0001b5b0: 636c 656f 7061 7472 6128 0d0a 2020 2020  cleopatra(..    
+0001b5c0: 2020 2020 2020 2020 2254 6865 2063 7572          "The cur
+0001b5d0: 7265 6e74 2066 756e 6372 696f 6e20 7573  rent funcrion us
+0001b5e0: 6573 2063 6c65 6f70 6174 7261 2070 6163  es cleopatra pac
+0001b5f0: 6b61 6765 2074 6f20 666f 7220 706c 6f74  kage to for plot
+0001b600: 7469 6e67 2c20 706c 6561 7365 2069 6e73  ting, please ins
+0001b610: 7461 6c6c 2069 7420 6d61 6e75 616c 6c79  tall it manually
+0001b620: 2c20 666f 7220 6d6f 7265 2069 6e66 6f20  , for more info 
+0001b630: 220d 0a20 2020 2020 2020 2020 2020 2022  "..            "
+0001b640: 6368 6563 6b20 6874 7470 733a 2f2f 6769  check https://gi
+0001b650: 7468 7562 2e63 6f6d 2f53 6572 6170 6965  thub.com/Serapie
+0001b660: 756d 2d6f 662d 616c 6578 2f63 6c65 6f70  um-of-alex/cleop
+0001b670: 6174 7261 220d 0a20 2020 2020 2020 2029  atra"..        )
+0001b680: 0d0a 2020 2020 2020 2020 6672 6f6d 2063  ..        from c
+0001b690: 6c65 6f70 6174 7261 2e61 7272 6179 2069  leopatra.array i
+0001b6a0: 6d70 6f72 7420 4172 7261 790d 0a0d 0a20  mport Array.... 
+0001b6b0: 2020 2020 2020 2064 6174 6120 3d20 7365         data = se
+0001b6c0: 6c66 2e64 6174 610d 0a0d 0a20 2020 2020  lf.data....     
+0001b6d0: 2020 2065 7863 6c75 6465 5f76 616c 7565     exclude_value
+0001b6e0: 203d 2028 0d0a 2020 2020 2020 2020 2020   = (..          
+0001b6f0: 2020 5b73 656c 662e 6261 7365 2e6e 6f5f    [self.base.no_
+0001b700: 6461 7461 5f76 616c 7565 5b62 616e 645d  data_value[band]
+0001b710: 2c20 6578 636c 7564 655f 7661 6c75 655d  , exclude_value]
+0001b720: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+0001b730: 2065 7863 6c75 6465 5f76 616c 7565 2069   exclude_value i
+0001b740: 7320 6e6f 7420 4e6f 6e65 0d0a 2020 2020  s not None..    
+0001b750: 2020 2020 2020 2020 656c 7365 205b 7365          else [se
+0001b760: 6c66 2e62 6173 652e 6e6f 5f64 6174 615f  lf.base.no_data_
+0001b770: 7661 6c75 655b 6261 6e64 5d5d 0d0a 2020  value[band]]..  
+0001b780: 2020 2020 2020 290d 0a0d 0a20 2020 2020        )....     
+0001b790: 2020 2063 6c65 6f20 3d20 4172 7261 7928     cleo = Array(
+0001b7a0: 6461 7461 2c20 6578 636c 7564 655f 7661  data, exclude_va
+0001b7b0: 6c75 653d 6578 636c 7564 655f 7661 6c75  lue=exclude_valu
+0001b7c0: 6529 0d0a 2020 2020 2020 2020 7469 6d65  e)..        time
+0001b7d0: 203d 206c 6973 7428 7261 6e67 6528 7365   = list(range(se
+0001b7e0: 6c66 2e74 696d 655f 6c65 6e67 7468 2929  lf.time_length))
+0001b7f0: 0d0a 2020 2020 2020 2020 616e 696d 203d  ..        anim =
+0001b800: 2063 6c65 6f2e 616e 696d 6174 6528 7469   cleo.animate(ti
+0001b810: 6d65 2c20 2a2a 6b77 6172 6773 290d 0a20  me, **kwargs).. 
+0001b820: 2020 2020 2020 2072 6574 7572 6e20 616e         return an
+0001b830: 696d 0d0a 0d0a 2020 2020 6465 6620 746f  im....    def to
+0001b840: 5f66 696c 6528 7365 6c66 2c20 7061 7468  _file(self, path
+0001b850: 3a20 7374 722c 2064 7269 7665 723a 2073  : str, driver: s
+0001b860: 7472 203d 2022 6765 6f74 6966 6622 2c20  tr = "geotiff", 
+0001b870: 6261 6e64 3a20 696e 7420 3d20 3029 3a0d  band: int = 0):.
+0001b880: 0a20 2020 2020 2020 2022 2222 5361 7665  .        """Save
+0001b890: 2074 6f20 6765 6f74 6966 6620 666f 726d   to geotiff form
+0001b8a0: 6174 2e0d 0a0d 0a20 2020 2020 2020 2020  at.....         
+0001b8b0: 2020 2073 6176 6552 6173 7465 7220 7361     saveRaster sa
+0001b8c0: 7665 7320 6120 7261 7374 6572 2074 6f20  ves a raster to 
+0001b8d0: 6120 7061 7468 0d0a 0d0a 2020 2020 2020  a path....      
+0001b8e0: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
+0001b8f0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0001b900: 0d0a 2020 2020 2020 2020 7061 7468 3a20  ..        path: 
+0001b910: 5b73 7472 696e 675d 0d0a 2020 2020 2020  [string]..      
+0001b920: 2020 2020 2020 6120 7061 7468 2069 6e63        a path inc
+0001b930: 6c75 646e 6720 7468 6520 6e61 6d65 206f  ludng the name o
+0001b940: 6620 7468 6520 7261 7374 6572 2061 6e64  f the raster and
+0001b950: 2065 7874 656e 7469 6f6e 2e0d 0a20 2020   extention...   
+0001b960: 2020 2020 2020 2020 203e 3e3e 2070 6174           >>> pat
+0001b970: 6820 3d20 2264 6174 612f 6372 6f70 7065  h = "data/croppe
+0001b980: 642e 7469 6622 0d0a 2020 2020 2020 2020  d.tif"..        
+0001b990: 6472 6976 6572 3a20 5b73 7472 5d0d 0a20  driver: [str].. 
+0001b9a0: 2020 2020 2020 2020 2020 2064 7269 7665             drive
+0001b9b0: 7220 3d20 2267 656f 7469 6666 222e 0d0a  r = "geotiff"...
+0001b9c0: 2020 2020 2020 2020 6261 6e64 3a20 5b69          band: [i
+0001b9d0: 6e74 5d0d 0a20 2020 2020 2020 2020 2020  nt]..           
+0001b9e0: 2062 616e 6420 696e 6465 782c 206e 6565   band index, nee
+0001b9f0: 6465 6420 6f6e 6c79 2069 6e20 6361 7365  ded only in case
+0001ba00: 206f 6620 6173 6369 6920 6472 6976 6572   of ascii driver
+0001ba10: 732e 2044 6566 6175 6c74 2069 7320 312e  s. Default is 1.
+0001ba20: 0d0a 0d0a 2020 2020 2020 2020 4578 616d  ....        Exam
+0001ba30: 706c 6573 0d0a 2020 2020 2020 2020 2d2d  ples..        --
+0001ba40: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+0001ba50: 3e3e 3e20 7261 7374 6572 5f6f 626a 203d  >>> raster_obj =
+0001ba60: 2044 6174 6173 6574 2e72 6561 645f 6669   Dataset.read_fi
+0001ba70: 6c65 2822 7061 7468 2f74 6f2f 6669 6c65  le("path/to/file
+0001ba80: 2f2a 2a2a 2e74 6966 2229 0d0a 2020 2020  /***.tif")..    
+0001ba90: 2020 2020 3e3e 3e20 6f75 7470 7574 5f70      >>> output_p
+0001baa0: 6174 6820 3d20 2265 7861 6d70 6c65 732f  ath = "examples/
+0001bab0: 4749 532f 6461 7461 2f73 6176 655f 7261  GIS/data/save_ra
+0001bac0: 7374 6572 5f74 6573 742e 7469 6622 0d0a  ster_test.tif"..
+0001bad0: 2020 2020 2020 2020 3e3e 3e20 7261 7374          >>> rast
+0001bae0: 6572 5f6f 626a 2e74 6f5f 6669 6c65 286f  er_obj.to_file(o
+0001baf0: 7574 7075 745f 7061 7468 290d 0a20 2020  utput_path)..   
+0001bb00: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+0001bb10: 2020 6966 206e 6f74 2050 6174 6828 7061    if not Path(pa
+0001bb20: 7468 292e 6578 6973 7473 2829 3a0d 0a20  th).exists():.. 
+0001bb30: 2020 2020 2020 2020 2020 2050 6174 6828             Path(
+0001bb40: 7061 7468 292e 6d6b 6469 7228 7061 7265  path).mkdir(pare
+0001bb50: 6e74 733d 5472 7565 2c20 6578 6973 745f  nts=True, exist_
+0001bb60: 6f6b 3d54 7275 6529 0d0a 2020 2020 2020  ok=True)..      
+0001bb70: 2020 6578 7420 3d20 4341 5441 4c4f 472e    ext = CATALOG.
+0001bb80: 6765 745f 6578 7465 6e73 696f 6e28 6472  get_extension(dr
+0001bb90: 6976 6572 290d 0a0d 0a20 2020 2020 2020  iver)....       
+0001bba0: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+0001bbb0: 7365 6c66 2e74 696d 655f 6c65 6e67 7468  self.time_length
+0001bbc0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+0001bbd0: 7372 6320 3d20 7365 6c66 2e69 6c6f 6328  src = self.iloc(
+0001bbe0: 6929 0d0a 2020 2020 2020 2020 2020 2020  i)..            
+0001bbf0: 7372 632e 746f 5f66 696c 6528 6622 7b70  src.to_file(f"{p
+0001bc00: 6174 687d 2f7b 697d 2e7b 6578 747d 222c  ath}/{i}.{ext}",
+0001bc10: 2064 7269 7665 723d 6472 6976 6572 2c20   driver=driver, 
+0001bc20: 6261 6e64 3d62 616e 6429 0d0a 0d0a 2020  band=band)....  
+0001bc30: 2020 6465 6620 746f 5f63 7273 280d 0a20    def to_crs(.. 
+0001bc40: 2020 2020 2020 2073 656c 662c 0d0a 2020         self,..  
+0001bc50: 2020 2020 2020 746f 5f65 7073 673a 2069        to_epsg: i
+0001bc60: 6e74 203d 2033 3835 372c 0d0a 2020 2020  nt = 3857,..    
+0001bc70: 2020 2020 6d65 7468 6f64 3a20 7374 7220      method: str 
+0001bc80: 3d20 226e 6561 7265 7374 206e 6569 626f  = "nearest neibo
+0001bc90: 7572 222c 0d0a 2020 2020 2020 2020 6d61  ur",..        ma
+0001bca0: 696e 7461 696e 5f61 6c69 6768 6d65 6e74  intain_alighment
+0001bcb0: 3a20 696e 7420 3d20 4661 6c73 652c 0d0a  : int = False,..
+0001bcc0: 2020 2020 293a 0d0a 2020 2020 2020 2020      ):..        
+0001bcd0: 2222 2274 6f5f 6570 7367 2e0d 0a0d 0a20  """to_epsg..... 
+0001bce0: 2020 2020 2020 2020 2020 202d 2074 6f5f             - to_
+0001bcf0: 6570 7367 2072 6570 726f 6a65 6374 7320  epsg reprojects 
+0001bd00: 6120 7261 7374 6572 2074 6f20 616e 7920  a raster to any 
+0001bd10: 7072 6f6a 6563 7469 6f6e 2028 6465 6661  projection (defa
+0001bd20: 756c 7420 7468 6520 5747 5338 3420 7765  ult the WGS84 we
+0001bd30: 6220 6d65 7263 6174 6f72 2070 726f 6a65  b mercator proje
+0001bd40: 6374 696f 6e2c 0d0a 2020 2020 2020 2020  ction,..        
+0001bd50: 2020 2020 7769 7468 6f75 7420 7265 7361      without resa
+0001bd60: 6d70 6c69 6e67 2920 5468 6520 6675 6e63  mpling) The func
+0001bd70: 7469 6f6e 2072 6574 7572 6e73 2061 2047  tion returns a G
+0001bd80: 4441 4c20 696e 2d6d 656d 6f72 7920 6669  DAL in-memory fi
+0001bd90: 6c65 206f 626a 6563 742c 2077 6865 7265  le object, where
+0001bda0: 2079 6f75 2063 616e 2052 6561 6441 7341   you can ReadAsA
+0001bdb0: 7272 6179 2065 7463 2e0d 0a0d 0a20 2020  rray etc.....   
+0001bdc0: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
+0001bdd0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0001bde0: 2d2d 2d0d 0a20 2020 2020 2020 2074 6f5f  ---..        to_
+0001bdf0: 6570 7367 3a20 5b69 6e74 6567 6572 5d0d  epsg: [integer].
+0001be00: 0a20 2020 2020 2020 2020 2020 2072 6566  .            ref
+0001be10: 6572 656e 6365 206e 756d 6265 7220 746f  erence number to
+0001be20: 2074 6865 206e 6577 2070 726f 6a65 6374   the new project
+0001be30: 696f 6e20 2868 7474 7073 3a2f 2f65 7073  ion (https://eps
+0001be40: 672e 696f 2f29 0d0a 2020 2020 2020 2020  g.io/)..        
+0001be50: 2020 2020 2864 6566 6175 6c74 2033 3835      (default 385
+0001be60: 3720 7468 6520 7265 6665 7265 6e63 6520  7 the reference 
+0001be70: 6e6f 206f 6620 5747 5338 3420 7765 6220  no of WGS84 web 
+0001be80: 6d65 7263 6174 6f72 2029 0d0a 2020 2020  mercator )..    
+0001be90: 2020 2020 6d65 7468 6f64 3a20 5b53 7472      method: [Str
+0001bea0: 696e 675d 0d0a 2020 2020 2020 2020 2020  ing]..          
+0001beb0: 2020 7265 7361 6d70 6c69 6e67 2074 6563    resampling tec
+0001bec0: 686e 6971 7565 2064 6566 6175 6c74 2069  hnique default i
+0001bed0: 7320 224e 6561 7265 7374 220d 0a20 2020  s "Nearest"..   
+0001bee0: 2020 2020 2020 2020 2068 7474 7073 3a2f           https:/
+0001bef0: 2f67 6973 6765 6f67 7261 7068 792e 636f  /gisgeography.co
+0001bf00: 6d2f 7261 7374 6572 2d72 6573 616d 706c  m/raster-resampl
+0001bf10: 696e 672f 0d0a 2020 2020 2020 2020 2020  ing/..          
+0001bf20: 2020 224e 6561 7265 7374 2220 666f 7220    "Nearest" for 
+0001bf30: 6e65 6172 6573 7420 6e65 6967 6862 6f75  nearest neighbou
+0001bf40: 722c 2263 7562 6963 2220 666f 7220 6375  r,"cubic" for cu
+0001bf50: 6269 6320 636f 6e76 6f6c 7574 696f 6e2c  bic convolution,
+0001bf60: 0d0a 2020 2020 2020 2020 2020 2020 2262  ..            "b
+0001bf70: 696c 696e 6561 7222 2066 6f72 2062 696c  ilinear" for bil
+0001bf80: 696e 6561 720d 0a20 2020 2020 2020 206d  inear..        m
+0001bf90: 6169 6e74 6169 6e5f 616c 6967 686d 656e  aintain_alighmen
+0001bfa0: 7420 3a20 5b62 6f6f 6c5d 0d0a 2020 2020  t : [bool]..    
+0001bfb0: 2020 2020 2020 2020 5472 7565 2074 6f20          True to 
+0001bfc0: 6d61 696e 7461 696e 2074 6865 206e 756d  maintain the num
+0001bfd0: 6265 7220 6f66 2072 6f77 7320 616e 6420  ber of rows and 
+0001bfe0: 636f 6c75 6d6e 7320 6f66 2074 6865 2072  columns of the r
+0001bff0: 6173 7465 7220 7468 6520 7361 6d65 2061  aster the same a
+0001c000: 6674 6572 2072 6570 726f 6a65 6374 696f  fter reprojectio
+0001c010: 6e2e 2044 6566 6175 6c74 2069 7320 4661  n. Default is Fa
+0001c020: 6c73 652e 0d0a 0d0a 2020 2020 2020 2020  lse.....        
+0001c030: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
+0001c040: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020   -------..      
+0001c050: 2020 7261 7374 6572 3a0d 0a20 2020 2020    raster:..     
+0001c060: 2020 2020 2020 2067 6461 6c20 6461 7461         gdal data
+0001c070: 7365 7420 2879 6f75 2063 616e 2072 6561  set (you can rea
+0001c080: 6420 6974 2062 7920 5265 6164 4173 4172  d it by ReadAsAr
+0001c090: 7261 7929 0d0a 0d0a 2020 2020 2020 2020  ray)....        
+0001c0a0: 4578 616d 706c 6573 0d0a 2020 2020 2020  Examples..      
+0001c0b0: 2020 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020    --------..    
+0001c0c0: 2020 2020 3e3e 3e20 6672 6f6d 2070 7972      >>> from pyr
+0001c0d0: 616d 6964 732e 6461 7461 7365 7420 696d  amids.dataset im
+0001c0e0: 706f 7274 2044 6174 6173 6574 0d0a 2020  port Dataset..  
+0001c0f0: 2020 2020 2020 3e3e 3e20 7372 6320 3d20        >>> src = 
+0001c100: 4461 7461 7365 742e 7265 6164 5f66 696c  Dataset.read_fil
+0001c110: 6528 2270 6174 682f 7261 7374 6572 5f6e  e("path/raster_n
+0001c120: 616d 652e 7469 6622 290d 0a20 2020 2020  ame.tif")..     
+0001c130: 2020 203e 3e3e 2070 726f 6a65 6374 6564     >>> projected
+0001c140: 5f72 6173 7465 7220 3d20 7372 632e 746f  _raster = src.to
+0001c150: 5f63 7273 2874 6f5f 6570 7367 3d33 3835  _crs(to_epsg=385
+0001c160: 3729 0d0a 2020 2020 2020 2020 2222 220d  7)..        """.
+0001c170: 0a20 2020 2020 2020 2066 6f72 2069 2069  .        for i i
+0001c180: 6e20 7261 6e67 6528 7365 6c66 2e74 696d  n range(self.tim
+0001c190: 655f 6c65 6e67 7468 293a 0d0a 2020 2020  e_length):..    
+0001c1a0: 2020 2020 2020 2020 7372 6320 3d20 7365          src = se
+0001c1b0: 6c66 2e69 6c6f 6328 6929 0d0a 2020 2020  lf.iloc(i)..    
+0001c1c0: 2020 2020 2020 2020 6473 7420 3d20 7372          dst = sr
+0001c1d0: 632e 746f 5f63 7273 280d 0a20 2020 2020  c.to_crs(..     
+0001c1e0: 2020 2020 2020 2020 2020 2074 6f5f 6570             to_ep
+0001c1f0: 7367 2c20 6d65 7468 6f64 3d6d 6574 686f  sg, method=metho
+0001c200: 642c 206d 6169 6e74 6169 6e5f 616c 6967  d, maintain_alig
+0001c210: 686d 656e 743d 6d61 696e 7461 696e 5f61  hment=maintain_a
+0001c220: 6c69 6768 6d65 6e74 0d0a 2020 2020 2020  lighment..      
+0001c230: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
+0001c240: 2020 2020 2061 7272 203d 2064 7374 2e72       arr = dst.r
+0001c250: 6561 645f 6172 7261 7928 290d 0a20 2020  ead_array()..   
+0001c260: 2020 2020 2020 2020 2069 6620 6920 3d3d           if i ==
+0001c270: 2030 3a0d 0a20 2020 2020 2020 2020 2020   0:..           
+0001c280: 2020 2020 2023 2063 7265 6174 6520 7468       # create th
+0001c290: 6520 6172 7261 790d 0a20 2020 2020 2020  e array..       
+0001c2a0: 2020 2020 2020 2020 2061 7272 6179 203d           array =
+0001c2b0: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
+0001c2c0: 2020 2020 2020 2020 6e70 2e6f 6e65 7328          np.ones(
+0001c2d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001c2e0: 2020 2020 2020 2020 2020 280d 0a20 2020            (..   
+0001c2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c300: 2020 2020 2020 2020 2073 656c 662e 7469           self.ti
+0001c310: 6d65 5f6c 656e 6774 682c 0d0a 2020 2020  me_length,..    
+0001c320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c330: 2020 2020 2020 2020 6172 722e 7368 6170          arr.shap
+0001c340: 655b 305d 2c0d 0a20 2020 2020 2020 2020  e[0],..         
+0001c350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c360: 2020 2061 7272 2e73 6861 7065 5b31 5d2c     arr.shape[1],
+0001c370: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001c380: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
+0001c390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c3a0: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
+0001c3b0: 2020 2020 2020 2020 2a20 6e70 2e6e 616e          * np.nan
+0001c3c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001c3d0: 2020 290d 0a20 2020 2020 2020 2020 2020    )..           
+0001c3e0: 2061 7272 6179 5b69 2c20 3a2c 203a 5d20   array[i, :, :] 
+0001c3f0: 3d20 6172 720d 0a0d 0a20 2020 2020 2020  = arr....       
+0001c400: 2073 656c 662e 5f64 6174 6120 3d20 6172   self._data = ar
+0001c410: 7261 790d 0a20 2020 2020 2020 2023 2075  ray..        # u
+0001c420: 7365 2074 6865 206c 6173 7420 7372 6320  se the last src 
+0001c430: 6173 0d0a 2020 2020 2020 2020 7365 6c66  as..        self
+0001c440: 2e5f 6261 7365 203d 2064 7374 0d0a 0d0a  ._base = dst....
+0001c450: 2020 2020 6465 6620 6372 6f70 280d 0a20      def crop(.. 
+0001c460: 2020 2020 2020 2073 656c 662c 0d0a 2020         self,..  
+0001c470: 2020 2020 2020 6d61 736b 3a20 556e 696f        mask: Unio
+0001c480: 6e5b 4461 7461 7365 742c 2073 7472 5d2c  n[Dataset, str],
+0001c490: 0d0a 2020 2020 2920 2d3e 204e 6f6e 653a  ..    ) -> None:
+0001c4a0: 0d0a 2020 2020 2020 2020 2222 2263 726f  ..        """cro
+0001c4b0: 7041 6c69 676e 6564 466f 6c64 6572 2e0d  pAlignedFolder..
+0001c4c0: 0a0d 0a20 2020 2020 2020 2020 2020 2063  ...            c
+0001c4d0: 726f 7041 6c69 676e 6564 466f 6c64 6572  ropAlignedFolder
+0001c4e0: 206d 6174 6368 6573 2074 6865 206c 6f63   matches the loc
+0001c4f0: 6174 696f 6e20 6f66 206e 6f64 6174 6120  ation of nodata 
+0001c500: 7661 6c75 6520 6672 6f6d 2073 7263 2072  value from src r
+0001c510: 6173 7465 7220 746f 2064 7374 0d0a 2020  aster to dst..  
+0001c520: 2020 2020 2020 2020 2020 7261 7374 6572            raster
+0001c530: 2c20 4d61 736b 2069 7320 7768 6572 6520  , Mask is where 
+0001c540: 7468 6520 4e6f 4461 7461 7661 6c75 6520  the NoDatavalue 
+0001c550: 7769 6c6c 2062 6520 7461 6b65 6e20 616e  will be taken an
+0001c560: 6420 7468 6520 6c6f 6361 7469 6f6e 206f  d the location o
+0001c570: 660d 0a20 2020 2020 2020 2020 2020 2074  f..            t
+0001c580: 6869 7320 7661 6c75 6520 7372 635f 6469  his value src_di
+0001c590: 7220 6973 2070 6174 6820 746f 2074 6865  r is path to the
+0001c5a0: 2066 6f6c 6465 7220 7768 6572 6520 7261   folder where ra
+0001c5b0: 7374 6572 7320 6578 6973 7420 7768 6572  sters exist wher
+0001c5c0: 6520 7765 0d0a 2020 2020 2020 2020 2020  e we..          
+0001c5d0: 2020 6e65 6564 2074 6f20 7075 7420 7468    need to put th
+0001c5e0: 6520 4e6f 4461 7461 5661 6c75 6520 6f66  e NoDataValue of
+0001c5f0: 2074 6865 206d 6173 6b20 696e 2052 6173   the mask in Ras
+0001c600: 7465 7242 2061 7420 7468 6520 7361 6d65  terB at the same
+0001c610: 206c 6f63 6174 696f 6e73 0d0a 0d0a 2020   locations....  
+0001c620: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+0001c630: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+0001c640: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6d61  ----..        ma
+0001c650: 736b 203a 205b 7374 722f 4461 7461 7365  sk : [str/Datase
+0001c660: 745d 0d0a 2020 2020 2020 2020 2020 2020  t]..            
+0001c670: 7061 7468 2f44 6174 6173 6574 206f 626a  path/Dataset obj
+0001c680: 6563 7420 6f66 2074 6865 206d 6173 6b20  ect of the mask 
+0001c690: 7261 7374 6572 2074 6f20 6372 6f70 2074  raster to crop t
+0001c6a0: 6865 2072 6173 7465 7273 2028 746f 2067  he rasters (to g
+0001c6b0: 6574 2074 6865 204e 6f44 6174 6120 7661  et the NoData va
+0001c6c0: 6c75 650d 0a20 2020 2020 2020 2020 2020  lue..           
+0001c6d0: 2061 6e64 2069 7420 6c6f 6361 7469 6f6e   and it location
+0001c6e0: 2069 6e20 7468 6520 6172 7261 7929 204d   in the array) M
+0001c6f0: 6173 6b20 7368 6f75 6c64 2069 6e63 6c75  ask should inclu
+0001c700: 6465 2074 6865 206e 616d 6520 6f66 2074  de the name of t
+0001c710: 6865 2072 6173 7465 7220 616e 6420 7468  he raster and th
+0001c720: 650d 0a20 2020 2020 2020 2020 2020 2065  e..            e
+0001c730: 7874 656e 7369 6f6e 206c 696b 6520 2264  xtension like "d
+0001c740: 6174 612f 6465 6d2e 7469 6622 2c20 6f72  ata/dem.tif", or
+0001c750: 2079 6f75 2063 616e 2072 6561 6420 7468   you can read th
+0001c760: 6520 6d61 736b 2072 6173 7465 7220 7573  e mask raster us
+0001c770: 696e 6720 6764 616c 2061 6e64 2075 7365  ing gdal and use
+0001c780: 0d0a 2020 2020 2020 2020 2020 2020 6973  ..            is
+0001c790: 2074 6865 2066 6972 7374 2070 6172 616d   the first param
+0001c7a0: 6574 6572 2074 6f20 7468 6520 6675 6e63  eter to the func
+0001c7b0: 7469 6f6e 2e0d 0a0d 0a20 2020 2020 2020  tion.....       
+0001c7c0: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
+0001c7d0: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
+0001c7e0: 2020 206e 6577 2072 6173 7465 7273 2068     new rasters h
+0001c7f0: 6176 6520 7468 6520 7661 6c75 6573 2066  ave the values f
+0001c800: 726f 6d20 7261 7374 6572 7320 696e 2042  rom rasters in B
+0001c810: 5f69 6e70 7574 5f70 6174 6820 7769 7468  _input_path with
+0001c820: 2074 6865 204e 6f44 6174 6156 616c 7565   the NoDataValue
+0001c830: 2069 6e20 7468 6520 7361 6d65 0d0a 2020   in the same..  
+0001c840: 2020 2020 2020 6c6f 6361 7469 6f6e 7320        locations 
+0001c850: 6c69 6b65 2072 6173 7465 7220 412e 0d0a  like raster A...
+0001c860: 0d0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
+0001c870: 6573 0d0a 2020 2020 2020 2020 2d2d 2d2d  es..        ----
+0001c880: 2d2d 2d2d 0d0a 2020 2020 2020 2020 3e3e  ----..        >>
+0001c890: 3e20 6465 6d5f 7061 7468 203d 2022 6578  > dem_path = "ex
+0001c8a0: 616d 706c 6573 2f47 4953 2f64 6174 612f  amples/GIS/data/
+0001c8b0: 6163 6334 3030 302e 7469 6622 0d0a 2020  acc4000.tif"..  
+0001c8c0: 2020 2020 2020 3e3e 3e20 7372 635f 7061        >>> src_pa
+0001c8d0: 7468 203d 2022 6578 616d 706c 6573 2f47  th = "examples/G
+0001c8e0: 4953 2f64 6174 612f 616c 6967 6e65 645f  IS/data/aligned_
+0001c8f0: 7261 7374 6572 732f 220d 0a20 2020 2020  rasters/"..     
+0001c900: 2020 203e 3e3e 206f 7574 5f70 6174 6820     >>> out_path 
+0001c910: 3d20 2265 7861 6d70 6c65 732f 4749 532f  = "examples/GIS/
+0001c920: 6461 7461 2f63 726f 705f 616c 6967 6e65  data/crop_aligne
+0001c930: 645f 666f 6c64 6572 2f22 0d0a 2020 2020  d_folder/"..    
+0001c940: 2020 2020 3e3e 3e20 4461 7461 6375 6265      >>> Datacube
+0001c950: 2e63 726f 7028 6465 6d5f 7061 7468 2c20  .crop(dem_path, 
+0001c960: 7372 635f 7061 7468 2c20 6f75 745f 7061  src_path, out_pa
+0001c970: 7468 290d 0a20 2020 2020 2020 2022 2222  th)..        """
+0001c980: 0d0a 2020 2020 2020 2020 666f 7220 6920  ..        for i 
+0001c990: 696e 2072 616e 6765 2873 656c 662e 7469  in range(self.ti
+0001c9a0: 6d65 5f6c 656e 6774 6829 3a0d 0a20 2020  me_length):..   
+0001c9b0: 2020 2020 2020 2020 2073 7263 203d 2073           src = s
+0001c9c0: 656c 662e 696c 6f63 2869 290d 0a20 2020  elf.iloc(i)..   
+0001c9d0: 2020 2020 2020 2020 2064 7374 203d 2073           dst = s
+0001c9e0: 7263 2e63 726f 7028 6d61 736b 290d 0a20  rc.crop(mask).. 
+0001c9f0: 2020 2020 2020 2020 2020 2061 7272 203d             arr =
+0001ca00: 2064 7374 2e72 6561 645f 6172 7261 7928   dst.read_array(
+0001ca10: 290d 0a20 2020 2020 2020 2020 2020 2069  )..            i
+0001ca20: 6620 6920 3d3d 2030 3a0d 0a20 2020 2020  f i == 0:..     
+0001ca30: 2020 2020 2020 2020 2020 2023 2063 7265             # cre
+0001ca40: 6174 6520 7468 6520 6172 7261 790d 0a20  ate the array.. 
+0001ca50: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0001ca60: 7272 6179 203d 2028 0d0a 2020 2020 2020  rray = (..      
+0001ca70: 2020 2020 2020 2020 2020 2020 2020 6e70                np
+0001ca80: 2e6f 6e65 7328 0d0a 2020 2020 2020 2020  .ones(..        
+0001ca90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001caa0: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+0001cab0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001cac0: 656c 662e 7469 6d65 5f6c 656e 6774 682c  elf.time_length,
+0001cad0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001cae0: 2020 2020 2020 2020 2020 2020 2020 6172                ar
+0001caf0: 722e 7368 6170 655b 305d 2c0d 0a20 2020  r.shape[0],..   
+0001cb00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cb10: 2020 2020 2020 2020 2061 7272 2e73 6861           arr.sha
+0001cb20: 7065 5b31 5d2c 0d0a 2020 2020 2020 2020  pe[1],..        
+0001cb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cb40: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0001cb50: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
+0001cb60: 2020 2020 2020 2020 2020 2020 2020 2a20                * 
+0001cb70: 6e70 2e6e 616e 0d0a 2020 2020 2020 2020  np.nan..        
+0001cb80: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
+0001cb90: 2020 2020 2020 2061 7272 6179 5b69 2c20         array[i, 
+0001cba0: 3a2c 203a 5d20 3d20 6172 720d 0a0d 0a20  :, :] = arr.... 
+0001cbb0: 2020 2020 2020 2073 656c 662e 5f64 6174         self._dat
+0001cbc0: 6120 3d20 6172 7261 790d 0a20 2020 2020  a = array..     
+0001cbd0: 2020 2023 2075 7365 2074 6865 206c 6173     # use the las
+0001cbe0: 7420 7372 6320 6173 0d0a 2020 2020 2020  t src as..      
+0001cbf0: 2020 7365 6c66 2e5f 6261 7365 203d 2064    self._base = d
+0001cc00: 7374 0d0a 0d0a 2020 2020 2320 2320 544f  st....    # # TO
+0001cc10: 444f 3a20 6d65 7267 6520 5265 7072 6f6a  DO: merge Reproj
+0001cc20: 6563 7444 6174 6173 6574 2061 6e64 2050  ectDataset and P
+0001cc30: 726f 6a65 6374 5261 7374 6572 2074 6865  rojectRaster the
+0001cc40: 7920 6172 6520 616c 6d6f 7374 2074 6865  y are almost the
+0001cc50: 2073 616d 650d 0a20 2020 2023 2023 2054   same..    # # T
+0001cc60: 4f44 4f3a 2073 7469 6c6c 206e 6565 6473  ODO: still needs
+0001cc70: 2074 6f20 6265 2074 6573 7465 640d 0a20   to be tested.. 
+0001cc80: 2020 2023 2040 7374 6174 6963 6d65 7468     # @staticmeth
+0001cc90: 6f64 0d0a 2020 2020 2320 6465 6620 746f  od..    # def to
+0001cca0: 5f65 7073 6728 0d0a 2020 2020 2320 2020  _epsg(..    #   
+0001ccb0: 2020 2020 2020 7372 633a 2067 6461 6c2e        src: gdal.
+0001ccc0: 4461 7461 6375 6265 2c0d 0a20 2020 2023  Datacube,..    #
+0001ccd0: 2020 2020 2020 2020 2074 6f5f 6570 7367           to_epsg
+0001cce0: 3a20 696e 7420 3d20 3338 3537 2c0d 0a20  : int = 3857,.. 
+0001ccf0: 2020 2023 2020 2020 2020 2020 2063 656c     #         cel
+0001cd00: 6c5f 7369 7a65 3a20 696e 7420 3d20 5b5d  l_size: int = []
+0001cd10: 2c0d 0a20 2020 2023 2020 2020 2020 2020  ,..    #        
+0001cd20: 206d 6574 686f 643a 2073 7472 203d 2022   method: str = "
+0001cd30: 4e65 6172 6573 7422 2c0d 0a20 2020 2023  Nearest",..    #
+0001cd40: 0d0a 2020 2020 2320 2920 2d3e 2067 6461  ..    # ) -> gda
+0001cd50: 6c2e 4461 7461 6375 6265 3a0d 0a20 2020  l.Datacube:..   
+0001cd60: 2023 2020 2020 2022 2222 746f 5f65 7073   #     """to_eps
+0001cd70: 672e 0d0a 2020 2020 230d 0a20 2020 2023  g...    #..    #
+0001cd80: 2020 2020 2020 2020 202d 2074 6f5f 6570           - to_ep
+0001cd90: 7367 2072 6570 726f 6a65 6374 7320 616e  sg reprojects an
+0001cda0: 6420 7265 7361 6d70 6c65 7320 6120 666f  d resamples a fo
+0001cdb0: 6c64 6572 206f 6620 7261 7374 6572 7320  lder of rasters 
+0001cdc0: 746f 2061 6e79 2070 726f 6a65 6374 696f  to any projectio
+0001cdd0: 6e0d 0a20 2020 2023 2020 2020 2020 2020  n..    #        
+0001cde0: 2028 6465 6661 756c 7420 7468 6520 5747   (default the WG
+0001cdf0: 5338 3420 7765 6220 6d65 7263 6174 6f72  S84 web mercator
+0001ce00: 2070 726f 6a65 6374 696f 6e2c 2077 6974   projection, wit
+0001ce10: 686f 7574 2072 6573 616d 706c 696e 6729  hout resampling)
+0001ce20: 0d0a 2020 2020 230d 0a20 2020 2023 2020  ..    #..    #  
+0001ce30: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
+0001ce40: 2020 2023 2020 2020 202d 2d2d 2d2d 2d2d     #     -------
+0001ce50: 2d2d 2d0d 0a20 2020 2023 2020 2020 2073  ---..    #     s
+0001ce60: 7263 3a20 5b67 6461 6c20 6461 7461 7365  rc: [gdal datase
+0001ce70: 745d 0d0a 2020 2020 2320 2020 2020 2020  t]..    #       
+0001ce80: 2020 6764 616c 2064 6174 6173 6574 206f    gdal dataset o
+0001ce90: 626a 6563 7420 2873 7263 3d67 6461 6c2e  bject (src=gdal.
+0001cea0: 4f70 656e 2822 6465 6d2e 7469 6622 2929  Open("dem.tif"))
+0001ceb0: 0d0a 2020 2020 2320 2020 2020 746f 5f65  ..    #     to_e
+0001cec0: 7073 673a 205b 696e 7465 6765 725d 0d0a  psg: [integer]..
+0001ced0: 2020 2020 2320 2020 2020 2020 2020 2072      #          r
+0001cee0: 6566 6572 656e 6365 206e 756d 6265 7220  eference number 
+0001cef0: 746f 2074 6865 206e 6577 2070 726f 6a65  to the new proje
+0001cf00: 6374 696f 6e20 2868 7474 7073 3a2f 2f65  ction (https://e
+0001cf10: 7073 672e 696f 2f29 0d0a 2020 2020 2320  psg.io/)..    # 
+0001cf20: 2020 2020 2020 2020 2864 6566 6175 6c74          (default
+0001cf30: 2033 3835 3720 7468 6520 7265 6665 7265   3857 the refere
+0001cf40: 6e63 6520 6e6f 206f 6620 5747 5338 3420  nce no of WGS84 
+0001cf50: 7765 6220 6d65 7263 6174 6f72 2029 0d0a  web mercator )..
+0001cf60: 2020 2020 2320 2020 2020 6365 6c6c 5f73      #     cell_s
+0001cf70: 697a 653a 205b 696e 7465 6765 725d 0d0a  ize: [integer]..
+0001cf80: 2020 2020 2320 2020 2020 2020 2020 206e      #          n
+0001cf90: 756d 6265 7220 746f 2072 6573 616d 706c  umber to resampl
+0001cfa0: 6520 7468 6520 7261 7374 6572 2063 656c  e the raster cel
+0001cfb0: 6c20 7369 7a65 2074 6f20 6120 6e65 7720  l size to a new 
+0001cfc0: 6365 6c6c 2073 697a 650d 0a20 2020 2023  cell size..    #
+0001cfd0: 2020 2020 2020 2020 2028 6465 6661 756c           (defaul
+0001cfe0: 7420 656d 7074 7920 736f 2072 6173 7465  t empty so raste
+0001cff0: 7220 7769 6c6c 206e 6f74 2062 6520 7265  r will not be re
+0001d000: 7361 6d70 6c65 6429 0d0a 2020 2020 2320  sampled)..    # 
+0001d010: 2020 2020 6d65 7468 6f64 3a20 5b53 7472      method: [Str
+0001d020: 696e 675d 0d0a 2020 2020 2320 2020 2020  ing]..    #     
+0001d030: 2020 2020 7265 7361 6d70 6c69 6e67 2074      resampling t
+0001d040: 6563 686e 6971 7565 2064 6566 6175 6c74  echnique default
+0001d050: 2069 7320 224e 6561 7265 7374 220d 0a20   is "Nearest".. 
+0001d060: 2020 2023 2020 2020 2020 2020 2068 7474     #         htt
+0001d070: 7073 3a2f 2f67 6973 6765 6f67 7261 7068  ps://gisgeograph
+0001d080: 792e 636f 6d2f 7261 7374 6572 2d72 6573  y.com/raster-res
+0001d090: 616d 706c 696e 672f 0d0a 2020 2020 2320  ampling/..    # 
+0001d0a0: 2020 2020 2020 2020 224e 6561 7265 7374          "Nearest
+0001d0b0: 2220 666f 7220 6e65 6172 6573 7420 6e65  " for nearest ne
+0001d0c0: 6967 6862 6f75 722c 2263 7562 6963 2220  ighbour,"cubic" 
+0001d0d0: 666f 7220 6375 6269 6320 636f 6e76 6f6c  for cubic convol
+0001d0e0: 7574 696f 6e2c 0d0a 2020 2020 2320 2020  ution,..    #   
+0001d0f0: 2020 2020 2020 2262 696c 696e 6561 7222        "bilinear"
+0001d100: 2066 6f72 2062 696c 696e 6561 720d 0a20   for bilinear.. 
+0001d110: 2020 2023 0d0a 2020 2020 2320 2020 2020     #..    #     
+0001d120: 5265 7475 726e 730d 0a20 2020 2023 2020  Returns..    #  
+0001d130: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
+0001d140: 2320 2020 2020 7261 7374 6572 3a20 5b67  #     raster: [g
+0001d150: 6461 6c20 4461 7461 6375 6265 5d0d 0a20  dal Datacube].. 
+0001d160: 2020 2023 2020 2020 2020 2020 2020 6120     #          a 
+0001d170: 4744 414c 2069 6e2d 6d65 6d6f 7279 2066  GDAL in-memory f
+0001d180: 696c 6520 6f62 6a65 6374 2c20 7768 6572  ile object, wher
+0001d190: 6520 796f 7520 6361 6e20 5265 6164 4173  e you can ReadAs
+0001d1a0: 4172 7261 7920 6574 632e 0d0a 2020 2020  Array etc...    
+0001d1b0: 2320 2020 2020 2222 220d 0a20 2020 2023  #     """..    #
+0001d1c0: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
+0001d1d0: 7374 616e 6365 2873 7263 2c20 6764 616c  stance(src, gdal
+0001d1e0: 2e44 6174 6163 7562 6529 3a0d 0a20 2020  .Datacube):..   
+0001d1f0: 2023 2020 2020 2020 2020 2072 6169 7365   #         raise
+0001d200: 2054 7970 6545 7272 6f72 280d 0a20 2020   TypeError(..   
+0001d210: 2023 2020 2020 2020 2020 2020 2020 2022   #             "
+0001d220: 7372 6320 7368 6f75 6c64 2062 6520 7265  src should be re
+0001d230: 6164 2075 7369 6e67 2067 6461 6c20 2867  ad using gdal (g
+0001d240: 6461 6c20 6461 7461 7365 7420 706c 6561  dal dataset plea
+0001d250: 7365 2072 6561 6420 6974 2075 7369 6e67  se read it using
+0001d260: 2067 6461 6c22 0d0a 2020 2020 2320 2020   gdal"..    #   
+0001d270: 2020 2020 2020 2020 2020 6622 206c 6962            f" lib
+0001d280: 7261 7279 2920 6769 7665 6e20 7b74 7970  rary) given {typ
+0001d290: 6528 7372 6329 7d22 0d0a 2020 2020 2320  e(src)}"..    # 
+0001d2a0: 2020 2020 2020 2020 290d 0a20 2020 2023          )..    #
+0001d2b0: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
+0001d2c0: 7374 616e 6365 2874 6f5f 6570 7367 2c20  stance(to_epsg, 
+0001d2d0: 696e 7429 3a0d 0a20 2020 2023 2020 2020  int):..    #    
+0001d2e0: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+0001d2f0: 7272 6f72 280d 0a20 2020 2023 2020 2020  rror(..    #    
+0001d300: 2020 2020 2020 2020 2022 706c 6561 7365           "please
+0001d310: 2065 6e74 6572 2063 6f72 7265 6374 2069   enter correct i
+0001d320: 6e74 6567 6572 206e 756d 6265 7220 666f  nteger number fo
+0001d330: 7220 746f 5f65 7073 6720 6d6f 7265 2069  r to_epsg more i
+0001d340: 6e66 6f72 6d61 7469 6f6e 2022 0d0a 2020  nformation "..  
+0001d350: 2020 2320 2020 2020 2020 2020 2020 2020    #             
+0001d360: 6622 6874 7470 733a 2f2f 6570 7367 2e69  f"https://epsg.i
+0001d370: 6f2f 2c20 6769 7665 6e20 7b74 7970 6528  o/, given {type(
+0001d380: 746f 5f65 7073 6729 7d22 0d0a 2020 2020  to_epsg)}"..    
+0001d390: 2320 2020 2020 2020 2020 290d 0a20 2020  #         )..   
+0001d3a0: 2023 2020 2020 2069 6620 6e6f 7420 6973   #     if not is
+0001d3b0: 696e 7374 616e 6365 286d 6574 686f 642c  instance(method,
+0001d3c0: 2073 7472 293a 0d0a 2020 2020 2320 2020   str):..    #   
+0001d3d0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
+0001d3e0: 4572 726f 7228 0d0a 2020 2020 2320 2020  Error(..    #   
+0001d3f0: 2020 2020 2020 2020 2020 2270 6c65 6173            "pleas
+0001d400: 6520 656e 7465 7220 636f 7272 6563 7420  e enter correct 
+0001d410: 6d65 7468 6f64 206d 6f72 6520 696e 666f  method more info
+0001d420: 726d 6174 696f 6e20 7365 6520 2220 2264  rmation see " "d
+0001d430: 6f63 6d65 6e74 6174 696f 6e20 220d 0a20  ocmentation ".. 
+0001d440: 2020 2023 2020 2020 2020 2020 2029 0d0a     #         )..
+0001d450: 2020 2020 230d 0a20 2020 2023 2020 2020      #..    #    
+0001d460: 2069 6620 6365 6c6c 5f73 697a 653a 0d0a   if cell_size:..
+0001d470: 2020 2020 2320 2020 2020 2020 2020 6173      #         as
+0001d480: 7365 7274 2069 7369 6e73 7461 6e63 6528  sert isinstance(
+0001d490: 6365 6c6c 5f73 697a 652c 2069 6e74 2920  cell_size, int) 
+0001d4a0: 6f72 2069 7369 6e73 7461 6e63 6528 0d0a  or isinstance(..
+0001d4b0: 2020 2020 2320 2020 2020 2020 2020 2020      #           
+0001d4c0: 2020 6365 6c6c 5f73 697a 652c 2066 6c6f    cell_size, flo
+0001d4d0: 6174 0d0a 2020 2020 2320 2020 2020 2020  at..    #       
+0001d4e0: 2020 292c 2022 706c 6561 7365 2065 6e74    ), "please ent
+0001d4f0: 6572 2061 6e20 696e 7465 6765 7220 6f72  er an integer or
+0001d500: 2066 6c6f 6174 2063 656c 6c20 7369 7a65   float cell size
+0001d510: 220d 0a20 2020 2023 0d0a 2020 2020 2320  "..    #..    # 
+0001d520: 2020 2020 6966 206d 6574 686f 6420 3d3d      if method ==
+0001d530: 2022 4e65 6172 6573 7422 3a0d 0a20 2020   "Nearest":..   
+0001d540: 2023 2020 2020 2020 2020 206d 6574 686f   #         metho
+0001d550: 6420 3d20 6764 616c 2e47 5241 5f4e 6561  d = gdal.GRA_Nea
+0001d560: 7265 7374 4e65 6967 6862 6f75 720d 0a20  restNeighbour.. 
+0001d570: 2020 2023 2020 2020 2065 6c69 6620 6d65     #     elif me
+0001d580: 7468 6f64 203d 3d20 2263 7562 6963 223a  thod == "cubic":
+0001d590: 0d0a 2020 2020 2320 2020 2020 2020 2020  ..    #         
+0001d5a0: 6d65 7468 6f64 203d 2067 6461 6c2e 4752  method = gdal.GR
+0001d5b0: 415f 4375 6269 630d 0a20 2020 2023 2020  A_Cubic..    #  
+0001d5c0: 2020 2065 6c69 6620 6d65 7468 6f64 203d     elif method =
+0001d5d0: 3d20 2262 696c 696e 6561 7222 3a0d 0a20  = "bilinear":.. 
+0001d5e0: 2020 2023 2020 2020 2020 2020 206d 6574     #         met
+0001d5f0: 686f 6420 3d20 6764 616c 2e47 5241 5f42  hod = gdal.GRA_B
+0001d600: 696c 696e 6561 720d 0a20 2020 2023 0d0a  ilinear..    #..
+0001d610: 2020 2020 2320 2020 2020 7372 635f 7072      #     src_pr
+0001d620: 6f6a 203d 2073 7263 2e47 6574 5072 6f6a  oj = src.GetProj
+0001d630: 6563 7469 6f6e 2829 0d0a 2020 2020 2320  ection()..    # 
+0001d640: 2020 2020 7372 635f 6774 203d 2073 7263      src_gt = src
+0001d650: 2e47 6574 4765 6f54 7261 6e73 666f 726d  .GetGeoTransform
+0001d660: 2829 0d0a 2020 2020 2320 2020 2020 7372  ()..    #     sr
+0001d670: 635f 7820 3d20 7372 632e 5261 7374 6572  c_x = src.Raster
+0001d680: 5853 697a 650d 0a20 2020 2023 2020 2020  XSize..    #    
+0001d690: 2073 7263 5f79 203d 2073 7263 2e52 6173   src_y = src.Ras
+0001d6a0: 7465 7259 5369 7a65 0d0a 2020 2020 2320  terYSize..    # 
+0001d6b0: 2020 2020 6474 7970 6520 3d20 7372 632e      dtype = src.
+0001d6c0: 4765 7452 6173 7465 7242 616e 6428 3129  GetRasterBand(1)
+0001d6d0: 2e44 6174 6154 7970 650d 0a20 2020 2023  .DataType..    #
+0001d6e0: 2020 2020 2023 2073 7061 7469 616c 2072       # spatial r
+0001d6f0: 6566 0d0a 2020 2020 2320 2020 2020 7372  ef..    #     sr
+0001d700: 635f 7372 203d 206f 7372 2e53 7061 7469  c_sr = osr.Spati
+0001d710: 616c 5265 6665 7265 6e63 6528 776b 743d  alReference(wkt=
+0001d720: 7372 635f 7072 6f6a 290d 0a20 2020 2023  src_proj)..    #
+0001d730: 2020 2020 2073 7263 5f65 7073 6720 3d20       src_epsg = 
+0001d740: 7372 635f 7372 2e47 6574 4174 7472 5661  src_sr.GetAttrVa
+0001d750: 6c75 6528 2241 5554 484f 5249 5459 222c  lue("AUTHORITY",
+0001d760: 2031 290d 0a20 2020 2023 0d0a 2020 2020   1)..    #..    
+0001d770: 2320 2020 2020 2320 6469 7374 696e 6174  #     # distinat
+0001d780: 696f 6e0d 0a20 2020 2023 2020 2020 2023  ion..    #     #
+0001d790: 2073 7061 7469 616c 2072 6566 0d0a 2020   spatial ref..  
+0001d7a0: 2020 2320 2020 2020 6473 745f 6570 7367    #     dst_epsg
+0001d7b0: 203d 206f 7372 2e53 7061 7469 616c 5265   = osr.SpatialRe
+0001d7c0: 6665 7265 6e63 6528 290d 0a20 2020 2023  ference()..    #
+0001d7d0: 2020 2020 2064 7374 5f65 7073 672e 496d       dst_epsg.Im
+0001d7e0: 706f 7274 4672 6f6d 4550 5347 2874 6f5f  portFromEPSG(to_
+0001d7f0: 6570 7367 290d 0a20 2020 2023 2020 2020  epsg)..    #    
+0001d800: 2023 2074 7261 6e73 666f 726d 6174 696f   # transformatio
+0001d810: 6e20 6661 6374 6f72 730d 0a20 2020 2023  n factors..    #
+0001d820: 2020 2020 2074 7820 3d20 6f73 722e 436f       tx = osr.Co
+0001d830: 6f72 6469 6e61 7465 5472 616e 7366 6f72  ordinateTransfor
+0001d840: 6d61 7469 6f6e 2873 7263 5f73 722c 2064  mation(src_sr, d
+0001d850: 7374 5f65 7073 6729 0d0a 2020 2020 230d  st_epsg)..    #.
+0001d860: 0a20 2020 2023 2020 2020 2023 2069 6e63  .    #     # inc
+0001d870: 6173 6520 7468 6520 736f 7572 6365 2063  ase the source c
+0001d880: 7273 2069 7320 4743 5320 616e 6420 6c6f  rs is GCS and lo
+0001d890: 6e67 6974 7564 6520 6973 2069 6e20 7468  ngitude is in th
+0001d8a0: 6520 7765 7374 2068 656d 6973 7068 6572  e west hemispher
+0001d8b0: 6520 6764 616c 0d0a 2020 2020 2320 2020  e gdal..    #   
+0001d8c0: 2020 2320 7265 6164 7320 6c6f 6e67 6974    # reads longit
+0001d8d0: 7564 6520 6672 6f6e 2030 2074 6f20 3336  ude fron 0 to 36
+0001d8e0: 3020 616e 6420 7472 616e 7366 6f72 6d61  0 and transforma
+0001d8f0: 7469 6f6e 2066 6163 746f 7220 776f 6e74  tion factor wont
+0001d900: 2077 6f72 6b20 7769 7468 2076 616c 6575   work with valeu
+0001d910: 730d 0a20 2020 2023 2020 2020 2023 2067  s..    #     # g
+0001d920: 7265 6174 6572 2074 6861 6e20 3138 300d  reater than 180.
+0001d930: 0a20 2020 2023 2020 2020 2069 6620 7372  .    #     if sr
+0001d940: 635f 6570 7367 203d 3d20 2234 3332 3622  c_epsg == "4326"
+0001d950: 2061 6e64 2073 7263 5f67 745b 305d 203e   and src_gt[0] >
+0001d960: 2031 3830 3a0d 0a20 2020 2023 2020 2020   180:..    #    
+0001d970: 2020 2020 206c 6e67 5f6e 6577 203d 2073       lng_new = s
+0001d980: 7263 5f67 745b 305d 202d 2033 3630 0d0a  rc_gt[0] - 360..
+0001d990: 2020 2020 2320 2020 2020 2020 2020 2320      #         # 
+0001d9a0: 7472 616e 7366 6f72 6d20 7468 6520 7269  transform the ri
+0001d9b0: 6768 7420 7570 7065 7220 636f 726e 6572  ght upper corner
+0001d9c0: 2070 6f69 6e74 0d0a 2020 2020 2320 2020   point..    #   
+0001d9d0: 2020 2020 2020 2875 6c78 2c20 756c 792c        (ulx, uly,
+0001d9e0: 2075 6c7a 2920 3d20 7478 2e54 7261 6e73   ulz) = tx.Trans
+0001d9f0: 666f 726d 506f 696e 7428 6c6e 675f 6e65  formPoint(lng_ne
+0001da00: 772c 2073 7263 5f67 745b 335d 290d 0a20  w, src_gt[3]).. 
+0001da10: 2020 2023 2020 2020 2020 2020 2023 2074     #         # t
+0001da20: 7261 6e73 666f 726d 2074 6865 2072 6967  ransform the rig
+0001da30: 6874 206c 6f77 6572 2063 6f72 6e65 7220  ht lower corner 
+0001da40: 706f 696e 740d 0a20 2020 2023 2020 2020  point..    #    
+0001da50: 2020 2020 2028 6c72 782c 206c 7279 2c20       (lrx, lry, 
+0001da60: 6c72 7a29 203d 2074 782e 5472 616e 7366  lrz) = tx.Transf
+0001da70: 6f72 6d50 6f69 6e74 280d 0a20 2020 2023  ormPoint(..    #
+0001da80: 2020 2020 2020 2020 2020 2020 206c 6e67               lng
+0001da90: 5f6e 6577 202b 2073 7263 5f67 745b 315d  _new + src_gt[1]
+0001daa0: 202a 2073 7263 5f78 2c20 7372 635f 6774   * src_x, src_gt
+0001dab0: 5b33 5d20 2b20 7372 635f 6774 5b35 5d20  [3] + src_gt[5] 
+0001dac0: 2a20 7372 635f 790d 0a20 2020 2023 2020  * src_y..    #  
+0001dad0: 2020 2020 2020 2029 0d0a 2020 2020 2320         )..    # 
+0001dae0: 2020 2020 656c 7365 3a0d 0a20 2020 2023      else:..    #
+0001daf0: 2020 2020 2020 2020 2023 2074 7261 6e73           # trans
+0001db00: 666f 726d 2074 6865 2072 6967 6874 2075  form the right u
+0001db10: 7070 6572 2063 6f72 6e65 7220 706f 696e  pper corner poin
+0001db20: 740d 0a20 2020 2023 2020 2020 2020 2020  t..    #        
+0001db30: 2028 756c 782c 2075 6c79 2c20 756c 7a29   (ulx, uly, ulz)
+0001db40: 203d 2074 782e 5472 616e 7366 6f72 6d50   = tx.TransformP
+0001db50: 6f69 6e74 2873 7263 5f67 745b 305d 2c20  oint(src_gt[0], 
+0001db60: 7372 635f 6774 5b33 5d29 0d0a 2020 2020  src_gt[3])..    
+0001db70: 2320 2020 2020 2020 2020 2320 7472 616e  #         # tran
+0001db80: 7366 6f72 6d20 7468 6520 7269 6768 7420  sform the right 
+0001db90: 6c6f 7765 7220 636f 726e 6572 2070 6f69  lower corner poi
+0001dba0: 6e74 0d0a 2020 2020 2320 2020 2020 2020  nt..    #       
+0001dbb0: 2020 286c 7278 2c20 6c72 792c 206c 727a    (lrx, lry, lrz
+0001dbc0: 2920 3d20 7478 2e54 7261 6e73 666f 726d  ) = tx.Transform
+0001dbd0: 506f 696e 7428 0d0a 2020 2020 2320 2020  Point(..    #   
+0001dbe0: 2020 2020 2020 2020 2020 7372 635f 6774            src_gt
+0001dbf0: 5b30 5d20 2b20 7372 635f 6774 5b31 5d20  [0] + src_gt[1] 
+0001dc00: 2a20 7372 635f 782c 2073 7263 5f67 745b  * src_x, src_gt[
+0001dc10: 335d 202b 2073 7263 5f67 745b 355d 202a  3] + src_gt[5] *
+0001dc20: 2073 7263 5f79 0d0a 2020 2020 2320 2020   src_y..    #   
+0001dc30: 2020 2020 2020 290d 0a20 2020 2023 0d0a        )..    #..
+0001dc40: 2020 2020 2320 2020 2020 6966 206e 6f74      #     if not
+0001dc50: 2063 656c 6c5f 7369 7a65 3a0d 0a20 2020   cell_size:..   
+0001dc60: 2023 2020 2020 2020 2020 2023 2074 6865   #         # the
+0001dc70: 2072 6573 756c 7420 7261 7374 6572 2068   result raster h
+0001dc80: 6173 2074 6865 2073 616d 6520 7069 7863  as the same pixc
+0001dc90: 656c 2073 697a 6520 6173 2074 6865 2073  el size as the s
+0001dca0: 6f75 7263 650d 0a20 2020 2023 2020 2020  ource..    #    
+0001dcb0: 2020 2020 2023 2063 6865 636b 2069 6620       # check if 
+0001dcc0: 7468 6520 636f 6f72 6469 6e61 7465 2073  the coordinate s
+0001dcd0: 7973 7465 6d20 6973 2047 4353 2063 6f6e  ystem is GCS con
+0001dce0: 7665 7274 2074 6865 2064 6973 7461 6e63  vert the distanc
+0001dcf0: 6520 6672 6f6d 2061 6e67 756c 6172 2074  e from angular t
+0001dd00: 6f20 6d65 7472 6963 0d0a 2020 2020 2320  o metric..    # 
+0001dd10: 2020 2020 2020 2020 6966 2073 7263 5f65          if src_e
+0001dd20: 7073 6720 3d3d 2022 3433 3236 223a 0d0a  psg == "4326":..
+0001dd30: 2020 2020 2320 2020 2020 2020 2020 2020      #           
+0001dd40: 2020 636f 6f72 6473 5f31 203d 2028 7372    coords_1 = (sr
+0001dd50: 635f 6774 5b33 5d2c 2073 7263 5f67 745b  c_gt[3], src_gt[
+0001dd60: 305d 290d 0a20 2020 2023 2020 2020 2020  0])..    #      
+0001dd70: 2020 2020 2020 2063 6f6f 7264 735f 3220         coords_2 
+0001dd80: 3d20 2873 7263 5f67 745b 335d 2c20 7372  = (src_gt[3], sr
+0001dd90: 635f 6774 5b30 5d20 2b20 7372 635f 6774  c_gt[0] + src_gt
+0001dda0: 5b31 5d29 0d0a 2020 2020 2320 2020 2020  [1])..    #     
+0001ddb0: 2020 2020 2020 2020 2320 2020 2020 2020          #       
+0001ddc0: 2020 2020 2070 6978 656c 5f73 7061 6369       pixel_spaci
+0001ddd0: 6e67 3d67 656f 7079 2e64 6973 7461 6e63  ng=geopy.distanc
+0001dde0: 652e 7669 6e63 656e 7479 2863 6f6f 7264  e.vincenty(coord
+0001ddf0: 735f 312c 2063 6f6f 7264 735f 3229 2e6d  s_1, coords_2).m
+0001de00: 0d0a 2020 2020 2320 2020 2020 2020 2020  ..    #         
+0001de10: 2020 2020 7069 7865 6c5f 7370 6163 696e      pixel_spacin
+0001de20: 6720 3d20 4665 6174 7572 6543 6f6c 6c65  g = FeatureColle
+0001de30: 6374 696f 6e2e 4743 5344 6973 7461 6e63  ction.GCSDistanc
+0001de40: 6528 636f 6f72 6473 5f31 2c20 636f 6f72  e(coords_1, coor
+0001de50: 6473 5f32 290d 0a20 2020 2023 2020 2020  ds_2)..    #    
+0001de60: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+0001de70: 2320 2020 2020 2020 2020 2020 2020 7069  #             pi
+0001de80: 7865 6c5f 7370 6163 696e 6720 3d20 7372  xel_spacing = sr
+0001de90: 635f 6774 5b31 5d0d 0a20 2020 2023 2020  c_gt[1]..    #  
+0001dea0: 2020 2065 6c73 653a 0d0a 2020 2020 2320     else:..    # 
+0001deb0: 2020 2020 2020 2020 2320 6966 2073 7263          # if src
+0001dec0: 5f65 7073 672e 4765 7441 7474 7256 616c  _epsg.GetAttrVal
+0001ded0: 7565 2827 4155 5448 4f52 4954 5927 2c20  ue('AUTHORITY', 
+0001dee0: 3129 2021 3d20 2234 3332 3622 3a0d 0a20  1) != "4326":.. 
+0001def0: 2020 2023 2020 2020 2020 2020 2023 2020     #         #  
+0001df00: 2020 2061 7373 6572 7420 2863 656c 6c5f     assert (cell_
+0001df10: 7369 7a65 203e 2031 292c 2022 706c 6561  size > 1), "plea
+0001df20: 7365 2065 6e74 6572 2063 656c 6c20 7369  se enter cell si
+0001df30: 7a65 2067 7265 6174 6572 2074 6861 6e20  ze greater than 
+0001df40: 3122 0d0a 2020 2020 2320 2020 2020 2020  1"..    #       
+0001df50: 2020 2320 6966 2074 6865 2075 7365 7220    # if the user 
+0001df60: 696e 7075 7420 6120 6365 6c6c 2073 697a  input a cell siz
+0001df70: 6520 7265 7361 6d70 6c65 2074 6865 2072  e resample the r
+0001df80: 6173 7465 720d 0a20 2020 2023 2020 2020  aster..    #    
+0001df90: 2020 2020 2070 6978 656c 5f73 7061 6369       pixel_spaci
+0001dfa0: 6e67 203d 2063 656c 6c5f 7369 7a65 0d0a  ng = cell_size..
+0001dfb0: 2020 2020 230d 0a20 2020 2023 2020 2020      #..    #    
+0001dfc0: 2023 2063 7265 6174 6520 6120 6e65 7720   # create a new 
+0001dfd0: 7261 7374 6572 0d0a 2020 2020 2320 2020  raster..    #   
+0001dfe0: 2020 636f 6c73 203d 2069 6e74 286e 702e    cols = int(np.
+0001dff0: 726f 756e 6428 6162 7328 6c72 7820 2d20  round(abs(lrx - 
+0001e000: 756c 7829 202f 2070 6978 656c 5f73 7061  ulx) / pixel_spa
+0001e010: 6369 6e67 2929 0d0a 2020 2020 2320 2020  cing))..    #   
+0001e020: 2020 726f 7773 203d 2069 6e74 286e 702e    rows = int(np.
+0001e030: 726f 756e 6428 6162 7328 756c 7920 2d20  round(abs(uly - 
+0001e040: 6c72 7929 202f 2070 6978 656c 5f73 7061  lry) / pixel_spa
+0001e050: 6369 6e67 2929 0d0a 2020 2020 2320 2020  cing))..    #   
+0001e060: 2020 6473 7420 3d20 4461 7461 7365 742e    dst = Dataset.
+0001e070: 5f63 7265 6174 655f 6461 7461 7365 7428  _create_dataset(
+0001e080: 636f 6c73 2c20 726f 7773 2c20 312c 2064  cols, rows, 1, d
+0001e090: 7479 7065 2c20 6472 6976 6572 3d22 4d45  type, driver="ME
+0001e0a0: 4d22 290d 0a20 2020 2023 0d0a 2020 2020  M")..    #..    
+0001e0b0: 2320 2020 2020 2320 6e65 7720 6765 6f74  #     # new geot
+0001e0c0: 7261 6e73 666f 726d 0d0a 2020 2020 2320  ransform..    # 
+0001e0d0: 2020 2020 6e65 775f 6765 6f20 3d20 2875      new_geo = (u
+0001e0e0: 6c78 2c20 7069 7865 6c5f 7370 6163 696e  lx, pixel_spacin
+0001e0f0: 672c 2073 7263 5f67 745b 325d 2c20 756c  g, src_gt[2], ul
+0001e100: 792c 2073 7263 5f67 745b 345d 2c20 2d70  y, src_gt[4], -p
+0001e110: 6978 656c 5f73 7061 6369 6e67 290d 0a20  ixel_spacing).. 
+0001e120: 2020 2023 2020 2020 2023 2073 6574 2074     #     # set t
+0001e130: 6865 2067 656f 7472 616e 7366 6f72 6d0d  he geotransform.
+0001e140: 0a20 2020 2023 2020 2020 2064 7374 2e53  .    #     dst.S
+0001e150: 6574 4765 6f54 7261 6e73 666f 726d 286e  etGeoTransform(n
+0001e160: 6577 5f67 656f 290d 0a20 2020 2023 2020  ew_geo)..    #  
+0001e170: 2020 2023 2073 6574 2074 6865 2070 726f     # set the pro
+0001e180: 6a65 6374 696f 6e0d 0a20 2020 2023 2020  jection..    #  
+0001e190: 2020 2064 7374 2e53 6574 5072 6f6a 6563     dst.SetProjec
+0001e1a0: 7469 6f6e 2864 7374 5f65 7073 672e 4578  tion(dst_epsg.Ex
+0001e1b0: 706f 7274 546f 576b 7428 2929 0d0a 2020  portToWkt())..  
+0001e1c0: 2020 2320 2020 2020 2320 7365 7420 7468    #     # set th
+0001e1d0: 6520 6e6f 2064 6174 6120 7661 6c75 650d  e no data value.
+0001e1e0: 0a20 2020 2023 2020 2020 206e 6f5f 6461  .    #     no_da
+0001e1f0: 7461 5f76 616c 7565 203d 2073 7263 2e47  ta_value = src.G
+0001e200: 6574 5261 7374 6572 4261 6e64 2831 292e  etRasterBand(1).
+0001e210: 4765 744e 6f44 6174 6156 616c 7565 2829  GetNoDataValue()
+0001e220: 0d0a 2020 2020 2320 2020 2020 6473 7420  ..    #     dst 
+0001e230: 3d20 4461 7461 7365 742e 5f73 6574 5f6e  = Dataset._set_n
+0001e240: 6f5f 6461 7461 5f76 616c 7565 2864 7374  o_data_value(dst
+0001e250: 2c20 6e6f 5f64 6174 615f 7661 6c75 6529  , no_data_value)
+0001e260: 0d0a 2020 2020 2320 2020 2020 2320 7065  ..    #     # pe
+0001e270: 7266 6f72 6d20 7468 6520 7072 6f6a 6563  rform the projec
+0001e280: 7469 6f6e 2026 2072 6573 616d 706c 696e  tion & resamplin
+0001e290: 670d 0a20 2020 2023 2020 2020 2067 6461  g..    #     gda
+0001e2a0: 6c2e 5265 7072 6f6a 6563 7449 6d61 6765  l.ReprojectImage
+0001e2b0: 280d 0a20 2020 2023 2020 2020 2020 2020  (..    #        
+0001e2c0: 2073 7263 2c20 6473 742c 2073 7263 5f73   src, dst, src_s
+0001e2d0: 722e 4578 706f 7274 546f 576b 7428 292c  r.ExportToWkt(),
+0001e2e0: 2064 7374 5f65 7073 672e 4578 706f 7274   dst_epsg.Export
+0001e2f0: 546f 576b 7428 292c 206d 6574 686f 640d  ToWkt(), method.
+0001e300: 0a20 2020 2023 2020 2020 2029 0d0a 2020  .    #     )..  
+0001e310: 2020 230d 0a20 2020 2023 2020 2020 2072    #..    #     r
+0001e320: 6574 7572 6e20 6473 740d 0a0d 0a20 2020  eturn dst....   
+0001e330: 2064 6566 2061 6c69 676e 2873 656c 662c   def align(self,
+0001e340: 2061 6c69 676e 6d65 6e74 5f73 7263 3a20   alignment_src: 
+0001e350: 4461 7461 7365 7429 3a0d 0a20 2020 2020  Dataset):..     
+0001e360: 2020 2022 2222 6d61 7463 6844 6174 6141     """matchDataA
+0001e370: 6c69 676e 6d65 6e74 2e0d 0a0d 0a20 2020  lignment.....   
+0001e380: 2020 2020 2074 6869 7320 6675 6e63 7469       this functi
+0001e390: 6f6e 206d 6174 6368 6573 2074 6865 2063  on matches the c
+0001e3a0: 6f6f 7264 696e 6174 6520 7379 7374 656d  oordinate system
+0001e3b0: 2061 6e64 2074 6865 206e 756d 6265 7220   and the number 
+0001e3c0: 6f66 206f 6620 726f 7773 2026 2063 6f6c  of of rows & col
+0001e3d0: 756d 6e73 0d0a 2020 2020 2020 2020 6265  umns..        be
+0001e3e0: 7477 6565 6e20 7477 6f20 7261 7374 6572  tween two raster
+0001e3f0: 730d 0a20 2020 2020 2020 2052 6173 7465  s..        Raste
+0001e400: 7220 4120 6973 2074 6865 2073 6f75 7263  r A is the sourc
+0001e410: 6520 6f66 2074 6865 2063 6f6f 7264 696e  e of the coordin
+0001e420: 6174 6520 7379 7374 656d 2c20 6e6f 206f  ate system, no o
+0001e430: 6620 726f 7773 2061 6e64 206e 6f20 6f66  f rows and no of
+0001e440: 2063 6f6c 756d 6e73 2026 2063 656c 6c20   columns & cell 
+0001e450: 7369 7a65 0d0a 2020 2020 2020 2020 7261  size..        ra
+0001e460: 7374 6572 735f 6469 7220 6973 2070 6174  sters_dir is pat
+0001e470: 6820 746f 2074 6865 2066 6f6c 6465 7220  h to the folder 
+0001e480: 7768 6572 6520 5261 7374 6572 2042 2065  where Raster B e
+0001e490: 7869 7374 2077 6865 7265 2020 5261 7374  xist where  Rast
+0001e4a0: 6572 2042 2069 730d 0a20 2020 2020 2020  er B is..       
+0001e4b0: 2074 6865 2073 6f75 7263 6520 6f66 2064   the source of d
+0001e4c0: 6174 6120 7661 6c75 6573 2069 6e20 6365  ata values in ce
+0001e4d0: 6c6c 730d 0a20 2020 2020 2020 2074 6865  lls..        the
+0001e4e0: 2072 6573 756c 7420 7769 6c6c 2062 6520   result will be 
+0001e4f0: 6120 7261 7374 6572 2077 6974 6820 7468  a raster with th
+0001e500: 6520 7361 6d65 2073 7472 7563 7475 7265  e same structure
+0001e510: 206c 696b 6520 5261 7374 6572 4120 6275   like RasterA bu
+0001e520: 7420 7769 7468 0d0a 2020 2020 2020 2020  t with..        
+0001e530: 7661 6c75 6573 2066 726f 6d20 5261 7374  values from Rast
+0001e540: 6572 4220 7573 696e 6720 4e65 6172 6573  erB using Neares
+0001e550: 7420 4e65 6967 6862 6f75 7220 696e 7465  t Neighbour inte
+0001e560: 7270 6f6c 6174 696f 6e20 616c 676f 7269  rpolation algori
+0001e570: 7468 6d0d 0a0d 0a20 2020 2020 2020 2050  thm....        P
+0001e580: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
+0001e590: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
+0001e5a0: 2020 2020 2020 2061 6c69 676e 6d65 6e74         alignment
+0001e5b0: 5f73 7263 3a20 5b53 7472 696e 675d 0d0a  _src: [String]..
+0001e5c0: 2020 2020 2020 2020 2020 2020 7061 7468              path
+0001e5d0: 2074 6f20 7468 6520 7370 6174 6961 6c20   to the spatial 
+0001e5e0: 696e 666f 726d 6174 696f 6e20 736f 7572  information sour
+0001e5f0: 6365 2072 6173 7465 7220 746f 2067 6574  ce raster to get
+0001e600: 2074 6865 2073 7061 7469 616c 2069 6e66   the spatial inf
+0001e610: 6f72 6d61 7469 6f6e 0d0a 2020 2020 2020  ormation..      
+0001e620: 2020 2020 2020 2863 6f6f 7264 696e 6174        (coordinat
+0001e630: 6520 7379 7374 656d 2c20 6e6f 206f 6620  e system, no of 
+0001e640: 726f 7773 2026 2063 6f6c 756d 6e73 2920  rows & columns) 
+0001e650: 616c 6967 6e6d 656e 745f 7372 6320 7368  alignment_src sh
+0001e660: 6f75 6c64 2069 6e63 6c75 6465 2074 6865  ould include the
+0001e670: 206e 616d 6520 6f66 2074 6865 2072 6173   name of the ras
+0001e680: 7465 720d 0a20 2020 2020 2020 2020 2020  ter..           
+0001e690: 2061 6e64 2074 6865 2065 7874 656e 7369   and the extensi
+0001e6a0: 6f6e 206c 696b 6520 2264 6174 612f 6465  on like "data/de
+0001e6b0: 6d2e 7469 6622 0d0a 0d0a 2020 2020 2020  m.tif"....      
+0001e6c0: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
+0001e6d0: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
+0001e6e0: 2020 2020 6e65 7720 7261 7374 6572 733a      new rasters:
+0001e6f0: 0d0a 2020 2020 2020 2020 2020 2020 d98c  ..            ..
+0001e700: 5261 7374 6572 7320 6861 7665 2074 6865  Rasters have the
+0001e710: 2076 616c 7565 7320 6672 6f6d 2072 6173   values from ras
+0001e720: 7465 7273 2069 6e20 7261 7374 6572 735f  ters in rasters_
+0001e730: 6469 7220 7769 7468 2074 6865 2073 616d  dir with the sam
+0001e740: 650d 0a20 2020 2020 2020 2020 2020 2063  e..            c
+0001e750: 656c 6c20 7369 7a65 2c20 6e6f 206f 6620  ell size, no of 
+0001e760: 726f 7773 2026 2063 6f6c 756d 6e73 2c20  rows & columns, 
+0001e770: 636f 6f72 6469 6e61 7465 2073 7973 7465  coordinate syste
+0001e780: 6d20 616e 6420 616c 6967 6e6d 656e 7420  m and alignment 
+0001e790: 6c69 6b65 2072 6173 7465 7220 410d 0a0d  like raster A...
+0001e7a0: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
+0001e7b0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+0001e7c0: 2d2d 2d0d 0a20 2020 2020 2020 203e 3e3e  ---..        >>>
+0001e7d0: 2064 656d 5f70 6174 6820 3d20 2230 3147   dem_path = "01G
+0001e7e0: 4953 2f69 6e70 7574 732f 3430 3030 2f61  IS/inputs/4000/a
+0001e7f0: 6363 3430 3030 2e74 6966 220d 0a20 2020  cc4000.tif"..   
+0001e800: 2020 2020 203e 3e3e 2070 7265 635f 696e       >>> prec_in
+0001e810: 5f70 6174 6820 3d20 2230 3250 7265 6369  _path = "02Preci
+0001e820: 7069 7461 7469 6f6e 2f43 4849 5250 532f  pitation/CHIRPS/
+0001e830: 4461 696c 792f 220d 0a20 2020 2020 2020  Daily/"..       
+0001e840: 203e 3e3e 2070 7265 635f 6f75 745f 7061   >>> prec_out_pa
+0001e850: 7468 203d 2022 3032 5072 6563 6970 6974  th = "02Precipit
+0001e860: 6174 696f 6e2f 346b 6d2f 220d 0a20 2020  ation/4km/"..   
+0001e870: 2020 2020 203e 3e3e 2044 6174 6173 6574       >>> Dataset
+0001e880: 2e61 6c69 676e 2864 656d 5f70 6174 682c  .align(dem_path,
+0001e890: 7072 6563 5f69 6e5f 7061 7468 2c70 7265  prec_in_path,pre
+0001e8a0: 635f 6f75 745f 7061 7468 290d 0a20 2020  c_out_path)..   
+0001e8b0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+0001e8c0: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
+0001e8d0: 6e63 6528 616c 6967 6e6d 656e 745f 7372  nce(alignment_sr
+0001e8e0: 632c 2044 6174 6173 6574 293a 0d0a 2020  c, Dataset):..  
+0001e8f0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0001e900: 5479 7065 4572 726f 7228 2261 6c69 676e  TypeError("align
+0001e910: 6d65 6e74 5f73 7263 2069 6e70 7574 2073  ment_src input s
+0001e920: 686f 756c 6420 6265 2061 2044 6174 6173  hould be a Datas
+0001e930: 6574 206f 626a 6563 7422 290d 0a0d 0a20  et object").... 
+0001e940: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+0001e950: 7261 6e67 6528 7365 6c66 2e74 696d 655f  range(self.time_
+0001e960: 6c65 6e67 7468 293a 0d0a 2020 2020 2020  length):..      
+0001e970: 2020 2020 2020 7372 6320 3d20 7365 6c66        src = self
+0001e980: 2e69 6c6f 6328 6929 0d0a 2020 2020 2020  .iloc(i)..      
+0001e990: 2020 2020 2020 6473 7420 3d20 7372 632e        dst = src.
+0001e9a0: 616c 6967 6e28 616c 6967 6e6d 656e 745f  align(alignment_
+0001e9b0: 7372 6329 0d0a 2020 2020 2020 2020 2020  src)..          
+0001e9c0: 2020 6172 7220 3d20 6473 742e 7265 6164    arr = dst.read
+0001e9d0: 5f61 7272 6179 2829 0d0a 2020 2020 2020  _array()..      
+0001e9e0: 2020 2020 2020 6966 2069 203d 3d20 303a        if i == 0:
+0001e9f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001ea00: 2020 2320 6372 6561 7465 2074 6865 2061    # create the a
+0001ea10: 7272 6179 0d0a 2020 2020 2020 2020 2020  rray..          
+0001ea20: 2020 2020 2020 6172 7261 7920 3d20 280d        array = (.
+0001ea30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001ea40: 2020 2020 206e 702e 6f6e 6573 280d 0a20       np.ones(.. 
+0001ea50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ea60: 2020 2020 2020 2028 0d0a 2020 2020 2020         (..      
+0001ea70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ea80: 2020 2020 2020 7365 6c66 2e74 696d 655f        self.time_
+0001ea90: 6c65 6e67 7468 2c0d 0a20 2020 2020 2020  length,..       
+0001eaa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001eab0: 2020 2020 2061 7272 2e73 6861 7065 5b30       arr.shape[0
+0001eac0: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
+0001ead0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001eae0: 6172 722e 7368 6170 655b 315d 2c0d 0a20  arr.shape[1],.. 
+0001eaf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001eb00: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
+0001eb10: 2020 2020 2020 2020 2020 2020 2020 290d                ).
+0001eb20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001eb30: 2020 2020 202a 206e 702e 6e61 6e0d 0a20       * np.nan.. 
+0001eb40: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0001eb50: 0d0a 2020 2020 2020 2020 2020 2020 6172  ..            ar
+0001eb60: 7261 795b 692c 203a 2c20 3a5d 203d 2061  ray[i, :, :] = a
+0001eb70: 7272 0d0a 0d0a 2020 2020 2020 2020 7365  rr....        se
+0001eb80: 6c66 2e5f 6461 7461 203d 2061 7272 6179  lf._data = array
+0001eb90: 0d0a 2020 2020 2020 2020 2320 7573 6520  ..        # use 
+0001eba0: 7468 6520 6c61 7374 2073 7263 2061 730d  the last src as.
+0001ebb0: 0a20 2020 2020 2020 2073 656c 662e 5f62  .        self._b
+0001ebc0: 6173 6520 3d20 6473 740d 0a0d 0a20 2020  ase = dst....   
+0001ebd0: 2040 7374 6174 6963 6d65 7468 6f64 0d0a   @staticmethod..
+0001ebe0: 2020 2020 6465 6620 6d65 7267 6528 0d0a      def merge(..
+0001ebf0: 2020 2020 2020 2020 7372 633a 204c 6973          src: Lis
+0001ec00: 745b 7374 725d 2c0d 0a20 2020 2020 2020  t[str],..       
+0001ec10: 2064 7374 3a20 7374 722c 0d0a 2020 2020   dst: str,..    
+0001ec20: 2020 2020 6e6f 5f64 6174 615f 7661 6c75      no_data_valu
+0001ec30: 653a 2055 6e69 6f6e 5b66 6c6f 6174 2c20  e: Union[float, 
+0001ec40: 696e 742c 2073 7472 5d20 3d20 2230 222c  int, str] = "0",
+0001ec50: 0d0a 2020 2020 2020 2020 696e 6974 3a20  ..        init: 
+0001ec60: 556e 696f 6e5b 666c 6f61 742c 2069 6e74  Union[float, int
+0001ec70: 2c20 7374 725d 203d 2022 6e61 6e22 2c0d  , str] = "nan",.
+0001ec80: 0a20 2020 2020 2020 206e 3a20 556e 696f  .        n: Unio
+0001ec90: 6e5b 666c 6f61 742c 2069 6e74 2c20 7374  n[float, int, st
+0001eca0: 725d 203d 2022 6e61 6e22 2c0d 0a20 2020  r] = "nan",..   
+0001ecb0: 2029 3a0d 0a20 2020 2020 2020 2022 2222   ):..        """
+0001ecc0: 6d65 7267 652e 0d0a 0d0a 2020 2020 2020  merge.....      
+0001ecd0: 2020 2020 2020 6d65 7267 6573 2067 726f        merges gro
+0001ece0: 7570 206f 6620 7261 7374 6572 7320 696e  up of rasters in
+0001ecf0: 746f 206f 6e65 2072 6173 7465 720d 0a0d  to one raster...
+0001ed00: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+0001ed10: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
+0001ed20: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+0001ed30: 2073 7263 3a20 4c69 7374 5b73 7472 5d0d   src: List[str].
+0001ed40: 0a20 2020 2020 2020 2020 2020 206c 6973  .            lis
+0001ed50: 7420 6f66 2074 6865 2070 6174 6820 746f  t of the path to
+0001ed60: 2061 6c6c 2069 6e70 7574 2072 6173 7465   all input raste
+0001ed70: 720d 0a20 2020 2020 2020 2064 7374 3a20  r..        dst: 
+0001ed80: 5b73 7472 5d0d 0a20 2020 2020 2020 2020  [str]..         
+0001ed90: 2020 2070 6174 6820 746f 2074 6865 206f     path to the o
+0001eda0: 7574 7075 7420 7261 7374 6572 0d0a 2020  utput raster..  
+0001edb0: 2020 2020 2020 6e6f 5f64 6174 615f 7661        no_data_va
+0001edc0: 6c75 653a 205b 666c 6f61 742f 696e 745d  lue: [float/int]
+0001edd0: 0d0a 2020 2020 2020 2020 2020 2020 4173  ..            As
+0001ede0: 7369 676e 2061 2073 7065 6369 6669 6564  sign a specified
+0001edf0: 206e 6f64 6174 6120 7661 6c75 6520 746f   nodata value to
+0001ee00: 206f 7574 7075 7420 6261 6e64 732e 0d0a   output bands...
+0001ee10: 2020 2020 2020 2020 696e 6974 3a20 5b66          init: [f
+0001ee20: 6c6f 6174 2f69 6e74 5d0d 0a20 2020 2020  loat/int]..     
+0001ee30: 2020 2020 2020 2050 7265 2d69 6e69 7469         Pre-initi
+0001ee40: 616c 697a 6520 7468 6520 6f75 7470 7574  alize the output
+0001ee50: 2069 6d61 6765 2062 616e 6473 2077 6974   image bands wit
+0001ee60: 6820 7468 6573 6520 7661 6c75 6573 2e20  h these values. 
+0001ee70: 486f 7765 7665 722c 2069 7420 6973 206e  However, it is n
+0001ee80: 6f74 206d 6172 6b65 6420 6173 2074 6865  ot marked as the
+0001ee90: 206e 6f64 6174 6120 7661 6c75 650d 0a20   nodata value.. 
+0001eea0: 2020 2020 2020 2020 2020 2069 6e20 7468             in th
+0001eeb0: 6520 6f75 7470 7574 2066 696c 652e 2049  e output file. I
+0001eec0: 6620 6f6e 6c79 206f 6e65 2076 616c 7565  f only one value
+0001eed0: 2069 7320 6769 7665 6e2c 2074 6865 2073   is given, the s
+0001eee0: 616d 6520 7661 6c75 6520 6973 2075 7365  ame value is use
+0001eef0: 6420 696e 2061 6c6c 2074 6865 2062 616e  d in all the ban
+0001ef00: 6473 2e0d 0a20 2020 2020 2020 206e 3a20  ds...        n: 
+0001ef10: 5b66 6c6f 6174 2f69 6e74 5d0d 0a20 2020  [float/int]..   
+0001ef20: 2020 2020 2020 2020 2049 676e 6f72 6520           Ignore 
+0001ef30: 7069 7865 6c73 2066 726f 6d20 6669 6c65  pixels from file
+0001ef40: 7320 6265 696e 6720 6d65 7267 6564 2069  s being merged i
+0001ef50: 6e20 7769 7468 2074 6869 7320 7069 7865  n with this pixe
+0001ef60: 6c20 7661 6c75 652e 0d0a 0d0a 2020 2020  l value.....    
+0001ef70: 2020 2020 5265 7475 726e 730d 0a20 2020      Returns..   
+0001ef80: 2020 2020 202d 2d2d 2d2d 2d2d 0d0a 2020       -------..  
+0001ef90: 2020 2020 2020 4e6f 6e65 0d0a 2020 2020        None..    
+0001efa0: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
+0001efb0: 2023 2072 756e 2074 6865 2063 6f6d 6d61   # run the comma
+0001efc0: 6e64 0d0a 2020 2020 2020 2020 2320 636d  nd..        # cm
+0001efd0: 6420 3d20 2267 6461 6c5f 6d65 7267 652e  d = "gdal_merge.
+0001efe0: 7079 202d 6f20 6d65 7267 6564 5f69 6d61  py -o merged_ima
+0001eff0: 6765 5f31 2e74 6966 220d 0a20 2020 2020  ge_1.tif"..     
+0001f000: 2020 2023 2073 7562 7072 6f63 6573 732e     # subprocess.
+0001f010: 6361 6c6c 2863 6d64 2e73 706c 6974 2829  call(cmd.split()
+0001f020: 202b 2066 696c 655f 6c69 7374 290d 0a20   + file_list).. 
+0001f030: 2020 2020 2020 2023 2076 7274 203d 2067         # vrt = g
+0001f040: 6461 6c2e 4275 696c 6456 5254 2822 6d65  dal.BuildVRT("me
+0001f050: 7267 6564 2e76 7274 222c 2066 696c 655f  rged.vrt", file_
+0001f060: 6c69 7374 290d 0a20 2020 2020 2020 2023  list)..        #
+0001f070: 2073 7263 203d 2067 6461 6c2e 5472 616e   src = gdal.Tran
+0001f080: 736c 6174 6528 226d 6572 6765 645f 696d  slate("merged_im
+0001f090: 6167 652e 7469 6622 2c20 7672 7429 0d0a  age.tif", vrt)..
+0001f0a0: 0d0a 2020 2020 2020 2020 7061 7261 6d65  ..        parame
+0001f0b0: 7465 7273 203d 2028 0d0a 2020 2020 2020  ters = (..      
+0001f0c0: 2020 2020 2020 5b22 222c 2022 2d6f 222c        ["", "-o",
+0001f0d0: 2064 7374 5d0d 0a20 2020 2020 2020 2020   dst]..         
+0001f0e0: 2020 202b 2073 7263 0d0a 2020 2020 2020     + src..      
+0001f0f0: 2020 2020 2020 2b20 5b0d 0a20 2020 2020        + [..     
+0001f100: 2020 2020 2020 2020 2020 2022 2d63 6f22             "-co"
+0001f110: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0001f120: 2020 2022 434f 4d50 5245 5353 3d4c 5a57     "COMPRESS=LZW
+0001f130: 222c 0d0a 2020 2020 2020 2020 2020 2020  ",..            
+0001f140: 2020 2020 222d 696e 6974 222c 0d0a 2020      "-init",..  
+0001f150: 2020 2020 2020 2020 2020 2020 2020 7374                st
+0001f160: 7228 696e 6974 292c 0d0a 2020 2020 2020  r(init),..      
+0001f170: 2020 2020 2020 2020 2020 222d 615f 6e6f            "-a_no
+0001f180: 6461 7461 222c 0d0a 2020 2020 2020 2020  data",..        
+0001f190: 2020 2020 2020 2020 7374 7228 6e6f 5f64          str(no_d
+0001f1a0: 6174 615f 7661 6c75 6529 2c0d 0a20 2020  ata_value),..   
+0001f1b0: 2020 2020 2020 2020 2020 2020 2022 2d6e               "-n
+0001f1c0: 222c 0d0a 2020 2020 2020 2020 2020 2020  ",..            
+0001f1d0: 2020 2020 7374 7228 6e29 2c0d 0a20 2020      str(n),..   
+0001f1e0: 2020 2020 2020 2020 205d 0d0a 2020 2020           ]..    
+0001f1f0: 2020 2020 2920 2023 2027 2d73 6570 6172      )  # '-separ
+0001f200: 6174 6527 0d0a 2020 2020 2020 2020 6764  ate'..        gd
+0001f210: 616c 5f6d 6572 6765 2e6d 6169 6e28 7061  al_merge.main(pa
+0001f220: 7261 6d65 7465 7273 290d 0a0d 0a20 2020  rameters)....   
+0001f230: 2064 6566 2061 7070 6c79 2873 656c 662c   def apply(self,
+0001f240: 2075 6675 6e63 3a20 4361 6c6c 6162 6c65   ufunc: Callable
+0001f250: 293a 0d0a 2020 2020 2020 2020 2222 2266  ):..        """f
+0001f260: 6f6c 6465 7243 616c 6375 6c61 746f 722e  olderCalculator.
+0001f270: 0d0a 0d0a 2020 2020 2020 2020 7468 6973  ....        this
+0001f280: 2066 756e 6374 696f 6e20 6d61 7463 6865   function matche
+0001f290: 7320 7468 6520 6c6f 6361 7469 6f6e 206f  s the location o
+0001f2a0: 6620 6e6f 6461 7461 2076 616c 7565 2066  f nodata value f
+0001f2b0: 726f 6d20 7372 6320 7261 7374 6572 2074  rom src raster t
+0001f2c0: 6f20 6473 740d 0a20 2020 2020 2020 2072  o dst..        r
+0001f2d0: 6173 7465 720d 0a20 2020 2020 2020 2044  aster..        D
+0001f2e0: 6174 6173 6574 2041 2069 7320 7768 6572  ataset A is wher
+0001f2f0: 6520 7468 6520 4e6f 4461 7461 7661 6c75  e the NoDatavalu
+0001f300: 6520 7769 6c6c 2062 6520 7461 6b65 6e20  e will be taken 
+0001f310: 616e 6420 7468 6520 6c6f 6361 7469 6f6e  and the location
+0001f320: 206f 6620 7468 6973 2076 616c 7565 0d0a   of this value..
+0001f330: 2020 2020 2020 2020 425f 696e 7075 745f          B_input_
+0001f340: 7061 7468 2069 7320 7061 7468 2074 6f20  path is path to 
+0001f350: 7468 6520 666f 6c64 6572 2077 6865 7265  the folder where
+0001f360: 2044 6174 6173 6574 2042 2065 7869 7374   Dataset B exist
+0001f370: 2077 6865 7265 2020 7765 206e 6565 6420   where  we need 
+0001f380: 746f 2070 7574 0d0a 2020 2020 2020 2020  to put..        
+0001f390: 7468 6520 4e6f 4461 7461 5661 6c75 6520  the NoDataValue 
+0001f3a0: 6f66 2052 6173 7465 7241 2069 6e20 5261  of RasterA in Ra
+0001f3b0: 7374 6572 4220 6174 2074 6865 2073 616d  sterB at the sam
+0001f3c0: 6520 6c6f 6361 7469 6f6e 730d 0a0d 0a20  e locations.... 
+0001f3d0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+0001f3e0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+0001f3f0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2075  -----..        u
+0001f400: 6675 6e63 3a20 5b66 756e 6374 696f 6e5d  func: [function]
+0001f410: 0d0a 2020 2020 2020 2020 2020 2020 6361  ..            ca
+0001f420: 6c6c 6162 6c65 2075 6e69 7665 7273 616c  llable universal
+0001f430: 2066 756e 6374 696f 6e20 7566 756e 6320   function ufunc 
+0001f440: 2862 7569 6c74 696e 206f 7220 7573 6572  (builtin or user
+0001f450: 2064 6566 696e 6564 290d 0a20 2020 2020   defined)..     
+0001f460: 2020 2020 2020 2068 7474 7073 3a2f 2f6e         https://n
+0001f470: 756d 7079 2e6f 7267 2f64 6f63 2f73 7461  umpy.org/doc/sta
+0001f480: 626c 652f 7265 6665 7265 6e63 652f 7566  ble/reference/uf
+0001f490: 756e 6373 2e68 746d 6c0d 0a20 2020 2020  uncs.html..     
+0001f4a0: 2020 2020 2020 202d 2074 6f20 6372 6561         - to crea
+0001f4b0: 7465 2061 2075 6675 6e63 2066 726f 6d20  te a ufunc from 
+0001f4c0: 6120 6e6f 726d 616c 2066 756e 6374 696f  a normal functio
+0001f4d0: 6e20 2868 7474 7073 3a2f 2f6e 756d 7079  n (https://numpy
+0001f4e0: 2e6f 7267 2f64 6f63 2f73 7461 626c 652f  .org/doc/stable/
+0001f4f0: 7265 6665 7265 6e63 652f 6765 6e65 7261  reference/genera
+0001f500: 7465 642f 6e75 6d70 792e 6672 6f6d 7079  ted/numpy.frompy
+0001f510: 6675 6e63 2e68 746d 6c29 0d0a 0d0a 2020  func.html)....  
+0001f520: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
+0001f530: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
+0001f540: 2020 2020 2020 2020 6e65 7720 7261 7374          new rast
+0001f550: 6572 7320 7769 6c6c 2062 6520 7361 7665  ers will be save
+0001f560: 6420 746f 2074 6865 2073 6176 655f 746f  d to the save_to
+0001f570: 0d0a 0d0a 2020 2020 2020 2020 4578 616d  ....        Exam
+0001f580: 706c 6573 0d0a 2020 2020 2020 2020 2d2d  ples..        --
+0001f590: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+0001f5a0: 3e3e 3e20 6465 6620 6675 6e63 2876 616c  >>> def func(val
+0001f5b0: 293a 0d0a 2020 2020 2020 2020 3e3e 3e20  ):..        >>> 
+0001f5c0: 2020 2072 6574 7572 6e20 7661 6c25 320d     return val%2.
+0001f5d0: 0a20 2020 2020 2020 203e 3e3e 2075 6675  .        >>> ufu
+0001f5e0: 6e63 203d 206e 702e 6672 6f6d 7079 6675  nc = np.frompyfu
+0001f5f0: 6e63 2866 756e 632c 2031 2c20 3129 0d0a  nc(func, 1, 1)..
+0001f600: 2020 2020 2020 2020 3e3e 3e20 6461 7461          >>> data
+0001f610: 7365 742e 6170 706c 7928 7566 756e 6329  set.apply(ufunc)
+0001f620: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+0001f630: 2020 2020 2020 2069 6620 6e6f 7420 6361         if not ca
+0001f640: 6c6c 6162 6c65 2875 6675 6e63 293a 0d0a  llable(ufunc):..
+0001f650: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0001f660: 6520 5479 7065 4572 726f 7228 2273 6563  e TypeError("sec
+0001f670: 6f6e 6420 6172 6775 6d65 6e74 2073 686f  ond argument sho
+0001f680: 756c 6420 6265 2061 2066 756e 6374 696f  uld be a functio
+0001f690: 6e22 290d 0a20 2020 2020 2020 2061 7272  n")..        arr
+0001f6a0: 203d 2073 656c 662e 6461 7461 0d0a 2020   = self.data..  
+0001f6b0: 2020 2020 2020 6e6f 5f64 6174 615f 7661        no_data_va
+0001f6c0: 6c75 6520 3d20 7365 6c66 2e62 6173 652e  lue = self.base.
+0001f6d0: 6e6f 5f64 6174 615f 7661 6c75 655b 305d  no_data_value[0]
+0001f6e0: 0d0a 2020 2020 2020 2020 2320 6578 6563  ..        # exec
+0001f6f0: 7574 6520 7468 6520 6675 6e63 7469 6f6e  ute the function
+0001f700: 206f 6e20 6561 6368 2072 6173 7465 720d   on each raster.
+0001f710: 0a20 2020 2020 2020 2061 7272 5b7e 6e70  .        arr[~np
+0001f720: 2e69 7363 6c6f 7365 2861 7272 2c20 6e6f  .isclose(arr, no
+0001f730: 5f64 6174 615f 7661 6c75 652c 2072 746f  _data_value, rto
+0001f740: 6c3d 302e 3030 3129 5d20 3d20 7566 756e  l=0.001)] = ufun
+0001f750: 6328 0d0a 2020 2020 2020 2020 2020 2020  c(..            
+0001f760: 6172 725b 7e6e 702e 6973 636c 6f73 6528  arr[~np.isclose(
+0001f770: 6172 722c 206e 6f5f 6461 7461 5f76 616c  arr, no_data_val
+0001f780: 7565 2c20 7274 6f6c 3d30 2e30 3031 295d  ue, rtol=0.001)]
+0001f790: 0d0a 2020 2020 2020 2020 290d 0a0d 0a20  ..        ).... 
+0001f7a0: 2020 2064 6566 206f 7665 726c 6179 280d     def overlay(.
+0001f7b0: 0a20 2020 2020 2020 2073 656c 662c 0d0a  .        self,..
+0001f7c0: 2020 2020 2020 2020 636c 6173 7365 735f          classes_
+0001f7d0: 6d61 702c 0d0a 2020 2020 2020 2020 6578  map,..        ex
+0001f7e0: 636c 7564 655f 7661 6c75 653a 2055 6e69  clude_value: Uni
+0001f7f0: 6f6e 5b66 6c6f 6174 2c20 696e 745d 203d  on[float, int] =
+0001f800: 204e 6f6e 652c 0d0a 2020 2020 2920 2d3e   None,..    ) ->
+0001f810: 2044 6963 745b 4c69 7374 5b66 6c6f 6174   Dict[List[float
+0001f820: 5d2c 204c 6973 745b 666c 6f61 745d 5d3a  ], List[float]]:
+0001f830: 0d0a 2020 2020 2020 2020 2222 2274 6869  ..        """thi
+0001f840: 7320 6675 6e63 7469 6f6e 2069 7320 7772  s function is wr
+0001f850: 6974 7465 6e20 746f 2065 7874 7261 6374  itten to extract
+0001f860: 2061 6e64 2072 6574 7572 6e20 6120 6c69   and return a li
+0001f870: 7374 206f 6620 616c 6c20 7468 6520 7661  st of all the va
+0001f880: 6c75 6573 2069 6e20 616e 2041 5343 4949  lues in an ASCII
+0001f890: 2066 696c 652e 0d0a 0d0a 2020 2020 2020   file.....      
+0001f8a0: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
+0001f8b0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0001f8c0: 0d0a 2020 2020 2020 2020 636c 6173 7365  ..        classe
+0001f8d0: 735f 6d61 703a 205b 4461 7461 7365 745d  s_map: [Dataset]
+0001f8e0: 0d0a 2020 2020 2020 2020 2020 2020 4461  ..            Da
+0001f8f0: 7461 7365 7420 4f62 6a65 6374 2066 7072  taset Object fpr
+0001f900: 2074 6865 2072 6173 7465 7220 7468 6174   the raster that
+0001f910: 2068 6176 6520 636c 6173 7365 7320 796f   have classes yo
+0001f920: 7520 7761 6e74 2074 6f20 6f76 6572 6c61  u want to overla
+0001f930: 7920 7769 7468 2074 6865 2072 6173 7465  y with the raste
+0001f940: 722e 0d0a 2020 2020 2020 2020 6578 636c  r...        excl
+0001f950: 7564 655f 7661 6c75 653a 205b 4e75 6d65  ude_value: [Nume
+0001f960: 7269 635d 0d0a 2020 2020 2020 2020 2020  ric]..          
+0001f970: 2020 7661 6c75 6573 2079 6f75 2077 616e    values you wan
+0001f980: 7420 746f 2065 7863 6c75 6465 2066 726f  t to exclude fro
+0001f990: 6d20 6578 7472 6163 7465 6420 7661 6c75  m extracted valu
+0001f9a0: 6573 2e0d 0a0d 0a20 2020 2020 2020 2052  es.....        R
+0001f9b0: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
+0001f9c0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+0001f9d0: 2044 6963 7469 6f6e 6172 793a 0d0a 2020   Dictionary:..  
+0001f9e0: 2020 2020 2020 2020 2020 6469 6374 6f6e            dicton
+0001f9f0: 6172 7920 7769 7468 2061 206c 6973 7420  ary with a list 
+0001fa00: 6f66 2076 616c 7565 7320 696e 2074 6865  of values in the
+0001fa10: 2062 6173 656d 6170 2061 7320 6b65 7973   basemap as keys
+0001fa20: 2061 6e64 2066 6f72 2065 6163 6820 6b65   and for each ke
+0001fa30: 7920 6120 6c69 7374 206f 6620 616c 6c20  y a list of all 
+0001fa40: 7468 6520 696e 7465 7273 6563 7465 640d  the intersected.
+0001fa50: 0a20 2020 2020 2020 2020 2020 2076 616c  .            val
+0001fa60: 7565 7320 696e 2074 6865 206d 6170 7320  ues in the maps 
+0001fa70: 6672 6f6d 2074 6865 2070 6174 682e 0d0a  from the path...
+0001fa80: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+0001fa90: 2020 2020 2076 616c 7565 7320 3d20 7b7d       values = {}
+0001faa0: 0d0a 2020 2020 2020 2020 666f 7220 6920  ..        for i 
+0001fab0: 696e 2072 616e 6765 2873 656c 662e 7469  in range(self.ti
+0001fac0: 6d65 5f6c 656e 6774 6829 3a0d 0a20 2020  me_length):..   
+0001fad0: 2020 2020 2020 2020 2073 7263 203d 2073           src = s
+0001fae0: 656c 662e 696c 6f63 2869 290d 0a20 2020  elf.iloc(i)..   
+0001faf0: 2020 2020 2020 2020 2064 6963 745f 6920           dict_i 
+0001fb00: 3d20 7372 632e 6f76 6572 6c61 7928 636c  = src.overlay(cl
+0001fb10: 6173 7365 735f 6d61 702c 2065 7863 6c75  asses_map, exclu
+0001fb20: 6465 5f76 616c 7565 290d 0a0d 0a20 2020  de_value)....   
+0001fb30: 2020 2020 2020 2020 2023 2074 6865 7365           # these
+0001fb40: 2061 7265 2074 6865 2064 6573 7469 6e63   are the destinc
+0001fb50: 7420 7661 6c75 6573 2066 726f 6d20 7468  t values from th
+0001fb60: 6520 4261 7365 4d61 7020 7768 6963 6820  e BaseMap which 
+0001fb70: 6172 6520 6b65 7973 2069 6e20 7468 650d  are keys in the.
+0001fb80: 0a20 2020 2020 2020 2020 2020 2023 2045  .            # E
+0001fb90: 7874 7261 6374 6564 5661 6c75 6573 6920  xtractedValuesi 
+0001fba0: 6469 6374 2077 6974 6820 6561 6368 206f  dict with each o
+0001fbb0: 6e65 2068 6176 696e 6720 6120 6c69 7374  ne having a list
+0001fbc0: 206f 6620 7661 6c75 6573 0d0a 2020 2020   of values..    
+0001fbd0: 2020 2020 2020 2020 636c 6173 7365 7320          classes 
+0001fbe0: 3d20 6c69 7374 2864 6963 745f 692e 6b65  = list(dict_i.ke
+0001fbf0: 7973 2829 290d 0a0d 0a20 2020 2020 2020  ys())....       
+0001fc00: 2020 2020 2066 6f72 2063 6c61 7373 5f69       for class_i
+0001fc10: 2069 6e20 636c 6173 7365 733a 0d0a 2020   in classes:..  
+0001fc20: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0001fc30: 2063 6c61 7373 5f69 206e 6f74 2069 6e20   class_i not in 
+0001fc40: 7661 6c75 6573 2e6b 6579 7328 293a 0d0a  values.keys():..
+0001fc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fc60: 2020 2020 7661 6c75 6573 5b63 6c61 7373      values[class
+0001fc70: 5f69 5d20 3d20 6c69 7374 2829 0d0a 0d0a  _i] = list()....
+0001fc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fc90: 7661 6c75 6573 5b63 6c61 7373 5f69 5d20  values[class_i] 
+0001fca0: 3d20 7661 6c75 6573 5b63 6c61 7373 5f69  = values[class_i
+0001fcb0: 5d20 2b20 6469 6374 5f69 5b63 6c61 7373  ] + dict_i[class
+0001fcc0: 5f69 5d0d 0a0d 0a20 2020 2020 2020 2072  _i]....        r
+0001fcd0: 6574 7572 6e20 7661 6c75 6573 0d0a 0d0a  eturn values....
+0001fce0: 2020 2020 2320 4073 7461 7469 636d 6574      # @staticmet
+0001fcf0: 686f 640d 0a20 2020 2023 2064 6566 2072  hod..    # def r
+0001fd00: 6561 644e 4328 0d0a 2020 2020 2320 2020  eadNC(..    #   
+0001fd10: 2020 2020 2020 7061 7468 2c0d 0a20 2020        path,..   
+0001fd20: 2023 2020 2020 2020 2020 2073 6176 655f   #         save_
+0001fd30: 746f 3a20 7374 722c 0d0a 2020 2020 2320  to: str,..    # 
+0001fd40: 2020 2020 2020 2020 7365 7061 7261 746f          separato
+0001fd50: 723a 2073 7472 203d 2022 5f22 2c0d 0a20  r: str = "_",.. 
+0001fd60: 2020 2023 2020 2020 2020 2020 2074 696d     #         tim
+0001fd70: 655f 7661 725f 6e61 6d65 3a20 7374 7220  e_var_name: str 
+0001fd80: 3d20 4e6f 6e65 2c0d 0a20 2020 2023 2020  = None,..    #  
+0001fd90: 2020 2020 2020 2070 7265 6669 783a 2073         prefix: s
+0001fda0: 7472 203d 204e 6f6e 652c 0d0a 2020 2020  tr = None,..    
+0001fdb0: 2320 293a 0d0a 2020 2020 230d 0a20 2020  # ):..    #..   
+0001fdc0: 2023 2020 2020 2069 6620 6973 696e 7374   #     if isinst
+0001fdd0: 616e 6365 2870 6174 682c 2073 7472 293a  ance(path, str):
+0001fde0: 0d0a 2020 2020 2320 2020 2020 2020 2020  ..    #         
+0001fdf0: 6e63 203d 206e 6574 4344 4634 2e44 6174  nc = netCDF4.Dat
+0001fe00: 6163 7562 6528 7061 7468 290d 0a20 2020  acube(path)..   
+0001fe10: 2023 2020 2020 2065 6c69 6620 6973 696e   #     elif isin
+0001fe20: 7374 616e 6365 2870 6174 682c 206c 6973  stance(path, lis
+0001fe30: 7429 3a0d 0a20 2020 2023 2020 2020 2020  t):..    #      
+0001fe40: 2020 206e 6320 3d20 6e65 7443 4446 342e     nc = netCDF4.
+0001fe50: 4d46 4461 7461 7365 7428 7061 7468 290d  MFDataset(path).
+0001fe60: 0a20 2020 2023 2020 2020 2065 6c73 653a  .    #     else:
+0001fe70: 0d0a 2020 2020 2320 2020 2020 2020 2020  ..    #         
+0001fe80: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
+0001fe90: 0d0a 2020 2020 2320 2020 2020 2020 2020  ..    #         
+0001fea0: 2020 2020 2246 6972 7374 2070 6172 616d      "First param
+0001feb0: 6574 6572 2074 6f20 7468 6520 6e63 746f  eter to the ncto
+0001fec0: 5469 6666 2066 756e 6374 696f 6e20 7368  Tiff function sh
+0001fed0: 6f75 6c64 2062 6520 6569 7468 6572 2073  ould be either s
+0001fee0: 7472 206f 7220 6c69 7374 220d 0a20 2020  tr or list"..   
+0001fef0: 2023 2020 2020 2020 2020 2029 0d0a 2020   #         )..  
+0001ff00: 2020 230d 0a20 2020 2023 2020 2020 2023    #..    #     #
+0001ff10: 2067 6574 2074 6865 2076 6172 6961 626c   get the variabl
+0001ff20: 650d 0a20 2020 2023 2020 2020 2056 6172  e..    #     Var
+0001ff30: 203d 206c 6973 7428 6e63 2e73 7562 7365   = list(nc.subse
+0001ff40: 7473 2e6b 6579 7328 2929 5b2d 315d 0d0a  ts.keys())[-1]..
+0001ff50: 2020 2020 2320 2020 2020 2320 6578 7472      #     # extr
+0001ff60: 6163 7420 7468 6520 6461 7461 0d0a 2020  act the data..  
+0001ff70: 2020 2320 2020 2020 6461 7461 7365 7420    #     dataset 
+0001ff80: 3d20 6e63 5b56 6172 5d0d 0a20 2020 2023  = nc[Var]..    #
+0001ff90: 2020 2020 2023 2067 6574 2074 6865 2064       # get the d
+0001ffa0: 6574 6169 6c73 206f 6620 7468 6520 6669  etails of the fi
+0001ffb0: 6c65 0d0a 2020 2020 2320 2020 2020 6765  le..    #     ge
+0001ffc0: 6f2c 2065 7073 672c 205f 2c20 5f2c 2074  o, epsg, _, _, t
+0001ffd0: 696d 655f 6c65 6e2c 2074 696d 655f 7661  ime_len, time_va
+0001ffe0: 722c 206e 6f5f 6461 7461 5f76 616c 7565  r, no_data_value
+0001fff0: 2c20 6461 7461 7479 7065 203d 204e 432e  , datatype = NC.
+00020000: 6765 744e 4344 6574 6169 6c73 280d 0a20  getNCDetails(.. 
+00020010: 2020 2023 2020 2020 2020 2020 206e 632c     #         nc,
+00020020: 2074 696d 655f 7661 725f 6e61 6d65 3d74   time_var_name=t
+00020030: 696d 655f 7661 725f 6e61 6d65 0d0a 2020  ime_var_name..  
+00020040: 2020 2320 2020 2020 290d 0a20 2020 2023    #     )..    #
+00020050: 2020 2020 2070 7269 6e74 2822 7373 7322       print("sss"
+00020060: 290d 0a                                  )..
```

### Comparing `pyramids-gis-0.3.3/pyramids_gis.egg-info/PKG-INFO` & `pyramids-gis-0.4.0/pyramids_gis.egg-info/PKG-INFO`

 * *Files 11% similar despite different names*

```diff
@@ -1,16 +1,16 @@
 Metadata-Version: 2.1
 Name: pyramids-gis
-Version: 0.3.3
+Version: 0.4.0
 Summary: GIS utility package
 Home-page: https://github.com/MAfarrag/pyramids
 Author: Mostafa Farrag
 Author-email: moah.farag@gmail.come
 License: GNU General Public License v3
-Keywords: GIS,gdal,rasterio
+Keywords: GIS,gdal
 Classifier: Development Status :: 5 - Production/Stable
 Classifier: Environment :: Console
 Classifier: License :: OSI Approved :: GNU General Public License v3 (GPLv3)
 Classifier: Natural Language :: English
 Classifier: Programming Language :: Python :: 3
 Classifier: Programming Language :: Python :: 3.7
 Classifier: Programming Language :: Python :: 3.8
@@ -86,26 +86,29 @@
 ```
 pip install git+https://github.com/Serapieum-of-alex/pyramids
 ```
 
 ## pip
 to install the last release you can easly use pip
 ```
-pip install pyramids-gis==0.3.3
+pip install pyramids-gis==0.4.0
 ```
 
 Quick start
 ===========
 
 ```
   >>> import pyramids
 ```
 
 [other code samples](https://pyramids-gis.readthedocs.io/en/latest/?badge=latest)
 
+## Coverage
+[![codecov](https://codecov.io/gh/Serapieum-of-alex/pyramids/branch/main/graphs/sunburst.svg?token=g0DV4dCa8N)](https://codecov.io/gh/Serapieum-of-alex/pyramids)
+
 
 =======
 History
 =======
 
 0.1.0 (2022-05-24)
 ------------------
@@ -152,7 +155,18 @@
 * add documentation
 * fix creating memory driver with compression in _createDataset
 
 0.3.3 (2023-02-06)
 ------------------
 * fix bug in reading the ogr drivers catalog for the vector class
 * fix bug in creating rasterLike in the asciiToRaster method
+
+0.4.0 (2023-04-11)
+------------------
+* Restructure the whole package to two main objects Dataset and FeatureCollection
+* Add class for multiple Dataset "DataCube".
+* Link both Dataset and FeatureCollection to convert between raster and vector data types.
+* Remove rasterio and netcdf from dependencies and depend only on gdal.
+* Test read rasters/netcdf from virtual file systems (aws, compressed)
+* Add dunder methods for all classes.
+* add plotting functionality and cleopatra (plotting package) as an optional package.
+* remove loops and replace it with ufunc from numpy.
```

### Comparing `pyramids-gis-0.3.3/setup.py` & `pyramids-gis-0.4.0/setup.py`

 * *Files 4% similar despite different names*

```diff
@@ -7,20 +7,20 @@
     history = history_file.read()
 
 requirements = [line.strip() for line in open("requirements.txt").readlines()]
 requirements_dev = [line.strip() for line in open("requirements-dev.txt").readlines()]
 
 setup(
     name="pyramids-gis",
-    version="0.3.3",
+    version="0.4.0",
     description="GIS utility package",
     author="Mostafa Farrag",
     author_email="moah.farag@gmail.come",
     url="https://github.com/MAfarrag/pyramids",
-    keywords=["GIS", "gdal", "rasterio"],
+    keywords=["GIS", "gdal"],
     long_description=readme + "\n\n" + history,
     repository="https://github.com/MAfarrag/pyramids",
     documentation="https://pyramids-gis.readthedocs.io/",
     long_description_content_type="text/markdown",
     license="GNU General Public License v3",
     zip_safe=False,
     packages=find_packages(include=["pyramids", "pyramids.*"]),
@@ -36,8 +36,10 @@
         "Programming Language :: Python :: 3.7",
         "Programming Language :: Python :: 3.8",
         "Programming Language :: Python :: 3.9",
         "Topic :: Scientific/Engineering :: GIS",
         "Intended Audience :: Science/Research",
         "Intended Audience :: Developers",
     ],
+    include_package_data=True,
+    package_data={"": ["gdal_drivers.yaml", "ogr_drivers.yaml"]},
 )
```

